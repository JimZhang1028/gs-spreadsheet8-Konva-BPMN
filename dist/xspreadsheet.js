!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=68)}([function(t,e){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),r=n(3);e.Factory={addGetterSetter:function(t,e,n,i,r){this.addGetter(t,e,n),this.addSetter(t,e,i,r),this.addOverloadedGetterSetter(t,e)},addGetter:function(t,e,n){var r="get"+i.Util._capitalize(e);t.prototype[r]=t.prototype[r]||function(){var t=this.attrs[e];return void 0===t?n:t}},addSetter:function(t,n,r,o){var a="set"+i.Util._capitalize(n);t.prototype[a]||e.Factory.overWriteSetter(t,n,r,o)},overWriteSetter:function(t,e,n,r){var o="set"+i.Util._capitalize(e);t.prototype[o]=function(t){return n&&null!=t&&(t=n.call(this,t,e)),this._setAttr(e,t),r&&r.call(this),this}},addComponentsGetterSetter:function(t,e,n,o,a){var s,c,l=n.length,u=i.Util._capitalize,h="get"+u(e),p="set"+u(e);t.prototype[h]=function(){var t={};for(s=0;s<l;s++)t[c=n[s]]=this.getAttr(e+u(c));return t};var d=r.getComponentValidator(n);t.prototype[p]=function(t){var n,i=this.attrs[e];for(n in o&&(t=o.call(this,t)),d&&d.call(this,t,e),t)t.hasOwnProperty(n)&&this._setAttr(e+u(n),t[n]);return this._fireChangeEvent(e,i,t),a&&a.call(this),this},this.addOverloadedGetterSetter(t,e)},addOverloadedGetterSetter:function(t,e){var n=i.Util._capitalize(e),r="set"+n,o="get"+n;t.prototype[e]=function(){return arguments.length?(this[r](arguments[0]),this):this[o]()}},addDeprecatedGetterSetter:function(t,e,n,r){i.Util.error("Adding deprecated "+e);var o="get"+i.Util._capitalize(e),a=e+" property is deprecated and will be removed soon. Look at Konva change log for more information.";t.prototype[o]=function(){i.Util.error(a);var t=this.attrs[e];return void 0===t?n:t},this.addSetter(t,e,r,(function(){i.Util.error(a)})),this.addOverloadedGetterSetter(t,e)},backCompat:function(t,e){i.Util.each(e,(function(e,n){var r=t.prototype[n],o="get"+i.Util._capitalize(e),a="set"+i.Util._capitalize(e);function s(){r.apply(this,arguments),i.Util.error('"'+e+'" method is deprecated and will be removed soon. Use ""'+n+'" instead.')}t.prototype[e]=s,t.prototype[o]=s,t.prototype[a]=s}))},afterSetFilter:function(){this._filterUpToDate=!1}}},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=Math.PI/180;var i=function(t){var e=t.indexOf("msie ");if(e>0)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(t.indexOf("trident/")>0){var n=t.indexOf("rv:");return parseInt(t.substring(n+3,t.indexOf(".",n)),10)}var i=t.indexOf("edge/");return i>0&&parseInt(t.substring(i+5,t.indexOf(".",i)),10)};e._parseUA=function(t){var e=t.toLowerCase(),n=/(chrome)[ /]([\w.]+)/.exec(e)||/(webkit)[ /]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ /]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],r=!!t.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i),o=!!t.match(/IEMobile/i);return{browser:n[1]||"",version:n[2]||"0",isIE:i(e),mobile:r,ieMobile:o}},e.glob=void 0!==t?t:"undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope?self:{},e.Konva={_global:e.glob,version:"4.0.12",isBrowser:"undefined"!=typeof window&&("[object Window]"==={}.toString.call(window)||"[object global]"==={}.toString.call(window)),isUnminified:/param/.test(function(t){}.toString()),dblClickWindow:400,getAngle:function(t){return e.Konva.angleDeg?t*n:t},enableTrace:!1,_pointerEventsEnabled:!1,hitOnDragEnabled:!1,captureTouchEventsEnabled:!1,listenClickTap:!1,inDblClickWindow:!1,pixelRatio:void 0,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging:function(){return e.Konva.DD.isDragging},isDragReady:function(){return!!e.Konva.DD.node},UA:e._parseUA(e.glob.navigator&&e.glob.navigator.userAgent||""),document:e.glob.document,_injectGlobal:function(t){e.glob.Konva=t},_parseUA:e._parseUA},e._NODES_REGISTRY={},e._registerNode=function(t){e._NODES_REGISTRY[t.prototype.getClassName()]=t,e.Konva[t.prototype.getClassName()]=t}}).call(this,n(17))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=n(4);function o(t){return r.Util._isString(t)?'"'+t+'"':"[object Number]"===Object.prototype.toString.call(t)?t:r.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}e.RGBComponent=function(t){return t>255?255:t<0?0:Math.round(t)},e.alphaComponent=function(t){return t>1?1:t<1e-4?1e-4:t},e.getNumberValidator=function(){if(i.Konva.isUnminified)return function(t,e){return r.Util._isNumber(t)||r.Util.warn(o(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}},e.getNumberOrAutoValidator=function(){if(i.Konva.isUnminified)return function(t,e){return r.Util._isNumber(t)||"auto"===t||r.Util.warn(o(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}},e.getStringValidator=function(){if(i.Konva.isUnminified)return function(t,e){return r.Util._isString(t)||r.Util.warn(o(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}},e.getFunctionValidator=function(){if(i.Konva.isUnminified)return function(t,e){return r.Util._isFunction(t)||r.Util.warn(o(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}},e.getNumberArrayValidator=function(){if(i.Konva.isUnminified)return function(t,e){return r.Util._isArray(t)?t.forEach((function(t){r.Util._isNumber(t)||r.Util.warn('"'+e+'" attribute has non numeric element '+t+". Make sure that all elements are numbers.")})):r.Util.warn(o(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.'),t}},e.getBooleanValidator=function(){if(i.Konva.isUnminified)return function(t,e){return!0===t||!1===t||r.Util.warn(o(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}},e.getComponentValidator=function(t){if(i.Konva.isUnminified)return function(e,n){return r.Util.isObject(e)||r.Util.warn(o(e)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+t),e}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=function(){function t(){}return t.toCollection=function(e){var n,i=new t,r=e.length;for(n=0;n<r;n++)i.push(e[n]);return i},t._mapMethod=function(e){t.prototype[e]=function(){var t,n=this.length,i=[].slice.call(arguments);for(t=0;t<n;t++)this[t][e].apply(this[t],i);return this}},t.mapMethods=function(e){var n=e.prototype;for(var i in n)t._mapMethod(i)},t}();e.Collection=r,r.prototype=[],r.prototype.each=function(t){for(var e=0;e<this.length;e++)t(this[e],e)},r.prototype.toArray=function(){var t,e=[],n=this.length;for(t=0;t<n;t++)e.push(this[t]);return e};var o=function(){function t(t){void 0===t&&(t=[1,0,0,1,0,0]),this.m=t&&t.slice()||[1,0,0,1,0,0]}return t.prototype.copy=function(){return new t(this.m)},t.prototype.point=function(t){var e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}},t.prototype.translate=function(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this},t.prototype.scale=function(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),i=this.m[0]*e+this.m[2]*n,r=this.m[1]*e+this.m[3]*n,o=this.m[0]*-n+this.m[2]*e,a=this.m[1]*-n+this.m[3]*e;return this.m[0]=i,this.m[1]=r,this.m[2]=o,this.m[3]=a,this},t.prototype.getTranslation=function(){return{x:this.m[4],y:this.m[5]}},t.prototype.skew=function(t,e){var n=this.m[0]+this.m[2]*e,i=this.m[1]+this.m[3]*e,r=this.m[2]+this.m[0]*t,o=this.m[3]+this.m[1]*t;return this.m[0]=n,this.m[1]=i,this.m[2]=r,this.m[3]=o,this},t.prototype.multiply=function(t){var e=this.m[0]*t.m[0]+this.m[2]*t.m[1],n=this.m[1]*t.m[0]+this.m[3]*t.m[1],i=this.m[0]*t.m[2]+this.m[2]*t.m[3],r=this.m[1]*t.m[2]+this.m[3]*t.m[3],o=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],a=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=n,this.m[2]=i,this.m[3]=r,this.m[4]=o,this.m[5]=a,this},t.prototype.invert=function(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,n=-this.m[1]*t,i=-this.m[2]*t,r=this.m[0]*t,o=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=n,this.m[2]=i,this.m[3]=r,this.m[4]=o,this.m[5]=a,this},t.prototype.getMatrix=function(){return this.m},t.prototype.setAbsolutePosition=function(t,e){var n=this.m[0],i=this.m[1],r=this.m[2],o=this.m[3],a=this.m[4],s=(n*(e-this.m[5])-i*(t-a))/(n*o-i*r),c=(t-a-r*s)/n;return this.translate(c,s)},t}();e.Transform=o;var a=Math.PI/180,s=180/Math.PI,c={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},l=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,u=[];e.Util={_isElement:function(t){return!(!t||1!=t.nodeType)},_isFunction:function(t){return!!(t&&t.constructor&&t.call&&t.apply)},_isPlainObject:function(t){return!!t&&t.constructor===Object},_isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},_isNumber:function(t){return"[object Number]"===Object.prototype.toString.call(t)&&!isNaN(t)&&isFinite(t)},_isString:function(t){return"[object String]"===Object.prototype.toString.call(t)},_isBoolean:function(t){return"[object Boolean]"===Object.prototype.toString.call(t)},isObject:function(t){return t instanceof Object},isValidSelector:function(t){if("string"!=typeof t)return!1;var e=t[0];return"#"===e||"."===e||e===e.toUpperCase()},_sign:function(t){return 0===t?0:t>0?1:-1},requestAnimFrame:function(t){u.push(t),1===u.length&&requestAnimationFrame((function(){var t=u;u=[],t.forEach((function(t){t()}))}))},createCanvasElement:function(){var t=document.createElement("canvas");try{t.style=t.style||{}}catch(t){}return t},createImageElement:function(){return document.createElement("img")},_isInDocument:function(t){for(;t=t.parentNode;)if(t==document)return!0;return!1},_simplifyArray:function(t){var n,i,r=[],o=t.length,a=e.Util;for(n=0;n<o;n++)i=t[n],a._isNumber(i)?i=Math.round(1e3*i)/1e3:a._isString(i)||(i=i.toString()),r.push(i);return r},_urlToImage:function(t,e){var n=new i.glob.Image;n.onload=function(){e(n)},n.src=t},_rgbToHex:function(t,e,n){return((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1)},_hexToRgb:function(t){t=t.replace("#","");var e=parseInt(t,16);return{r:e>>16&255,g:e>>8&255,b:255&e}},getRandomColor:function(){for(var t=(16777215*Math.random()<<0).toString(16);t.length<6;)t="0"+t;return"#"+t},get:function(t,e){return void 0===t?e:t},getRGB:function(t){var e;return t in c?{r:(e=c[t])[0],g:e[1],b:e[2]}:"#"===t[0]?this._hexToRgb(t.substring(1)):"rgb("===t.substr(0,4)?(e=l.exec(t.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA:function(t){return t=t||"black",e.Util._namedColorToRBA(t)||e.Util._hex3ColorToRGBA(t)||e.Util._hex6ColorToRGBA(t)||e.Util._rgbColorToRGBA(t)||e.Util._rgbaColorToRGBA(t)||e.Util._hslColorToRGBA(t)},_namedColorToRBA:function(t){var e=c[t.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA:function(t){if(0===t.indexOf("rgb(")){var e=(t=t.match(/rgb\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA:function(t){if(0===t.indexOf("rgba(")){var e=(t=t.match(/rgba\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex6ColorToRGBA:function(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:1}},_hex3ColorToRGBA:function(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:1}},_hslColorToRGBA:function(t){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(t)){var e=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t),n=(e[0],e.slice(1)),i=Number(n[0])/360,r=Number(n[1])/100,o=Number(n[2])/100,a=void 0,s=void 0,c=void 0;if(0===r)return c=255*o,{r:Math.round(c),g:Math.round(c),b:Math.round(c),a:1};for(var l=2*o-(a=o<.5?o*(1+r):o+r-o*r),u=[0,0,0],h=0;h<3;h++)(s=i+1/3*-(h-1))<0&&s++,s>1&&s--,c=6*s<1?l+6*(a-l)*s:2*s<1?a:3*s<2?l+(a-l)*(2/3-s)*6:l,u[h]=255*c;return{r:Math.round(u[0]),g:Math.round(u[1]),b:Math.round(u[2]),a:1}}},haveIntersection:function(t,e){return!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y)},cloneObject:function(t){var e={};for(var n in t)this._isPlainObject(t[n])?e[n]=this.cloneObject(t[n]):this._isArray(t[n])?e[n]=this.cloneArray(t[n]):e[n]=t[n];return e},cloneArray:function(t){return t.slice(0)},_degToRad:function(t){return t*a},_radToDeg:function(t){return t*s},_capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},throw:function(t){throw new Error("Konva error: "+t)},error:function(t){console.error("Konva error: "+t)},warn:function(t){i.Konva.showWarnings&&console.warn("Konva warning: "+t)},extend:function(t,e){function n(){this.constructor=t}n.prototype=e.prototype;var i=t.prototype;for(var r in t.prototype=new n,i)i.hasOwnProperty(r)&&(t.prototype[r]=i[r]);t.__super__=e.prototype,t.super=e},_getControlPoints:function(t,e,n,i,r,o,a){var s=Math.sqrt(Math.pow(n-t,2)+Math.pow(i-e,2)),c=Math.sqrt(Math.pow(r-n,2)+Math.pow(o-i,2)),l=a*s/(s+c),u=a*c/(s+c);return[n-l*(r-t),i-l*(o-e),n+u*(r-t),i+u*(o-e)]},_expandPoints:function(t,n){var i,r,o=t.length,a=[];for(i=2;i<o-2;i+=2)r=e.Util._getControlPoints(t[i-2],t[i-1],t[i],t[i+1],t[i+2],t[i+3],n),a.push(r[0]),a.push(r[1]),a.push(t[i]),a.push(t[i+1]),a.push(r[2]),a.push(r[3]);return a},each:function(t,e){for(var n in t)e(n,t[n])},_inRange:function(t,e,n){return e<=t&&t<n},_getProjectionToSegment:function(t,e,n,i,r,o){var a,s,c,l=(t-n)*(t-n)+(e-i)*(e-i);if(0==l)a=t,s=e,c=(r-n)*(r-n)+(o-i)*(o-i);else{var u=((r-t)*(n-t)+(o-e)*(i-e))/l;u<0?(a=t,s=e,c=(t-r)*(t-r)+(e-o)*(e-o)):u>1?(a=n,s=i,c=(n-r)*(n-r)+(i-o)*(i-o)):c=((a=t+u*(n-t))-r)*(a-r)+((s=e+u*(i-e))-o)*(s-o)}return[a,s,c]},_getProjectionToLine:function(t,n,i){var r=e.Util.cloneObject(t),o=Number.MAX_VALUE;return n.forEach((function(a,s){if(i||s!==n.length-1){var c=n[(s+1)%n.length],l=e.Util._getProjectionToSegment(a.x,a.y,c.x,c.y,t.x,t.y),u=l[0],h=l[1],p=l[2];p<o&&(r.x=u,r.y=h,o=p)}})),r},_prepareArrayForTween:function(t,n,i){var r,o=[],a=[];if(t.length>n.length){var s=n;n=t,t=s}for(r=0;r<t.length;r+=2)o.push({x:t[r],y:t[r+1]});for(r=0;r<n.length;r+=2)a.push({x:n[r],y:n[r+1]});var c=[];return a.forEach((function(t){var n=e.Util._getProjectionToLine(t,o,i);c.push(n.x),c.push(n.y)})),c},_prepareToStringify:function(t){var n;for(var i in t.visitedByCircularReferenceRemoval=!0,t)if(t.hasOwnProperty(i)&&t[i]&&"object"==typeof t[i])if(n=Object.getOwnPropertyDescriptor(t,i),t[i].visitedByCircularReferenceRemoval||e.Util._isElement(t[i])){if(!n.configurable)return null;delete t[i]}else if(null===e.Util._prepareToStringify(t[i])){if(!n.configurable)return null;delete t[i]}return delete t.visitedByCircularReferenceRemoval,t},_assign:function(t,e){for(var n in e)t[n]=e[n];return t},_getFirstPointerId:function(t){return t.touches?t.changedTouches[0].identifier:999}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),r=n(1),o=n(11),a=n(2),s=n(13),c=n(3);e.ids={},e.names={};e._removeId=function(t,n){t&&e.ids[t]===n&&delete e.ids[t]},e._addName=function(t,n){n&&(e.names[n]||(e.names[n]=[]),e.names[n].push(t))},e._removeName=function(t,n){if(t){var i=e.names[t];if(i){for(var r=0;r<i.length;r++){i[r]._id===n&&i.splice(r,1)}0===i.length&&delete e.names[t]}}};var l="absoluteOpacity",u="absoluteTransform",h="absoluteScale",p="listening",d="Shape",f="transform",m="visible",v=["id"],y=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(" "),g=["scaleXChange.konva","scaleYChange.konva"].join(" "),b=new i.Collection,_=1,w=function(){function t(t){var e=this;this._id=_++,this.eventListeners={},this.attrs={},this.index=0,this.parent=null,this._cache=new Map,this._lastPos=null,this._filterUpToDate=!1,this._isUnderCache=!1,this.children=b,this._dragEventId=null,this.setAttrs(t),this.on(y,(function(){e._clearCache(f),e._clearSelfAndDescendantCache(u)})),this.on(g,(function(){e._clearSelfAndDescendantCache(h)})),this.on("visibleChange.konva",(function(){e._clearSelfAndDescendantCache(m)})),this.on("listeningChange.konva",(function(){e._clearSelfAndDescendantCache(p)})),this.on("opacityChange.konva",(function(){e._clearSelfAndDescendantCache(l)}))}return t.prototype.hasChildren=function(){return!1},t.prototype.getChildren=function(){return b},t.prototype._clearCache=function(t){t?this._cache.delete(t):this._cache.clear()},t.prototype._getCache=function(t,e){var n=this._cache.get(t);return void 0===n&&(n=e.call(this),this._cache.set(t,n)),n},t.prototype._getCanvasCache=function(){return this._cache.get("canvas")},t.prototype._clearSelfAndDescendantCache=function(t){this._clearCache(t),this._getCanvasCache()||this.children&&this.children.each((function(e){e._clearSelfAndDescendantCache(t)}))},t.prototype.clearCache=function(){return this._cache.delete("canvas"),this._clearSelfAndDescendantCache(),this},t.prototype.cache=function(t){var e=t||{},n={};void 0!==e.x&&void 0!==e.y&&void 0!==e.width&&void 0!==e.height||(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()}));var r=e.width||n.width,a=e.height||n.height,s=e.pixelRatio,c=void 0===e.x?n.x:e.x,u=void 0===e.y?n.y:e.y,p=e.offset||0,d=e.drawBorder||!1;if(r&&a){r+=2*p,a+=2*p,c-=p,u-=p;var f=new o.SceneCanvas({pixelRatio:s,width:r,height:a}),m=new o.SceneCanvas({pixelRatio:s,width:r,height:a}),v=new o.HitCanvas({pixelRatio:1,width:r,height:a}),y=f.getContext(),g=v.getContext();return v.isCache=!0,this._cache.delete("canvas"),this._filterUpToDate=!1,!1===e.imageSmoothingEnabled&&(f.getContext()._context.imageSmoothingEnabled=!1,m.getContext()._context.imageSmoothingEnabled=!1,v.getContext()._context.imageSmoothingEnabled=!1),y.save(),g.save(),y.translate(-c,-u),g.translate(-c,-u),this._isUnderCache=!0,this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(h),this.drawScene(f,this,!0),this.drawHit(v,this,!0),this._isUnderCache=!1,y.restore(),g.restore(),d&&(y.save(),y.beginPath(),y.rect(0,0,r,a),y.closePath(),y.setAttr("strokeStyle","red"),y.setAttr("lineWidth",5),y.stroke(),y.restore()),this._cache.set("canvas",{scene:f,filter:m,hit:v,x:c,y:u}),this}i.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.")},t.prototype.isCached=function(){return this._cache.has("canvas")},t.prototype.getClientRect=function(t){throw new Error('abstract "getClientRect" method call')},t.prototype._transformedRect=function(t,e){var n,i,r,o,a=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],s=this.getAbsoluteTransform(e);return a.forEach((function(t){var e=s.point(t);void 0===n&&(n=r=e.x,i=o=e.y),n=Math.min(n,e.x),i=Math.min(i,e.y),r=Math.max(r,e.x),o=Math.max(o,e.y)})),{x:n,y:i,width:r-n,height:o-i}},t.prototype._drawCachedSceneCanvas=function(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);var e=this._getCanvasCache();t.translate(e.x,e.y);var n=this._getCachedSceneCanvas(),i=n.pixelRatio;t.drawImage(n._canvas,0,0,n.width/i,n.height/i),t.restore()},t.prototype._drawCachedHitCanvas=function(t){var e=this._getCanvasCache(),n=e.hit;t.save(),t._applyGlobalCompositeOperation(this),t.translate(e.x,e.y),t.drawImage(n._canvas,0,0),t.restore()},t.prototype._getCachedSceneCanvas=function(){var t,e,n,r,o=this.filters(),a=this._getCanvasCache(),s=a.scene,c=a.filter,l=c.getContext();if(o){if(!this._filterUpToDate){var u=s.pixelRatio;try{for(t=o.length,l.clear(),l.drawImage(s._canvas,0,0,s.getWidth()/u,s.getHeight()/u),e=l.getImageData(0,0,c.getWidth(),c.getHeight()),n=0;n<t;n++)"function"==typeof(r=o[n])?(r.call(this,e),l.putImageData(e,0,0)):i.Util.error("Filter should be type of function, but got "+typeof r+" insted. Please check correct filters")}catch(t){i.Util.error("Unable to apply filter. "+t.message)}this._filterUpToDate=!0}return c}return s},t.prototype.on=function(t,e){if(3===arguments.length)return this._delegate.apply(this,arguments);var n,i,r,o,a=t.split(" "),s=a.length;for(n=0;n<s;n++)r=(i=a[n].split("."))[0],o=i[1]||"",this.eventListeners[r]||(this.eventListeners[r]=[]),this.eventListeners[r].push({name:o,handler:e});return this},t.prototype.off=function(t,e){var n,i,r,o,a,s=(t||"").split(" "),c=s.length;if(!t)for(i in this.eventListeners)this._off(i);for(n=0;n<c;n++)if(o=(r=s[n].split("."))[0],a=r[1],o)this.eventListeners[o]&&this._off(o,a,e);else for(i in this.eventListeners)this._off(i,a,e);return this},t.prototype.dispatchEvent=function(t){var e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this},t.prototype.addEventListener=function(t,e){return this.on(t,(function(t){e.call(this,t.evt)})),this},t.prototype.removeEventListener=function(t){return this.off(t),this},t.prototype._delegate=function(t,e,n){var r=this;this.on(t,(function(t){for(var o=t.target.findAncestors(e,!0,r),a=0;a<o.length;a++)(t=i.Util.cloneObject(t)).currentTarget=o[a],n.call(o[a],t)}))},t.prototype.remove=function(){return this.isDragging()&&this.stopDrag(),s.DD._dragElements.delete(this._id),this._remove(),this},t.prototype._remove=function(){this._clearSelfAndDescendantCache("stage"),this._clearSelfAndDescendantCache(u),this._clearSelfAndDescendantCache(m),this._clearSelfAndDescendantCache(p),this._clearSelfAndDescendantCache(l);var t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)},t.prototype.destroy=function(){e._removeId(this.id(),this);for(var t=(this.name()||"").split(/\s/g),n=0;n<t.length;n++){var i=t[n];e._removeName(i,this._id)}return this.remove(),this},t.prototype.getAttr=function(t){var e="get"+i.Util._capitalize(t);return i.Util._isFunction(this[e])?this[e]():this.attrs[t]},t.prototype.getAncestors=function(){for(var t=this.getParent(),e=new i.Collection;t;)e.push(t),t=t.getParent();return e},t.prototype.getAttrs=function(){return this.attrs||{}},t.prototype.setAttrs=function(t){var e,n;if(!t)return this;for(e in t)"children"!==e&&(n="set"+i.Util._capitalize(e),i.Util._isFunction(this[n])?this[n](t[e]):this._setAttr(e,t[e]));return this},t.prototype.isListening=function(){return this._getCache(p,this._isListening)},t.prototype._isListening=function(){var t=this.listening(),e=this.getParent();return"inherit"===t?!e||e.isListening():t},t.prototype.isVisible=function(){return this._getCache(m,this._isVisible)},t.prototype._isVisible=function(t){var e=this.visible(),n=this.getParent();return"inherit"===e?!n||n===t||n._isVisible(t):e},t.prototype.shouldDrawHit=function(){var t=this.getLayer();return!t&&this.isListening()&&this.isVisible()||t&&t.hitGraphEnabled()&&this.isListening()&&this.isVisible()},t.prototype.show=function(){return this.visible(!0),this},t.prototype.hide=function(){return this.visible(!1),this},t.prototype.getZIndex=function(){return this.index||0},t.prototype.getAbsoluteZIndex=function(){var t,e,n,i,r=this.getDepth(),o=this,a=0;return"Stage"!==o.nodeType&&function s(c){for(t=[],e=c.length,n=0;n<e;n++)i=c[n],a++,i.nodeType!==d&&(t=t.concat(i.getChildren().toArray())),i._id===o._id&&(n=e);t.length>0&&t[0].getDepth()<=r&&s(t)}(o.getStage().getChildren()),a},t.prototype.getDepth=function(){for(var t=0,e=this.parent;e;)t++,e=e.parent;return t},t.prototype.setPosition=function(t){return this.x(t.x),this.y(t.y),this},t.prototype.getPosition=function(){return{x:this.x(),y:this.y()}},t.prototype.getAbsolutePosition=function(t){var e=this.getAbsoluteTransform(t).getMatrix(),n=new i.Transform,r=this.offset();return n.m=e.slice(),n.translate(r.x,r.y),n.getTranslation()},t.prototype.setAbsolutePosition=function(t){var e,n=this._clearTransform();return this.attrs.x=n.x,this.attrs.y=n.y,delete n.x,delete n.y,(e=this.getAbsoluteTransform()).invert(),e.translate(t.x,t.y),t={x:this.attrs.x+e.getTranslation().x,y:this.attrs.y+e.getTranslation().y},this.setPosition({x:t.x,y:t.y}),this._setTransform(n),this},t.prototype._setTransform=function(t){var e;for(e in t)this.attrs[e]=t[e];this._clearCache(f),this._clearSelfAndDescendantCache(u)},t.prototype._clearTransform=function(){var t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,this._clearCache(f),this._clearSelfAndDescendantCache(u),t},t.prototype.move=function(t){var e=t.x,n=t.y,i=this.x(),r=this.y();return void 0!==e&&(i+=e),void 0!==n&&(r+=n),this.setPosition({x:i,y:r}),this},t.prototype._eachAncestorReverse=function(t,e){var n,i,r=[],o=this.getParent();if(e&&e._id===this._id)t(this);else{for(r.unshift(this);o&&(!e||o._id!==e._id);)r.unshift(o),o=o.parent;for(n=r.length,i=0;i<n;i++)t(r[i])}},t.prototype.rotate=function(t){return this.rotation(this.rotation()+t),this},t.prototype.moveToTop=function(){if(!this.parent)return i.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var t=this.index;return this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0},t.prototype.moveUp=function(){if(!this.parent)return i.Util.warn("Node has no parent. moveUp function is ignored."),!1;var t=this.index;return t<this.parent.getChildren().length-1&&(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0)},t.prototype.moveDown=function(){if(!this.parent)return i.Util.warn("Node has no parent. moveDown function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0)},t.prototype.moveToBottom=function(){if(!this.parent)return i.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0)},t.prototype.setZIndex=function(t){if(!this.parent)return i.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&i.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this},t.prototype.getAbsoluteOpacity=function(){return this._getCache(l,this._getAbsoluteOpacity)},t.prototype._getAbsoluteOpacity=function(){var t=this.opacity(),e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t},t.prototype.moveTo=function(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this},t.prototype.toObject=function(){var t,e,n,r,o={},a=this.getAttrs();for(t in o.attrs={},a)e=a[t],i.Util.isObject(e)&&!i.Util._isPlainObject(e)&&!i.Util._isArray(e)||(n="function"==typeof this[t]&&this[t],delete a[t],r=n?n.call(this):null,a[t]=e,r!==e&&(o.attrs[t]=e));return o.className=this.getClassName(),i.Util._prepareToStringify(o)},t.prototype.toJSON=function(){return JSON.stringify(this.toObject())},t.prototype.getParent=function(){return this.parent},t.prototype.findAncestors=function(t,e,n){var i=[];e&&this._isMatch(t)&&i.push(this);for(var r=this.parent;r;){if(r===n)return i;r._isMatch(t)&&i.push(r),r=r.parent}return i},t.prototype.isAncestorOf=function(t){return!1},t.prototype.findAncestor=function(t,e,n){return this.findAncestors(t,e,n)[0]},t.prototype._isMatch=function(t){if(!t)return!1;if("function"==typeof t)return t(this);var e,n,r=t.replace(/ /g,"").split(","),o=r.length;for(e=0;e<o;e++)if(n=r[e],i.Util.isValidSelector(n)||(i.Util.warn('Selector "'+n+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),i.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),i.Util.warn("Konva is awesome, right?")),"#"===n.charAt(0)){if(this.id()===n.slice(1))return!0}else if("."===n.charAt(0)){if(this.hasName(n.slice(1)))return!0}else if(this.className===n||this.nodeType===n)return!0;return!1},t.prototype.getLayer=function(){var t=this.getParent();return t?t.getLayer():null},t.prototype.getStage=function(){return this._getCache("stage",this._getStage)},t.prototype._getStage=function(){var t=this.getParent();return t?t.getStage():void 0},t.prototype.fire=function(t,e,n){return(e=e||{}).target=e.target||this,n?this._fireAndBubble(t,e):this._fire(t,e),this},t.prototype.getAbsoluteTransform=function(t){return t?this._getAbsoluteTransform(t):this._getCache(u,this._getAbsoluteTransform)},t.prototype._getAbsoluteTransform=function(t){var e=new i.Transform;return this._eachAncestorReverse((function(t){var n=t.getTransformsEnabled();"all"===n?e.multiply(t.getTransform()):"position"===n&&e.translate(t.getX()-t.getOffsetX(),t.getY()-t.getOffsetY())}),t),e},t.prototype.getAbsoluteScale=function(t){return t?this._getAbsoluteScale(t):this._getCache(h,this._getAbsoluteScale)},t.prototype._getAbsoluteScale=function(t){for(var e=this;e;)e._isUnderCache&&(t=e),e=e.getParent();var n=1,i=1;return this._eachAncestorReverse((function(t){n*=t.scaleX(),i*=t.scaleY()}),t),{x:n,y:i}},t.prototype.getTransform=function(){return this._getCache(f,this._getTransform)},t.prototype._getTransform=function(){var t=new i.Transform,e=this.x(),n=this.y(),r=a.Konva.getAngle(this.rotation()),o=this.scaleX(),s=this.scaleY(),c=this.skewX(),l=this.skewY(),u=this.offsetX(),h=this.offsetY();return 0===e&&0===n||t.translate(e,n),0!==r&&t.rotate(r),0===c&&0===l||t.skew(c,l),1===o&&1===s||t.scale(o,s),0===u&&0===h||t.translate(-1*u,-1*h),t},t.prototype.clone=function(t){var e,n,r,o,a,s=i.Util.cloneObject(this.attrs);for(var c in v){delete s[v[c]]}for(e in t)s[e]=t[e];var l=new this.constructor(s);for(e in this.eventListeners)for(r=(n=this.eventListeners[e]).length,o=0;o<r;o++)(a=n[o]).name.indexOf("konva")<0&&(l.eventListeners[e]||(l.eventListeners[e]=[]),l.eventListeners[e].push(a));return l},t.prototype._toKonvaCanvas=function(t){t=t||{};var e=this.getClientRect(),n=this.getStage(),i=void 0!==t.x?t.x:e.x,r=void 0!==t.y?t.y:e.y,a=t.pixelRatio||1,s=new o.SceneCanvas({width:t.width||e.width||(n?n.width():0),height:t.height||e.height||(n?n.height():0),pixelRatio:a}),c=s.getContext();return c.save(),(i||r)&&c.translate(-1*i,-1*r),this.drawScene(s),c.restore(),s},t.prototype.toCanvas=function(t){return this._toKonvaCanvas(t)._canvas},t.prototype.toDataURL=function(t){var e=(t=t||{}).mimeType||null,n=t.quality||null,i=this._toKonvaCanvas(t).toDataURL(e,n);return t.callback&&t.callback(i),i},t.prototype.toImage=function(t){if(!t||!t.callback)throw"callback required for toImage method config argument";var e=t.callback;delete t.callback,i.Util._urlToImage(this.toDataURL(t),(function(t){e(t)}))},t.prototype.setSize=function(t){return this.width(t.width),this.height(t.height),this},t.prototype.getSize=function(){return{width:this.width(),height:this.height()}},t.prototype.getClassName=function(){return this.className||this.nodeType},t.prototype.getType=function(){return this.nodeType},t.prototype.getDragDistance=function(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():a.Konva.dragDistance},t.prototype._off=function(t,e,n){var i,r,o,a=this.eventListeners[t];for(i=0;i<a.length;i++)if(r=a[i].name,o=a[i].handler,!("konva"===r&&"konva"!==e||e&&r!==e||n&&n!==o)){if(a.splice(i,1),0===a.length){delete this.eventListeners[t];break}i--}},t.prototype._fireChangeEvent=function(t,e,n){this._fire(t+"Change",{oldVal:e,newVal:n})},t.prototype.setId=function(t){var n=this.id();return e._removeId(n,this),function(t,n){n&&(e.ids[n]=t)}(this,t),this._setAttr("id",t),this},t.prototype.setName=function(t){var n,i,r=(this.name()||"").split(/\s/g),o=(t||"").split(/\s/g);for(i=0;i<r.length;i++)n=r[i],-1===o.indexOf(n)&&n&&e._removeName(n,this._id);for(i=0;i<o.length;i++)n=o[i],-1===r.indexOf(n)&&n&&e._addName(this,n);return this._setAttr("name",t),this},t.prototype.addName=function(t){if(!this.hasName(t)){var e=this.name(),n=e?e+" "+t:t;this.setName(n)}return this},t.prototype.hasName=function(t){if(!t)return!1;var e=this.name();return!!e&&-1!==(e||"").split(/\s/g).indexOf(t)},t.prototype.removeName=function(t){var e=(this.name()||"").split(/\s/g),n=e.indexOf(t);return-1!==n&&(e.splice(n,1),this.setName(e.join(" "))),this},t.prototype.setAttr=function(t,e){var n=this["set"+i.Util._capitalize(t)];return i.Util._isFunction(n)?n.call(this,e):this._setAttr(t,e),this},t.prototype._setAttr=function(t,e){var n=this.attrs[t];(n!==e||i.Util.isObject(e))&&(null==e?delete this.attrs[t]:this.attrs[t]=e,this._fireChangeEvent(t,n,e))},t.prototype._setComponentAttr=function(t,e,n){var i;void 0!==n&&((i=this.attrs[t])||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=n,this._fireChangeEvent(t,i,n))},t.prototype._fireAndBubble=function(t,e,n){if(e&&this.nodeType===d&&(e.target=this),!(("mouseenter"===t||"mouseleave"===t)&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||"Stage"===this.nodeType&&!n))){this._fire(t,e);var i=("mouseenter"===t||"mouseleave"===t)&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!i&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,e,n.parent):this._fireAndBubble.call(this.parent,t,e))}},t.prototype._fire=function(t,e){var n,i=this.eventListeners[t];if(i)for((e=e||{}).currentTarget=this,e.type=t,n=0;n<i.length;n++)i[n].handler.call(this,e)},t.prototype.draw=function(){return this.drawScene(),this.drawHit(),this},t.prototype._createDragElement=function(t){var e=t?t.pointerId:void 0,n=this.getStage(),i=this.getAbsolutePosition(),r=n._getPointerById(e)||n._changedPointerPositions[0]||i;s.DD._dragElements.set(this._id,{node:this,startPointerPos:r,offset:{x:r.x-i.x,y:r.y-i.y},dragStatus:"ready",pointerId:e})},t.prototype.startDrag=function(t){s.DD._dragElements.has(this._id)||this._createDragElement(t),s.DD._dragElements.get(this._id).dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},!0)},t.prototype._setDragPosition=function(t,e){var n=this.getStage()._getPointerById(e.pointerId),i=this.dragBoundFunc();if(n){var r={x:n.x-e.offset.x,y:n.y-e.offset.y};void 0!==i&&(r=i.call(this,r,t)),this._lastPos&&this._lastPos.x===r.x&&this._lastPos.y===r.y||(this.setAbsolutePosition(r),this.getLayer()?this.getLayer().batchDraw():this.getStage()&&this.getStage().batchDraw()),this._lastPos=r}},t.prototype.stopDrag=function(t){var e=s.DD._dragElements.get(this._id);e&&(e.dragStatus="stopped"),s.DD._endDragBefore(t),s.DD._endDragAfter(t)},t.prototype.setDraggable=function(t){this._setAttr("draggable",t),this._dragChange()},t.prototype.isDragging=function(){var t=s.DD._dragElements.get(this._id);return!!t&&"dragging"===t.dragStatus},t.prototype._listenDrag=function(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",(function(t){var e=this;if((!(void 0!==t.evt.button)||a.Konva.dragButtons.indexOf(t.evt.button)>=0)&&!this.isDragging()){var n=!1;s.DD._dragElements.forEach((function(t){e.isAncestorOf(t.node)&&(n=!0)})),n||this._createDragElement(t)}}))},t.prototype._dragChange=function(){this.attrs.draggable?this._listenDrag():(this._dragCleanup(),this.getStage()&&s.DD._dragElements.has(this._id)&&this.stopDrag())},t.prototype._dragCleanup=function(){this.off("mousedown.konva"),this.off("touchstart.konva")},t.create=function(t,e){return i.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)},t._createNode=function(e,n){var r,o,s,c=t.prototype.getClassName.call(e),l=e.children;if(n&&(e.attrs.container=n),a._NODES_REGISTRY[c]||(i.Util.warn('Can not find a node with class name "'+c+'". Fallback to "Shape".'),c="Shape"),r=new(0,a._NODES_REGISTRY[c])(e.attrs),l)for(o=l.length,s=0;s<o;s++)r.add(t._createNode(l[s]));return r},t}();e.Node=w,w.prototype.nodeType="Node",w.prototype._attrsAffectingSize=[],r.Factory.addGetterSetter(w,"zIndex"),r.Factory.addGetterSetter(w,"absolutePosition"),r.Factory.addGetterSetter(w,"position"),r.Factory.addGetterSetter(w,"x",0,c.getNumberValidator()),r.Factory.addGetterSetter(w,"y",0,c.getNumberValidator()),r.Factory.addGetterSetter(w,"globalCompositeOperation","source-over",c.getStringValidator()),r.Factory.addGetterSetter(w,"opacity",1,c.getNumberValidator()),r.Factory.addGetterSetter(w,"name","",c.getStringValidator()),r.Factory.addGetterSetter(w,"id","",c.getStringValidator()),r.Factory.addGetterSetter(w,"rotation",0,c.getNumberValidator()),r.Factory.addComponentsGetterSetter(w,"scale",["x","y"]),r.Factory.addGetterSetter(w,"scaleX",1,c.getNumberValidator()),r.Factory.addGetterSetter(w,"scaleY",1,c.getNumberValidator()),r.Factory.addComponentsGetterSetter(w,"skew",["x","y"]),r.Factory.addGetterSetter(w,"skewX",0,c.getNumberValidator()),r.Factory.addGetterSetter(w,"skewY",0,c.getNumberValidator()),r.Factory.addComponentsGetterSetter(w,"offset",["x","y"]),r.Factory.addGetterSetter(w,"offsetX",0,c.getNumberValidator()),r.Factory.addGetterSetter(w,"offsetY",0,c.getNumberValidator()),r.Factory.addGetterSetter(w,"dragDistance",null,c.getNumberValidator()),r.Factory.addGetterSetter(w,"width",0,c.getNumberValidator()),r.Factory.addGetterSetter(w,"height",0,c.getNumberValidator()),r.Factory.addGetterSetter(w,"listening","inherit",(function(t){return!0===t||!1===t||"inherit"===t||i.Util.warn(t+' is a not valid value for "listening" attribute. The value may be true, false or "inherit".'),t})),r.Factory.addGetterSetter(w,"preventDefault",!0,c.getBooleanValidator()),r.Factory.addGetterSetter(w,"filters",null,(function(t){return this._filterUpToDate=!1,t})),r.Factory.addGetterSetter(w,"visible","inherit",(function(t){return!0===t||!1===t||"inherit"===t||i.Util.warn(t+' is a not valid value for "visible" attribute. The value may be true, false or "inherit".'),t})),r.Factory.addGetterSetter(w,"transformsEnabled","all",c.getStringValidator()),r.Factory.addGetterSetter(w,"size"),r.Factory.addGetterSetter(w,"dragBoundFunc"),r.Factory.addGetterSetter(w,"draggable",!1,c.getBooleanValidator()),r.Factory.backCompat(w,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),i.Collection.mapMethods(w)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o,a=n(4),s=n(1),c=n(5),l=n(3),u=n(2),h=n(19),p="hasShadow",d="shadowRGBA",f="patternImage",m="linearGradient",v="radialGradient";function y(){return o||(o=a.Util.createCanvasElement().getContext("2d"))}function g(){this._clearCache(p)}function b(){this._clearCache(d)}function _(){this._clearCache(f)}function w(){this._clearCache(m)}function x(){this._clearCache(v)}e.shapes={};var E=function(t){function n(n){for(var i,r=t.call(this,n)||this;!(i=a.Util.getRandomColor())||i in e.shapes;);return r.colorKey=i,e.shapes[i]=r,r.on("shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",g),r.on("shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",b),r.on("fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva",_),r.on("fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",w),r.on("fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",x),r}return r(n,t),n.prototype.getContext=function(){return this.getLayer().getContext()},n.prototype.getCanvas=function(){return this.getLayer().getCanvas()},n.prototype.getSceneFunc=function(){return this.attrs.sceneFunc||this._sceneFunc},n.prototype.getHitFunc=function(){return this.attrs.hitFunc||this._hitFunc},n.prototype.hasShadow=function(){return this._getCache(p,this._hasShadow)},n.prototype._hasShadow=function(){return this.shadowEnabled()&&0!==this.shadowOpacity()&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())},n.prototype._getFillPattern=function(){return this._getCache(f,this.__getFillPattern)},n.prototype.__getFillPattern=function(){if(this.fillPatternImage())return y().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat")},n.prototype._getLinearGradient=function(){return this._getCache(m,this.__getLinearGradient)},n.prototype.__getLinearGradient=function(){var t=this.fillLinearGradientColorStops();if(t){for(var e=y(),n=this.fillLinearGradientStartPoint(),i=this.fillLinearGradientEndPoint(),r=e.createLinearGradient(n.x,n.y,i.x,i.y),o=0;o<t.length;o+=2)r.addColorStop(t[o],t[o+1]);return r}},n.prototype._getRadialGradient=function(){return this._getCache(v,this.__getRadialGradient)},n.prototype.__getRadialGradient=function(){var t=this.fillRadialGradientColorStops();if(t){for(var e=y(),n=this.fillRadialGradientStartPoint(),i=this.fillRadialGradientEndPoint(),r=e.createRadialGradient(n.x,n.y,this.fillRadialGradientStartRadius(),i.x,i.y,this.fillRadialGradientEndRadius()),o=0;o<t.length;o+=2)r.addColorStop(t[o],t[o+1]);return r}},n.prototype.getShadowRGBA=function(){return this._getCache(d,this._getShadowRGBA)},n.prototype._getShadowRGBA=function(){if(this.hasShadow()){var t=a.Util.colorToRGBA(this.shadowColor());return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}},n.prototype.hasFill=function(){return!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops())},n.prototype.hasStroke=function(){return this.strokeEnabled()&&this.strokeWidth()&&!(!this.stroke()&&!this.strokeLinearGradientColorStops())},n.prototype.intersects=function(t){var e=this.getStage().bufferHitCanvas;return e.getContext().clear(),this.drawHit(e),e.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0},n.prototype.destroy=function(){return c.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this},n.prototype._useBufferCanvas=function(t){return!(t&&!this.hasShadow()||!this.perfectDrawEnabled()||1===this.getAbsoluteOpacity()||!this.hasFill()||!this.hasStroke()||!this.getStage())},n.prototype.setStrokeHitEnabled=function(t){t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)},n.prototype.getStrokeHitEnabled=function(){return 0!==this.hitStrokeWidth()},n.prototype.getSelfRect=function(){var t=this.size();return{x:this._centroid?Math.round(-t.width/2):0,y:this._centroid?Math.round(-t.height/2):0,width:t.width,height:t.height}},n.prototype.getClientRect=function(t){var e=(t=t||{}).skipTransform,n=t.relativeTo,i=this.getSelfRect(),r=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,o=i.width+r,a=i.height+r,s=!t.skipShadow&&this.hasShadow(),c=s?this.shadowOffsetX():0,l=s?this.shadowOffsetY():0,u=o+Math.abs(c),h=a+Math.abs(l),p=s&&this.shadowBlur()||0,d=u+2*p,f=h+2*p,m=0;Math.round(r/2)!==r/2&&(m=1);var v={width:d+m,height:f+m,x:-Math.round(r/2+p)+Math.min(c,0)+i.x,y:-Math.round(r/2+p)+Math.min(l,0)+i.y};return e?v:this._transformedRect(v,n)},n.prototype.drawScene=function(t,e,n,i){var r,o,a=this.getLayer(),s=t||a.getCanvas(),c=s.getContext(),l=this._getCanvasCache(),u=this.sceneFunc(),h=this.hasShadow(),p=this.hasStroke();if(!this.isVisible()&&!n)return this;if(l)return c.save(),a._applyTransform(this,c,e),this._drawCachedSceneCanvas(c),c.restore(),this;if(!u)return this;if(c.save(),this._useBufferCanvas(n)&&!i){if((o=(r=this.getStage().bufferCanvas).getContext()).clear(),o.save(),o._applyLineJoin(this),!n)if(a)a._applyTransform(this,o,e);else{var d=this.getAbsoluteTransform(e).getMatrix();c.transform(d[0],d[1],d[2],d[3],d[4],d[5])}u.call(this,o,this),o.restore();var f=r.pixelRatio;h&&!s.hitCanvas?(c.save(),c._applyShadow(this),c._applyOpacity(this),c._applyGlobalCompositeOperation(this),c.drawImage(r._canvas,0,0,r.width/f,r.height/f),c.restore()):(c._applyOpacity(this),c._applyGlobalCompositeOperation(this),c.drawImage(r._canvas,0,0,r.width/f,r.height/f))}else{if(c._applyLineJoin(this),!n)if(a)a._applyTransform(this,c,e);else{var m=this.getAbsoluteTransform(e).getMatrix();c.transform(m[0],m[1],m[2],m[3],m[4],m[5])}h&&p&&!s.hitCanvas?(c.save(),n||(c._applyOpacity(this),c._applyGlobalCompositeOperation(this)),c._applyShadow(this),u.call(this,c,this),c.restore(),this.hasFill()&&this.shadowForStrokeEnabled()&&u.call(this,c,this)):h&&!s.hitCanvas?(c.save(),n||(c._applyOpacity(this),c._applyGlobalCompositeOperation(this)),c._applyShadow(this),u.call(this,c,this),c.restore()):(n||(c._applyOpacity(this),c._applyGlobalCompositeOperation(this)),u.call(this,c,this))}return c.restore(),this},n.prototype.drawHit=function(t,e,n){var i=this.getLayer(),r=t||i.hitCanvas,o=r&&r.getContext(),s=this.hitFunc()||this.sceneFunc(),c=this._getCanvasCache(),l=c&&c.hit;if(this.colorKey||(console.log(this),a.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. See the shape in logs above. If you want to reuse shape you should call remove() instead of destroy()")),!this.shouldDrawHit()&&!n)return this;if(l)return o.save(),i._applyTransform(this,o,e),this._drawCachedHitCanvas(o),o.restore(),this;if(!s)return this;if(o.save(),o._applyLineJoin(this),!n)if(i)i._applyTransform(this,o,e);else{var u=this.getAbsoluteTransform(e).getMatrix();o.transform(u[0],u[1],u[2],u[3],u[4],u[5])}return s.call(this,o,this),o.restore(),this},n.prototype.drawHitFromCache=function(t){void 0===t&&(t=0);var e,n,i,r,o,s=this._getCanvasCache(),c=this._getCachedSceneCanvas(),l=s.hit,u=l.getContext(),h=l.getWidth(),p=l.getHeight();u.clear(),u.drawImage(c._canvas,0,0,h,p);try{for(i=(n=(e=u.getImageData(0,0,h,p)).data).length,r=a.Util._hexToRgb(this.colorKey),o=0;o<i;o+=4)n[o+3]>t?(n[o]=r.r,n[o+1]=r.g,n[o+2]=r.b,n[o+3]=255):n[o+3]=0;u.putImageData(e,0,0)}catch(t){a.Util.error("Unable to draw hit graph from cached scene canvas. "+t.message)}return this},n.prototype.hasPointerCapture=function(t){return h.hasPointerCapture(t,this)},n.prototype.setPointerCapture=function(t){h.setPointerCapture(t,this)},n.prototype.releaseCapture=function(t){h.releaseCapture(t,this)},n}(c.Node);e.Shape=E,E.prototype._fillFunc=function(t){t.fill()},E.prototype._strokeFunc=function(t){t.stroke()},E.prototype._fillFuncHit=function(t){t.fill()},E.prototype._strokeFuncHit=function(t){t.stroke()},E.prototype._centroid=!1,E.prototype.nodeType="Shape",u._registerNode(E),s.Factory.addGetterSetter(E,"stroke",void 0,l.getStringValidator()),s.Factory.addGetterSetter(E,"strokeWidth",2,l.getNumberValidator()),s.Factory.addGetterSetter(E,"hitStrokeWidth","auto",l.getNumberOrAutoValidator()),s.Factory.addGetterSetter(E,"strokeHitEnabled",!0,l.getBooleanValidator()),s.Factory.addGetterSetter(E,"perfectDrawEnabled",!0,l.getBooleanValidator()),s.Factory.addGetterSetter(E,"shadowForStrokeEnabled",!0,l.getBooleanValidator()),s.Factory.addGetterSetter(E,"lineJoin"),s.Factory.addGetterSetter(E,"lineCap"),s.Factory.addGetterSetter(E,"sceneFunc"),s.Factory.addGetterSetter(E,"hitFunc"),s.Factory.addGetterSetter(E,"dash"),s.Factory.addGetterSetter(E,"dashOffset",0,l.getNumberValidator()),s.Factory.addGetterSetter(E,"shadowColor",void 0,l.getStringValidator()),s.Factory.addGetterSetter(E,"shadowBlur",0,l.getNumberValidator()),s.Factory.addGetterSetter(E,"shadowOpacity",1,l.getNumberValidator()),s.Factory.addComponentsGetterSetter(E,"shadowOffset",["x","y"]),s.Factory.addGetterSetter(E,"shadowOffsetX",0,l.getNumberValidator()),s.Factory.addGetterSetter(E,"shadowOffsetY",0,l.getNumberValidator()),s.Factory.addGetterSetter(E,"fillPatternImage"),s.Factory.addGetterSetter(E,"fill",void 0,l.getStringValidator()),s.Factory.addGetterSetter(E,"fillPatternX",0,l.getNumberValidator()),s.Factory.addGetterSetter(E,"fillPatternY",0,l.getNumberValidator()),s.Factory.addGetterSetter(E,"fillLinearGradientColorStops"),s.Factory.addGetterSetter(E,"strokeLinearGradientColorStops"),s.Factory.addGetterSetter(E,"fillRadialGradientStartRadius",0),s.Factory.addGetterSetter(E,"fillRadialGradientEndRadius",0),s.Factory.addGetterSetter(E,"fillRadialGradientColorStops"),s.Factory.addGetterSetter(E,"fillPatternRepeat","repeat"),s.Factory.addGetterSetter(E,"fillEnabled",!0),s.Factory.addGetterSetter(E,"strokeEnabled",!0),s.Factory.addGetterSetter(E,"shadowEnabled",!0),s.Factory.addGetterSetter(E,"dashEnabled",!0),s.Factory.addGetterSetter(E,"strokeScaleEnabled",!0),s.Factory.addGetterSetter(E,"fillPriority","color"),s.Factory.addComponentsGetterSetter(E,"fillPatternOffset",["x","y"]),s.Factory.addGetterSetter(E,"fillPatternOffsetX",0,l.getNumberValidator()),s.Factory.addGetterSetter(E,"fillPatternOffsetY",0,l.getNumberValidator()),s.Factory.addComponentsGetterSetter(E,"fillPatternScale",["x","y"]),s.Factory.addGetterSetter(E,"fillPatternScaleX",1,l.getNumberValidator()),s.Factory.addGetterSetter(E,"fillPatternScaleY",1,l.getNumberValidator()),s.Factory.addComponentsGetterSetter(E,"fillLinearGradientStartPoint",["x","y"]),s.Factory.addComponentsGetterSetter(E,"strokeLinearGradientStartPoint",["x","y"]),s.Factory.addGetterSetter(E,"fillLinearGradientStartPointX",0),s.Factory.addGetterSetter(E,"strokeLinearGradientStartPointX",0),s.Factory.addGetterSetter(E,"fillLinearGradientStartPointY",0),s.Factory.addGetterSetter(E,"strokeLinearGradientStartPointY",0),s.Factory.addComponentsGetterSetter(E,"fillLinearGradientEndPoint",["x","y"]),s.Factory.addComponentsGetterSetter(E,"strokeLinearGradientEndPoint",["x","y"]),s.Factory.addGetterSetter(E,"fillLinearGradientEndPointX",0),s.Factory.addGetterSetter(E,"strokeLinearGradientEndPointX",0),s.Factory.addGetterSetter(E,"fillLinearGradientEndPointY",0),s.Factory.addGetterSetter(E,"strokeLinearGradientEndPointY",0),s.Factory.addComponentsGetterSetter(E,"fillRadialGradientStartPoint",["x","y"]),s.Factory.addGetterSetter(E,"fillRadialGradientStartPointX",0),s.Factory.addGetterSetter(E,"fillRadialGradientStartPointY",0),s.Factory.addComponentsGetterSetter(E,"fillRadialGradientEndPoint",["x","y"]),s.Factory.addGetterSetter(E,"fillRadialGradientEndPointX",0),s.Factory.addGetterSetter(E,"fillRadialGradientEndPointY",0),s.Factory.addGetterSetter(E,"fillPatternRotation",0),s.Factory.backCompat(E,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"}),a.Collection.mapMethods(E)},function(t,e,n){var i=n(28).Konva;i._injectGlobal(i),e.default=i,t.exports=e.default},function(t,e,n){t.exports=n(66),t.exports.Collection=n(25)},function(t,e,n){var i;
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */!function(r,o,a,s){"use strict";var c,l=["","webkit","Moz","MS","ms","o"],u=o.createElement("div"),h="function",p=Math.round,d=Math.abs,f=Date.now;function m(t,e,n){return setTimeout(x(t,n),e)}function v(t,e,n){return!!Array.isArray(t)&&(y(t,n[e],n),!0)}function y(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==s)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function g(t,e,n){var i="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=r.console&&(r.console.warn||r.console.log);return o&&o.call(r.console,i,n),t.apply(this,arguments)}}c="function"!=typeof Object.assign?function(t){if(t===s||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==s&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e}:Object.assign;var b=g((function(t,e,n){for(var i=Object.keys(e),r=0;r<i.length;)(!n||n&&t[i[r]]===s)&&(t[i[r]]=e[i[r]]),r++;return t}),"extend","Use `assign`."),_=g((function(t,e){return b(t,e,!0)}),"merge","Use `assign`.");function w(t,e,n){var i,r=e.prototype;(i=t.prototype=Object.create(r)).constructor=t,i._super=r,n&&c(i,n)}function x(t,e){return function(){return t.apply(e,arguments)}}function E(t,e){return typeof t==h?t.apply(e&&e[0]||s,e):t}function S(t,e){return t===s?e:t}function C(t,e,n){y(O(e),(function(e){t.addEventListener(e,n,!1)}))}function k(t,e,n){y(O(e),(function(e){t.removeEventListener(e,n,!1)}))}function P(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function T(t,e){return t.indexOf(e)>-1}function O(t){return t.trim().split(/\s+/g)}function A(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function M(t){return Array.prototype.slice.call(t,0)}function j(t,e,n){for(var i=[],r=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];A(r,a)<0&&i.push(t[o]),r[o]=a,o++}return n&&(i=e?i.sort((function(t,n){return t[e]>n[e]})):i.sort()),i}function R(t,e){for(var n,i,r=e[0].toUpperCase()+e.slice(1),o=0;o<l.length;){if((i=(n=l[o])?n+r:e)in t)return i;o++}return s}var D=1;function N(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||r}var I="ontouchstart"in r,L=R(r,"PointerEvent")!==s,B=I&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),F=25,z=1,G=2,V=4,H=8,U=1,W=2,$=4,q=8,K=16,Y=W|$,X=q|K,Z=Y|X,J=["x","y"],Q=["clientX","clientY"];function tt(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){E(t.options.enable,[t])&&n.handler(e)},this.init()}function et(t,e,n){var i=n.pointers.length,r=n.changedPointers.length,o=e&z&&i-r==0,a=e&(V|H)&&i-r==0;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,i=e.pointers,r=i.length;n.firstInput||(n.firstInput=nt(e));r>1&&!n.firstMultiple?n.firstMultiple=nt(e):1===r&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,c=a?a.center:o.center,l=e.center=it(i);e.timeStamp=f(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=st(c,l),e.distance=at(c,l),function(t,e){var n=e.center,i=t.offsetDelta||{},r=t.prevDelta||{},o=t.prevInput||{};e.eventType!==z&&o.eventType!==V||(r=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y});e.deltaX=r.x+(n.x-i.x),e.deltaY=r.y+(n.y-i.y)}(n,e),e.offsetDirection=ot(e.deltaX,e.deltaY);var u=rt(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=u.x,e.overallVelocityY=u.y,e.overallVelocity=d(u.x)>d(u.y)?u.x:u.y,e.scale=a?(h=a.pointers,p=i,at(p[0],p[1],Q)/at(h[0],h[1],Q)):1,e.rotation=a?function(t,e){return st(e[1],e[0],Q)+st(t[1],t[0],Q)}(a.pointers,i):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,i,r,o,a=t.lastInterval||e,c=e.timeStamp-a.timeStamp;if(e.eventType!=H&&(c>F||a.velocity===s)){var l=e.deltaX-a.deltaX,u=e.deltaY-a.deltaY,h=rt(c,l,u);i=h.x,r=h.y,n=d(h.x)>d(h.y)?h.x:h.y,o=ot(l,u),t.lastInterval=e}else n=a.velocity,i=a.velocityX,r=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=i,e.velocityY=r,e.direction=o}(n,e);var h,p;var m=t.element;P(e.srcEvent.target,m)&&(m=e.srcEvent.target);e.target=m}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function nt(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:p(t.pointers[n].clientX),clientY:p(t.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:e,center:it(e),deltaX:t.deltaX,deltaY:t.deltaY}}function it(t){var e=t.length;if(1===e)return{x:p(t[0].clientX),y:p(t[0].clientY)};for(var n=0,i=0,r=0;r<e;)n+=t[r].clientX,i+=t[r].clientY,r++;return{x:p(n/e),y:p(i/e)}}function rt(t,e,n){return{x:e/t||0,y:n/t||0}}function ot(t,e){return t===e?U:d(t)>=d(e)?t<0?W:$:e<0?q:K}function at(t,e,n){n||(n=J);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return Math.sqrt(i*i+r*r)}function st(t,e,n){n||(n=J);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return 180*Math.atan2(r,i)/Math.PI}tt.prototype={handler:function(){},init:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(N(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&k(this.element,this.evEl,this.domHandler),this.evTarget&&k(this.target,this.evTarget,this.domHandler),this.evWin&&k(N(this.element),this.evWin,this.domHandler)}};var ct={mousedown:z,mousemove:G,mouseup:V},lt="mousedown",ut="mousemove mouseup";function ht(){this.evEl=lt,this.evWin=ut,this.pressed=!1,tt.apply(this,arguments)}w(ht,tt,{handler:function(t){var e=ct[t.type];e&z&&0===t.button&&(this.pressed=!0),e&G&&1!==t.which&&(e=V),this.pressed&&(e&V&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var pt={pointerdown:z,pointermove:G,pointerup:V,pointercancel:H,pointerout:H},dt={2:"touch",3:"pen",4:"mouse",5:"kinect"},ft="pointerdown",mt="pointermove pointerup pointercancel";function vt(){this.evEl=ft,this.evWin=mt,tt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(ft="MSPointerDown",mt="MSPointerMove MSPointerUp MSPointerCancel"),w(vt,tt,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace("ms",""),r=pt[i],o=dt[t.pointerType]||t.pointerType,a="touch"==o,s=A(e,t.pointerId,"pointerId");r&z&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):r&(V|H)&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var yt={touchstart:z,touchmove:G,touchend:V,touchcancel:H},gt="touchstart",bt="touchstart touchmove touchend touchcancel";function _t(){this.evTarget=gt,this.evWin=bt,this.started=!1,tt.apply(this,arguments)}function wt(t,e){var n=M(t.touches),i=M(t.changedTouches);return e&(V|H)&&(n=j(n.concat(i),"identifier",!0)),[n,i]}w(_t,tt,{handler:function(t){var e=yt[t.type];if(e===z&&(this.started=!0),this.started){var n=wt.call(this,t,e);e&(V|H)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var xt={touchstart:z,touchmove:G,touchend:V,touchcancel:H},Et="touchstart touchmove touchend touchcancel";function St(){this.evTarget=Et,this.targetIds={},tt.apply(this,arguments)}function Ct(t,e){var n=M(t.touches),i=this.targetIds;if(e&(z|G)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,o,a=M(t.changedTouches),s=[],c=this.target;if(o=n.filter((function(t){return P(t.target,c)})),e===z)for(r=0;r<o.length;)i[o[r].identifier]=!0,r++;for(r=0;r<a.length;)i[a[r].identifier]&&s.push(a[r]),e&(V|H)&&delete i[a[r].identifier],r++;return s.length?[j(o.concat(s),"identifier",!0),s]:void 0}w(St,tt,{handler:function(t){var e=xt[t.type],n=Ct.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}});var kt=2500,Pt=25;function Tt(){tt.apply(this,arguments);var t=x(this.handler,this);this.touch=new St(this.manager,t),this.mouse=new ht(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function Ot(t,e){t&z?(this.primaryTouch=e.changedPointers[0].identifier,At.call(this,e)):t&(V|H)&&At.call(this,e)}function At(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout((function(){var t=i.indexOf(n);t>-1&&i.splice(t,1)}),kt)}}function Mt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],o=Math.abs(e-r.x),a=Math.abs(n-r.y);if(o<=Pt&&a<=Pt)return!0}return!1}w(Tt,tt,{handler:function(t,e,n){var i="touch"==n.pointerType,r="mouse"==n.pointerType;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)Ot.call(this,e,n);else if(r&&Mt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var jt=R(u.style,"touchAction"),Rt=jt!==s,Dt="auto",Nt="manipulation",It="none",Lt="pan-x",Bt="pan-y",Ft=function(){if(!Rt)return!1;var t={},e=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||r.CSS.supports("touch-action",n)})),t}();function zt(t,e){this.manager=t,this.set(e)}zt.prototype={set:function(t){"compute"==t&&(t=this.compute()),Rt&&this.manager.element.style&&Ft[t]&&(this.manager.element.style[jt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return y(this.manager.recognizers,(function(e){E(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(T(t,It))return It;var e=T(t,Lt),n=T(t,Bt);if(e&&n)return It;if(e||n)return e?Lt:Bt;if(T(t,Nt))return Nt;return Dt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var i=this.actions,r=T(i,It)&&!Ft[It],o=T(i,Bt)&&!Ft[Bt],a=T(i,Lt)&&!Ft[Lt];if(r){var s=1===t.pointers.length,c=t.distance<2,l=t.deltaTime<250;if(s&&c&&l)return}if(!a||!o)return r||o&&n&Y||a&&n&X?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Gt=1,Vt=2,Ht=4,Ut=8,Wt=Ut,$t=16;function qt(t){this.options=c({},this.defaults,t||{}),this.id=D++,this.manager=null,this.options.enable=S(this.options.enable,!0),this.state=Gt,this.simultaneous={},this.requireFail=[]}function Kt(t){return t&$t?"cancel":t&Ut?"end":t&Ht?"move":t&Vt?"start":""}function Yt(t){return t==K?"down":t==q?"up":t==W?"left":t==$?"right":""}function Xt(t,e){var n=e.manager;return n?n.get(t):t}function Zt(){qt.apply(this,arguments)}function Jt(){Zt.apply(this,arguments),this.pX=null,this.pY=null}function Qt(){Zt.apply(this,arguments)}function te(){qt.apply(this,arguments),this._timer=null,this._input=null}function ee(){Zt.apply(this,arguments)}function ne(){Zt.apply(this,arguments)}function ie(){qt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function re(t,e){return(e=e||{}).recognizers=S(e.recognizers,re.defaults.preset),new oe(t,e)}qt.prototype={defaults:{},set:function(t){return c(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(v(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Xt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return v(t,"dropRecognizeWith",this)?this:(t=Xt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(v(t,"requireFailure",this))return this;var e=this.requireFail;return-1===A(e,t=Xt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(v(t,"dropRequireFailure",this))return this;t=Xt(t,this);var e=A(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function i(n){e.manager.emit(n,t)}n<Ut&&i(e.options.event+Kt(n)),i(e.options.event),t.additionalEvent&&i(t.additionalEvent),n>=Ut&&i(e.options.event+Kt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|Gt)))return!1;t++}return!0},recognize:function(t){var e=c({},t);if(!E(this.options.enable,[this,e]))return this.reset(),void(this.state=32);this.state&(Wt|$t|32)&&(this.state=Gt),this.state=this.process(e),this.state&(Vt|Ht|Ut|$t)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},w(Zt,qt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=e&(Vt|Ht),r=this.attrTest(t);return i&&(n&H||!r)?e|$t:i||r?n&V?e|Ut:e&Vt?e|Ht:Vt:32}}),w(Jt,Zt,{defaults:{event:"pan",threshold:10,pointers:1,direction:Z},getTouchAction:function(){var t=this.options.direction,e=[];return t&Y&&e.push(Bt),t&X&&e.push(Lt),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,r=t.direction,o=t.deltaX,a=t.deltaY;return r&e.direction||(e.direction&Y?(r=0===o?U:o<0?W:$,n=o!=this.pX,i=Math.abs(t.deltaX)):(r=0===a?U:a<0?q:K,n=a!=this.pY,i=Math.abs(t.deltaY))),t.direction=r,n&&i>e.threshold&&r&e.direction},attrTest:function(t){return Zt.prototype.attrTest.call(this,t)&&(this.state&Vt||!(this.state&Vt)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Yt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),w(Qt,Zt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[It]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&Vt)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),w(te,qt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Dt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime>e.time;if(this._input=t,!i||!n||t.eventType&(V|H)&&!r)this.reset();else if(t.eventType&z)this.reset(),this._timer=m((function(){this.state=Wt,this.tryEmit()}),e.time,this);else if(t.eventType&V)return Wt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===Wt&&(t&&t.eventType&V?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),w(ee,Zt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[It]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&Vt)}}),w(ne,Zt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Y|X,pointers:1},getTouchAction:function(){return Jt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(Y|X)?e=t.overallVelocity:n&Y?e=t.overallVelocityX:n&X&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&d(e)>this.options.velocity&&t.eventType&V},emit:function(t){var e=Yt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),w(ie,qt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Nt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime<e.time;if(this.reset(),t.eventType&z&&0===this.count)return this.failTimeout();if(i&&r&&n){if(t.eventType!=V)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||at(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=m((function(){this.state=Wt,this.tryEmit()}),e.interval,this),Vt):Wt}return 32},failTimeout:function(){return this._timer=m((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Wt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),re.VERSION="2.0.7",re.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[ee,{enable:!1}],[Qt,{enable:!1},["rotate"]],[ne,{direction:Y}],[Jt,{direction:Y},["swipe"]],[ie],[ie,{event:"doubletap",taps:2},["tap"]],[te]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function oe(t,e){var n;this.options=c({},re.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(L?vt:B?St:I?Tt:ht))(n,et),this.touchAction=new zt(this,this.options.touchAction),ae(this,!0),y(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function ae(t,e){var n,i=t.element;i.style&&(y(t.options.cssProps,(function(r,o){n=R(i.style,o),e?(t.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}oe.prototype={set:function(t){return c(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var i=this.recognizers,r=e.curRecognizer;(!r||r&&r.state&Wt)&&(r=e.curRecognizer=null);for(var o=0;o<i.length;)n=i[o],2===e.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(t),!r&&n.state&(Vt|Ht|Ut)&&(r=e.curRecognizer=n),o++}},get:function(t){if(t instanceof qt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(v(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(v(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=A(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==s&&e!==s){var n=this.handlers;return y(O(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==s){var n=this.handlers;return y(O(t),(function(t){e?n[t]&&n[t].splice(A(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](e),i++}},destroy:function(){this.element&&ae(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},c(re,{INPUT_START:z,INPUT_MOVE:G,INPUT_END:V,INPUT_CANCEL:H,STATE_POSSIBLE:Gt,STATE_BEGAN:Vt,STATE_CHANGED:Ht,STATE_ENDED:Ut,STATE_RECOGNIZED:Wt,STATE_CANCELLED:$t,STATE_FAILED:32,DIRECTION_NONE:U,DIRECTION_LEFT:W,DIRECTION_RIGHT:$,DIRECTION_UP:q,DIRECTION_DOWN:K,DIRECTION_HORIZONTAL:Y,DIRECTION_VERTICAL:X,DIRECTION_ALL:Z,Manager:oe,Input:tt,TouchAction:zt,TouchInput:St,MouseInput:ht,PointerEventInput:vt,TouchMouseInput:Tt,SingleTouchInput:_t,Recognizer:qt,AttrRecognizer:Zt,Tap:ie,Pan:Jt,Swipe:ne,Pinch:Qt,Rotate:ee,Press:te,on:C,off:k,each:y,merge:_,extend:b,assign:c,inherit:w,bindFn:x,prefixed:R}),(void 0!==r?r:"undefined"!=typeof self?self:{}).Hammer=re,(i=function(){return re}.call(e,n,e,t))===s||(t.exports=i)}(window,document)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(5),c=n(13),l=n(3),u=n(2),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.children=new o.Collection,e}return r(e,t),e.prototype.getChildren=function(t){if(!t)return this.children;var e=new o.Collection;return this.children.each((function(n){t(n)&&e.push(n)})),e},e.prototype.hasChildren=function(){return this.getChildren().length>0},e.prototype.removeChildren=function(){for(var t,e=0;e<this.children.length;e++)(t=this.children[e]).parent=null,t.index=0,t.remove();return this.children=new o.Collection,this},e.prototype.destroyChildren=function(){for(var t,e=0;e<this.children.length;e++)(t=this.children[e]).parent=null,t.index=0,t.destroy();return this.children=new o.Collection,this},e.prototype.add=function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}if(t.getParent())return t.moveTo(this),this;var n=this.children;return this._validateAdd(t),t.index=n.length,t.parent=this,n.push(t),this._fire("add",{child:t}),this},e.prototype.destroy=function(){return this.hasChildren()&&this.destroyChildren(),t.prototype.destroy.call(this),this},e.prototype.find=function(t){return this._generalFind(t,!1)},e.prototype.get=function(t){return o.Util.warn("collection.get() method is deprecated. Please use collection.find() instead."),this.find(t)},e.prototype.findOne=function(t){var e=this._generalFind(t,!0);return e.length>0?e[0]:void 0},e.prototype._generalFind=function(t,e){var n=[];return this._descendants((function(i){var r=i._isMatch(t);return r&&n.push(i),!(!r||!e)})),o.Collection.toCollection(n)},e.prototype._descendants=function(t){for(var e=0;e<this.children.length;e++){var n=this.children[e];if(t(n))return!0;if(n.hasChildren()&&n._descendants(t))return!0}return!1},e.prototype.toObject=function(){var t=s.Node.prototype.toObject.call(this);t.children=[];for(var e=this.getChildren(),n=e.length,i=0;i<n;i++){var r=e[i];t.children.push(r.toObject())}return t},e.prototype._getDescendants=function(t){for(var e=[],n=t.length,i=0;i<n;i++){var r=t[i];this.isAncestorOf(r)&&e.push(r)}return e},e.prototype.isAncestorOf=function(t){for(var e=t.getParent();e;){if(e._id===this._id)return!0;e=e.getParent()}return!1},e.prototype.clone=function(t){var e=s.Node.prototype.clone.call(this,t);return this.getChildren().each((function(t){e.add(t.clone())})),e},e.prototype.getAllIntersections=function(t){var e=[];return this.find("Shape").each((function(n){n.isVisible()&&n.intersects(t)&&e.push(n)})),e},e.prototype._setChildrenIndices=function(){this.children.each((function(t,e){t.index=e}))},e.prototype.drawScene=function(t,e,n){var i=this.getLayer(),r=t||i&&i.getCanvas(),o=r&&r.getContext(),a=this._getCanvasCache(),s=a&&a.scene;return(this.isVisible()||n)&&(!n&&s?(o.save(),i._applyTransform(this,o,e),this._drawCachedSceneCanvas(o),o.restore()):this._drawChildren(r,"drawScene",e,!1,n,n)),this},e.prototype.drawHit=function(t,e,n){var i=this.getLayer(),r=t||i&&i.hitCanvas,o=r&&r.getContext(),a=this._getCanvasCache(),s=a&&a.hit;return(this.shouldDrawHit(r)||n)&&(!n&&s?(o.save(),i._applyTransform(this,o,e),this._drawCachedHitCanvas(o),o.restore()):this._drawChildren(r,"drawHit",e,!1,n,n)),this},e.prototype._drawChildren=function(t,e,n,i,r,o){var a,s,c=this.getLayer(),l=t&&t.getContext(),u=this.clipWidth(),h=this.clipHeight(),p=this.clipFunc(),d=u&&h||p;if(d&&c){l.save();var f=this.getAbsoluteTransform(n),m=f.getMatrix();l.transform(m[0],m[1],m[2],m[3],m[4],m[5]),l.beginPath(),p?p.call(this,l,this):(a=this.clipX(),s=this.clipY(),l.rect(a,s,u,h)),l.clip(),m=f.copy().invert().getMatrix(),l.transform(m[0],m[1],m[2],m[3],m[4],m[5])}var v="source-over"!==this.globalCompositeOperation()&&!o;v&&c&&(l.save(),l._applyGlobalCompositeOperation(this)),this.children.each((function(o){o[e](t,n,i,r)})),v&&c&&l.restore(),d&&c&&l.restore()},e.prototype.shouldDrawHit=function(t){if(t&&t.isCache)return!0;var e=this.getLayer(),n=!1;c.DD._dragElements.forEach((function(t){"dragging"===t.dragStatus&&t.node.getLayer()===e&&(n=!0)}));var i=!u.Konva.hitOnDragEnabled&&n;return e&&e.hitGraphEnabled()&&this.isVisible()&&!i},e.prototype.getClientRect=function(t){var e,n,i,r,o=(t=t||{}).skipTransform,a=t.relativeTo,s={x:1/0,y:1/0,width:0,height:0},c=this;this.children.each((function(o){if(o.visible()){var a=o.getClientRect({relativeTo:c,skipShadow:t.skipShadow,skipStroke:t.skipStroke});0===a.width&&0===a.height||(void 0===e?(e=a.x,n=a.y,i=a.x+a.width,r=a.y+a.height):(e=Math.min(e,a.x),n=Math.min(n,a.y),i=Math.max(i,a.x+a.width),r=Math.max(r,a.y+a.height)))}}));for(var l=this.find("Shape"),u=!1,h=0;h<l.length;h++){if(l[h]._isVisible(this)){u=!0;break}}return s=u?{x:e,y:n,width:i-e,height:r-n}:{x:0,y:0,width:0,height:0},o?s:this._transformedRect(s,a)},e}(s.Node);e.Container=h,a.Factory.addComponentsGetterSetter(h,"clip",["x","y","width","height"]),a.Factory.addGetterSetter(h,"clipX",void 0,l.getNumberValidator()),a.Factory.addGetterSetter(h,"clipY",void 0,l.getNumberValidator()),a.Factory.addGetterSetter(h,"clipWidth",void 0,l.getNumberValidator()),a.Factory.addGetterSetter(h,"clipHeight",void 0,l.getNumberValidator()),a.Factory.addGetterSetter(h,"clipFunc"),o.Collection.mapMethods(h)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o,a=n(4),s=n(18),c=n(2),l=n(1),u=n(3);var h=function(){function t(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var e=(t||{}).pixelRatio||c.Konva.pixelRatio||function(){if(o)return o;var t=a.Util.createCanvasElement().getContext("2d");return o=(c.Konva._global.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}();this.pixelRatio=e,this._canvas=a.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}return t.prototype.getContext=function(){return this.context},t.prototype.getPixelRatio=function(){return this.pixelRatio},t.prototype.setPixelRatio=function(t){var e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)},t.prototype.setWidth=function(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";var e=this.pixelRatio;this.getContext()._context.scale(e,e)},t.prototype.setHeight=function(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";var e=this.pixelRatio;this.getContext()._context.scale(e,e)},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.setSize=function(t,e){this.setWidth(t),this.setHeight(e)},t.prototype.toDataURL=function(t,e){try{return this._canvas.toDataURL(t,e)}catch(t){try{return this._canvas.toDataURL()}catch(t){return a.Util.error("Unable to get data URL. "+t.message),""}}},t}();e.Canvas=h,l.Factory.addGetterSetter(h,"pixelRatio",void 0,u.getNumberValidator());var p=function(t){function e(e){void 0===e&&(e={width:0,height:0});var n=t.call(this,e)||this;return n.context=new s.SceneContext(n),n.setSize(e.width,e.height),n}return r(e,t),e}(h);e.SceneCanvas=p;var d=function(t){function e(e){void 0===e&&(e={width:0,height:0});var n=t.call(this,e)||this;return n.hitCanvas=!0,n.context=new s.HitContext(n),n.setSize(e.width,e.height),n}return r(e,t),e}(h);e.HitCanvas=d},function(t,e,n){(function(e){var n;n=void 0!==e?e:this,t.exports=function(t){if(t.CSS&&t.CSS.escape)return t.CSS.escape;var e=function(t){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var e,n=String(t),i=n.length,r=-1,o="",a=n.charCodeAt(0);++r<i;)0!=(e=n.charCodeAt(r))?o+=e>=1&&e<=31||127==e||0==r&&e>=48&&e<=57||1==r&&e>=48&&e<=57&&45==a?"\\"+e.toString(16)+" ":0==r&&1==i&&45==e||!(e>=128||45==e||95==e||e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122)?"\\"+n.charAt(r):n.charAt(r):o+="�";return o};return t.CSS||(t.CSS={}),t.CSS.escape=e,e}(n)}).call(this,n(17))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=n(4);e.DD={get isDragging(){var t=!1;return e.DD._dragElements.forEach((function(e){"dragging"===e.dragStatus&&(t=!0)})),t},justDragged:!1,get node(){var t;return e.DD._dragElements.forEach((function(e){t=e.node})),t},_dragElements:new Map,_drag:function(t){e.DD._dragElements.forEach((function(e,n){var i=e.node,o=i.getStage();o.setPointersPositions(t),void 0===e.pointerId&&(e.pointerId=r.Util._getFirstPointerId(t));var a=o._changedPointerPositions.find((function(t){return t.id===e.pointerId}));if(a){if("dragging"!==e.dragStatus){var s=i.dragDistance();if(Math.max(Math.abs(a.x-e.startPointerPos.x),Math.abs(a.y-e.startPointerPos.y))<s)return;if(i.startDrag({evt:t}),!i.isDragging())return}i._setDragPosition(t,e),i.fire("dragmove",{type:"dragmove",target:i,evt:t},!0)}}))},_endDragBefore:function(t){e.DD._dragElements.forEach((function(n,r){var o=n.node.getStage();if(t&&o.setPointersPositions(t),o._changedPointerPositions.find((function(t){return t.id===n.pointerId}))){"dragging"===n.dragStatus&&(e.DD.justDragged=!0,i.Konva.listenClickTap=!1,n.dragStatus="stopped");var a=n.node.getLayer()||n.node instanceof i.Konva.Stage&&n.node;a&&a.draw()}}))},_endDragAfter:function(t){e.DD._dragElements.forEach((function(n,i){"stopped"===n.dragStatus&&n.node.fire("dragend",{type:"dragend",target:n.node,evt:t},!0),"dragging"!==n.dragStatus&&e.DD._dragElements.delete(i)}))}},i.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1))},function(t,e,n){"use strict";var i="hasOwnProperty",r=/,?([a-z]),?/gi,o=parseFloat,a=Math,s=a.PI,c=a.min,l=a.max,u=a.pow,h=a.abs,p=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/gi,d=/(-?\d*\.?\d*(?:e[-+]?\\d+)?)[\s]*,?[\s]*/gi;function f(t,e){return"finite"==(e=String.prototype.toLowerCase.call(e))?isFinite(t):!("array"!=e||!(t instanceof Array||Array.isArray&&Array.isArray(t)))||("null"==e&&null===t||e==typeof t&&null!==t||"object"==e&&t===Object(t)||Object.prototype.toString.call(t).slice(8,-1).toLowerCase()==e)}function m(t){if("function"==typeof t||Object(t)!==t)return t;var e=new t.constructor;for(var n in t)t[i](n)&&(e[n]=m(t[n]));return e}function v(t){var e=v.ps=v.ps||{};return e[t]?e[t].sleep=100:e[t]={sleep:100},setTimeout((function(){for(var n in e)e[i](n)&&n!=t&&(e[n].sleep--,!e[n].sleep&&delete e[n])})),e[t]}function y(t,e,n,i){return null==t&&(t=e=n=i=0),null==e&&(e=t.y,n=t.width,i=t.height,t=t.x),{x:t,y:e,width:n,w:n,height:i,h:i,x2:t+n,y2:e+i,cx:t+n/2,cy:e+i/2,r1:a.min(n,i)/2,r2:a.max(n,i)/2,r0:a.sqrt(n*n+i*i)/2,path:P(t,e,n,i),vb:[t,e,n,i].join(" ")}}function g(){return this.join(",").replace(r,"$1")}function b(t){var e=m(t);return e.toString=g,e}function _(t,e,n,i,r,o,c,l,h){var p=1-h,d=u(p,3),f=u(p,2),m=h*h,v=m*h,y=t+2*h*(n-t)+m*(r-2*n+t),g=e+2*h*(i-e)+m*(o-2*i+e),b=n+2*h*(r-n)+m*(c-2*r+n),_=i+2*h*(o-i)+m*(l-2*o+i);return{x:d*t+3*f*h*n+3*p*h*h*r+v*c,y:d*e+3*f*h*i+3*p*h*h*o+v*l,m:{x:y,y:g},n:{x:b,y:_},start:{x:p*t+h*n,y:p*e+h*i},end:{x:p*r+h*c,y:p*o+h*l},alpha:90-180*a.atan2(y-b,g-_)/s}}function w(t,e,n,i,r,o,a,s){f(t,"array")||(t=[t,e,n,i,r,o,a,s]);var c=D.apply(null,t);return y(c.min.x,c.min.y,c.max.x-c.min.x,c.max.y-c.min.y)}function x(t,e,n){return e>=t.x&&e<=t.x+t.width&&n>=t.y&&n<=t.y+t.height}function E(t,e,n,i,r){return t*(t*(-3*e+9*n-9*i+3*r)+6*e-12*n+6*i)-3*e+3*n}function S(t,e,n,i,r,o,s,c,l){null==l&&(l=1);for(var u=(l=l>1?1:l<0?0:l)/2,h=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],p=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],d=0,f=0;f<12;f++){var m=u*h[f]+u,v=E(m,t,n,r,s),y=E(m,e,i,o,c),g=v*v+y*y;d+=p[f]*a.sqrt(g)}return u*d}function C(t,e,n,i,r,o,a,s){if(!(l(t,n)<c(r,a)||c(t,n)>l(r,a)||l(e,i)<c(o,s)||c(e,i)>l(o,s))){var u=(t-n)*(o-s)-(e-i)*(r-a);if(u){var h=((t*i-e*n)*(r-a)-(t-n)*(r*s-o*a))/u,p=((t*i-e*n)*(o-s)-(e-i)*(r*s-o*a))/u,d=+h.toFixed(2),f=+p.toFixed(2);if(!(d<+c(t,n).toFixed(2)||d>+l(t,n).toFixed(2)||d<+c(r,a).toFixed(2)||d>+l(r,a).toFixed(2)||f<+c(e,i).toFixed(2)||f>+l(e,i).toFixed(2)||f<+c(o,s).toFixed(2)||f>+l(o,s).toFixed(2)))return{x:h,y:p}}}}function k(t,e,n){if(!function(t,e){return t=y(t),x(e=y(e),t.x,t.y)||x(e,t.x2,t.y)||x(e,t.x,t.y2)||x(e,t.x2,t.y2)||x(t,e.x,e.y)||x(t,e.x2,e.y)||x(t,e.x,e.y2)||x(t,e.x2,e.y2)||(t.x<e.x2&&t.x>e.x||e.x<t.x2&&e.x>t.x)&&(t.y<e.y2&&t.y>e.y||e.y<t.y2&&e.y>t.y)}(w(t),w(e)))return n?0:[];for(var i=~~(S.apply(0,t)/5),r=~~(S.apply(0,e)/5),o=[],a=[],s={},c=n?0:[],l=0;l<i+1;l++){var u=_.apply(0,t.concat(l/i));o.push({x:u.x,y:u.y,t:l/i})}for(l=0;l<r+1;l++)u=_.apply(0,e.concat(l/r)),a.push({x:u.x,y:u.y,t:l/r});for(l=0;l<i;l++)for(var p=0;p<r;p++){var d=o[l],f=o[l+1],m=a[p],v=a[p+1],g=h(f.x-d.x)<.01?"y":"x",b=h(v.x-m.x)<.01?"y":"x",E=C(d.x,d.y,f.x,f.y,m.x,m.y,v.x,v.y);if(E){if(s[E.x.toFixed(0)]==E.y.toFixed(0))continue;s[E.x.toFixed(0)]=E.y.toFixed(0);var k=d.t+h((E[g]-d[g])/(f[g]-d[g]))*(f.t-d.t),P=m.t+h((E[b]-m[b])/(v[b]-m[b]))*(v.t-m.t);k>=0&&k<=1&&P>=0&&P<=1&&(n?c++:c.push({x:E.x,y:E.y,t1:k,t2:P}))}}return c}function P(t,e,n,i,r){if(r)return[["M",+t+ +r,e],["l",n-2*r,0],["a",r,r,0,0,1,r,r],["l",0,i-2*r],["a",r,r,0,0,1,-r,r],["l",2*r-n,0],["a",r,r,0,0,1,-r,-r],["l",0,2*r-i],["a",r,r,0,0,1,r,-r],["z"]];var o=[["M",t,e],["l",n,0],["l",0,i],["l",-n,0],["z"]];return o.toString=g,o}function T(t,e,n,i,r){if(null==r&&null==i&&(i=n),t=+t,e=+e,n=+n,i=+i,null!=r)var o=Math.PI/180,a=t+n*Math.cos(-i*o),s=t+n*Math.cos(-r*o),c=[["M",a,e+n*Math.sin(-i*o)],["A",n,n,0,+(r-i>180),0,s,e+n*Math.sin(-r*o)]];else c=[["M",t,e],["m",0,-i],["a",n,i,0,1,1,0,2*i],["a",n,i,0,1,1,0,-2*i],["z"]];return c.toString=g,c}function O(t){var e=v(t);if(e.abs)return b(e.abs);if(f(t,"array")&&f(t&&t[0],"array")||(t=function(t){if(!t)return null;var e=v(t);if(e.arr)return m(e.arr);var n={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},i=[];return f(t,"array")&&f(t[0],"array")&&(i=m(t)),i.length||String(t).replace(p,(function(t,e,r){var o=[],a=e.toLowerCase();if(r.replace(d,(function(t,e){e&&o.push(+e)})),"m"==a&&o.length>2&&(i.push([e].concat(o.splice(0,2))),a="l",e="m"==e?"l":"L"),"o"==a&&1==o.length&&i.push([e,o[0]]),"r"==a)i.push([e].concat(o));else for(;o.length>=n[a]&&(i.push([e].concat(o.splice(0,n[a]))),n[a]););})),i.toString=v.toString,e.arr=m(i),i}(t)),!t||!t.length)return[["M",0,0]];var n,i=[],r=0,o=0,a=0,s=0,c=0;"M"==t[0][0]&&(a=r=+t[0][1],s=o=+t[0][2],c++,i[0]=["M",r,o]);for(var l,u,h=3==t.length&&"M"==t[0][0]&&"R"==t[1][0].toUpperCase()&&"Z"==t[2][0].toUpperCase(),y=c,_=t.length;y<_;y++){if(i.push(l=[]),(n=(u=t[y])[0])!=n.toUpperCase())switch(l[0]=n.toUpperCase(),l[0]){case"A":l[1]=u[1],l[2]=u[2],l[3]=u[3],l[4]=u[4],l[5]=u[5],l[6]=+u[6]+r,l[7]=+u[7]+o;break;case"V":l[1]=+u[1]+o;break;case"H":l[1]=+u[1]+r;break;case"R":for(var w=[r,o].concat(u.slice(1)),x=2,E=w.length;x<E;x++)w[x]=+w[x]+r,w[++x]=+w[x]+o;i.pop(),i=i.concat(R(w,h));break;case"O":i.pop(),(w=T(r,o,u[1],u[2])).push(w[0]),i=i.concat(w);break;case"U":i.pop(),i=i.concat(T(r,o,u[1],u[2],u[3])),l=["U"].concat(i[i.length-1].slice(-2));break;case"M":a=+u[1]+r,s=+u[2]+o;default:for(x=1,E=u.length;x<E;x++)l[x]=+u[x]+(x%2?r:o)}else if("R"==n)w=[r,o].concat(u.slice(1)),i.pop(),i=i.concat(R(w,h)),l=["R"].concat(u.slice(-2));else if("O"==n)i.pop(),(w=T(r,o,u[1],u[2])).push(w[0]),i=i.concat(w);else if("U"==n)i.pop(),i=i.concat(T(r,o,u[1],u[2],u[3])),l=["U"].concat(i[i.length-1].slice(-2));else for(var S=0,C=u.length;S<C;S++)l[S]=u[S];if("O"!=(n=n.toUpperCase()))switch(l[0]){case"Z":r=+a,o=+s;break;case"H":r=l[1];break;case"V":o=l[1];break;case"M":a=l[l.length-2],s=l[l.length-1];default:r=l[l.length-2],o=l[l.length-1]}}return i.toString=g,e.abs=b(i),i}function A(t,e,n,i){return[t,e,n,i,n,i]}function M(t,e,n,i,r,o){return[1/3*t+2/3*n,1/3*e+2/3*i,1/3*r+2/3*n,1/3*o+2/3*i,r,o]}function j(t,e,n,r,o,c,l,u,p,d){var f,m,v,y,g=120*s/180,b=s/180*(+o||0),_=[],w=(m=function(t,e,n){return{x:t*a.cos(n)-e*a.sin(n),y:t*a.sin(n)+e*a.cos(n)}},function t(){var e=Array.prototype.slice.call(arguments,0),n=e.join("␀"),r=t.cache=t.cache||{},o=t.count=t.count||[];return r[i](n)?(function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return t.push(t.splice(n,1)[0])}(o,n),y?y(r[n]):r[n]):(o.length>=1e3&&delete r[o.shift()],o.push(n),r[n]=m.apply(v,e),y?y(r[n]):r[n])});if(d)A=d[0],M=d[1],T=d[2],O=d[3];else{t=(f=w(t,e,-b)).x,e=f.y;var x=(t-(u=(f=w(u,p,-b)).x))/2,E=(e-(p=f.y))/2,S=x*x/(n*n)+E*E/(r*r);S>1&&(n*=S=a.sqrt(S),r*=S);var C=n*n,k=r*r,P=(c==l?-1:1)*a.sqrt(h((C*k-C*E*E-k*x*x)/(C*E*E+k*x*x))),T=P*n*E/r+(t+u)/2,O=P*-r*x/n+(e+p)/2,A=a.asin(((e-O)/r).toFixed(9)),M=a.asin(((p-O)/r).toFixed(9));(A=t<T?s-A:A)<0&&(A=2*s+A),(M=u<T?s-M:M)<0&&(M=2*s+M),l&&A>M&&(A-=2*s),!l&&M>A&&(M-=2*s)}var R=M-A;if(h(R)>g){var D=M,N=u,I=p;M=A+g*(l&&M>A?1:-1),_=j(u=T+n*a.cos(M),p=O+r*a.sin(M),n,r,o,0,l,N,I,[M,D,T,O])}R=M-A;var L=a.cos(A),B=a.sin(A),F=a.cos(M),z=a.sin(M),G=a.tan(R/4),V=4/3*n*G,H=4/3*r*G,U=[t,e],W=[t+V*B,e-H*L],$=[u+V*z,p-H*F],q=[u,p];if(W[0]=2*U[0]-W[0],W[1]=2*U[1]-W[1],d)return[W,$,q].concat(_);for(var K=[],Y=0,X=(_=[W,$,q].concat(_).join().split(",")).length;Y<X;Y++)K[Y]=Y%2?w(_[Y-1],_[Y],b).y:w(_[Y],_[Y+1],b).x;return K}function R(t,e){for(var n=[],i=0,r=t.length;r-2*!e>i;i+=2){var o=[{x:+t[i-2],y:+t[i-1]},{x:+t[i],y:+t[i+1]},{x:+t[i+2],y:+t[i+3]},{x:+t[i+4],y:+t[i+5]}];e?i?r-4==i?o[3]={x:+t[0],y:+t[1]}:r-2==i&&(o[2]={x:+t[0],y:+t[1]},o[3]={x:+t[2],y:+t[3]}):o[0]={x:+t[r-2],y:+t[r-1]}:r-4==i?o[3]=o[2]:i||(o[0]={x:+t[i],y:+t[i+1]}),n.push(["C",(-o[0].x+6*o[1].x+o[2].x)/6,(-o[0].y+6*o[1].y+o[2].y)/6,(o[1].x+6*o[2].x-o[3].x)/6,(o[1].y+6*o[2].y-o[3].y)/6,o[2].x,o[2].y])}return n}function D(t,e,n,i,r,o,s,u){for(var p,d,f,m,v,y,g,b,_=[],w=[[],[]],x=0;x<2;++x)if(0==x?(d=6*t-12*n+6*r,p=-3*t+9*n-9*r+3*s,f=3*n-3*t):(d=6*e-12*i+6*o,p=-3*e+9*i-9*o+3*u,f=3*i-3*e),h(p)<1e-12){if(h(d)<1e-12)continue;0<(m=-f/d)&&m<1&&_.push(m)}else g=d*d-4*f*p,b=a.sqrt(g),g<0||(0<(v=(-d+b)/(2*p))&&v<1&&_.push(v),0<(y=(-d-b)/(2*p))&&y<1&&_.push(y));for(var E,S=_.length,C=S;S--;)E=1-(m=_[S]),w[0][S]=E*E*E*t+3*E*E*m*n+3*E*m*m*r+m*m*m*s,w[1][S]=E*E*E*e+3*E*E*m*i+3*E*m*m*o+m*m*m*u;return w[0][C]=t,w[1][C]=e,w[0][C+1]=s,w[1][C+1]=u,w[0].length=w[1].length=C+2,{min:{x:c.apply(0,w[0]),y:c.apply(0,w[1])},max:{x:l.apply(0,w[0]),y:l.apply(0,w[1])}}}function N(t,e){var n=!e&&v(t);if(!e&&n.curve)return b(n.curve);for(var i=O(t),r=e&&O(e),a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},c=function(t,e,n){var i,r;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"].concat(j.apply(0,[e.x,e.y].concat(t.slice(1))));break;case"S":"C"==n||"S"==n?(i=2*e.x-e.bx,r=2*e.y-e.by):(i=e.x,r=e.y),t=["C",i,r].concat(t.slice(1));break;case"T":"Q"==n||"T"==n?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"].concat(M(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"].concat(M(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"].concat(A(e.x,e.y,t[1],t[2]));break;case"H":t=["C"].concat(A(e.x,e.y,t[1],e.y));break;case"V":t=["C"].concat(A(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"].concat(A(e.x,e.y,e.X,e.Y))}return t},u=function(t,e){if(t[e].length>7){t[e].shift();for(var n=t[e];n.length;)p[e]="A",r&&(d[e]="A"),t.splice(e++,0,["C"].concat(n.splice(0,6)));t.splice(e,1),g=l(i.length,r&&r.length||0)}},h=function(t,e,n,o,a){t&&e&&"M"==t[a][0]&&"M"!=e[a][0]&&(e.splice(a,0,["M",o.x,o.y]),n.bx=0,n.by=0,n.x=t[a][1],n.y=t[a][2],g=l(i.length,r&&r.length||0))},p=[],d=[],f="",m="",y=0,g=l(i.length,r&&r.length||0);y<g;y++){i[y]&&(f=i[y][0]),"C"!=f&&(p[y]=f,y&&(m=p[y-1])),i[y]=c(i[y],a,m),"A"!=p[y]&&"C"==f&&(p[y]="C"),u(i,y),r&&(r[y]&&(f=r[y][0]),"C"!=f&&(d[y]=f,y&&(m=d[y-1])),r[y]=c(r[y],s,m),"A"!=d[y]&&"C"==f&&(d[y]="C"),u(r,y)),h(i,r,a,s,y),h(r,i,s,a,y);var _=i[y],w=r&&r[y],x=_.length,E=r&&w.length;a.x=_[x-2],a.y=_[x-1],a.bx=o(_[x-4])||a.x,a.by=o(_[x-3])||a.y,s.bx=r&&(o(w[E-4])||s.x),s.by=r&&(o(w[E-3])||s.y),s.x=r&&w[E-2],s.y=r&&w[E-1]}return r||(n.curve=b(i)),r?[i,r]:i}t.exports=function(t,e,n){t=N(t),e=N(e);for(var i,r,o,a,s,c,l,u,h,p,d=n?0:[],f=0,m=t.length;f<m;f++){var v=t[f];if("M"==v[0])i=s=v[1],r=c=v[2];else{"C"==v[0]?(h=[i,r].concat(v.slice(1)),i=h[6],r=h[7]):(h=[i,r,i,r,s,c,s,c],i=s,r=c);for(var y=0,g=e.length;y<g;y++){var b=e[y];if("M"==b[0])o=l=b[1],a=u=b[2];else{"C"==b[0]?(p=[o,a].concat(b.slice(1)),o=p[6],a=p[7]):(p=[o,a,o,a,l,u,l,u],o=l,a=u);var _=k(h,p,n);if(n)d+=_;else{for(var w=0,x=_.length;w<x;w++)_[w].segment1=f,_[w].segment2=y,_[w].bez1=h,_[w].bez2=p;d=d.concat(_)}}}}}return d}},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(10),s=n(2),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._validateAdd=function(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&o.Util.throw("You may only add groups and shapes to groups.")},e}(a.Container);e.Group=c,c.prototype.nodeType="Group",s._registerNode(c),o.Collection.mapMethods(c)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=i.glob.performance&&i.glob.performance.now?function(){return i.glob.performance.now()}:function(){return(new Date).getTime()},o=function(){function t(e,n){this.id=t.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:r(),frameRate:0},this.func=e,this.setLayers(n)}return t.prototype.setLayers=function(t){var e=[];return e=t?t.length>0?t:[t]:[],this.layers=e,this},t.prototype.getLayers=function(){return this.layers},t.prototype.addLayer=function(t){var e,n=this.layers,i=n.length;for(e=0;e<i;e++)if(n[e]._id===t._id)return!1;return this.layers.push(t),!0},t.prototype.isRunning=function(){var e,n=t.animations,i=n.length;for(e=0;e<i;e++)if(n[e].id===this.id)return!0;return!1},t.prototype.start=function(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=r(),t._addAnimation(this),this},t.prototype.stop=function(){return t._removeAnimation(this),this},t.prototype._updateFrameObject=function(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff},t._addAnimation=function(t){this.animations.push(t),this._handleAnimation()},t._removeAnimation=function(t){var e,n=t.id,i=this.animations,r=i.length;for(e=0;e<r;e++)if(i[e].id===n){this.animations.splice(e,1);break}},t._runFrames=function(){var t,e,n,i,o,a,s,c,l={},u=this.animations;for(i=0;i<u.length;i++)if(e=(t=u[i]).layers,n=t.func,t._updateFrameObject(r()),a=e.length,!n||!1!==n.call(t,t.frame))for(o=0;o<a;o++)void 0!==(s=e[o])._id&&(l[s._id]=s);for(c in l)l.hasOwnProperty(c)&&l[c].draw()},t._animationLoop=function(){var e=t;e.animations.length?(e._runFrames(),requestAnimationFrame(e._animationLoop)):e.animRunning=!1},t._handleAnimation=function(){this.animRunning||(this.animRunning=!0,requestAnimationFrame(this._animationLoop))},t.animations=[],t.animIdCounter=0,t.animRunning=!1,t}();e.Animation=o},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(2),s=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],c=function(){function t(t){this.canvas=t,this._context=t._canvas.getContext("2d"),a.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}return t.prototype.fillShape=function(t){t.getFillEnabled()&&this._fill(t)},t.prototype._fill=function(t){},t.prototype.strokeShape=function(t){t.getStrokeEnabled()&&this._stroke(t)},t.prototype._stroke=function(t){},t.prototype.fillStrokeShape=function(t){t.getFillEnabled()&&this._fill(t),t.getStrokeEnabled()&&this._stroke(t)},t.prototype.getTrace=function(t){var e,n,i,r,a=this.traceArr,s=a.length,c="";for(e=0;e<s;e++)(i=(n=a[e]).method)?(r=n.args,c+=i,t?c+="()":o.Util._isArray(r[0])?c+="(["+r.join(",")+"])":c+="("+r.join(",")+")"):(c+=n.property,t||(c+="="+n.val)),c+=";";return c},t.prototype.clearTrace=function(){this.traceArr=[]},t.prototype._trace=function(t){var e=this.traceArr;e.push(t),e.length>=100&&e.shift()},t.prototype.reset=function(){var t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)},t.prototype.getCanvas=function(){return this.canvas},t.prototype.clear=function(t){var e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)},t.prototype._applyLineCap=function(t){var e=t.getLineCap();e&&this.setAttr("lineCap",e)},t.prototype._applyOpacity=function(t){var e=t.getAbsoluteOpacity();1!==e&&this.setAttr("globalAlpha",e)},t.prototype._applyLineJoin=function(t){var e=t.getLineJoin();e&&this.setAttr("lineJoin",e)},t.prototype.setAttr=function(t,e){this._context[t]=e},t.prototype.arc=function(t,e,n,i,r,o){this._context.arc(t,e,n,i,r,o)},t.prototype.arcTo=function(t,e,n,i,r){this._context.arcTo(t,e,n,i,r)},t.prototype.beginPath=function(){this._context.beginPath()},t.prototype.bezierCurveTo=function(t,e,n,i,r,o){this._context.bezierCurveTo(t,e,n,i,r,o)},t.prototype.clearRect=function(t,e,n,i){this._context.clearRect(t,e,n,i)},t.prototype.clip=function(){this._context.clip()},t.prototype.closePath=function(){this._context.closePath()},t.prototype.createImageData=function(t,e){var n=arguments;return 2===n.length?this._context.createImageData(t,e):1===n.length?this._context.createImageData(t):void 0},t.prototype.createLinearGradient=function(t,e,n,i){return this._context.createLinearGradient(t,e,n,i)},t.prototype.createPattern=function(t,e){return this._context.createPattern(t,e)},t.prototype.createRadialGradient=function(t,e,n,i,r,o){return this._context.createRadialGradient(t,e,n,i,r,o)},t.prototype.drawImage=function(t,e,n,i,r,o,a,s,c){var l=arguments,u=this._context;3===l.length?u.drawImage(t,e,n):5===l.length?u.drawImage(t,e,n,i,r):9===l.length&&u.drawImage(t,e,n,i,r,o,a,s,c)},t.prototype.ellipse=function(t,e,n,i,r,o,a,s){this._context.ellipse(t,e,n,i,r,o,a,s)},t.prototype.isPointInPath=function(t,e){return this._context.isPointInPath(t,e)},t.prototype.fill=function(){this._context.fill()},t.prototype.fillRect=function(t,e,n,i){this._context.fillRect(t,e,n,i)},t.prototype.strokeRect=function(t,e,n,i){this._context.strokeRect(t,e,n,i)},t.prototype.fillText=function(t,e,n){this._context.fillText(t,e,n)},t.prototype.measureText=function(t){return this._context.measureText(t)},t.prototype.getImageData=function(t,e,n,i){return this._context.getImageData(t,e,n,i)},t.prototype.lineTo=function(t,e){this._context.lineTo(t,e)},t.prototype.moveTo=function(t,e){this._context.moveTo(t,e)},t.prototype.rect=function(t,e,n,i){this._context.rect(t,e,n,i)},t.prototype.putImageData=function(t,e,n){this._context.putImageData(t,e,n)},t.prototype.quadraticCurveTo=function(t,e,n,i){this._context.quadraticCurveTo(t,e,n,i)},t.prototype.restore=function(){this._context.restore()},t.prototype.rotate=function(t){this._context.rotate(t)},t.prototype.save=function(){this._context.save()},t.prototype.scale=function(t,e){this._context.scale(t,e)},t.prototype.setLineDash=function(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)},t.prototype.getLineDash=function(){return this._context.getLineDash()},t.prototype.setTransform=function(t,e,n,i,r,o){this._context.setTransform(t,e,n,i,r,o)},t.prototype.stroke=function(){this._context.stroke()},t.prototype.strokeText=function(t,e,n,i){this._context.strokeText(t,e,n,i)},t.prototype.transform=function(t,e,n,i,r,o){this._context.transform(t,e,n,i,r,o)},t.prototype.translate=function(t,e){this._context.translate(t,e)},t.prototype._enableTrace=function(){var t,e,n=this,i=s.length,r=o.Util._simplifyArray,a=this.setAttr,c=function(t){var i,o=n[t];n[t]=function(){return e=r(Array.prototype.slice.call(arguments,0)),i=o.apply(n,arguments),n._trace({method:t,args:e}),i}};for(t=0;t<i;t++)c(s[t]);n.setAttr=function(){a.apply(n,arguments);var t=arguments[0],e=arguments[1];"shadowOffsetX"!==t&&"shadowOffsetY"!==t&&"shadowBlur"!==t||(e/=this.canvas.getPixelRatio()),n._trace({property:t,val:e})}},t.prototype._applyGlobalCompositeOperation=function(t){var e=t.getGlobalCompositeOperation();"source-over"!==e&&this.setAttr("globalCompositeOperation",e)},t}();e.Context=c,["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"].forEach((function(t){Object.defineProperty(c.prototype,t,{get:function(){return this._context[t]},set:function(e){this._context[t]=e}})}));var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._fillColor=function(t){var e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)},e.prototype._fillPattern=function(t){var e=t.getFillPatternX(),n=t.getFillPatternY(),i=a.Konva.getAngle(t.getFillPatternRotation()),r=t.getFillPatternOffsetX(),o=t.getFillPatternOffsetY(),s=t.getFillPatternScaleX(),c=t.getFillPatternScaleY();(e||n)&&this.translate(e||0,n||0),i&&this.rotate(i),(s||c)&&this.scale(s,c),(r||o)&&this.translate(-1*r,-1*o),this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)},e.prototype._fillLinearGradient=function(t){var e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))},e.prototype._fillRadialGradient=function(t){var e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))},e.prototype._fill=function(t){var e=t.fill(),n=t.getFillPriority();if(e&&"color"===n)this._fillColor(t);else{var i=t.getFillPatternImage();if(i&&"pattern"===n)this._fillPattern(t);else{var r=t.getFillLinearGradientColorStops();if(r&&"linear-gradient"===n)this._fillLinearGradient(t);else{var o=t.getFillRadialGradientColorStops();o&&"radial-gradient"===n?this._fillRadialGradient(t):e?this._fillColor(t):i?this._fillPattern(t):r?this._fillLinearGradient(t):o&&this._fillRadialGradient(t)}}}},e.prototype._strokeLinearGradient=function(t){var e=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),i=t.getStrokeLinearGradientColorStops(),r=this.createLinearGradient(e.x,e.y,n.x,n.y);if(i){for(var o=0;o<i.length;o+=2)r.addColorStop(i[o],i[o+1]);this.setAttr("strokeStyle",r)}},e.prototype._stroke=function(t){var e=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();var i=this.getCanvas().getPixelRatio();this.setTransform(i,0,0,i,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}},e.prototype._applyShadow=function(t){var e=o.Util,n=e.get(t.getShadowRGBA(),"black"),i=e.get(t.getShadowBlur(),5),r=e.get(t.getShadowOffset(),{x:0,y:0}),a=t.getAbsoluteScale(),s=this.canvas.getPixelRatio(),c=a.x*s,l=a.y*s;this.setAttr("shadowColor",n),this.setAttr("shadowBlur",i*Math.min(Math.abs(c),Math.abs(l))),this.setAttr("shadowOffsetX",r.x*c),this.setAttr("shadowOffsetY",r.y*l)},e}(c);e.SceneContext=l;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._fill=function(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()},e.prototype._stroke=function(t){if(t.hasStroke()&&t.hitStrokeWidth()){var e=t.getStrokeScaleEnabled();if(!e){this.save();var n=this.getCanvas().getPixelRatio();this.setTransform(n,0,0,n,0,0)}this._applyLineCap(t);var i=t.hitStrokeWidth(),r="auto"===i?t.strokeWidth():i;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}},e}(c);e.HitContext=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=new Map,o=void 0!==i.Konva._global.PointerEvent;function a(t){return{evt:t,pointerId:t.pointerId}}function s(t,e){var n=r.get(t);if(n){var i=n.getStage();i&&i.content,r.delete(t),o&&n._fire("lostpointercapture",a(new PointerEvent("lostpointercapture")))}}e.getCapturedShape=function(t){return r.get(t)},e.createEvent=a,e.hasPointerCapture=function(t,e){return r.get(t)===e},e.setPointerCapture=function(t,e){s(t),e.getStage()&&(r.set(t,e),o&&e._fire("gotpointercapture",a(new PointerEvent("gotpointercapture"))))},e.releaseCapture=s},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(10),s=n(5),c=n(1),l=n(11),u=function(t){function e(e){var n=t.call(this,e)||this;return n.canvas=new l.SceneCanvas,n._waitingForDraw=!1,n.on("visibleChange",n._checkVisibility),n._checkVisibility(),n.on("imageSmoothingEnabledChange",n._checkSmooth),n._checkSmooth(),n}return r(e,t),e.prototype.createPNGStream=function(){return this.canvas._canvas.createPNGStream()},e.prototype.getCanvas=function(){return this.canvas},e.prototype.getHitCanvas=function(){return this.hitCanvas},e.prototype.getContext=function(){return this.getCanvas().getContext()},e.prototype.clear=function(t){return this.getContext().clear(t),this},e.prototype.setZIndex=function(e){t.prototype.setZIndex.call(this,e);var n=this.getStage();return n&&(n.content.removeChild(this.getCanvas()._canvas),e<n.getChildren().length-1?n.content.insertBefore(this.getCanvas()._canvas,n.getChildren()[e+1].getCanvas()._canvas):n.content.appendChild(this.getCanvas()._canvas)),this},e.prototype.moveToTop=function(){s.Node.prototype.moveToTop.call(this);var t=this.getStage();return t&&(t.content.removeChild(this.getCanvas()._canvas),t.content.appendChild(this.getCanvas()._canvas)),!0},e.prototype.moveUp=function(){if(!s.Node.prototype.moveUp.call(this))return!1;var t=this.getStage();return!!t&&(t.content.removeChild(this.getCanvas()._canvas),this.index<t.getChildren().length-1?t.content.insertBefore(this.getCanvas()._canvas,t.getChildren()[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getCanvas()._canvas),!0)},e.prototype.moveDown=function(){if(s.Node.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.getChildren();t.content.removeChild(this.getCanvas()._canvas),t.content.insertBefore(this.getCanvas()._canvas,e[this.index+1].getCanvas()._canvas)}return!0}return!1},e.prototype.moveToBottom=function(){if(s.Node.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.getChildren();t.content.removeChild(this.getCanvas()._canvas),t.content.insertBefore(this.getCanvas()._canvas,e[1].getCanvas()._canvas)}return!0}return!1},e.prototype.getLayer=function(){return this},e.prototype.hitGraphEnabled=function(){return!0},e.prototype.remove=function(){var t=this.getCanvas()._canvas;return s.Node.prototype.remove.call(this),t&&t.parentNode&&o.Util._isInDocument(t)&&t.parentNode.removeChild(t),this},e.prototype.getStage=function(){return this.parent},e.prototype.setSize=function(t){var e=t.width,n=t.height;return this.canvas.setSize(e,n),this},e.prototype._toKonvaCanvas=function(t){return(t=t||{}).width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=void 0!==t.x?t.x:this.x(),t.y=void 0!==t.y?t.y:this.y(),s.Node.prototype._toKonvaCanvas.call(this,t)},e.prototype._checkVisibility=function(){var t=this.visible();this.canvas._canvas.style.display=t?"block":"none"},e.prototype._checkSmooth=function(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()},e.prototype.getWidth=function(){if(this.parent)return this.parent.width()},e.prototype.setWidth=function(){o.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')},e.prototype.getHeight=function(){if(this.parent)return this.parent.height()},e.prototype.setHeight=function(){o.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')},e.prototype.getIntersection=function(t,e){return null},e.prototype.batchDraw=function(){var t=this;return this._waitingForDraw||(this._waitingForDraw=!0,o.Util.requestAnimFrame((function(){t.draw(),t._waitingForDraw=!1}))),this},e.prototype._applyTransform=function(t,e,n){var i=t.getAbsoluteTransform(n).getMatrix();e.transform(i[0],i[1],i[2],i[3],i[4],i[5])},e}(a.Container);e.BaseLayer=u,u.prototype.nodeType="BaseLayer",c.Factory.addGetterSetter(u,"imageSmoothingEnabled",!0),c.Factory.addGetterSetter(u,"clearBeforeDraw",!0),o.Collection.mapMethods(u)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(6),c=n(3),l=n(2),u=function(t){function e(e){var n=t.call(this,e)||this;return n.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",(function(){this._clearCache("tensionPoints")})),n}return r(e,t),e.prototype._sceneFunc=function(t){var e,n,i,r=this.points(),o=r.length,a=this.tension(),s=this.closed(),c=this.bezier();if(o){if(t.beginPath(),t.moveTo(r[0],r[1]),0!==a&&o>4){for(n=(e=this.getTensionPoints()).length,i=s?0:4,s||t.quadraticCurveTo(e[0],e[1],e[2],e[3]);i<n-2;)t.bezierCurveTo(e[i++],e[i++],e[i++],e[i++],e[i++],e[i++]);s||t.quadraticCurveTo(e[n-2],e[n-1],r[o-2],r[o-1])}else if(c)for(i=2;i<o;)t.bezierCurveTo(r[i++],r[i++],r[i++],r[i++],r[i++],r[i++]);else for(i=2;i<o;i+=2)t.lineTo(r[i],r[i+1]);s?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}},e.prototype.getTensionPoints=function(){return this._getCache("tensionPoints",this._getTensionPoints)},e.prototype._getTensionPoints=function(){return this.closed()?this._getTensionPointsClosed():o.Util._expandPoints(this.points(),this.tension())},e.prototype._getTensionPointsClosed=function(){var t=this.points(),e=t.length,n=this.tension(),i=o.Util._getControlPoints(t[e-2],t[e-1],t[0],t[1],t[2],t[3],n),r=o.Util._getControlPoints(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],n),a=o.Util._expandPoints(t,n);return[i[2],i[3]].concat(a).concat([r[0],r[1],t[e-2],t[e-1],r[2],r[3],i[0],i[1],t[0],t[1]])},e.prototype.getWidth=function(){return this.getSelfRect().width},e.prototype.getHeight=function(){return this.getSelfRect().height},e.prototype.getSelfRect=function(){for(var t,e,n,i=(t=0!==this.tension()?this._getTensionPoints():this.points())[0],r=t[0],o=t[1],a=t[1],s=0;s<t.length/2;s++)e=t[2*s],n=t[2*s+1],i=Math.min(i,e),r=Math.max(r,e),o=Math.min(o,n),a=Math.max(a,n);return{x:Math.round(i),y:Math.round(o),width:Math.round(r-i),height:Math.round(a-o)}},e}(s.Shape);e.Line=u,u.prototype.className="Line",u.prototype._attrsAffectingSize=["points","bezier","tension"],l._registerNode(u),a.Factory.addGetterSetter(u,"closed",!1),a.Factory.addGetterSetter(u,"bezier",!1),a.Factory.addGetterSetter(u,"tension",0,c.getNumberValidator()),a.Factory.addGetterSetter(u,"points",[],c.getNumberArrayValidator()),o.Collection.mapMethods(u)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(6),c=n(2),l=function(t){function e(n){var i=t.call(this,n)||this;i.dataArray=[],i.pathLength=0,i.dataArray=e.parsePathData(i.data()),i.pathLength=0;for(var r=0;r<i.dataArray.length;++r)i.pathLength+=i.dataArray[r].pathLength;return i.on("dataChange.konva",(function(){this.dataArray=e.parsePathData(this.data()),this.pathLength=0;for(var t=0;t<this.dataArray.length;++t)this.pathLength+=this.dataArray[t].pathLength})),i}return r(e,t),e.prototype._sceneFunc=function(t){var e=this.dataArray;t.beginPath();for(var n=0;n<e.length;n++){var i=e[n].command,r=e[n].points;switch(i){case"L":t.lineTo(r[0],r[1]);break;case"M":t.moveTo(r[0],r[1]);break;case"C":t.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);break;case"Q":t.quadraticCurveTo(r[0],r[1],r[2],r[3]);break;case"A":var o=r[0],a=r[1],s=r[2],c=r[3],l=r[4],u=r[5],h=r[6],p=r[7],d=s>c?s:c,f=s>c?1:s/c,m=s>c?c/s:1;t.translate(o,a),t.rotate(h),t.scale(f,m),t.arc(0,0,d,l,l+u,1-p),t.scale(1/f,1/m),t.rotate(-h),t.translate(-o,-a);break;case"z":t.closePath()}}t.fillStrokeShape(this)},e.prototype.getSelfRect=function(){var t=[];this.dataArray.forEach((function(e){t=t.concat(e.points)}));for(var e,n,i=t[0],r=t[0],o=t[1],a=t[1],s=0;s<t.length/2;s++)e=t[2*s],n=t[2*s+1],isNaN(e)||(i=Math.min(i,e),r=Math.max(r,e)),isNaN(n)||(o=Math.min(o,n),a=Math.max(a,n));return{x:Math.round(i),y:Math.round(o),width:Math.round(r-i),height:Math.round(a-o)}},e.prototype.getLength=function(){return this.pathLength},e.prototype.getPointAtLength=function(t){var n,i=0,r=this.dataArray.length;if(!r)return null;for(;i<r&&t>this.dataArray[i].pathLength;)t-=this.dataArray[i].pathLength,++i;if(i===r)return{x:(n=this.dataArray[i-1].points.slice(-2))[0],y:n[1]};if(t<.01)return{x:(n=this.dataArray[i].points.slice(0,2))[0],y:n[1]};var o=this.dataArray[i],a=o.points;switch(o.command){case"L":return e.getPointOnLine(t,o.start.x,o.start.y,a[0],a[1]);case"C":return e.getPointOnCubicBezier(t/o.pathLength,o.start.x,o.start.y,a[0],a[1],a[2],a[3],a[4],a[5]);case"Q":return e.getPointOnQuadraticBezier(t/o.pathLength,o.start.x,o.start.y,a[0],a[1],a[2],a[3]);case"A":var s=a[0],c=a[1],l=a[2],u=a[3],h=a[4],p=a[5],d=a[6];return h+=p*t/o.pathLength,e.getPointOnEllipticalArc(s,c,l,u,h,d)}return null},e.getLineLength=function(t,e,n,i){return Math.sqrt((n-t)*(n-t)+(i-e)*(i-e))},e.getPointOnLine=function(t,e,n,i,r,o,a){void 0===o&&(o=e),void 0===a&&(a=n);var s=(r-n)/(i-e+1e-8),c=Math.sqrt(t*t/(1+s*s));i<e&&(c*=-1);var l,u=s*c;if(i===e)l={x:o,y:a+u};else if((a-n)/(o-e+1e-8)===s)l={x:o+c,y:a+u};else{var h,p,d=this.getLineLength(e,n,i,r);if(d<1e-8)return;var f=(o-e)*(i-e)+(a-n)*(r-n);h=e+(f/=d*d)*(i-e),p=n+f*(r-n);var m=this.getLineLength(o,a,h,p),v=Math.sqrt(t*t-m*m);c=Math.sqrt(v*v/(1+s*s)),i<e&&(c*=-1),l={x:h+c,y:p+(u=s*c)}}return l},e.getPointOnCubicBezier=function(t,e,n,i,r,o,a,s,c){function l(t){return t*t*t}function u(t){return 3*t*t*(1-t)}function h(t){return 3*t*(1-t)*(1-t)}function p(t){return(1-t)*(1-t)*(1-t)}return{x:s*l(t)+o*u(t)+i*h(t)+e*p(t),y:c*l(t)+a*u(t)+r*h(t)+n*p(t)}},e.getPointOnQuadraticBezier=function(t,e,n,i,r,o,a){function s(t){return t*t}function c(t){return 2*t*(1-t)}function l(t){return(1-t)*(1-t)}return{x:o*s(t)+i*c(t)+e*l(t),y:a*s(t)+r*c(t)+n*l(t)}},e.getPointOnEllipticalArc=function(t,e,n,i,r,o){var a=Math.cos(o),s=Math.sin(o),c=n*Math.cos(r),l=i*Math.sin(r);return{x:t+(c*a-l*s),y:e+(c*s+l*a)}},e.parsePathData=function(t){if(!t)return[];var e=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(var i=0;i<n.length;i++)e=e.replace(new RegExp(n[i],"g"),"|"+n[i]);var r,o=e.split("|"),a=[],s=[],c=0,l=0,u=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;for(i=1;i<o.length;i++){var h=o[i],p=h.charAt(0);for(h=h.slice(1),s.length=0;r=u.exec(h);)s.push(r[0]);for(var d=[],f=0,m=s.length;f<m;f++){var v=parseFloat(s[f]);isNaN(v)?d.push(0):d.push(v)}for(;d.length>0&&!isNaN(d[0]);){var y,g,b,_,w,x,E,S,C,k,P=null,T=[],O=c,A=l;switch(p){case"l":c+=d.shift(),l+=d.shift(),P="L",T.push(c,l);break;case"L":c=d.shift(),l=d.shift(),T.push(c,l);break;case"m":var M=d.shift(),j=d.shift();if(c+=M,l+=j,P="M",a.length>2&&"z"===a[a.length-1].command)for(var R=a.length-2;R>=0;R--)if("M"===a[R].command){c=a[R].points[0]+M,l=a[R].points[1]+j;break}T.push(c,l),p="l";break;case"M":c=d.shift(),l=d.shift(),P="M",T.push(c,l),p="L";break;case"h":c+=d.shift(),P="L",T.push(c,l);break;case"H":c=d.shift(),P="L",T.push(c,l);break;case"v":l+=d.shift(),P="L",T.push(c,l);break;case"V":l=d.shift(),P="L",T.push(c,l);break;case"C":T.push(d.shift(),d.shift(),d.shift(),d.shift()),c=d.shift(),l=d.shift(),T.push(c,l);break;case"c":T.push(c+d.shift(),l+d.shift(),c+d.shift(),l+d.shift()),c+=d.shift(),l+=d.shift(),P="C",T.push(c,l);break;case"S":g=c,b=l,"C"===(y=a[a.length-1]).command&&(g=c+(c-y.points[2]),b=l+(l-y.points[3])),T.push(g,b,d.shift(),d.shift()),c=d.shift(),l=d.shift(),P="C",T.push(c,l);break;case"s":g=c,b=l,"C"===(y=a[a.length-1]).command&&(g=c+(c-y.points[2]),b=l+(l-y.points[3])),T.push(g,b,c+d.shift(),l+d.shift()),c+=d.shift(),l+=d.shift(),P="C",T.push(c,l);break;case"Q":T.push(d.shift(),d.shift()),c=d.shift(),l=d.shift(),T.push(c,l);break;case"q":T.push(c+d.shift(),l+d.shift()),c+=d.shift(),l+=d.shift(),P="Q",T.push(c,l);break;case"T":g=c,b=l,"Q"===(y=a[a.length-1]).command&&(g=c+(c-y.points[0]),b=l+(l-y.points[1])),c=d.shift(),l=d.shift(),P="Q",T.push(g,b,c,l);break;case"t":g=c,b=l,"Q"===(y=a[a.length-1]).command&&(g=c+(c-y.points[0]),b=l+(l-y.points[1])),c+=d.shift(),l+=d.shift(),P="Q",T.push(g,b,c,l);break;case"A":_=d.shift(),w=d.shift(),x=d.shift(),E=d.shift(),S=d.shift(),C=c,k=l,c=d.shift(),l=d.shift(),P="A",T=this.convertEndpointToCenterParameterization(C,k,c,l,E,S,_,w,x);break;case"a":_=d.shift(),w=d.shift(),x=d.shift(),E=d.shift(),S=d.shift(),C=c,k=l,c+=d.shift(),l+=d.shift(),P="A",T=this.convertEndpointToCenterParameterization(C,k,c,l,E,S,_,w,x)}a.push({command:P||p,points:T,start:{x:O,y:A},pathLength:this.calcLength(O,A,P||p,T)})}"z"!==p&&"Z"!==p||a.push({command:"z",points:[],start:void 0,pathLength:0})}return a},e.calcLength=function(t,n,i,r){var o,a,s,c,l=e;switch(i){case"L":return l.getLineLength(t,n,r[0],r[1]);case"C":for(o=0,a=l.getPointOnCubicBezier(0,t,n,r[0],r[1],r[2],r[3],r[4],r[5]),c=.01;c<=1;c+=.01)s=l.getPointOnCubicBezier(c,t,n,r[0],r[1],r[2],r[3],r[4],r[5]),o+=l.getLineLength(a.x,a.y,s.x,s.y),a=s;return o;case"Q":for(o=0,a=l.getPointOnQuadraticBezier(0,t,n,r[0],r[1],r[2],r[3]),c=.01;c<=1;c+=.01)s=l.getPointOnQuadraticBezier(c,t,n,r[0],r[1],r[2],r[3]),o+=l.getLineLength(a.x,a.y,s.x,s.y),a=s;return o;case"A":o=0;var u=r[4],h=r[5],p=r[4]+h,d=Math.PI/180;if(Math.abs(u-p)<d&&(d=Math.abs(u-p)),a=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],u,0),h<0)for(c=u-d;c>p;c-=d)s=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],c,0),o+=l.getLineLength(a.x,a.y,s.x,s.y),a=s;else for(c=u+d;c<p;c+=d)s=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],c,0),o+=l.getLineLength(a.x,a.y,s.x,s.y),a=s;return s=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],p,0),o+=l.getLineLength(a.x,a.y,s.x,s.y)}return 0},e.convertEndpointToCenterParameterization=function(t,e,n,i,r,o,a,s,c){var l=c*(Math.PI/180),u=Math.cos(l)*(t-n)/2+Math.sin(l)*(e-i)/2,h=-1*Math.sin(l)*(t-n)/2+Math.cos(l)*(e-i)/2,p=u*u/(a*a)+h*h/(s*s);p>1&&(a*=Math.sqrt(p),s*=Math.sqrt(p));var d=Math.sqrt((a*a*(s*s)-a*a*(h*h)-s*s*(u*u))/(a*a*(h*h)+s*s*(u*u)));r===o&&(d*=-1),isNaN(d)&&(d=0);var f=d*a*h/s,m=d*-s*u/a,v=(t+n)/2+Math.cos(l)*f-Math.sin(l)*m,y=(e+i)/2+Math.sin(l)*f+Math.cos(l)*m,g=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},b=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(g(t)*g(e))},_=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(b(t,e))},w=_([1,0],[(u-f)/a,(h-m)/s]),x=[(u-f)/a,(h-m)/s],E=[(-1*u-f)/a,(-1*h-m)/s],S=_(x,E);return b(x,E)<=-1&&(S=Math.PI),b(x,E)>=1&&(S=0),0===o&&S>0&&(S-=2*Math.PI),1===o&&S<0&&(S+=2*Math.PI),[v,y,a,s,w,S,l,o]},e}(s.Shape);e.Path=l,l.prototype.className="Path",l.prototype._attrsAffectingSize=["data"],c._registerNode(l),a.Factory.addGetterSetter(l,"data"),o.Collection.mapMethods(l)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(6),c=n(2),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){var e=this.cornerRadius(),n=this.width(),i=this.height();if(t.beginPath(),e){var r=0,o=0,a=0,s=0;"number"==typeof e?r=o=a=s=Math.min(e,n/2,i/2):(r=Math.min(e[0],n/2,i/2),o=Math.min(e[1],n/2,i/2),s=Math.min(e[2],n/2,i/2),a=Math.min(e[3],n/2,i/2)),t.moveTo(r,0),t.lineTo(n-o,0),t.arc(n-o,o,o,3*Math.PI/2,0,!1),t.lineTo(n,i-s),t.arc(n-s,i-s,s,0,Math.PI/2,!1),t.lineTo(a,i),t.arc(a,i-a,a,Math.PI/2,Math.PI,!1),t.lineTo(0,r),t.arc(r,r,r,Math.PI,3*Math.PI/2,!1)}else t.rect(0,0,n,i);t.closePath(),t.fillStrokeShape(this)},e}(s.Shape);e.Rect=l,l.prototype.className="Rect",c._registerNode(l),a.Factory.addGetterSetter(l,"cornerRadius",0),o.Collection.mapMethods(l)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o,a=n(4),s=n(1),c=n(6),l=n(2),u=n(3),h=n(2),p="Change.konva",d="2d",f=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],m=f.length;function v(){return o||(o=a.Util.createCanvasElement().getContext(d))}var y=function(t){function e(e){var n=t.call(this,function(t){return(t=t||{}).fillLinearGradientColorStops||t.fillRadialGradientColorStops||t.fillPatternImage||(t.fill=t.fill||"black"),t}(e))||this;n._partialTextX=0,n._partialTextY=0;for(var i=0;i<m;i++)n.on(f[i]+p,n._setTextData);return n._setTextData(),n}return r(e,t),e.prototype._sceneFunc=function(t){var e,n=this.padding(),i=this.fontSize(),r=this.lineHeight()*i,o=this.textArr,a=o.length,s=this.verticalAlign(),c=0,l=this.align(),u=this.getWidth(),h=this.letterSpacing(),p=this.fill(),d=this.textDecoration(),f=-1!==d.indexOf("underline"),m=-1!==d.indexOf("line-through"),v=0,y=(v=r/2,0),g=0;for(t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline","middle"),t.setAttr("textAlign","left"),"middle"===s?c=(this.getHeight()-a*r-2*n)/2:"bottom"===s&&(c=this.getHeight()-a*r-2*n),t.translate(n,c+n),e=0;e<a;e++){y=0,g=0;var b,_,w,x=o[e],E=x.text,S=x.width,C=e!==a-1;if(t.save(),"right"===l?y+=u-S-2*n:"center"===l&&(y+=(u-S-2*n)/2),f&&(t.save(),t.beginPath(),t.moveTo(y,v+g+Math.round(i/2)),_=0===(b=E.split(" ").length-1),w="justify"===l&&C&&!_?u-2*n:S,t.lineTo(y+Math.round(w),v+g+Math.round(i/2)),t.lineWidth=i/15,t.strokeStyle=p,t.stroke(),t.restore()),m&&(t.save(),t.beginPath(),t.moveTo(y,v+g),_=0===(b=E.split(" ").length-1),w="justify"===l&&C&&!_?u-2*n:S,t.lineTo(y+Math.round(w),v+g),t.lineWidth=i/15,t.strokeStyle=p,t.stroke(),t.restore()),0!==h||"justify"===l){b=E.split(" ").length-1;for(var k=0;k<E.length;k++){var P=E[k];" "===P&&e!==a-1&&"justify"===l&&(y+=Math.floor((u-2*n-S)/b)),this._partialTextX=y,this._partialTextY=v+g,this._partialText=P,t.fillStrokeShape(this),y+=Math.round(this.measureSize(P).width)+h}}else this._partialTextX=y,this._partialTextY=v+g,this._partialText=E,t.fillStrokeShape(this);t.restore(),a>1&&(v+=r)}},e.prototype._hitFunc=function(t){var e=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)},e.prototype.setText=function(t){var e=a.Util._isString(t)?t:(t||"").toString();return this._setAttr("text",e),this},e.prototype.getWidth=function(){return"auto"===this.attrs.width||void 0===this.attrs.width?this.getTextWidth()+2*this.padding():this.attrs.width},e.prototype.getHeight=function(){return"auto"===this.attrs.height||void 0===this.attrs.height?this.fontSize()*this.textArr.length*this.lineHeight()+2*this.padding():this.attrs.height},e.prototype.getTextWidth=function(){return this.textWidth},e.prototype.getTextHeight=function(){return a.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight},e.prototype.measureSize=function(t){var e,n=v(),i=this.fontSize();return n.save(),n.font=this._getContextFont(),e=n.measureText(t),n.restore(),{width:e.width,height:i}},e.prototype._getContextFont=function(){return l.Konva.UA.isIE?this.fontStyle()+" "+this.fontSize()+"px "+this.fontFamily():this.fontStyle()+" "+this.fontVariant()+" "+this.fontSize()+"px "+this.fontFamily()},e.prototype._addTextLine=function(t){"justify"===this.align()&&(t=t.trim());var e=this._getTextWidth(t);return this.textArr.push({text:t,width:e})},e.prototype._getTextWidth=function(t){var e=this.letterSpacing(),n=t.length;return v().measureText(t).width+(n?e*(n-1):0)},e.prototype._setTextData=function(){var t=this.text().split("\n"),e=+this.fontSize(),n=0,i=this.lineHeight()*e,r=this.attrs.width,o=this.attrs.height,a="auto"!==r&&void 0!==r,s="auto"!==o&&void 0!==o,c=this.padding(),l=r-2*c,u=o-2*c,h=0,p=this.wrap(),d="none"!==p,f="char"!==p&&d,m=this.ellipsis()&&!d;this.textArr=[],v().font=this._getContextFont();for(var y=m?this._getTextWidth("…"):0,g=0,b=t.length;g<b;++g){var _=t[g],w=this._getTextWidth(_);if(a&&w>l)for(;_.length>0;){for(var x=0,E=_.length,S="",C=0;x<E;){var k=x+E>>>1,P=_.slice(0,k+1),T=this._getTextWidth(P)+y;T<=l?(x=k+1,S=P+(m?"…":""),C=T):E=k}if(!S)break;if(f){var O,A=_[S.length];(O=(" "===A||"-"===A)&&C<=l?S.length:Math.max(S.lastIndexOf(" "),S.lastIndexOf("-"))+1)>0&&(x=O,S=S.slice(0,x),C=this._getTextWidth(S))}if(S=S.trimRight(),this._addTextLine(S),n=Math.max(n,C),h+=i,!d||s&&h+i>u)break;if((_=(_=_.slice(x)).trimLeft()).length>0&&(w=this._getTextWidth(_))<=l){this._addTextLine(_),h+=i,n=Math.max(n,w);break}}else this._addTextLine(_),h+=i,n=Math.max(n,w);if(s&&h+i>u)break}this.textHeight=e,this.textWidth=n},e.prototype.getStrokeScaleEnabled=function(){return!0},e}(c.Shape);e.Text=y,y.prototype._fillFunc=function(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)},y.prototype._strokeFunc=function(t){t.strokeText(this._partialText,this._partialTextX,this._partialTextY)},y.prototype.className="Text",y.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight"],h._registerNode(y),s.Factory.overWriteSetter(y,"width",u.getNumberOrAutoValidator()),s.Factory.overWriteSetter(y,"height",u.getNumberOrAutoValidator()),s.Factory.addGetterSetter(y,"fontFamily","Arial"),s.Factory.addGetterSetter(y,"fontSize",12,u.getNumberValidator()),s.Factory.addGetterSetter(y,"fontStyle","normal"),s.Factory.addGetterSetter(y,"fontVariant","normal"),s.Factory.addGetterSetter(y,"padding",0,u.getNumberValidator()),s.Factory.addGetterSetter(y,"align","left"),s.Factory.addGetterSetter(y,"verticalAlign","top"),s.Factory.addGetterSetter(y,"lineHeight",1,u.getNumberValidator()),s.Factory.addGetterSetter(y,"wrap","word"),s.Factory.addGetterSetter(y,"ellipsis",!1),s.Factory.addGetterSetter(y,"letterSpacing",0,u.getNumberValidator()),s.Factory.addGetterSetter(y,"text","",u.getStringValidator()),s.Factory.addGetterSetter(y,"textDecoration",""),a.Collection.mapMethods(y)},function(t,e,n){"use strict";t.exports.extend=function(t,e,n,i){var r=n.inverse;return Object.defineProperty(t,"remove",{value:function(t){var n=this.indexOf(t);return-1!==n&&(this.splice(n,1),e.unset(t,r,i)),t}}),Object.defineProperty(t,"contains",{value:function(t){return-1!==this.indexOf(t)}}),Object.defineProperty(t,"add",{value:function(t,n){var o=this.indexOf(t);if(void 0===n){if(-1!==o)return;n=this.length}-1!==o&&this.splice(o,1),this.splice(n,0,t),-1===o&&e.set(t,r,i)}}),Object.defineProperty(t,"__refs_collection",{value:!0}),t},t.exports.isExtended=function(t){return!0===t.__refs_collection}},function(t,e,n){var i;"undefined"!=typeof self&&self,i=function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./src/main/js/index.ts")}({"./node_modules/css-loader/lib/css-base.js":
/*!*************************************************!*\
  !*** ./node_modules/css-loader/lib/css-base.js ***!
  \*************************************************/
/*! no static exports found */function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n,i=t[1]||"",r=t[3];if(!r)return i;if(e&&"function"==typeof btoa){var o=(n=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),a=r.sources.map((function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"}));return[i].concat(a).concat([o]).join("\n")}return[i].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n})).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(i[o]=!0)}for(r=0;r<t.length;r++){var a=t[r];"number"==typeof a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},"./node_modules/process/browser.js":
/*!*****************************************!*\
  !*** ./node_modules/process/browser.js ***!
  \*****************************************/
/*! no static exports found */function(t,e){var n,i,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var c,l=[],u=!1,h=-1;function p(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&d())}function d(){if(!u){var t=s(p);u=!0;for(var e=l.length;e;){for(c=l,l=[];++h<e;)c&&c[h].run();h=-1,e=l.length}c=null,u=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new f(t,e)),1!==l.length||u||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},"./src/main/js/api/button.ts":
/*!***********************************!*\
  !*** ./src/main/js/api/button.ts ***!
  \***********************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.controller=t}return t.prototype.dispose=function(){this.controller.dispose()},t.prototype.on=function(t,e){this.controller.button.emitter.on(t,e)},t}();e.default=i},"./src/main/js/api/folder.ts":
/*!***********************************!*\
  !*** ./src/main/js/api/folder.ts ***!
  \***********************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../controller/binding-creators/input */"./src/main/js/controller/binding-creators/input.ts"),r=n(/*! ../controller/binding-creators/monitor */"./src/main/js/controller/binding-creators/monitor.ts"),o=n(/*! ../controller/button */"./src/main/js/controller/button.ts"),a=n(/*! ../controller/separator */"./src/main/js/controller/separator.ts"),s=n(/*! ../model/target */"./src/main/js/model/target.ts"),c=n(/*! ./button */"./src/main/js/api/button.ts"),l=n(/*! ./input-binding */"./src/main/js/api/input-binding.ts"),u=n(/*! ./monitor-binding */"./src/main/js/api/monitor-binding.ts"),h={change:"inputchange",fold:"fold",update:"monitorupdate"},p=function(){function t(t){this.controller=t}return Object.defineProperty(t.prototype,"expanded",{get:function(){return this.controller.folder.expanded},set:function(t){this.controller.folder.expanded=t},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.controller.dispose()},t.prototype.addInput=function(t,e,n){var r=n||{},o=i.create(this.controller.document,new s.default(t,e,r.presetKey),r);return this.controller.uiControllerList.append(o),new l.default(o)},t.prototype.addMonitor=function(t,e,n){var i=n||{},o=r.create(this.controller.document,new s.default(t,e),i);return this.controller.uiControllerList.append(o),new u.default(o)},t.prototype.addButton=function(t){var e=new o.default(this.controller.document,t);return this.controller.uiControllerList.append(e),new c.default(e)},t.prototype.addSeparator=function(){var t=new a.default(this.controller.document);this.controller.uiControllerList.append(t)},t.prototype.on=function(t,e){var n=h[t];return n&&this.controller.emitter.on(n,e),this},t}();e.default=p},"./src/main/js/api/input-binding.ts":
/*!******************************************!*\
  !*** ./src/main/js/api/input-binding.ts ***!
  \******************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.controller=t}return t.prototype.dispose=function(){this.controller.dispose()},t.prototype.on=function(t,e){return this.controller.binding.value.emitter.on(t,e),this},t.prototype.refresh=function(){this.controller.binding.read()},t}();e.default=i},"./src/main/js/api/monitor-binding.ts":
/*!********************************************!*\
  !*** ./src/main/js/api/monitor-binding.ts ***!
  \********************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.controller=t}return t.prototype.dispose=function(){this.controller.dispose()},t.prototype.on=function(t,e){return this.controller.binding.value.emitter.on(t,e),this},t.prototype.refresh=function(){this.controller.binding.read()},t}();e.default=i},"./src/main/js/api/preset.ts":
/*!***********************************!*\
  !*** ./src/main/js/api/preset.ts ***!
  \***********************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.exportJson=function(t){return t.reduce((function(t,e){var n;return Object.assign(t,((n={})[e.presetKey]=e.read(),n))}),{})},e.importJson=function(t,e){t.forEach((function(t){var n=e[t.presetKey];void 0!==n&&t.write(n)}))}},"./src/main/js/api/root.ts":
/*!*********************************!*\
  !*** ./src/main/js/api/root.ts ***!
  \*********************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../controller/binding-creators/input */"./src/main/js/controller/binding-creators/input.ts"),r=n(/*! ../controller/binding-creators/monitor */"./src/main/js/controller/binding-creators/monitor.ts"),o=n(/*! ../controller/button */"./src/main/js/controller/button.ts"),a=n(/*! ../controller/folder */"./src/main/js/controller/folder.ts"),s=n(/*! ../controller/input-binding */"./src/main/js/controller/input-binding.ts"),c=n(/*! ../controller/monitor-binding */"./src/main/js/controller/monitor-binding.ts"),l=n(/*! ../controller/separator */"./src/main/js/controller/separator.ts"),u=n(/*! ../controller/ui-util */"./src/main/js/controller/ui-util.ts"),h=n(/*! ../model/target */"./src/main/js/model/target.ts"),p=n(/*! ./button */"./src/main/js/api/button.ts"),d=n(/*! ./folder */"./src/main/js/api/folder.ts"),f=n(/*! ./input-binding */"./src/main/js/api/input-binding.ts"),m=n(/*! ./monitor-binding */"./src/main/js/api/monitor-binding.ts"),v=n(/*! ./preset */"./src/main/js/api/preset.ts"),y={change:"inputchange",fold:"fold",update:"monitorupdate"},g=function(){function t(t){this.controller=t}return Object.defineProperty(t.prototype,"element",{get:function(){return this.controller.view.element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"expanded",{get:function(){var t=this.controller.folder;return!t||t.expanded},set:function(t){var e=this.controller.folder;e&&(e.expanded=t)},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.controller.dispose()},t.prototype.addInput=function(t,e,n){var r=n||{},o=i.create(this.controller.document,new h.default(t,e,r.presetKey),r);return this.controller.uiControllerList.append(o),new f.default(o)},t.prototype.addMonitor=function(t,e,n){var i=n||{},o=r.create(this.controller.document,new h.default(t,e),i);return this.controller.uiControllerList.append(o),new m.default(o)},t.prototype.addButton=function(t){var e=new o.default(this.controller.document,t);return this.controller.uiControllerList.append(e),new p.default(e)},t.prototype.addFolder=function(t){var e=new a.default(this.controller.document,t);return this.controller.uiControllerList.append(e),new d.default(e)},t.prototype.addSeparator=function(){var t=new l.default(this.controller.document);this.controller.uiControllerList.append(t)},t.prototype.importPreset=function(t){var e=u.findControllers(this.controller.uiControllerList.items,s.default).map((function(t){return t.binding.target}));v.importJson(e,t),this.refresh()},t.prototype.exportPreset=function(){var t=u.findControllers(this.controller.uiControllerList.items,s.default).map((function(t){return t.binding.target}));return v.exportJson(t)},t.prototype.on=function(t,e){var n=y[t];return n&&this.controller.emitter.on(n,e),this},t.prototype.refresh=function(){u.findControllers(this.controller.uiControllerList.items,s.default).forEach((function(t){t.binding.read()})),u.findControllers(this.controller.uiControllerList.items,c.default).forEach((function(t){t.binding.read()}))},t}();e.default=g},"./src/main/js/binding/input.ts":
/*!**************************************!*\
  !*** ./src/main/js/binding/input.ts ***!
  \**************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.onValueChange_=this.onValueChange_.bind(this),this.reader_=t.reader,this.writer_=t.writer,this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.target=t.target,this.read()}return t.prototype.read=function(){var t=this.target.read();void 0!==t&&(this.value.rawValue=this.reader_(t))},t.prototype.write_=function(t){var e=this.writer_(t);this.target.write(e)},t.prototype.onValueChange_=function(t){this.write_(t)},t}();e.default=i},"./src/main/js/binding/monitor.ts":
/*!****************************************!*\
  !*** ./src/main/js/binding/monitor.ts ***!
  \****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.onTick_=this.onTick_.bind(this),this.reader_=t.reader,this.target=t.target,this.value=t.value,this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}return t.prototype.dispose=function(){this.ticker.dispose()},t.prototype.read=function(){var t=this.target.read();void 0!==t&&this.value.append(this.reader_(t))},t.prototype.onTick_=function(){this.read()},t}();e.default=i},"./src/main/js/constraint/composite.ts":
/*!*********************************************!*\
  !*** ./src/main/js/constraint/composite.ts ***!
  \*********************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.constraints_=t.constraints}return Object.defineProperty(t.prototype,"constraints",{get:function(){return this.constraints_},enumerable:!0,configurable:!0}),t.prototype.constrain=function(t){return this.constraints_.reduce((function(t,e){return e.constrain(t)}),t)},t}();e.default=i},"./src/main/js/constraint/list.ts":
/*!****************************************!*\
  !*** ./src/main/js/constraint/list.ts ***!
  \****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.opts_=t.options}return Object.defineProperty(t.prototype,"options",{get:function(){return this.opts_},enumerable:!0,configurable:!0}),t.prototype.constrain=function(t){var e=this.opts_;return 0===e.length?t:e.filter((function(e){return e.value===t})).length>0?t:e[0].value},t}();e.default=i},"./src/main/js/constraint/range.ts":
/*!*****************************************!*\
  !*** ./src/main/js/constraint/range.ts ***!
  \*****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.max_=t.max,this.min_=t.min}return Object.defineProperty(t.prototype,"minValue",{get:function(){return this.min_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.max_},enumerable:!0,configurable:!0}),t.prototype.constrain=function(t){var e=t;return null!==this.min_&&void 0!==this.min_&&(e=Math.max(e,this.min_)),null!==this.max_&&void 0!==this.max_&&(e=Math.min(e,this.max_)),e},t}();e.default=i},"./src/main/js/constraint/step.ts":
/*!****************************************!*\
  !*** ./src/main/js/constraint/step.ts ***!
  \****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.step=t.step}return t.prototype.constrain=function(t){return(t<0?-Math.round(-t/this.step):Math.round(t/this.step))*this.step},t}();e.default=i},"./src/main/js/constraint/util.ts":
/*!****************************************!*\
  !*** ./src/main/js/constraint/util.ts ***!
  \****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ./composite */"./src/main/js/constraint/composite.ts"),r={findConstraint:function(t,e){if(t instanceof e)return t;if(t instanceof i.default){var n=t.constraints.reduce((function(t,n){return t||(n instanceof e?n:null)}),null);if(n)return n}return null}};e.default=r},"./src/main/js/controller/binding-creators/boolean-input.ts":
/*!******************************************************************!*\
  !*** ./src/main/js/controller/binding-creators/boolean-input.ts ***!
  \******************************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../binding/input */"./src/main/js/binding/input.ts"),r=n(/*! ../../constraint/composite */"./src/main/js/constraint/composite.ts"),o=n(/*! ../../constraint/list */"./src/main/js/constraint/list.ts"),a=n(/*! ../../constraint/util */"./src/main/js/constraint/util.ts"),s=n(/*! ../../converter/boolean */"./src/main/js/converter/boolean.ts"),c=n(/*! ../../model/input-value */"./src/main/js/model/input-value.ts"),l=n(/*! ../input-binding */"./src/main/js/controller/input-binding.ts"),u=n(/*! ../input/checkbox */"./src/main/js/controller/input/checkbox.ts"),h=n(/*! ../input/list */"./src/main/js/controller/input/list.ts");function p(t,e){var n=e.constraint;return n&&a.default.findConstraint(n,o.default)?new h.default(t,{stringifyValue:s.toString,value:e}):new u.default(t,{value:e})}e.create=function(t,e,n){var a=new c.default(!1,function(t){var e=[];return t.options&&e.push(new o.default({options:t.options})),new r.default({constraints:e})}(n)),u=new i.default({reader:s.fromMixed,target:e,value:a,writer:function(t){return t}});return new l.default(t,{binding:u,controller:p(t,a),label:n.label||e.key})}},"./src/main/js/controller/binding-creators/boolean-monitor.ts":
/*!********************************************************************!*\
  !*** ./src/main/js/controller/binding-creators/boolean-monitor.ts ***!
  \********************************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../binding/monitor */"./src/main/js/binding/monitor.ts"),r=n(/*! ../../converter/boolean */"./src/main/js/converter/boolean.ts"),o=n(/*! ../../formatter/boolean */"./src/main/js/formatter/boolean.ts"),a=n(/*! ../../misc/ticker/interval */"./src/main/js/misc/ticker/interval.ts"),s=n(/*! ../../misc/type-util */"./src/main/js/misc/type-util.ts"),c=n(/*! ../../model/monitor-value */"./src/main/js/model/monitor-value.ts"),l=n(/*! ../monitor-binding */"./src/main/js/controller/monitor-binding.ts"),u=n(/*! ../monitor/multi-log */"./src/main/js/controller/monitor/multi-log.ts"),h=n(/*! ../monitor/single-log */"./src/main/js/controller/monitor/single-log.ts");e.createTextMonitor=function(t,e,n){var p=new c.default(s.default.getOrDefault(n.count,1)),d=1===p.totalCount?new h.default(t,{formatter:new o.default,value:p}):new u.default(t,{formatter:new o.default,value:p}),f=new a.default(t,s.default.getOrDefault(n.interval,200));return new l.default(t,{binding:new i.default({reader:r.fromMixed,target:e,ticker:f,value:p}),controller:d,label:n.label||e.key})}},"./src/main/js/controller/binding-creators/color-input.ts":
/*!****************************************************************!*\
  !*** ./src/main/js/controller/binding-creators/color-input.ts ***!
  \****************************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../binding/input */"./src/main/js/binding/input.ts"),r=n(/*! ../../converter/color */"./src/main/js/converter/color.ts"),o=n(/*! ../../formatter/color */"./src/main/js/formatter/color.ts"),a=n(/*! ../../model/input-value */"./src/main/js/model/input-value.ts"),s=n(/*! ../../parser/color */"./src/main/js/parser/color.ts"),c=n(/*! ../input-binding */"./src/main/js/controller/input-binding.ts"),l=n(/*! ../input/color-swatch-text */"./src/main/js/controller/input/color-swatch-text.ts");e.create=function(t,e,n,u){var h=new a.default(n);return new c.default(t,{binding:new i.default({reader:r.fromMixed,target:e,value:h,writer:r.toString}),controller:new l.default(t,{formatter:new o.default,parser:s.default,value:h}),label:u.label||e.key})}},"./src/main/js/controller/binding-creators/input.ts":
/*!**********************************************************!*\
  !*** ./src/main/js/controller/binding-creators/input.ts ***!
  \**********************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../converter/boolean */"./src/main/js/converter/boolean.ts"),r=n(/*! ../../converter/number */"./src/main/js/converter/number.ts"),o=n(/*! ../../converter/string */"./src/main/js/converter/string.ts"),a=n(/*! ../../misc/pane-error */"./src/main/js/misc/pane-error.ts"),s=n(/*! ../../parser/color */"./src/main/js/parser/color.ts"),c=n(/*! ./boolean-input */"./src/main/js/controller/binding-creators/boolean-input.ts"),l=n(/*! ./color-input */"./src/main/js/controller/binding-creators/color-input.ts"),u=n(/*! ./number-input */"./src/main/js/controller/binding-creators/number-input.ts"),h=n(/*! ./string-input */"./src/main/js/controller/binding-creators/string-input.ts");function p(t,e){var n={label:t.label,max:t.max,min:t.min,step:t.step};if(t.options)if(Array.isArray(t.options))n.options=t.options.map((function(t){return{text:t.text,value:e(t.value)}}));else{var i=t.options,r=Object.keys(i);n.options=r.reduce((function(t,n){return t.concat({text:n,value:e(i[n])})}),[])}return n}e.create=function(t,e,n){var d=e.read();if(null==d)throw new a.default({context:{key:e.key},type:"emptyvalue"});if("boolean"==typeof d)return c.create(t,e,p(n,i.fromMixed));if("number"==typeof d)return u.create(t,e,p(n,r.fromMixed));if("string"==typeof d){var f=s.default(d);return f?l.create(t,e,f,n):h.create(t,e,p(n,o.fromMixed))}throw new a.default({context:{key:e.key},type:"nomatchingcontroller"})}},"./src/main/js/controller/binding-creators/monitor.ts":
/*!************************************************************!*\
  !*** ./src/main/js/controller/binding-creators/monitor.ts ***!
  \************************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../misc/pane-error */"./src/main/js/misc/pane-error.ts"),r=n(/*! ./boolean-monitor */"./src/main/js/controller/binding-creators/boolean-monitor.ts"),o=n(/*! ./number-monitor */"./src/main/js/controller/binding-creators/number-monitor.ts"),a=n(/*! ./string-monitor */"./src/main/js/controller/binding-creators/string-monitor.ts");e.create=function(t,e,n){var s=e.read();if(null==s)throw new i.default({context:{key:e.key},type:"emptyvalue"});if("number"==typeof s)return"graph"===n.type?o.createGraphMonitor(t,e,n):o.createTextMonitor(t,e,n);if("string"==typeof s)return a.createTextMonitor(t,e,n);if("boolean"==typeof s)return r.createTextMonitor(t,e,n);throw new i.default({context:{key:e.key},type:"nomatchingcontroller"})}},"./src/main/js/controller/binding-creators/number-input.ts":
/*!*****************************************************************!*\
  !*** ./src/main/js/controller/binding-creators/number-input.ts ***!
  \*****************************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../binding/input */"./src/main/js/binding/input.ts"),r=n(/*! ../../constraint/composite */"./src/main/js/constraint/composite.ts"),o=n(/*! ../../constraint/list */"./src/main/js/constraint/list.ts"),a=n(/*! ../../constraint/range */"./src/main/js/constraint/range.ts"),s=n(/*! ../../constraint/step */"./src/main/js/constraint/step.ts"),c=n(/*! ../../constraint/util */"./src/main/js/constraint/util.ts"),l=n(/*! ../../converter/number */"./src/main/js/converter/number.ts"),u=n(/*! ../../formatter/number */"./src/main/js/formatter/number.ts"),h=n(/*! ../../misc/number-util */"./src/main/js/misc/number-util.ts"),p=n(/*! ../../model/input-value */"./src/main/js/model/input-value.ts"),d=n(/*! ../../parser/number */"./src/main/js/parser/number.ts"),f=n(/*! ../input-binding */"./src/main/js/controller/input-binding.ts"),m=n(/*! ../input/list */"./src/main/js/controller/input/list.ts"),v=n(/*! ../input/number-text */"./src/main/js/controller/input/number-text.ts"),y=n(/*! ../input/slider-text */"./src/main/js/controller/input/slider-text.ts");function g(t){var e=t.constraint,n=e&&c.default.findConstraint(e,s.default);return n?h.default.getDecimalDigits(n.step):Math.max(h.default.getDecimalDigits(t.rawValue),2)}function b(t,e){var n=e.constraint;return n&&c.default.findConstraint(n,o.default)?new m.default(t,{stringifyValue:l.toString,value:e}):n&&c.default.findConstraint(n,a.default)?new y.default(t,{formatter:new u.default(g(e)),parser:d.default,value:e}):new v.default(t,{formatter:new u.default(g(e)),parser:d.default,value:e})}e.create=function(t,e,n){var c=new p.default(0,function(t){var e=[];return null!==t.step&&void 0!==t.step&&e.push(new s.default({step:t.step})),(null!==t.max&&void 0!==t.max||null!==t.min&&void 0!==t.min)&&e.push(new a.default({max:t.max,min:t.min})),t.options&&e.push(new o.default({options:t.options})),new r.default({constraints:e})}(n)),u=new i.default({reader:l.fromMixed,target:e,value:c,writer:function(t){return t}});return new f.default(t,{binding:u,controller:b(t,c),label:n.label||e.key})}},"./src/main/js/controller/binding-creators/number-monitor.ts":
/*!*******************************************************************!*\
  !*** ./src/main/js/controller/binding-creators/number-monitor.ts ***!
  \*******************************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../binding/monitor */"./src/main/js/binding/monitor.ts"),r=n(/*! ../../converter/number */"./src/main/js/converter/number.ts"),o=n(/*! ../../formatter/number */"./src/main/js/formatter/number.ts"),a=n(/*! ../../misc/ticker/interval */"./src/main/js/misc/ticker/interval.ts"),s=n(/*! ../../misc/type-util */"./src/main/js/misc/type-util.ts"),c=n(/*! ../../model/monitor-value */"./src/main/js/model/monitor-value.ts"),l=n(/*! ../monitor-binding */"./src/main/js/controller/monitor-binding.ts"),u=n(/*! ../monitor/graph */"./src/main/js/controller/monitor/graph.ts"),h=n(/*! ../monitor/multi-log */"./src/main/js/controller/monitor/multi-log.ts"),p=n(/*! ../monitor/single-log */"./src/main/js/controller/monitor/single-log.ts");function d(){return new o.default(2)}e.createTextMonitor=function(t,e,n){var o=new c.default(s.default.getOrDefault(n.count,1)),u=1===o.totalCount?new p.default(t,{formatter:d(),value:o}):new h.default(t,{formatter:d(),value:o}),f=new a.default(t,s.default.getOrDefault(n.interval,200));return new l.default(t,{binding:new i.default({reader:r.fromMixed,target:e,ticker:f,value:o}),controller:u,label:n.label||e.key})},e.createGraphMonitor=function(t,e,n){var o=new c.default(s.default.getOrDefault(n.count,64)),h=new a.default(t,s.default.getOrDefault(n.interval,200));return new l.default(t,{binding:new i.default({reader:r.fromMixed,target:e,ticker:h,value:o}),controller:new u.default(t,{formatter:d(),maxValue:s.default.getOrDefault(n.max,100),minValue:s.default.getOrDefault(n.min,0),value:o}),label:n.label||e.key})}},"./src/main/js/controller/binding-creators/string-input.ts":
/*!*****************************************************************!*\
  !*** ./src/main/js/controller/binding-creators/string-input.ts ***!
  \*****************************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../binding/input */"./src/main/js/binding/input.ts"),r=n(/*! ../../constraint/composite */"./src/main/js/constraint/composite.ts"),o=n(/*! ../../constraint/list */"./src/main/js/constraint/list.ts"),a=n(/*! ../../constraint/util */"./src/main/js/constraint/util.ts"),s=n(/*! ../../converter/string */"./src/main/js/converter/string.ts"),c=n(/*! ../../formatter/string */"./src/main/js/formatter/string.ts"),l=n(/*! ../../model/input-value */"./src/main/js/model/input-value.ts"),u=n(/*! ../input-binding */"./src/main/js/controller/input-binding.ts"),h=n(/*! ../input/list */"./src/main/js/controller/input/list.ts"),p=n(/*! ../input/text */"./src/main/js/controller/input/text.ts");function d(t,e){var n=e.constraint;return n&&a.default.findConstraint(n,o.default)?new h.default(t,{stringifyValue:s.toString,value:e}):new p.default(t,{formatter:new c.default,parser:s.toString,value:e})}e.create=function(t,e,n){var a=new l.default("",function(t){var e=[];return t.options&&e.push(new o.default({options:t.options})),new r.default({constraints:e})}(n)),c=new i.default({reader:s.fromMixed,target:e,value:a,writer:function(t){return t}});return new u.default(t,{binding:c,controller:d(t,a),label:n.label||e.key})}},"./src/main/js/controller/binding-creators/string-monitor.ts":
/*!*******************************************************************!*\
  !*** ./src/main/js/controller/binding-creators/string-monitor.ts ***!
  \*******************************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../binding/monitor */"./src/main/js/binding/monitor.ts"),r=n(/*! ../../converter/string */"./src/main/js/converter/string.ts"),o=n(/*! ../../formatter/string */"./src/main/js/formatter/string.ts"),a=n(/*! ../../misc/ticker/interval */"./src/main/js/misc/ticker/interval.ts"),s=n(/*! ../../misc/type-util */"./src/main/js/misc/type-util.ts"),c=n(/*! ../../model/monitor-value */"./src/main/js/model/monitor-value.ts"),l=n(/*! ../monitor-binding */"./src/main/js/controller/monitor-binding.ts"),u=n(/*! ../monitor/multi-log */"./src/main/js/controller/monitor/multi-log.ts"),h=n(/*! ../monitor/single-log */"./src/main/js/controller/monitor/single-log.ts");e.createTextMonitor=function(t,e,n){var p=new c.default(s.default.getOrDefault(n.count,1)),d=p.totalCount>1||n.multiline?new u.default(t,{formatter:new o.default,value:p}):new h.default(t,{formatter:new o.default,value:p}),f=new a.default(t,s.default.getOrDefault(n.interval,200));return new l.default(t,{binding:new i.default({reader:r.fromMixed,target:e,ticker:f,value:p}),controller:d,label:n.label||e.key})}},"./src/main/js/controller/button.ts":
/*!******************************************!*\
  !*** ./src/main/js/controller/button.ts ***!
  \******************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../model/button */"./src/main/js/model/button.ts"),r=n(/*! ../view/button */"./src/main/js/view/button.ts"),o=function(){function t(t,e){this.onButtonClick_=this.onButtonClick_.bind(this),this.button=new i.default(e.title),this.view=new r.default(t,{button:this.button}),this.view.buttonElement.addEventListener("click",this.onButtonClick_)}return t.prototype.dispose=function(){this.view.dispose()},t.prototype.onButtonClick_=function(){this.button.click()},t}();e.default=o},"./src/main/js/controller/folder.ts":
/*!******************************************!*\
  !*** ./src/main/js/controller/folder.ts ***!
  \******************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../misc/dom-util */"./src/main/js/misc/dom-util.ts"),r=n(/*! ../misc/emitter */"./src/main/js/misc/emitter.ts"),o=n(/*! ../misc/type-util */"./src/main/js/misc/type-util.ts"),a=n(/*! ../model/folder */"./src/main/js/model/folder.ts"),s=n(/*! ../model/list */"./src/main/js/model/list.ts"),c=n(/*! ../view/folder */"./src/main/js/view/folder.ts"),l=n(/*! ./input-binding */"./src/main/js/controller/input-binding.ts"),u=n(/*! ./monitor-binding */"./src/main/js/controller/monitor-binding.ts"),h=function(){function t(t,e){this.onFolderChange_=this.onFolderChange_.bind(this),this.onInputChange_=this.onInputChange_.bind(this),this.onMonitorUpdate_=this.onMonitorUpdate_.bind(this),this.onTitleClick_=this.onTitleClick_.bind(this),this.onUiControllerListAppend_=this.onUiControllerListAppend_.bind(this),this.emitter=new r.default,this.folder=new a.default(e.title,o.default.getOrDefault(e.expanded,!0)),this.folder.emitter.on("change",this.onFolderChange_),this.ucList_=new s.default,this.ucList_.emitter.on("append",this.onUiControllerListAppend_),this.doc_=t,this.view=new c.default(this.doc_,{folder:this.folder}),this.view.titleElement.addEventListener("click",this.onTitleClick_)}return Object.defineProperty(t.prototype,"document",{get:function(){return this.doc_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uiControllerList",{get:function(){return this.ucList_},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.view.dispose()},t.prototype.computeExpandedHeight_=function(){var t=this,e=this.view.containerElement,n=0;return i.disableTransitionTemporarily(e,(function(){var r=t.folder.expanded;t.folder.expandedHeight=null,t.folder.expanded=!0,i.forceReflow(e),n=e.getBoundingClientRect().height,t.folder.expanded=r,i.forceReflow(e)})),n},t.prototype.onTitleClick_=function(){this.folder.expanded=!this.folder.expanded},t.prototype.onUiControllerListAppend_=function(t){t instanceof l.default?t.binding.value.emitter.on("change",this.onInputChange_):t instanceof u.default&&t.binding.value.emitter.on("update",this.onMonitorUpdate_),this.view.containerElement.appendChild(t.view.element),this.folder.expandedHeight=this.computeExpandedHeight_()},t.prototype.onInputChange_=function(t){this.emitter.emit("inputchange",[t])},t.prototype.onMonitorUpdate_=function(t){this.emitter.emit("monitorupdate",[t])},t.prototype.onFolderChange_=function(){this.emitter.emit("fold")},t}();e.default=h},"./src/main/js/controller/input-binding.ts":
/*!*************************************************!*\
  !*** ./src/main/js/controller/input-binding.ts ***!
  \*************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../view/labeled */"./src/main/js/view/labeled.ts"),r=function(){function t(t,e){this.binding=e.binding,this.controller=e.controller,this.view=new i.default(t,{label:e.label,view:this.controller.view})}return t.prototype.dispose=function(){this.controller.dispose(),this.view.dispose()},t}();e.default=r},"./src/main/js/controller/input/checkbox.ts":
/*!**************************************************!*\
  !*** ./src/main/js/controller/input/checkbox.ts ***!
  \**************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../misc/type-util */"./src/main/js/misc/type-util.ts"),r=n(/*! ../../view/input/checkbox */"./src/main/js/view/input/checkbox.ts"),o=function(){function t(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.view=new r.default(t,{value:this.value}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return t.prototype.dispose=function(){this.view.dispose()},t.prototype.onInputChange_=function(t){var e=i.default.forceCast(t.currentTarget);this.value.rawValue=e.checked,this.view.update()},t}();e.default=o},"./src/main/js/controller/input/color-picker.ts":
/*!******************************************************!*\
  !*** ./src/main/js/controller/input/color-picker.ts ***!
  \******************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../constraint/composite */"./src/main/js/constraint/composite.ts"),r=n(/*! ../../constraint/range */"./src/main/js/constraint/range.ts"),o=n(/*! ../../constraint/step */"./src/main/js/constraint/step.ts"),a=n(/*! ../../formatter/number */"./src/main/js/formatter/number.ts"),s=n(/*! ../../misc/type-util */"./src/main/js/misc/type-util.ts"),c=n(/*! ../../model/color */"./src/main/js/model/color.ts"),l=n(/*! ../../model/foldable */"./src/main/js/model/foldable.ts"),u=n(/*! ../../model/input-value */"./src/main/js/model/input-value.ts"),h=n(/*! ../../parser/number */"./src/main/js/parser/number.ts"),p=n(/*! ../../view/input/color-picker */"./src/main/js/view/input/color-picker.ts"),d=n(/*! ./h-palette */"./src/main/js/controller/input/h-palette.ts"),f=n(/*! ./number-text */"./src/main/js/controller/input/number-text.ts"),m=n(/*! ./sv-palette */"./src/main/js/controller/input/sv-palette.ts"),v=new i.default({constraints:[new r.default({max:255,min:0}),new o.default({step:1})]}),y=function(){function t(t,e){var n=this;this.onInputBlur_=this.onInputBlur_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.foldable=new l.default,this.hPaletteIc_=new d.default(t,{value:this.value}),this.svPaletteIc_=new m.default(t,{value:this.value});var i=this.value.rawValue.getComponents(),r=[0,1,2].map((function(t){return new u.default(i[t],v)}));r.forEach((function(t,e){t.emitter.on("change",(function(t){var i=n.value.rawValue.getComponents();0!==e&&1!==e&&2!==e||(i[e]=t),n.value.rawValue=new(c.default.bind.apply(c.default,[void 0].concat(i)))}))})),this.rgbIcs_=r.map((function(e){return new f.default(t,{formatter:new a.default(0),parser:h.default,value:e})})),this.view=new p.default(t,{foldable:this.foldable,hPaletteInputView:this.hPaletteIc_.view,rgbInputViews:this.rgbIcs_.map((function(t){return t.view})),svPaletteInputView:this.svPaletteIc_.view,value:this.value}),this.view.allFocusableElements.forEach((function(t){t.addEventListener("blur",n.onInputBlur_)}))}return t.prototype.dispose=function(){this.view.dispose()},t.prototype.onInputBlur_=function(t){var e=this.view.element,n=s.default.forceCast(t.relatedTarget);n&&e.contains(n)||(this.foldable.expanded=!1)},t.prototype.onValueChange_=function(){var t=this.value.rawValue.getComponents();this.rgbIcs_.forEach((function(e,n){e.value.rawValue=t[n]}))},t}();e.default=y},"./src/main/js/controller/input/color-swatch-text.ts":
/*!***********************************************************!*\
  !*** ./src/main/js/controller/input/color-swatch-text.ts ***!
  \***********************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../view/input/color-swatch-text */"./src/main/js/view/input/color-swatch-text.ts"),r=n(/*! ../input/color-swatch */"./src/main/js/controller/input/color-swatch.ts"),o=n(/*! ./text */"./src/main/js/controller/input/text.ts"),a=function(){function t(t,e){this.value=e.value,this.swatchIc_=new r.default(t,{value:this.value}),this.textIc_=new o.default(t,{formatter:e.formatter,parser:e.parser,value:this.value}),this.view=new i.default(t,{swatchInputView:this.swatchIc_.view,textInputView:this.textIc_.view})}return t.prototype.dispose=function(){this.view.dispose()},t}();e.default=a},"./src/main/js/controller/input/color-swatch.ts":
/*!******************************************************!*\
  !*** ./src/main/js/controller/input/color-swatch.ts ***!
  \******************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../misc/type-util */"./src/main/js/misc/type-util.ts"),r=n(/*! ../../view/input/color-swatch */"./src/main/js/view/input/color-swatch.ts"),o=n(/*! ./color-picker */"./src/main/js/controller/input/color-picker.ts"),a=function(){function t(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.value=e.value,this.pickerIc_=new o.default(t,{value:this.value}),this.view=new r.default(t,{pickerInputView:this.pickerIc_.view,value:this.value}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_)}return t.prototype.dispose=function(){this.view.dispose()},t.prototype.onButtonBlur_=function(t){var e=this.view.element,n=i.default.forceCast(t.relatedTarget);n&&e.contains(n)||(this.pickerIc_.foldable.expanded=!1)},t.prototype.onButtonClick_=function(){this.pickerIc_.foldable.expanded=!this.pickerIc_.foldable.expanded},t}();e.default=a},"./src/main/js/controller/input/h-palette.ts":
/*!***************************************************!*\
  !*** ./src/main/js/controller/input/h-palette.ts ***!
  \***************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../misc/color-model */"./src/main/js/misc/color-model.ts"),r=n(/*! ../../misc/number-util */"./src/main/js/misc/number-util.ts"),o=n(/*! ../../misc/pointer-handler */"./src/main/js/misc/pointer-handler.ts"),a=n(/*! ../../model/color */"./src/main/js/model/color.ts"),s=n(/*! ../../view/input/h-palette */"./src/main/js/view/input/h-palette.ts"),c=function(){function t(t,e){this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.view=new s.default(t,{value:this.value}),this.ptHandler_=new o.default(t,this.view.canvasElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_)}return t.prototype.dispose=function(){this.view.dispose()},t.prototype.handlePointerEvent_=function(t){var e=r.default.map(t.py,0,1,0,360),n=this.value.rawValue,o=i.rgbToHsv.apply(i,n.getComponents()),s=o[1],c=o[2];this.value.rawValue=new(a.default.bind.apply(a.default,[void 0].concat(i.hsvToRgb(e,s,c)))),this.view.update()},t.prototype.onPointerDown_=function(t){this.handlePointerEvent_(t)},t.prototype.onPointerMove_=function(t){this.handlePointerEvent_(t)},t.prototype.onPointerUp_=function(t){this.handlePointerEvent_(t)},t}();e.default=c},"./src/main/js/controller/input/list.ts":
/*!**********************************************!*\
  !*** ./src/main/js/controller/input/list.ts ***!
  \**********************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../constraint/list */"./src/main/js/constraint/list.ts"),r=n(/*! ../../constraint/util */"./src/main/js/constraint/util.ts"),o=n(/*! ../../misc/type-util */"./src/main/js/misc/type-util.ts"),a=n(/*! ../../view/input/list */"./src/main/js/view/input/list.ts"),s=function(){function t(t,e){var n,o;this.onSelectChange_=this.onSelectChange_.bind(this),this.value_=e.value,this.listItems_=(n=this.value_,((o=n.constraint?r.default.findConstraint(n.constraint,i.default):null)?o.options:null)||[]),this.view_=new a.default(t,{options:this.listItems_,stringifyValue:e.stringifyValue,value:this.value_}),this.view_.selectElement.addEventListener("change",this.onSelectChange_)}return Object.defineProperty(t.prototype,"value",{get:function(){return this.value_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"view",{get:function(){return this.view_},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.view.dispose()},t.prototype.onSelectChange_=function(t){var e=o.default.forceCast(t.currentTarget).selectedOptions.item(0);if(e){var n=Number(e.dataset.index);this.value_.rawValue=this.listItems_[n].value,this.view_.update()}},t}();e.default=s},"./src/main/js/controller/input/number-text.ts":
/*!*****************************************************!*\
  !*** ./src/main/js/controller/input/number-text.ts ***!
  \*****************************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../../constraint/step */"./src/main/js/constraint/step.ts"),a=n(/*! ../../constraint/util */"./src/main/js/constraint/util.ts"),s=n(/*! ../../misc/type-util */"./src/main/js/misc/type-util.ts");function c(t){var e=function(t){var e=t.constraint?a.default.findConstraint(t.constraint,o.default):null;return e?e.step:null}(t);return s.default.getOrDefault(e,1)}var l=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.onInputKeyDown_=i.onInputKeyDown_.bind(i),i.step_=c(i.value),i.view.inputElement.addEventListener("keydown",i.onInputKeyDown_),i}return r(e,t),e.prototype.dispose=function(){this.view.dispose()},e.prototype.onInputKeyDown_=function(t){var e=this.step_*(t.altKey?.1:1)*(t.shiftKey?10:1);38===t.keyCode?(this.value.rawValue+=e,this.view.update()):40===t.keyCode&&(this.value.rawValue-=e,this.view.update())},e}(n(/*! ./text */"./src/main/js/controller/input/text.ts").default);e.default=l},"./src/main/js/controller/input/slider-text.ts":
/*!*****************************************************!*\
  !*** ./src/main/js/controller/input/slider-text.ts ***!
  \*****************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../view/input/slider-text */"./src/main/js/view/input/slider-text.ts"),r=n(/*! ./number-text */"./src/main/js/controller/input/number-text.ts"),o=n(/*! ./slider */"./src/main/js/controller/input/slider.ts"),a=function(){function t(t,e){this.value_=e.value,this.sliderIc_=new o.default(t,{value:e.value}),this.textIc_=new r.default(t,{formatter:e.formatter,parser:e.parser,value:e.value}),this.view_=new i.default(t,{sliderInputView:this.sliderIc_.view,textInputView:this.textIc_.view})}return Object.defineProperty(t.prototype,"value",{get:function(){return this.value_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"view",{get:function(){return this.view_},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.view.dispose()},t}();e.default=a},"./src/main/js/controller/input/slider.ts":
/*!************************************************!*\
  !*** ./src/main/js/controller/input/slider.ts ***!
  \************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../constraint/range */"./src/main/js/constraint/range.ts"),r=n(/*! ../../constraint/util */"./src/main/js/constraint/util.ts"),o=n(/*! ../../misc/number-util */"./src/main/js/misc/number-util.ts"),a=n(/*! ../../misc/pointer-handler */"./src/main/js/misc/pointer-handler.ts"),s=n(/*! ../../misc/type-util */"./src/main/js/misc/type-util.ts"),c=n(/*! ../../view/input/slider */"./src/main/js/view/input/slider.ts");function l(t){var e=function(t){var e=t.constraint?r.default.findConstraint(t.constraint,i.default):null;return e?[e.minValue,e.maxValue]:[void 0,void 0]}(t),n=e[0],o=e[1];return[s.default.getOrDefault(n,0),s.default.getOrDefault(o,100)]}var u=function(){function t(t,e){this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value;var n=l(this.value),i=n[0],r=n[1];this.minValue_=i,this.maxValue_=r,this.view=new c.default(t,{maxValue:this.maxValue_,minValue:this.minValue_,value:this.value}),this.ptHandler_=new a.default(t,this.view.outerElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_)}return t.prototype.dispose=function(){this.view.dispose()},t.prototype.onPointerDown_=function(t){this.value.rawValue=o.default.map(t.px,0,1,this.minValue_,this.maxValue_),this.view.update()},t.prototype.onPointerMove_=function(t){this.value.rawValue=o.default.map(t.px,0,1,this.minValue_,this.maxValue_),this.view.update()},t.prototype.onPointerUp_=function(t){this.value.rawValue=o.default.map(t.px,0,1,this.minValue_,this.maxValue_),this.view.update()},t}();e.default=u},"./src/main/js/controller/input/sv-palette.ts":
/*!****************************************************!*\
  !*** ./src/main/js/controller/input/sv-palette.ts ***!
  \****************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../misc/color-model */"./src/main/js/misc/color-model.ts"),r=n(/*! ../../misc/number-util */"./src/main/js/misc/number-util.ts"),o=n(/*! ../../misc/pointer-handler */"./src/main/js/misc/pointer-handler.ts"),a=n(/*! ../../model/color */"./src/main/js/model/color.ts"),s=n(/*! ../../view/input/sv-palette */"./src/main/js/view/input/sv-palette.ts"),c=function(){function t(t,e){this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.view=new s.default(t,{value:this.value}),this.ptHandler_=new o.default(t,this.view.canvasElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_)}return t.prototype.dispose=function(){this.view.dispose()},t.prototype.handlePointerEvent_=function(t){var e=r.default.map(t.px,0,1,0,100),n=r.default.map(t.py,0,1,100,0),o=this.value.rawValue,s=i.rgbToHsv.apply(i,o.getComponents())[0];this.value.rawValue=new(a.default.bind.apply(a.default,[void 0].concat(i.hsvToRgb(s,e,n)))),this.view.update()},t.prototype.onPointerDown_=function(t){this.handlePointerEvent_(t)},t.prototype.onPointerMove_=function(t){this.handlePointerEvent_(t)},t.prototype.onPointerUp_=function(t){this.handlePointerEvent_(t)},t}();e.default=c},"./src/main/js/controller/input/text.ts":
/*!**********************************************!*\
  !*** ./src/main/js/controller/input/text.ts ***!
  \**********************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../misc/type-util */"./src/main/js/misc/type-util.ts"),r=n(/*! ../../view/input/text */"./src/main/js/view/input/text.ts"),o=function(){function t(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.value=e.value,this.view=new r.default(t,{formatter:e.formatter,value:this.value}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return t.prototype.dispose=function(){this.view.dispose()},t.prototype.onInputChange_=function(t){var e=this,n=i.default.forceCast(t.currentTarget).value;i.default.ifNotEmpty(this.parser_(n),(function(t){e.value.rawValue=t})),this.view.update()},t}();e.default=o},"./src/main/js/controller/monitor-binding.ts":
/*!***************************************************!*\
  !*** ./src/main/js/controller/monitor-binding.ts ***!
  \***************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../view/labeled */"./src/main/js/view/labeled.ts"),r=function(){function t(t,e){this.binding=e.binding,this.controller=e.controller,this.view=new i.default(t,{label:e.label,view:this.controller.view})}return t.prototype.dispose=function(){this.binding.dispose(),this.controller.dispose(),this.view.dispose()},t}();e.default=r},"./src/main/js/controller/monitor/graph.ts":
/*!*************************************************!*\
  !*** ./src/main/js/controller/monitor/graph.ts ***!
  \*************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../misc/number-util */"./src/main/js/misc/number-util.ts"),r=n(/*! ../../model/graph-cursor */"./src/main/js/model/graph-cursor.ts"),o=n(/*! ../../view/monitor/graph */"./src/main/js/view/monitor/graph.ts"),a=function(){function t(t,e){this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.value=e.value,this.cursor_=new r.default,this.view=new o.default(t,{cursor:this.cursor_,formatter:e.formatter,maxValue:e.maxValue,minValue:e.minValue,value:this.value}),this.view.graphElement.addEventListener("mouseleave",this.onGraphMouseLeave_),this.view.graphElement.addEventListener("mousemove",this.onGraphMouseMove_)}return t.prototype.dispose=function(){this.view.dispose()},t.prototype.onGraphMouseLeave_=function(){this.cursor_.index=-1},t.prototype.onGraphMouseMove_=function(t){var e=this.view.graphElement.getBoundingClientRect(),n=t.offsetX;this.cursor_.index=Math.floor(i.default.map(n,0,e.width,0,this.value.totalCount))},t}();e.default=a},"./src/main/js/controller/monitor/multi-log.ts":
/*!*****************************************************!*\
  !*** ./src/main/js/controller/monitor/multi-log.ts ***!
  \*****************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../view/monitor/multi-log */"./src/main/js/view/monitor/multi-log.ts"),r=function(){function t(t,e){this.value=e.value,this.view=new i.default(t,{formatter:e.formatter,value:this.value})}return t.prototype.dispose=function(){this.view.dispose()},t}();e.default=r},"./src/main/js/controller/monitor/single-log.ts":
/*!******************************************************!*\
  !*** ./src/main/js/controller/monitor/single-log.ts ***!
  \******************************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../../view/monitor/single-log */"./src/main/js/view/monitor/single-log.ts"),r=function(){function t(t,e){this.value=e.value,this.view=new i.default(t,{formatter:e.formatter,value:this.value})}return t.prototype.dispose=function(){this.view.dispose()},t}();e.default=r},"./src/main/js/controller/root.ts":
/*!****************************************!*\
  !*** ./src/main/js/controller/root.ts ***!
  \****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../misc/emitter */"./src/main/js/misc/emitter.ts"),r=n(/*! ../misc/type-util */"./src/main/js/misc/type-util.ts"),o=n(/*! ../model/folder */"./src/main/js/model/folder.ts"),a=n(/*! ../model/list */"./src/main/js/model/list.ts"),s=n(/*! ../view/root */"./src/main/js/view/root.ts"),c=n(/*! ./folder */"./src/main/js/controller/folder.ts"),l=n(/*! ./input-binding */"./src/main/js/controller/input-binding.ts"),u=n(/*! ./monitor-binding */"./src/main/js/controller/monitor-binding.ts"),h=function(){function t(t,e){this.onFolderChange_=this.onFolderChange_.bind(this),this.onRootFolderChange_=this.onRootFolderChange_.bind(this),this.onTitleClick_=this.onTitleClick_.bind(this),this.onUiControllerListAppend_=this.onUiControllerListAppend_.bind(this),this.onInputChange_=this.onInputChange_.bind(this),this.onMonitorUpdate_=this.onMonitorUpdate_.bind(this),this.emitter=new i.default,this.folder=function(t){return t.title?new o.default(t.title,r.default.getOrDefault(t.expanded,!0)):null}(e),this.ucList_=new a.default,this.ucList_.emitter.on("append",this.onUiControllerListAppend_),this.doc_=t,this.view=new s.default(this.doc_,{folder:this.folder}),this.view.titleElement&&this.view.titleElement.addEventListener("click",this.onTitleClick_),this.folder&&this.folder.emitter.on("change",this.onRootFolderChange_)}return Object.defineProperty(t.prototype,"document",{get:function(){return this.doc_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uiControllerList",{get:function(){return this.ucList_},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.view.dispose()},t.prototype.onUiControllerListAppend_=function(t){if(t instanceof l.default)(e=t.binding.value.emitter).on("change",this.onInputChange_);else if(t instanceof u.default)(e=t.binding.value.emitter).on("update",this.onMonitorUpdate_);else if(t instanceof c.default){var e;(e=t.emitter).on("fold",this.onFolderChange_),e.on("inputchange",this.onInputChange_),e.on("monitorupdate",this.onMonitorUpdate_)}this.view.containerElement.appendChild(t.view.element)},t.prototype.onTitleClick_=function(){this.folder&&(this.folder.expanded=!this.folder.expanded)},t.prototype.onInputChange_=function(t){this.emitter.emit("inputchange",[t])},t.prototype.onMonitorUpdate_=function(t){this.emitter.emit("monitorupdate",[t])},t.prototype.onFolderChange_=function(){this.emitter.emit("fold")},t.prototype.onRootFolderChange_=function(){this.emitter.emit("fold")},t}();e.default=h},"./src/main/js/controller/separator.ts":
/*!*********************************************!*\
  !*** ./src/main/js/controller/separator.ts ***!
  \*********************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../view/separator */"./src/main/js/view/separator.ts"),r=function(){function t(t){this.view=new i.default(t)}return t.prototype.dispose=function(){this.view.dispose()},t}();e.default=r},"./src/main/js/controller/ui-util.ts":
/*!*******************************************!*\
  !*** ./src/main/js/controller/ui-util.ts ***!
  \*******************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ./folder */"./src/main/js/controller/folder.ts");e.findControllers=function t(e,n){return e.reduce((function(e,r){return r instanceof i.default&&e.push.apply(e,t(r.uiControllerList.items,n)),r instanceof n&&e.push(r),e}),[])}},"./src/main/js/converter/boolean.ts":
/*!******************************************!*\
  !*** ./src/main/js/converter/boolean.ts ***!
  \******************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fromMixed=function(t){return"false"!==t&&!!t},e.toString=function(t){return String(t)}},"./src/main/js/converter/color.ts":
/*!****************************************!*\
  !*** ./src/main/js/converter/color.ts ***!
  \****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../misc/number-util */"./src/main/js/misc/number-util.ts"),r=n(/*! ../model/color */"./src/main/js/model/color.ts"),o=n(/*! ../parser/color */"./src/main/js/parser/color.ts");e.fromMixed=function(t){if("string"==typeof t){var e=o.default(t);if(e)return e}return new r.default(0,0,0)},e.toString=function(t){return"#"+t.getComponents().map((function(t){var e=i.default.constrain(Math.floor(t),0,255).toString(16);return 1===e.length?"0"+e:e})).join("")}},"./src/main/js/converter/number.ts":
/*!*****************************************!*\
  !*** ./src/main/js/converter/number.ts ***!
  \*****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../parser/number */"./src/main/js/parser/number.ts");e.fromMixed=function(t){if("number"==typeof t)return t;if("string"==typeof t){var e=i.default(t);if(null!=e)return e}return 0},e.toString=function(t){return String(t)}},"./src/main/js/converter/string.ts":
/*!*****************************************!*\
  !*** ./src/main/js/converter/string.ts ***!
  \*****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fromMixed=function(t){return String(t)},e.toString=function(t){return t}},"./src/main/js/formatter/boolean.ts":
/*!******************************************!*\
  !*** ./src/main/js/formatter/boolean.ts ***!
  \******************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../converter/boolean */"./src/main/js/converter/boolean.ts"),r=function(){function t(){}return t.prototype.format=function(t){return i.toString(t)},t}();e.default=r},"./src/main/js/formatter/color.ts":
/*!****************************************!*\
  !*** ./src/main/js/formatter/color.ts ***!
  \****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../converter/color */"./src/main/js/converter/color.ts"),r=n(/*! ../misc/number-util */"./src/main/js/misc/number-util.ts"),o=function(){function t(){}return t.rgb=function(t,e,n){return"rgb("+[r.default.constrain(Math.floor(t),0,255),r.default.constrain(Math.floor(e),0,255),r.default.constrain(Math.floor(n),0,255)].join(", ")+")"},t.hsl=function(t,e,n){return"hsl("+[(Math.floor(t)%360+360)%360,r.default.constrain(Math.floor(e),0,100)+"%",r.default.constrain(Math.floor(n),0,100)+"%"].join(", ")+")"},t.prototype.format=function(t){return i.toString(t)},t}();e.default=o},"./src/main/js/formatter/number.ts":
/*!*****************************************!*\
  !*** ./src/main/js/formatter/number.ts ***!
  \*****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.digits_=t}return Object.defineProperty(t.prototype,"digits",{get:function(){return this.digits_},enumerable:!0,configurable:!0}),t.prototype.format=function(t){return t.toFixed(this.digits_)},t}();e.default=i},"./src/main/js/formatter/string.ts":
/*!*****************************************!*\
  !*** ./src/main/js/formatter/string.ts ***!
  \*****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.prototype.format=function(t){return t},t}();e.default=i},"./src/main/js/index.ts":
/*!******************************!*\
  !*** ./src/main/js/index.ts ***!
  \******************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../sass/bundle.scss */"./src/main/sass/bundle.scss"),a=function(t){function e(e){var n=t.call(this,e)||this;return function(t){if(!t.querySelector("style[data-for=tweakpane]")){var e=t.createElement("style");e.dataset.for="tweakpane",e.textContent=o.toString(),t.head&&t.head.appendChild(e)}}(n.document),n}return r(e,t),e}(n(/*! ./tweakpane-without-style */"./src/main/js/tweakpane-without-style.ts").default);e.default=a},"./src/main/js/misc/class-name.ts":
/*!****************************************!*\
  !*** ./src/main/js/misc/class-name.ts ***!
  \****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i="tp",r={"":"v",input:"iv",monitor:"mv"};e.default=function(t,e){var n=r[e||""];return function(e,r){return[i,"-",t,n,e?"_"+e:"",r?"-"+r:""].join("")}}},"./src/main/js/misc/color-model.ts":
/*!*****************************************!*\
  !*** ./src/main/js/misc/color-model.ts ***!
  \*****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ./number-util */"./src/main/js/misc/number-util.ts");e.rgbToHsl=function(t,e,n){var r=i.default.constrain(t/255,0,1),o=i.default.constrain(e/255,0,1),a=i.default.constrain(n/255,0,1),s=Math.max(r,o,a),c=Math.min(r,o,a),l=s-c,u=0,h=0,p=(c+s)/2;return 0!==l&&(h=p>.5?l/(2-c-s):l/(s+c),u=(u=r===s?(o-a)/l:o===s?2+(a-r)/l:4+(r-o)/l)/6+(u<0?1:0)),[360*u,100*h,100*p]},e.hslToRgb=function(t,e,n){var r,o,a,s,c,l,u,h,p,d=(t%360+360)%360,f=i.default.constrain(e/100,0,1),m=i.default.constrain(n/100,0,1),v=(1-Math.abs(2*m-1))*f,y=v*(1-Math.abs(d/60%2-1)),g=m-v/2;return d>=0&&d<60?(u=(r=[v,y,0])[0],h=r[1],p=r[2]):d>=60&&d<120?(u=(o=[y,v,0])[0],h=o[1],p=o[2]):d>=120&&d<180?(u=(a=[0,v,y])[0],h=a[1],p=a[2]):d>=180&&d<240?(u=(s=[0,y,v])[0],h=s[1],p=s[2]):d>=240&&d<300?(u=(c=[y,0,v])[0],h=c[1],p=c[2]):(u=(l=[v,0,y])[0],h=l[1],p=l[2]),[255*(u+g),255*(h+g),255*(p+g)]},e.rgbToHsv=function(t,e,n){var r=i.default.constrain(t/255,0,1),o=i.default.constrain(e/255,0,1),a=i.default.constrain(n/255,0,1),s=Math.max(r,o,a),c=s-Math.min(r,o,a);return[0===c?0:s===r?((o-a)/c%6+6)%6*60:s===o?60*((a-r)/c+2):60*((r-o)/c+4),100*(0===s?0:c/s),100*s]},e.hsvToRgb=function(t,e,n){var r,o,a,s,c,l,u,h,p,d=(t%360+360)%360,f=i.default.constrain(e/100,0,1),m=i.default.constrain(n/100,0,1),v=m*f,y=v*(1-Math.abs(d/60%2-1)),g=m-v;return d>=0&&d<60?(u=(r=[v,y,0])[0],h=r[1],p=r[2]):d>=60&&d<120?(u=(o=[y,v,0])[0],h=o[1],p=o[2]):d>=120&&d<180?(u=(a=[0,v,y])[0],h=a[1],p=a[2]):d>=180&&d<240?(u=(s=[0,y,v])[0],h=s[1],p=s[2]):d>=240&&d<300?(u=(c=[y,0,v])[0],h=c[1],p=c[2]):(u=(l=[v,0,y])[0],h=l[1],p=l[2]),[255*(u+g),255*(h+g),255*(p+g)]}},"./src/main/js/misc/disposing-util.ts":
/*!********************************************!*\
  !*** ./src/main/js/misc/disposing-util.ts ***!
  \********************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.disposeElement=function(t){return t&&t.parentElement&&t.parentElement.removeChild(t),null}},"./src/main/js/misc/dom-util.ts":
/*!**************************************!*\
  !*** ./src/main/js/misc/dom-util.ts ***!
  \**************************************/
/*! no static exports found */function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ./type-util */"./src/main/js/misc/type-util.ts");e.forceReflow=function(t){t.offsetHeight},e.disableTransitionTemporarily=function(t,e){var n=t.style.transition;t.style.transition="none",e(),t.style.transition=n},e.supportsTouch=function(t){return void 0!==t.ontouchstart},e.getWindowDocument=function(){return i.default.forceCast(new Function("return this")()).document},e.getCanvasContext=function(e){return t.browser?e.getContext("2d"):null}}).call(this,n(/*! ./../../../../node_modules/process/browser.js */"./node_modules/process/browser.js"))},"./src/main/js/misc/emitter.ts":
/*!*************************************!*\
  !*** ./src/main/js/misc/emitter.ts ***!
  \*************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){this.observers_={}}return t.prototype.on=function(t,e){var n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this},t.prototype.off=function(t,e){var n=this.observers_[t];return n&&(this.observers_[t]=n.filter((function(t){return t.handler!==e}))),this},t.prototype.emit=function(t,e){var n=this.observers_[t];n&&n.forEach((function(t){var n=e||[];t.handler.apply(t,n)}))},t}();e.default=i},"./src/main/js/misc/number-util.ts":
/*!*****************************************!*\
  !*** ./src/main/js/misc/number-util.ts ***!
  \*****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={map:function(t,e,n,i,r){return i+(t-e)/(n-e)*(r-i)},getDecimalDigits:function(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length},constrain:function(t,e,n){return Math.min(Math.max(t,e),n)}};e.default=i},"./src/main/js/misc/pane-error.ts":
/*!****************************************!*\
  !*** ./src/main/js/misc/pane-error.ts ***!
  \****************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.message=function(t){return"alreadydisposed"===t.type?"View has been already disposed":"emptyvalue"===t.type?"Value is empty for "+t.context.key:"invalidparams"===t.type?"Invalid parameters for "+t.context.name:"nomatchingcontroller"===t.type?"No matching controller for "+t.context.key:"shouldneverhappen"===t.type?"This error should never happen":"Unexpected error"}(t),this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}return t.alreadyDisposed=function(){return new t({type:"alreadydisposed"})},t.shouldNeverHappen=function(){return new t({type:"shouldneverhappen"})},t}();e.default=i,i.prototype=Object.create(Error.prototype),i.prototype.constructor=i},"./src/main/js/misc/pointer-handler.ts":
/*!*********************************************!*\
  !*** ./src/main/js/misc/pointer-handler.ts ***!
  \*********************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ./dom-util */"./src/main/js/misc/dom-util.ts"),r=n(/*! ./emitter */"./src/main/js/misc/emitter.ts"),o=function(){function t(t,e){this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.document=t,this.element=e,this.emitter=new r.default,this.pressed_=!1,i.supportsTouch(this.document)?(e.addEventListener("touchstart",this.onTouchStart_),e.addEventListener("touchmove",this.onTouchMove_)):(e.addEventListener("mousedown",this.onMouseDown_),this.document.addEventListener("mousemove",this.onDocumentMouseMove_),this.document.addEventListener("mouseup",this.onDocumentMouseUp_))}return t.prototype.computePosition_=function(t,e){var n=this.element.getBoundingClientRect();return{px:t/n.width,py:e/n.height}},t.prototype.onMouseDown_=function(t){t.preventDefault(),this.pressed_=!0,this.emitter.emit("down",[this.computePosition_(t.offsetX,t.offsetY)])},t.prototype.onDocumentMouseMove_=function(t){if(this.pressed_){var e=this.document.defaultView,n=this.element.getBoundingClientRect();this.emitter.emit("move",[this.computePosition_(t.pageX-((e&&e.scrollX||0)+n.left),t.pageY-((e&&e.scrollY||0)+n.top))])}},t.prototype.onDocumentMouseUp_=function(t){if(this.pressed_){this.pressed_=!1;var e=this.document.defaultView,n=this.element.getBoundingClientRect();this.emitter.emit("up",[this.computePosition_(t.pageX-((e&&e.scrollX||0)+n.left),t.pageY-((e&&e.scrollY||0)+n.top))])}},t.prototype.onTouchStart_=function(t){t.preventDefault();var e=t.targetTouches[0],n=this.element.getBoundingClientRect();this.emitter.emit("down",[this.computePosition_(e.clientX-n.left,e.clientY-n.top)])},t.prototype.onTouchMove_=function(t){var e=t.targetTouches[0],n=this.element.getBoundingClientRect();this.emitter.emit("move",[this.computePosition_(e.clientX-n.left,e.clientY-n.top)])},t}();e.default=o},"./src/main/js/misc/ticker/interval.ts":
/*!*********************************************!*\
  !*** ./src/main/js/misc/ticker/interval.ts ***!
  \*********************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../emitter */"./src/main/js/misc/emitter.ts"),r=function(){function t(t,e){var n=this;if(this.onTick_=this.onTick_.bind(this),this.onWindowBlur_=this.onWindowBlur_.bind(this),this.onWindowFocus_=this.onWindowFocus_.bind(this),this.active_=!0,this.doc_=t,this.emitter=new i.default,e<=0)this.id_=null;else{var r=this.doc_.defaultView;r&&(this.id_=r.setInterval((function(){n.active_&&n.onTick_()}),e))}}return t.prototype.dispose=function(){if(null!==this.id_){var t=this.doc_.defaultView;t&&t.clearInterval(this.id_)}this.id_=null},t.prototype.onTick_=function(){this.emitter.emit("tick")},t.prototype.onWindowBlur_=function(){this.active_=!1},t.prototype.onWindowFocus_=function(){this.active_=!0},t}();e.default=r},"./src/main/js/misc/type-util.ts":
/*!***************************************!*\
  !*** ./src/main/js/misc/type-util.ts ***!
  \***************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={forceCast:function(t){return t},getOrDefault:function(t,e){return null!=t?t:e},ifNotEmpty:function(t,e,n){null!=t?e(t):n&&n()}};e.default=i},"./src/main/js/model/button.ts":
/*!*************************************!*\
  !*** ./src/main/js/model/button.ts ***!
  \*************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../misc/emitter */"./src/main/js/misc/emitter.ts"),r=function(){function t(t){this.emitter=new i.default,this.title=t}return t.prototype.click=function(){this.emitter.emit("click")},t}();e.default=r},"./src/main/js/model/color.ts":
/*!************************************!*\
  !*** ./src/main/js/model/color.ts ***!
  \************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../misc/emitter */"./src/main/js/misc/emitter.ts"),r=n(/*! ../misc/number-util */"./src/main/js/misc/number-util.ts");function o(t){return r.default.constrain(t,0,255)}var a=function(){function t(t,e,n){this.emitter=new i.default,this.comps_=[o(t),o(e),o(n)]}return t.prototype.getComponents=function(){return this.comps_},t.prototype.toObject=function(){return{r:this.comps_[0],g:this.comps_[1],b:this.comps_[2]}},t}();e.default=a},"./src/main/js/model/foldable.ts":
/*!***************************************!*\
  !*** ./src/main/js/model/foldable.ts ***!
  \***************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../misc/emitter */"./src/main/js/misc/emitter.ts"),r=function(){function t(){this.emitter=new i.default,this.expanded_=!1}return Object.defineProperty(t.prototype,"expanded",{get:function(){return this.expanded_},set:function(t){this.expanded_!==t&&(this.expanded_=t,this.emitter.emit("change"))},enumerable:!0,configurable:!0}),t}();e.default=r},"./src/main/js/model/folder.ts":
/*!*************************************!*\
  !*** ./src/main/js/model/folder.ts ***!
  \*************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../misc/emitter */"./src/main/js/misc/emitter.ts"),r=function(){function t(t,e){this.emitter=new i.default,this.expanded_=e,this.expandedHeight_=null,this.title=t}return Object.defineProperty(t.prototype,"expanded",{get:function(){return this.expanded_},set:function(t){this.expanded_!==t&&(this.expanded_=t,this.emitter.emit("change"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"expandedHeight",{get:function(){return this.expandedHeight_},set:function(t){this.expandedHeight_!==t&&(this.expandedHeight_=t,this.emitter.emit("change"))},enumerable:!0,configurable:!0}),t}();e.default=r},"./src/main/js/model/graph-cursor.ts":
/*!*******************************************!*\
  !*** ./src/main/js/model/graph-cursor.ts ***!
  \*******************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../misc/emitter */"./src/main/js/misc/emitter.ts"),r=function(){function t(){this.emitter=new i.default,this.index_=-1}return Object.defineProperty(t.prototype,"index",{get:function(){return this.index_},set:function(t){this.index_!==t&&(this.index_=t,this.emitter.emit("change",[t]))},enumerable:!0,configurable:!0}),t}();e.default=r},"./src/main/js/model/input-value.ts":
/*!******************************************!*\
  !*** ./src/main/js/model/input-value.ts ***!
  \******************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../misc/emitter */"./src/main/js/misc/emitter.ts"),r=function(){function t(t,e){this.constraint_=e,this.emitter=new i.default,this.rawValue_=t}return t.equalsValue=function(t,e){return t===e},Object.defineProperty(t.prototype,"constraint",{get:function(){return this.constraint_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rawValue",{get:function(){return this.rawValue_},set:function(e){var n=this.constraint_?this.constraint_.constrain(e):e;!t.equalsValue(this.rawValue_,n)&&(this.rawValue_=n,this.emitter.emit("change",[n]))},enumerable:!0,configurable:!0}),t}();e.default=r},"./src/main/js/model/list.ts":
/*!***********************************!*\
  !*** ./src/main/js/model/list.ts ***!
  \***********************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../misc/emitter */"./src/main/js/misc/emitter.ts"),r=function(){function t(){this.emitter=new i.default,this.items_=[]}return Object.defineProperty(t.prototype,"items",{get:function(){return this.items_},enumerable:!0,configurable:!0}),t.prototype.append=function(t){this.items_.push(t),this.emitter.emit("append",[t])},t}();e.default=r},"./src/main/js/model/monitor-value.ts":
/*!********************************************!*\
  !*** ./src/main/js/model/monitor-value.ts ***!
  \********************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../misc/emitter */"./src/main/js/misc/emitter.ts"),r=function(){function t(t){this.emitter=new i.default,this.rawValues_=[],this.totalCount_=t}return Object.defineProperty(t.prototype,"rawValues",{get:function(){return this.rawValues_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"totalCount",{get:function(){return this.totalCount_},enumerable:!0,configurable:!0}),t.prototype.append=function(t){this.rawValues_.push(t),this.rawValues_.length>this.totalCount_&&this.rawValues_.splice(0,this.rawValues_.length-this.totalCount_),this.emitter.emit("update",[t])},t}();e.default=r},"./src/main/js/model/target.ts":
/*!*************************************!*\
  !*** ./src/main/js/model/target.ts ***!
  \*************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../misc/type-util */"./src/main/js/misc/type-util.ts"),r=function(){function t(t,e,n){this.obj_=t,this.key_=e,this.presetKey_=i.default.getOrDefault(n,e)}return Object.defineProperty(t.prototype,"key",{get:function(){return this.key_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"presetKey",{get:function(){return this.presetKey_},enumerable:!0,configurable:!0}),t.prototype.read=function(){return this.obj_[this.key_]},t.prototype.write=function(t){this.obj_[this.key_]=t},t}();e.default=r},"./src/main/js/parser/color.ts":
/*!*************************************!*\
  !*** ./src/main/js/parser/color.ts ***!
  \*************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../model/color */"./src/main/js/model/color.ts"),r=[function(t){var e=t.match(/^#?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return e?new i.default(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)):null},function(t){var e=t.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);return e?new i.default(parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)):null}];e.default=function(t){return r.reduce((function(e,n){return e||n(t)}),null)}},"./src/main/js/parser/number.ts":
/*!**************************************!*\
  !*** ./src/main/js/parser/number.ts ***!
  \**************************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=parseFloat(t);return isNaN(e)?null:e}},"./src/main/js/tweakpane-without-style.ts":
/*!************************************************!*\
  !*** ./src/main/js/tweakpane-without-style.ts ***!
  \************************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ./api/root */"./src/main/js/api/root.ts"),a=n(/*! ./controller/root */"./src/main/js/controller/root.ts"),s=n(/*! ./misc/class-name */"./src/main/js/misc/class-name.ts"),c=n(/*! ./misc/dom-util */"./src/main/js/misc/dom-util.ts"),l=n(/*! ./misc/pane-error */"./src/main/js/misc/pane-error.ts"),u=n(/*! ./misc/type-util */"./src/main/js/misc/type-util.ts"),h=function(t){function e(e){var n=this,i=e||{},r=u.default.getOrDefault(i.document,c.getWindowDocument()),o=new a.default(r,{title:i.title});return(n=t.call(this,o)||this).containerElem_=i.container||function(t){var e=t.createElement("div");return e.classList.add(s.default("dfw")()),t.body&&t.body.appendChild(e),e}(r),n.containerElem_.appendChild(n.element),n.doc_=r,n.usesDefaultWrapper_=!i.container,n}return r(e,t),e.prototype.dispose=function(){var e=this.containerElem_;if(!e)throw l.default.alreadyDisposed();if(this.usesDefaultWrapper_){var n=e.parentElement;n&&n.removeChild(e)}this.containerElem_=null,this.doc_=null,t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"document",{get:function(){if(!this.doc_)throw l.default.alreadyDisposed();return this.doc_},enumerable:!0,configurable:!0}),e}(o.default);e.default=h},"./src/main/js/view/button.ts":
/*!************************************!*\
  !*** ./src/main/js/view/button.ts ***!
  \************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../misc/class-name */"./src/main/js/misc/class-name.ts"),a=n(/*! ../misc/disposing-util */"./src/main/js/misc/disposing-util.ts"),s=n(/*! ../misc/pane-error */"./src/main/js/misc/pane-error.ts"),c=n(/*! ./view */"./src/main/js/view/view.ts"),l=o.default("btn"),u=function(t){function e(e,n){var i=t.call(this,e)||this;i.button=n.button,i.element.classList.add(l());var r=e.createElement("button");return r.classList.add(l("b")),r.textContent=i.button.title,i.element.appendChild(r),i.buttonElem_=r,i}return r(e,t),Object.defineProperty(e.prototype,"buttonElement",{get:function(){if(!this.buttonElem_)throw s.default.alreadyDisposed();return this.buttonElem_},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.buttonElem_=a.disposeElement(this.buttonElem_),t.prototype.dispose.call(this)},e}(c.default);e.default=u},"./src/main/js/view/folder.ts":
/*!************************************!*\
  !*** ./src/main/js/view/folder.ts ***!
  \************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../misc/class-name */"./src/main/js/misc/class-name.ts"),a=n(/*! ../misc/disposing-util */"./src/main/js/misc/disposing-util.ts"),s=n(/*! ../misc/pane-error */"./src/main/js/misc/pane-error.ts"),c=n(/*! ../misc/type-util */"./src/main/js/misc/type-util.ts"),l=n(/*! ./view */"./src/main/js/view/view.ts"),u=o.default("fld"),h=function(t){function e(e,n){var i=t.call(this,e)||this;i.onFolderChange_=i.onFolderChange_.bind(i),i.folder_=n.folder,i.folder_.emitter.on("change",i.onFolderChange_),i.element.classList.add(u());var r=e.createElement("button");r.classList.add(u("t")),r.textContent=i.folder_.title,i.element.appendChild(r),i.titleElem_=r;var o=e.createElement("div");o.classList.add(u("m")),i.titleElem_.appendChild(o);var a=e.createElement("div");return a.classList.add(u("c")),i.element.appendChild(a),i.containerElem_=a,i.applyModel_(),i}return r(e,t),Object.defineProperty(e.prototype,"titleElement",{get:function(){if(!this.titleElem_)throw s.default.alreadyDisposed();return this.titleElem_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerElement",{get:function(){if(!this.containerElem_)throw s.default.alreadyDisposed();return this.containerElem_},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.containerElem_=a.disposeElement(this.containerElem_),this.titleElem_=a.disposeElement(this.titleElem_),t.prototype.dispose.call(this)},e.prototype.applyModel_=function(){var t=this.containerElem_;if(!t)throw s.default.alreadyDisposed();var e=this.folder_.expanded,n=u(void 0,"expanded");e?this.element.classList.add(n):this.element.classList.remove(n),c.default.ifNotEmpty(this.folder_.expandedHeight,(function(n){var i=e?n:0;t.style.height=i+"px"}),(function(){t.style.height=e?"auto":"0px"}))},e.prototype.onFolderChange_=function(){this.applyModel_()},e}(l.default);e.default=h},"./src/main/js/view/input/checkbox.ts":
/*!********************************************!*\
  !*** ./src/main/js/view/input/checkbox.ts ***!
  \********************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../../misc/class-name */"./src/main/js/misc/class-name.ts"),a=n(/*! ../../misc/disposing-util */"./src/main/js/misc/disposing-util.ts"),s=n(/*! ../../misc/pane-error */"./src/main/js/misc/pane-error.ts"),c=n(/*! ../view */"./src/main/js/view/view.ts"),l=o.default("ckb","input"),u=function(t){function e(e,n){var i=t.call(this,e)||this;i.onValueChange_=i.onValueChange_.bind(i),i.element.classList.add(l());var r=e.createElement("label");r.classList.add(l("l")),i.element.appendChild(r);var o=e.createElement("input");o.classList.add(l("i")),o.type="checkbox",r.appendChild(o),i.inputElem_=o;var a=e.createElement("div");return a.classList.add(l("m")),r.appendChild(a),n.value.emitter.on("change",i.onValueChange_),i.value=n.value,i.update(),i}return r(e,t),Object.defineProperty(e.prototype,"inputElement",{get:function(){if(!this.inputElem_)throw s.default.alreadyDisposed();return this.inputElem_},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.inputElem_=a.disposeElement(this.inputElem_),t.prototype.dispose.call(this)},e.prototype.update=function(){if(!this.inputElem_)throw s.default.alreadyDisposed();this.inputElem_.checked=this.value.rawValue},e.prototype.onValueChange_=function(){this.update()},e}(c.default);e.default=u},"./src/main/js/view/input/color-picker.ts":
/*!************************************************!*\
  !*** ./src/main/js/view/input/color-picker.ts ***!
  \************************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../../misc/class-name */"./src/main/js/misc/class-name.ts"),a=n(/*! ../view */"./src/main/js/view/view.ts"),s=o.default("clp","input"),c=function(t){function e(e,n){var i=t.call(this,e)||this;i.onFoldableChange_=i.onFoldableChange_.bind(i),i.onValueChange_=i.onValueChange_.bind(i),i.value=n.value,i.value.emitter.on("change",i.onValueChange_),i.foldable=n.foldable,i.foldable.emitter.on("change",i.onFoldableChange_),i.element.classList.add(s());var r=e.createElement("div");r.classList.add(s("pl"));var o=e.createElement("div");o.classList.add(s("sv")),i.svPaletteView_=n.svPaletteInputView,o.appendChild(i.svPaletteView_.element),r.appendChild(o);var a=e.createElement("div");a.classList.add(s("h")),i.hPaletteView_=n.hPaletteInputView,a.appendChild(i.hPaletteView_.element),r.appendChild(a),i.element.appendChild(r);var c=e.createElement("div");return c.classList.add(s("is")),i.rgbInputViews_=n.rgbInputViews,i.rgbInputViews_.forEach((function(t,n){var i=e.createElement("div");i.classList.add(s("iw"));var r=e.createElement("label");r.classList.add(s("il")),r.textContent=["R","G","B"][n],i.appendChild(r),i.appendChild(t.element),c.appendChild(i)})),i.element.appendChild(c),i.update(),i}return r(e,t),Object.defineProperty(e.prototype,"allFocusableElements",{get:function(){return[].concat(this.hPaletteView_.canvasElement,this.svPaletteView_.canvasElement,this.rgbInputViews_.map((function(t){return t.inputElement})))},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.hPaletteView_.dispose(),this.rgbInputViews_=[],this.svPaletteView_.dispose(),t.prototype.dispose.call(this)},e.prototype.update=function(){this.foldable.expanded?this.element.classList.add(s(void 0,"expanded")):this.element.classList.remove(s(void 0,"expanded")),this.rgbInputViews_.forEach((function(t){t.update()}))},e.prototype.onValueChange_=function(){this.update()},e.prototype.onFoldableChange_=function(){this.update()},e}(a.default);e.default=c},"./src/main/js/view/input/color-swatch-text.ts":
/*!*****************************************************!*\
  !*** ./src/main/js/view/input/color-swatch-text.ts ***!
  \*****************************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../../misc/class-name */"./src/main/js/misc/class-name.ts"),a=n(/*! ../view */"./src/main/js/view/view.ts"),s=o.default("cswtxt","input"),c=function(t){function e(e,n){var i=t.call(this,e)||this;i.element.classList.add(s());var r=e.createElement("div");r.classList.add(s("s")),i.swatchInputView_=n.swatchInputView,r.appendChild(i.swatchInputView_.element),i.element.appendChild(r);var o=e.createElement("div");return o.classList.add(s("t")),i.textInputView_=n.textInputView,o.appendChild(i.textInputView_.element),i.element.appendChild(o),i}return r(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.textInputView_.value},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.swatchInputView_.dispose(),this.textInputView_.dispose(),t.prototype.dispose.call(this)},e.prototype.update=function(){this.swatchInputView_.update(),this.textInputView_.update()},e}(a.default);e.default=c},"./src/main/js/view/input/color-swatch.ts":
/*!************************************************!*\
  !*** ./src/main/js/view/input/color-swatch.ts ***!
  \************************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../../converter/color */"./src/main/js/converter/color.ts"),a=n(/*! ../../misc/class-name */"./src/main/js/misc/class-name.ts"),s=n(/*! ../../misc/disposing-util */"./src/main/js/misc/disposing-util.ts"),c=n(/*! ../../misc/pane-error */"./src/main/js/misc/pane-error.ts"),l=n(/*! ../view */"./src/main/js/view/view.ts"),u=a.default("csw","input"),h=function(t){function e(e,n){var i=t.call(this,e)||this;if(null===i.element)throw c.default.alreadyDisposed();i.onValueChange_=i.onValueChange_.bind(i),n.value.emitter.on("change",i.onValueChange_),i.value=n.value,i.element.classList.add(u());var r=e.createElement("div");r.classList.add(u("sw")),i.element.appendChild(r),i.swatchElem_=r;var o=e.createElement("button");o.classList.add(u("b")),i.element.appendChild(o),i.buttonElem_=o;var a=e.createElement("div");return a.classList.add(u("p")),i.pickerView_=n.pickerInputView,a.appendChild(i.pickerView_.element),i.element.appendChild(a),i.update(),i}return r(e,t),Object.defineProperty(e.prototype,"buttonElement",{get:function(){if(null===this.buttonElem_)throw c.default.alreadyDisposed();return this.buttonElem_},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.pickerView_.dispose(),this.buttonElem_=s.disposeElement(this.buttonElem_),this.swatchElem_=s.disposeElement(this.swatchElem_),t.prototype.dispose.call(this)},e.prototype.update=function(){if(!this.swatchElem_)throw c.default.alreadyDisposed();var t=this.value.rawValue;this.swatchElem_.style.backgroundColor=o.toString(t)},e.prototype.onValueChange_=function(){this.update()},e}(l.default);e.default=h},"./src/main/js/view/input/h-palette.ts":
/*!*********************************************!*\
  !*** ./src/main/js/view/input/h-palette.ts ***!
  \*********************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../../formatter/color */"./src/main/js/formatter/color.ts"),a=n(/*! ../../misc/class-name */"./src/main/js/misc/class-name.ts"),s=n(/*! ../../misc/color-model */"./src/main/js/misc/color-model.ts"),c=n(/*! ../../misc/disposing-util */"./src/main/js/misc/disposing-util.ts"),l=n(/*! ../../misc/dom-util */"./src/main/js/misc/dom-util.ts"),u=n(/*! ../../misc/number-util */"./src/main/js/misc/number-util.ts"),h=n(/*! ../../misc/pane-error */"./src/main/js/misc/pane-error.ts"),p=n(/*! ../view */"./src/main/js/view/view.ts"),d=a.default("hpl","input"),f=function(t){function e(e,n){var i=t.call(this,e)||this;i.onValueChange_=i.onValueChange_.bind(i),i.value=n.value,i.value.emitter.on("change",i.onValueChange_),i.element.classList.add(d());var r=e.createElement("canvas");r.classList.add(d("c")),r.tabIndex=-1,i.element.appendChild(r),i.canvasElem_=r;var o=e.createElement("div");return o.classList.add(d("m")),i.element.appendChild(o),i.markerElem_=o,i.update(),i}return r(e,t),Object.defineProperty(e.prototype,"canvasElement",{get:function(){if(!this.canvasElem_)throw h.default.alreadyDisposed();return this.canvasElem_},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.canvasElem_=c.disposeElement(this.canvasElem_),this.markerElem_=c.disposeElement(this.markerElem_),t.prototype.dispose.call(this)},e.prototype.update=function(){if(!this.markerElem_)throw h.default.alreadyDisposed();var t=l.getCanvasContext(this.canvasElement);if(t){for(var e=this.canvasElement.width,n=this.canvasElement.height,i=Math.ceil(n/64),r=0;r<64;r++){var a=u.default.map(r,0,63,0,360),c=s.hsvToRgb(a,100,100);t.fillStyle=o.default.rgb.apply(o.default,c);var p=Math.floor(u.default.map(r,0,63,0,n-i));t.fillRect(0,p,e,i)}var d=this.value.rawValue,f=s.rgbToHsv.apply(s,d.getComponents()),m=u.default.map(f[0],0,360,0,100);this.markerElem_.style.top=m+"%"}},e.prototype.onValueChange_=function(){this.update()},e}(p.default);e.default=f},"./src/main/js/view/input/list.ts":
/*!****************************************!*\
  !*** ./src/main/js/view/input/list.ts ***!
  \****************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../../misc/class-name */"./src/main/js/misc/class-name.ts"),a=n(/*! ../../misc/disposing-util */"./src/main/js/misc/disposing-util.ts"),s=n(/*! ../../misc/pane-error */"./src/main/js/misc/pane-error.ts"),c=n(/*! ../view */"./src/main/js/view/view.ts"),l=o.default("lst","input"),u=function(t){function e(e,n){var i=t.call(this,e)||this;i.onValueChange_=i.onValueChange_.bind(i),i.element.classList.add(l()),i.stringifyValue_=n.stringifyValue;var r=e.createElement("select");r.classList.add(l("s")),n.options.forEach((function(t,n){var o=e.createElement("option");o.dataset.index=String(n),o.textContent=t.text,o.value=i.stringifyValue_(t.value),r.appendChild(o)})),i.element.appendChild(r),i.selectElem_=r;var o=e.createElement("div");return o.classList.add(l("m")),i.element.appendChild(o),n.value.emitter.on("change",i.onValueChange_),i.value=n.value,i.update(),i}return r(e,t),Object.defineProperty(e.prototype,"selectElement",{get:function(){if(!this.selectElem_)throw s.default.alreadyDisposed();return this.selectElem_},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.selectElem_=a.disposeElement(this.selectElem_),t.prototype.dispose.call(this)},e.prototype.update=function(){if(!this.selectElem_)throw s.default.alreadyDisposed();this.selectElem_.value=this.stringifyValue_(this.value.rawValue)},e.prototype.onValueChange_=function(){this.update()},e}(c.default);e.default=u},"./src/main/js/view/input/slider-text.ts":
/*!***********************************************!*\
  !*** ./src/main/js/view/input/slider-text.ts ***!
  \***********************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../../misc/class-name */"./src/main/js/misc/class-name.ts"),a=n(/*! ../view */"./src/main/js/view/view.ts"),s=o.default("sldtxt","input"),c=function(t){function e(e,n){var i=t.call(this,e)||this;i.element.classList.add(s());var r=e.createElement("div");r.classList.add(s("s")),i.sliderInputView_=n.sliderInputView,r.appendChild(i.sliderInputView_.element),i.element.appendChild(r);var o=e.createElement("div");return o.classList.add(s("t")),i.textInputView_=n.textInputView,o.appendChild(i.textInputView_.element),i.element.appendChild(o),i}return r(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.sliderInputView_.value},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.sliderInputView_.dispose(),this.textInputView_.dispose(),t.prototype.dispose.call(this)},e.prototype.update=function(){this.sliderInputView_.update(),this.textInputView_.update()},e}(a.default);e.default=c},"./src/main/js/view/input/slider.ts":
/*!******************************************!*\
  !*** ./src/main/js/view/input/slider.ts ***!
  \******************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../../misc/class-name */"./src/main/js/misc/class-name.ts"),a=n(/*! ../../misc/disposing-util */"./src/main/js/misc/disposing-util.ts"),s=n(/*! ../../misc/number-util */"./src/main/js/misc/number-util.ts"),c=n(/*! ../../misc/pane-error */"./src/main/js/misc/pane-error.ts"),l=n(/*! ../view */"./src/main/js/view/view.ts"),u=o.default("sld","input"),h=function(t){function e(e,n){var i=t.call(this,e)||this;i.onValueChange_=i.onValueChange_.bind(i),i.minValue_=n.minValue,i.maxValue_=n.maxValue,i.element.classList.add(u());var r=e.createElement("div");r.classList.add(u("o")),i.element.appendChild(r),i.outerElem_=r;var o=e.createElement("div");return o.classList.add(u("i")),i.outerElem_.appendChild(o),i.innerElem_=o,n.value.emitter.on("change",i.onValueChange_),i.value=n.value,i.update(),i}return r(e,t),Object.defineProperty(e.prototype,"outerElement",{get:function(){if(!this.outerElem_)throw c.default.alreadyDisposed();return this.outerElem_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"innerElement",{get:function(){if(!this.innerElem_)throw c.default.alreadyDisposed();return this.innerElem_},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.innerElem_=a.disposeElement(this.innerElem_),this.outerElem_=a.disposeElement(this.outerElem_),t.prototype.dispose.call(this)},e.prototype.update=function(){if(!this.innerElem_)throw c.default.alreadyDisposed();var t=s.default.map(this.value.rawValue,this.minValue_,this.maxValue_,0,100);this.innerElem_.style.width=t+"%"},e.prototype.onValueChange_=function(){this.update()},e}(l.default);e.default=h},"./src/main/js/view/input/sv-palette.ts":
/*!**********************************************!*\
  !*** ./src/main/js/view/input/sv-palette.ts ***!
  \**********************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../../formatter/color */"./src/main/js/formatter/color.ts"),a=n(/*! ../../misc/class-name */"./src/main/js/misc/class-name.ts"),s=n(/*! ../../misc/color-model */"./src/main/js/misc/color-model.ts"),c=n(/*! ../../misc/disposing-util */"./src/main/js/misc/disposing-util.ts"),l=n(/*! ../../misc/dom-util */"./src/main/js/misc/dom-util.ts"),u=n(/*! ../../misc/number-util */"./src/main/js/misc/number-util.ts"),h=n(/*! ../../misc/pane-error */"./src/main/js/misc/pane-error.ts"),p=n(/*! ../view */"./src/main/js/view/view.ts"),d=a.default("svp","input"),f=function(t){function e(e,n){var i=t.call(this,e)||this;i.onValueChange_=i.onValueChange_.bind(i),i.value=n.value,i.value.emitter.on("change",i.onValueChange_),i.element.classList.add(d());var r=e.createElement("canvas");r.classList.add(d("c")),r.tabIndex=-1,i.element.appendChild(r),i.canvasElem_=r;var o=e.createElement("div");return o.classList.add(d("m")),i.element.appendChild(o),i.markerElem_=o,i.update(),i}return r(e,t),Object.defineProperty(e.prototype,"canvasElement",{get:function(){if(!this.canvasElem_)throw h.default.alreadyDisposed();return this.canvasElem_},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.canvasElem_=c.disposeElement(this.canvasElem_),this.markerElem_=c.disposeElement(this.markerElem_),t.prototype.dispose.call(this)},e.prototype.update=function(){if(!this.markerElem_)throw h.default.alreadyDisposed();var t=l.getCanvasContext(this.canvasElement);if(t){for(var e=this.value.rawValue,n=s.rgbToHsv.apply(s,e.getComponents()),i=this.canvasElement.width,r=this.canvasElement.height,a=Math.ceil(i/64),c=Math.ceil(r/64),p=0;p<64;p++)for(var d=0;d<64;d++){var f=u.default.map(d,0,63,0,100),m=u.default.map(p,0,63,100,0),v=s.hsvToRgb(n[0],f,m);t.fillStyle=o.default.rgb.apply(o.default,v);var y=Math.floor(u.default.map(d,0,63,0,i-a)),g=Math.floor(u.default.map(p,0,63,0,r-c));t.fillRect(y,g,a,c)}var b=u.default.map(n[1],0,100,0,100);this.markerElem_.style.left=b+"%";var _=u.default.map(n[2],0,100,100,0);this.markerElem_.style.top=_+"%"}},e.prototype.onValueChange_=function(){this.update()},e}(p.default);e.default=f},"./src/main/js/view/input/text.ts":
/*!****************************************!*\
  !*** ./src/main/js/view/input/text.ts ***!
  \****************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../../misc/class-name */"./src/main/js/misc/class-name.ts"),a=n(/*! ../../misc/disposing-util */"./src/main/js/misc/disposing-util.ts"),s=n(/*! ../../misc/pane-error */"./src/main/js/misc/pane-error.ts"),c=n(/*! ../view */"./src/main/js/view/view.ts"),l=o.default("txt","input"),u=function(t){function e(e,n){var i=t.call(this,e)||this;i.onValueChange_=i.onValueChange_.bind(i),i.formatter_=n.formatter,i.element.classList.add(l());var r=e.createElement("input");return r.classList.add(l("i")),r.type="text",i.element.appendChild(r),i.inputElem_=r,n.value.emitter.on("change",i.onValueChange_),i.value=n.value,i.update(),i}return r(e,t),Object.defineProperty(e.prototype,"inputElement",{get:function(){if(!this.inputElem_)throw s.default.alreadyDisposed();return this.inputElem_},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.inputElem_=a.disposeElement(this.inputElem_),t.prototype.dispose.call(this)},e.prototype.update=function(){if(!this.inputElem_)throw s.default.alreadyDisposed();this.inputElem_.value=this.formatter_.format(this.value.rawValue)},e.prototype.onValueChange_=function(){this.update()},e}(c.default);e.default=u},"./src/main/js/view/labeled.ts":
/*!*************************************!*\
  !*** ./src/main/js/view/labeled.ts ***!
  \*************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../misc/class-name */"./src/main/js/misc/class-name.ts"),a=n(/*! ./view */"./src/main/js/view/view.ts"),s=o.default("lbl"),c=function(t){function e(e,n){var i=t.call(this,e)||this;i.label=n.label,i.element.classList.add(s());var r=e.createElement("div");r.classList.add(s("l")),r.textContent=i.label,i.element.appendChild(r);var o=e.createElement("div");return o.classList.add(s("v")),o.appendChild(n.view.element),i.element.appendChild(o),i}return r(e,t),e}(a.default);e.default=c},"./src/main/js/view/monitor/graph.ts":
/*!*******************************************!*\
  !*** ./src/main/js/view/monitor/graph.ts ***!
  \*******************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../../misc/class-name */"./src/main/js/misc/class-name.ts"),a=n(/*! ../../misc/disposing-util */"./src/main/js/misc/disposing-util.ts"),s=n(/*! ../../misc/number-util */"./src/main/js/misc/number-util.ts"),c=n(/*! ../../misc/pane-error */"./src/main/js/misc/pane-error.ts"),l=n(/*! ../view */"./src/main/js/view/view.ts"),u="http://www.w3.org/2000/svg",h=o.default("grp","monitor"),p=function(t){function e(e,n){var i=t.call(this,e)||this;i.onCursorChange_=i.onCursorChange_.bind(i),i.onValueUpdate_=i.onValueUpdate_.bind(i),i.element.classList.add(h()),i.formatter_=n.formatter,i.minValue_=n.minValue,i.maxValue_=n.maxValue,i.cursor_=n.cursor,i.cursor_.emitter.on("change",i.onCursorChange_);var r=e.createElementNS(u,"svg");r.classList.add(h("g")),i.element.appendChild(r),i.svgElem_=r;var o=e.createElementNS(u,"polyline");i.svgElem_.appendChild(o),i.lineElem_=o;var a=e.createElement("div");return a.classList.add(h("t")),i.element.appendChild(a),i.tooltipElem_=a,n.value.emitter.on("update",i.onValueUpdate_),i.value=n.value,i.update(),i}return r(e,t),Object.defineProperty(e.prototype,"graphElement",{get:function(){if(!this.svgElem_)throw c.default.alreadyDisposed();return this.svgElem_},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.lineElem_=a.disposeElement(this.lineElem_),this.svgElem_=a.disposeElement(this.svgElem_),this.tooltipElem_=a.disposeElement(this.tooltipElem_),t.prototype.dispose.call(this)},e.prototype.update=function(){var t=this.tooltipElem_;if(!this.lineElem_||!this.svgElem_||!t)throw c.default.alreadyDisposed();var e=this.svgElem_.getBoundingClientRect(),n=this.value.totalCount-1,i=this.minValue_,r=this.maxValue_;this.lineElem_.setAttributeNS(null,"points",this.value.rawValues.map((function(t,o){return[s.default.map(o,0,n,0,e.width),s.default.map(t,i,r,e.height,0)].join(",")})).join(" "));var o=this.value.rawValues[this.cursor_.index];if(void 0!==o){t.classList.add(h("t","valid"));var a=s.default.map(this.cursor_.index,0,n,0,e.width),l=s.default.map(o,i,r,e.height,0);t.style.left=a+"px",t.style.top=l+"px",t.textContent=""+this.formatter_.format(o)}else t.classList.remove(h("t","valid"))},e.prototype.onValueUpdate_=function(){this.update()},e.prototype.onCursorChange_=function(){this.update()},e}(l.default);e.default=p},"./src/main/js/view/monitor/multi-log.ts":
/*!***********************************************!*\
  !*** ./src/main/js/view/monitor/multi-log.ts ***!
  \***********************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../../misc/class-name */"./src/main/js/misc/class-name.ts"),a=n(/*! ../../misc/disposing-util */"./src/main/js/misc/disposing-util.ts"),s=n(/*! ../../misc/pane-error */"./src/main/js/misc/pane-error.ts"),c=n(/*! ../view */"./src/main/js/view/view.ts"),l=o.default("mll","monitor"),u=function(t){function e(e,n){var i=t.call(this,e)||this;i.onValueUpdate_=i.onValueUpdate_.bind(i),i.formatter_=n.formatter,i.element.classList.add(l());var r=e.createElement("textarea");return r.classList.add(l("i")),r.readOnly=!0,i.element.appendChild(r),i.textareaElem_=r,n.value.emitter.on("update",i.onValueUpdate_),i.value=n.value,i.update(),i}return r(e,t),e.prototype.dispose=function(){this.textareaElem_=a.disposeElement(this.textareaElem_),t.prototype.dispose.call(this)},e.prototype.update=function(){var t=this,e=this.textareaElem_;if(!e)throw s.default.alreadyDisposed();var n=e.scrollTop===e.scrollHeight-e.clientHeight;e.textContent=this.value.rawValues.map((function(e){return t.formatter_.format(e)})).join("\n"),n&&(e.scrollTop=e.scrollHeight)},e.prototype.onValueUpdate_=function(){this.update()},e}(c.default);e.default=u},"./src/main/js/view/monitor/single-log.ts":
/*!************************************************!*\
  !*** ./src/main/js/view/monitor/single-log.ts ***!
  \************************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../../misc/class-name */"./src/main/js/misc/class-name.ts"),a=n(/*! ../../misc/disposing-util */"./src/main/js/misc/disposing-util.ts"),s=n(/*! ../../misc/pane-error */"./src/main/js/misc/pane-error.ts"),c=n(/*! ../view */"./src/main/js/view/view.ts"),l=o.default("sgl","monitor"),u=function(t){function e(e,n){var i=t.call(this,e)||this;i.onValueUpdate_=i.onValueUpdate_.bind(i),i.formatter_=n.formatter,i.element.classList.add(l());var r=e.createElement("input");return r.classList.add(l("i")),r.readOnly=!0,r.type="text",i.element.appendChild(r),i.inputElem_=r,n.value.emitter.on("update",i.onValueUpdate_),i.value=n.value,i.update(),i}return r(e,t),e.prototype.dispose=function(){this.inputElem_=a.disposeElement(this.inputElem_),t.prototype.dispose.call(this)},e.prototype.update=function(){if(!this.inputElem_)throw s.default.alreadyDisposed();var t=this.value.rawValues;this.inputElem_.value=t.length>0?this.formatter_.format(t[t.length-1]):""},e.prototype.onValueUpdate_=function(){this.update()},e}(c.default);e.default=u},"./src/main/js/view/root.ts":
/*!**********************************!*\
  !*** ./src/main/js/view/root.ts ***!
  \**********************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../misc/class-name */"./src/main/js/misc/class-name.ts"),a=n(/*! ../misc/disposing-util */"./src/main/js/misc/disposing-util.ts"),s=n(/*! ../misc/pane-error */"./src/main/js/misc/pane-error.ts"),c=n(/*! ./view */"./src/main/js/view/view.ts"),l=o.default("rot"),u=function(t){function e(e,n){var i=t.call(this,e)||this;i.onFolderChange_=i.onFolderChange_.bind(i),i.folder_=n.folder,i.folder_&&i.folder_.emitter.on("change",i.onFolderChange_),i.element.classList.add(l());var r=i.folder_;if(r){var o=e.createElement("button");o.classList.add(l("t")),o.textContent=r.title,i.element.appendChild(o);var a=e.createElement("div");a.classList.add(l("m")),o.appendChild(a),i.titleElem_=o}var s=e.createElement("div");return s.classList.add(l("c")),i.element.appendChild(s),i.containerElem_=s,i.applyModel_(),i}return r(e,t),Object.defineProperty(e.prototype,"titleElement",{get:function(){return this.titleElem_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerElement",{get:function(){if(!this.containerElem_)throw s.default.alreadyDisposed();return this.containerElem_},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.containerElem_=a.disposeElement(this.containerElem_),this.folder_=null,this.titleElem_=a.disposeElement(this.titleElem_),t.prototype.dispose.call(this)},e.prototype.applyModel_=function(){var t=!this.folder_||this.folder_.expanded,e=l(void 0,"expanded");t?this.element.classList.add(e):this.element.classList.remove(e)},e.prototype.onFolderChange_=function(){this.applyModel_()},e}(c.default);e.default=u},"./src/main/js/view/separator.ts":
/*!***************************************!*\
  !*** ./src/main/js/view/separator.ts ***!
  \***************************************/
/*! no static exports found */function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(/*! ../misc/class-name */"./src/main/js/misc/class-name.ts"),a=n(/*! ./view */"./src/main/js/view/view.ts"),s=o.default("spt"),c=function(t){function e(e){var n=t.call(this,e)||this;n.element.classList.add(s());var i=e.createElement("hr");return i.classList.add(s("r")),n.element.appendChild(i),n}return r(e,t),e}(a.default);e.default=c},"./src/main/js/view/view.ts":
/*!**********************************!*\
  !*** ./src/main/js/view/view.ts ***!
  \**********************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ../misc/disposing-util */"./src/main/js/misc/disposing-util.ts"),r=n(/*! ../misc/pane-error */"./src/main/js/misc/pane-error.ts"),o=function(){function t(t){this.disposed_=!1,this.doc_=t,this.elem_=this.doc_.createElement("div")}return Object.defineProperty(t.prototype,"disposed",{get:function(){return this.disposed_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"document",{get:function(){if(!this.doc_)throw r.default.alreadyDisposed();return this.doc_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){if(!this.elem_)throw r.default.alreadyDisposed();return this.elem_},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.doc_=null,this.elem_=i.disposeElement(this.elem_),this.disposed_=!0},t}();e.default=o},"./src/main/sass/bundle.scss":
/*!***********************************!*\
  !*** ./src/main/sass/bundle.scss ***!
  \***********************************/
/*! no static exports found */function(t,e,n){(t.exports=n(/*! ../../../node_modules/css-loader/lib/css-base.js */"./node_modules/css-loader/lib/css-base.js")(!1)).push([t.i,".tp-fldv_t,.tp-rotv_t{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0;background-color:rgba(200,202,208,0.1);color:#c8cad0;cursor:pointer;display:block;height:24px;line-height:24px;overflow:hidden;padding-left:30px;position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%}.tp-fldv_t:hover,.tp-rotv_t:hover{background-color:rgba(200,202,208,0.15)}.tp-fldv_t:focus,.tp-rotv_t:focus{background-color:rgba(200,202,208,0.2)}.tp-fldv_t:active,.tp-rotv_t:active{background-color:rgba(200,202,208,0.25)}.tp-fldv_m,.tp-rotv_m{background:linear-gradient(to left, #c8cad0, #c8cad0 2px, transparent 2px, transparent 4px, #c8cad0 4px, #c8cad0);border-radius:2px;bottom:0;content:'';display:block;height:6px;left:12px;margin:auto;position:absolute;top:0;-webkit-transform:rotate(90deg);transform:rotate(90deg);transition:-webkit-transform 0.2s ease-in-out;transition:transform 0.2s ease-in-out;transition:transform 0.2s ease-in-out, -webkit-transform 0.2s ease-in-out;width:6px}.tp-fldv.tp-fldv-expanded .tp-fldv_m,.tp-rotv.tp-rotv-expanded .tp-rotv_m{-webkit-transform:none;transform:none}.tp-fldv_c>.tp-fldv:first-child,.tp-rotv_c>.tp-fldv:first-child{margin-top:-4px}.tp-fldv_c>.tp-fldv:last-child,.tp-rotv_c>.tp-fldv:last-child{margin-bottom:-4px}.tp-fldv_c>*+*,.tp-rotv_c>*+*{margin-top:4px}.tp-fldv_c>.tp-fldv+.tp-fldv,.tp-rotv_c>.tp-fldv+.tp-fldv{margin-top:0}.tp-fldv_c>.tp-sptv+.tp-sptv,.tp-rotv_c>.tp-sptv+.tp-sptv{margin-top:0}.tp-btnv{padding:0 4px}.tp-btnv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0;background-color:#adafb8;border-radius:2px;color:#2f3137;cursor:pointer;display:block;font-weight:bold;height:20px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}.tp-btnv_b:hover{background-color:#bbbcc4}.tp-btnv_b:focus{background-color:#c8cad0}.tp-btnv_b:active{background-color:#d6d7db}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv_c{border-left:rgba(200,202,208,0.1) solid 4px;box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height 0.2s ease-in-out, opacity 0.2s linear, padding 0.2s ease-in-out}.tp-fldv_t:hover+.tp-fldv_c{border-left-color:rgba(200,202,208,0.15)}.tp-fldv_t:focus+.tp-fldv_c{border-left-color:rgba(200,202,208,0.2)}.tp-fldv_t:active+.tp-fldv_c{border-left-color:rgba(200,202,208,0.25)}.tp-fldv.tp-fldv-expanded .tp-fldv_c{opacity:1;overflow:visible;padding-bottom:4px;padding-top:4px;-webkit-transform:none;transform:none;transition:height 0.2s ease-in-out, opacity 0.2s linear 0.2s, padding 0.2s ease-in-out}.tp-ckbiv_l{display:block;position:relative}.tp-ckbiv_i{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0;background:red;left:0;opacity:0;position:absolute;top:0}.tp-ckbiv_m{background-color:rgba(200,202,208,0.15);border-radius:2px;cursor:pointer;display:block;height:20px;position:relative;width:20px}.tp-ckbiv_m::before{background-color:#c8cad0;border-radius:2px;bottom:4px;content:'';display:block;left:4px;opacity:0;position:absolute;right:4px;top:4px}.tp-ckbiv_i:hover+.tp-ckbiv_m{background-color:rgba(200,202,208,0.15)}.tp-ckbiv_i:focus+.tp-ckbiv_m{background-color:rgba(200,202,208,0.25)}.tp-ckbiv_i:active+.tp-ckbiv_m{background-color:rgba(200,202,208,0.35)}.tp-ckbiv_i:checked+.tp-ckbiv_m::before{opacity:1}.tp-clpiv{background-color:#2f3137;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,0.2);display:none;padding:4px;position:relative;visibility:hidden;z-index:1000}.tp-clpiv.tp-clpiv-expanded{display:block;visibility:visible}.tp-clpiv_pl{display:flex}.tp-clpiv_h{margin-left:4px}.tp-clpiv_is{display:flex;margin-top:4px}.tp-clpiv_iw{align-items:center;display:flex}.tp-clpiv_iw+.tp-clpiv_iw{margin-left:4px}.tp-clpiv_il{color:rgba(200,202,208,0.8);margin-left:4px;margin-right:8px}.tp-clpiv_i{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0;background-color:rgba(200,202,208,0.15);border-radius:2px;box-sizing:border-box;color:#c8cad0;font-family:inherit;height:20px;line-height:20px;width:100%;padding:0 4px;width:100%}.tp-clpiv_i:hover{background-color:rgba(200,202,208,0.15)}.tp-clpiv_i:focus{background-color:rgba(200,202,208,0.25)}.tp-clpiv_i:active{background-color:rgba(200,202,208,0.35)}.tp-hpliv{border-radius:2px;overflow:hidden;position:relative}.tp-hpliv_c{cursor:crosshair;display:block;height:80px;width:20px}.tp-hpliv_m{border-radius:100%;border:rgba(255,255,255,0.75) solid 1px;box-shadow:0 1px 2px rgba(0,0,0,0.1);height:4px;left:50%;margin-left:-3px;margin-top:-3px;pointer-events:none;position:absolute;width:4px}.tp-svpiv{border-radius:2px;overflow:hidden;position:relative}.tp-svpiv_c{cursor:crosshair;display:block;height:80px;width:100%}.tp-svpiv_m{border-radius:100%;border:rgba(255,255,255,0.75) solid 1px;box-shadow:0 1px 2px rgba(0,0,0,0.1);height:4px;margin-left:-3px;margin-top:-3px;pointer-events:none;position:absolute;width:4px}.tp-lstiv{color:#c8cad0;display:block;padding:0;position:relative}.tp-lstiv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0;background-color:#adafb8;border-radius:2px;color:#2f3137;cursor:pointer;display:block;height:20px;line-height:20px;padding:0 4px;width:100%}.tp-lstiv_s:hover{background-color:#bbbcc4}.tp-lstiv_s:focus{background-color:#c8cad0}.tp-lstiv_s:active{background-color:#d6d7db}.tp-lstiv_m{border-color:#2f3137 transparent transparent;border-style:solid;border-width:3px;bottom:0;box-sizing:border-box;height:6px;margin:auto;pointer-events:none;position:absolute;right:6px;top:3px;width:6px}.tp-sldiv{color:#c8cad0;display:block;padding:0}.tp-sldiv_o{box-sizing:border-box;cursor:pointer;height:20px;margin:0 6px;position:relative}.tp-sldiv_o::before{background-color:rgba(200,202,208,0.2);border-radius:1px;bottom:0;content:'';display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldiv_i{height:100%;left:0;position:absolute;top:0}.tp-sldiv_i::before{background-color:#adafb8;border-radius:2px;bottom:0;content:'';display:block;height:12px;margin:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldiv_o:hover .tp-sldiv_i::before{background-color:#bbbcc4}.tp-sldiv_o:focus .tp-sldiv_i::before{background-color:#c8cad0}.tp-sldiv_o:active .tp-sldiv_i::before{background-color:#d6d7db}.tp-txtiv{color:#c8cad0;display:block;padding:0}.tp-txtiv_i{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0;background-color:rgba(200,202,208,0.15);border-radius:2px;box-sizing:border-box;color:#c8cad0;font-family:inherit;height:20px;line-height:20px;width:100%;padding:0 4px}.tp-txtiv_i:hover{background-color:rgba(200,202,208,0.15)}.tp-txtiv_i:focus{background-color:rgba(200,202,208,0.25)}.tp-txtiv_i:active{background-color:rgba(200,202,208,0.35)}.tp-cswiv_sw{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0;background-color:rgba(200,202,208,0.15);border-radius:2px;box-sizing:border-box;color:#c8cad0;font-family:inherit;height:20px;line-height:20px;width:100%}.tp-cswiv_sw:hover{background-color:rgba(200,202,208,0.15)}.tp-cswiv_sw:focus{background-color:rgba(200,202,208,0.25)}.tp-cswiv_sw:active{background-color:rgba(200,202,208,0.35)}.tp-cswiv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:20px;left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:20px}.tp-cswiv_b:focus::after{border:rgba(255,255,255,0.75) solid 2px;border-radius:2px;bottom:0;content:'';display:block;left:0;position:absolute;right:0;top:0}.tp-cswiv_p{left:-4px;position:absolute;right:-4px;top:20px}.tp-cswtxtiv{display:flex;position:relative}.tp-cswtxtiv_s{flex-grow:0;flex-shrink:0;width:20px}.tp-cswtxtiv_t{flex:1;margin-left:4px}.tp-sldtxtiv{display:flex}.tp-sldtxtiv_s{flex:2}.tp-sldtxtiv_t{flex:1;margin-left:4px}.tp-lblv{align-items:center;display:flex;padding-left:4px;padding-right:4px}.tp-lblv_l{color:rgba(200,202,208,0.8);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;padding-left:4px;padding-right:16px}.tp-lblv_v{flex-grow:0;flex-shrink:0;width:160px}.tp-grpmv{color:#c8cad0;display:block;padding:0;position:relative}.tp-grpmv_g{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0;background-color:rgba(24,24,27,0.5);border-radius:2px;box-sizing:border-box;color:rgba(200,202,208,0.7);height:20px;width:100%;display:block;height:60px}.tp-grpmv_g polyline{fill:none;stroke:rgba(200,202,208,0.7);stroke-linejoin:round}.tp-grpmv_t{font-size:0.9em;left:0;pointer-events:none;position:absolute;text-indent:4px;top:0;visibility:hidden}.tp-grpmv_t.tp-grpmv_t-valid{visibility:visible}.tp-grpmv_t::before{background-color:rgba(200,202,208,0.7);border-radius:100%;content:'';display:block;height:4px;left:-2px;position:absolute;top:-2px;width:4px}.tp-sglmv_i{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0;background-color:rgba(24,24,27,0.5);border-radius:2px;box-sizing:border-box;color:rgba(200,202,208,0.7);height:20px;width:100%;padding:0 4px}.tp-mllmv_i{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0;background-color:rgba(24,24,27,0.5);border-radius:2px;box-sizing:border-box;color:rgba(200,202,208,0.7);height:20px;width:100%;display:block;height:60px;line-height:20px;padding:0 4px;resize:none;white-space:pre}.tp-cswmv_sw{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0;background-color:rgba(24,24,27,0.5);border-radius:2px;box-sizing:border-box;color:rgba(200,202,208,0.7);height:20px;width:100%}.tp-rotv{background-color:#2f3137;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,0.2);font-family:\"Roboto Mono\",\"Source Code Pro\",Menlo,Courier,monospace;font-size:11px;font-weight:500;text-align:left}.tp-rotv_t{border-top-left-radius:6px;border-top-right-radius:6px}.tp-rotv_m{transition:none}.tp-rotv_c{box-sizing:border-box;height:0;overflow:hidden;padding-bottom:0;padding-top:0}.tp-rotv_c>.tp-fldv:first-child .tp-fldv_t{border-top-left-radius:6px;border-top-right-radius:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_c{height:auto;overflow:visible;padding-bottom:4px;padding-top:4px}.tp-sptv_r{background-color:rgba(24,24,27,0.3);border-width:0;display:block;height:4px;margin:0;width:100%}\n",""])}}).default},t.exports=i()},,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(29),r=n(34),o=n(35),a=n(36),s=n(37),c=n(38),l=n(39),u=n(21),h=n(22),p=n(23),d=n(40),f=n(41),m=n(42),v=n(43),y=n(24),g=n(44),b=n(45),_=n(46),w=n(47),x=n(48),E=n(49),S=n(50),C=n(51),k=n(52),P=n(53),T=n(54),O=n(55),A=n(56),M=n(57),j=n(58),R=n(59),D=n(60),N=n(61),I=n(62),L=n(63),B=n(64),F=n(65);e.Konva=i.Konva.Util._assign(i.Konva,{Arc:r.Arc,Arrow:o.Arrow,Circle:a.Circle,Ellipse:s.Ellipse,Image:c.Image,Label:l.Label,Tag:l.Tag,Line:u.Line,Path:h.Path,Rect:p.Rect,RegularPolygon:d.RegularPolygon,Ring:f.Ring,Sprite:m.Sprite,Star:v.Star,Text:y.Text,TextPath:g.TextPath,Transformer:b.Transformer,Wedge:_.Wedge,Filters:{Blur:w.Blur,Brighten:x.Brighten,Contrast:E.Contrast,Emboss:S.Emboss,Enhance:C.Enhance,Grayscale:k.Grayscale,HSL:P.HSL,HSV:T.HSV,Invert:O.Invert,Kaleidoscope:A.Kaleidoscope,Mask:M.Mask,Noise:j.Noise,Pixelate:R.Pixelate,Posterize:D.Posterize,RGB:N.RGB,RGBA:I.RGBA,Sepia:L.Sepia,Solarize:B.Solarize,Threshold:F.Threshold}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=n(4),o=n(5),a=n(10),s=n(30),c=n(31),l=n(32),u=n(15),h=n(13),p=n(6),d=n(16),f=n(33),m=n(18),v=n(11);e.Konva=r.Util._assign(i.Konva,{Collection:r.Collection,Util:r.Util,Node:o.Node,ids:o.ids,names:o.names,Container:a.Container,Stage:s.Stage,stages:s.stages,Layer:c.Layer,FastLayer:l.FastLayer,Group:u.Group,DD:h.DD,Shape:p.Shape,shapes:p.shapes,Animation:d.Animation,Tween:f.Tween,Easings:f.Easings,Context:m.Context,Canvas:v.Canvas})},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(10),c=n(2),l=n(11),u=n(13),h=n(2),p=n(19),d="_",f=["mouseenter","mousedown","mousemove","mouseup","mouseout","touchstart","touchmove","touchend","mouseover","wheel","contextmenu","pointerdown","pointermove","pointerup","pointercancel","lostpointercapture"],m=f.length;function v(t,e){t.content.addEventListener(e,(function(n){t[d+e](n)}),!1)}function y(t){return void 0===t&&(t={}),(t.clipFunc||t.clipWidth||t.clipHeight)&&o.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),t}e.stages=[];var g=function(t){function n(n){var i=t.call(this,y(n))||this;return i._pointerPositions=[],i._changedPointerPositions=[],i._buildDOM(),i._bindContentEvents(),e.stages.push(i),i.on("widthChange.konva heightChange.konva",i._resizeDOM),i.on("visibleChange.konva",i._checkVisibility),i.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",(function(){y(i.attrs)})),i._checkVisibility(),i}return r(n,t),n.prototype._validateAdd=function(t){var e="Layer"===t.getType(),n="FastLayer"===t.getType();e||n||o.Util.throw("You may only add layers to the stage.")},n.prototype._checkVisibility=function(){var t=this.visible()?"":"none";this.content.style.display=t},n.prototype.setContainer=function(t){if("string"==typeof t){if("."===t.charAt(0)){var e=t.slice(1);t=document.getElementsByClassName(e)[0]}else{var n;n="#"!==t.charAt(0)?t:t.slice(1),t=document.getElementById(n)}if(!t)throw"Can not find container in document with id "+n}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this},n.prototype.shouldDrawHit=function(){return!0},n.prototype.clear=function(){var t,e=this.children,n=e.length;for(t=0;t<n;t++)e[t].clear();return this},n.prototype.clone=function(t){return t||(t={}),t.container=document.createElement("div"),s.Container.prototype.clone.call(this,t)},n.prototype.destroy=function(){t.prototype.destroy.call(this);var n=this.content;n&&o.Util._isInDocument(n)&&this.container().removeChild(n);var i=e.stages.indexOf(this);return i>-1&&e.stages.splice(i,1),this},n.prototype.getPointerPosition=function(){var t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(o.Util.warn("Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);"),null)},n.prototype._getPointerById=function(t){return this._pointerPositions.find((function(e){return e.id===t}))},n.prototype.getPointersPositions=function(){return this._pointerPositions},n.prototype.getStage=function(){return this},n.prototype.getContent=function(){return this.content},n.prototype._toKonvaCanvas=function(t){var e=(t=t||{}).x||0,n=t.y||0,i=new l.SceneCanvas({width:t.width||this.width(),height:t.height||this.height(),pixelRatio:t.pixelRatio||1}),r=i.getContext()._context,o=this.children;return(e||n)&&r.translate(-1*e,-1*n),o.each((function(i){if(i.isVisible()){var o=i._toKonvaCanvas(t);r.drawImage(o._canvas,e,n,o.getWidth()/o.getPixelRatio(),o.getHeight()/o.getPixelRatio())}})),i},n.prototype.getIntersection=function(t,e){if(!t)return null;var n,i,r=this.children;for(n=r.length-1;n>=0;n--)if(i=r[n].getIntersection(t,e))return i;return null},n.prototype._resizeDOM=function(){if(this.content){var t,e,n=this.width(),i=this.height(),r=this.getChildren(),o=r.length;for(this.content.style.width=n+"px",this.content.style.height=i+"px",this.bufferCanvas.setSize(n,i),this.bufferHitCanvas.setSize(n,i),t=0;t<o;t++)(e=r[t]).setSize({width:n,height:i}),e.draw()}},n.prototype.add=function(e){if(arguments.length>1){for(var n=0;n<arguments.length;n++)this.add(arguments[n]);return this}t.prototype.add.call(this,e);var i=this.children.length;return i>5&&o.Util.warn("The stage has "+i+" layers. Recommended maximin number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),e._setCanvasSize(this.width(),this.height()),e.draw(),c.Konva.isBrowser&&this.content.appendChild(e.canvas._canvas),this},n.prototype.getParent=function(){return null},n.prototype.getLayer=function(){return null},n.prototype.hasPointerCapture=function(t){return p.hasPointerCapture(t,this)},n.prototype.setPointerCapture=function(t){p.setPointerCapture(t,this)},n.prototype.releaseCapture=function(t){p.releaseCapture(t,this)},n.prototype.getLayers=function(){return this.getChildren()},n.prototype._bindContentEvents=function(){if(c.Konva.isBrowser)for(var t=0;t<m;t++)v(this,f[t])},n.prototype._mouseenter=function(t){this.setPointersPositions(t),this._fire("mouseenter",{evt:t,target:this,currentTarget:this})},n.prototype._mouseover=function(t){this.setPointersPositions(t),this._fire("contentMouseover",{evt:t}),this._fire("mouseover",{evt:t,target:this,currentTarget:this})},n.prototype._mouseout=function(t){this.setPointersPositions(t);var e=this.targetShape,n=!u.DD.isDragging||c.Konva.hitOnDragEnabled;e&&n?(e._fireAndBubble("mouseout",{evt:t}),e._fireAndBubble("mouseleave",{evt:t}),this.targetShape=null):n&&(this._fire("mouseleave",{evt:t,target:this,currentTarget:this}),this._fire("mouseout",{evt:t,target:this,currentTarget:this})),this.pointerPos=void 0,this._pointerPositions=[],this._fire("contentMouseout",{evt:t})},n.prototype._mousemove=function(t){if(c.Konva.UA.ieMobile)return this._touchmove(t);this.setPointersPositions(t);var e,n=o.Util._getFirstPointerId(t),i=!u.DD.isDragging||c.Konva.hitOnDragEnabled;if(i){if((e=this.getIntersection(this.getPointerPosition()))&&e.isListening()){var r=!this.targetShape||this.targetShape!==e;i&&r?(this.targetShape&&(this.targetShape._fireAndBubble("mouseout",{evt:t,pointerId:n},e),this.targetShape._fireAndBubble("mouseleave",{evt:t,pointerId:n},e)),e._fireAndBubble("mouseover",{evt:t,pointerId:n},this.targetShape),e._fireAndBubble("mouseenter",{evt:t,pointerId:n},this.targetShape),e._fireAndBubble("mousemove",{evt:t,pointerId:n}),this.targetShape=e):e._fireAndBubble("mousemove",{evt:t,pointerId:n})}else this.targetShape&&i&&(this.targetShape._fireAndBubble("mouseout",{evt:t,pointerId:n}),this.targetShape._fireAndBubble("mouseleave",{evt:t,pointerId:n}),this._fire("mouseover",{evt:t,target:this,currentTarget:this,pointerId:n}),this.targetShape=null),this._fire("mousemove",{evt:t,target:this,currentTarget:this,pointerId:n});this._fire("contentMousemove",{evt:t})}t.cancelable&&t.preventDefault()},n.prototype._mousedown=function(t){if(c.Konva.UA.ieMobile)return this._touchstart(t);this.setPointersPositions(t);var e=o.Util._getFirstPointerId(t),n=this.getIntersection(this.getPointerPosition());c.Konva.listenClickTap=!0,n&&n.isListening()?(this.clickStartShape=n,n._fireAndBubble("mousedown",{evt:t,pointerId:e})):this._fire("mousedown",{evt:t,target:this,currentTarget:this,pointerId:e}),this._fire("contentMousedown",{evt:t})},n.prototype._mouseup=function(t){if(c.Konva.UA.ieMobile)return this._touchend(t);this.setPointersPositions(t);var e=o.Util._getFirstPointerId(t),n=this.getIntersection(this.getPointerPosition()),i=this.clickStartShape,r=this.clickEndShape,a=!1;c.Konva.inDblClickWindow?(a=!0,clearTimeout(this.dblTimeout)):u.DD.justDragged?u.DD&&(u.DD.justDragged=!1):(c.Konva.inDblClickWindow=!0,clearTimeout(this.dblTimeout)),this.dblTimeout=setTimeout((function(){c.Konva.inDblClickWindow=!1}),c.Konva.dblClickWindow),n&&n.isListening()?(this.clickEndShape=n,n._fireAndBubble("mouseup",{evt:t,pointerId:e}),c.Konva.listenClickTap&&i&&i._id===n._id&&(n._fireAndBubble("click",{evt:t,pointerId:e}),a&&r&&r===n&&n._fireAndBubble("dblclick",{evt:t,pointerId:e}))):(this._fire("mouseup",{evt:t,target:this,currentTarget:this,pointerId:e}),c.Konva.listenClickTap&&this._fire("click",{evt:t,target:this,currentTarget:this,pointerId:e}),a&&this._fire("dblclick",{evt:t,target:this,currentTarget:this,pointerId:e})),this._fire("contentMouseup",{evt:t}),c.Konva.listenClickTap&&(this._fire("contentClick",{evt:t}),a&&this._fire("contentDblclick",{evt:t})),c.Konva.listenClickTap=!1,t.cancelable&&t.preventDefault()},n.prototype._contextmenu=function(t){this.setPointersPositions(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble("contextmenu",{evt:t}):this._fire("contextmenu",{evt:t,target:this,currentTarget:this}),this._fire("contentContextmenu",{evt:t})},n.prototype._touchstart=function(t){var e=this;this.setPointersPositions(t);var n=!1;this._changedPointerPositions.forEach((function(i){var r=e.getIntersection(i);c.Konva.listenClickTap=!0,r&&r.isListening()&&(c.Konva.captureTouchEventsEnabled&&r.setPointerCapture(i.id),e.tapStartShape=r,r._fireAndBubble("touchstart",{evt:t,pointerId:i.id},e),n=!0,r.isListening()&&r.preventDefault()&&t.cancelable&&t.preventDefault())})),n||this._fire("touchstart",{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),this._fire("contentTouchstart",{evt:t})},n.prototype._touchmove=function(t){var e=this;if(this.setPointersPositions(t),!u.DD.isDragging||c.Konva.hitOnDragEnabled){var n=!1,i={};this._changedPointerPositions.forEach((function(r){var o=p.getCapturedShape(r.id)||e.getIntersection(r);o&&o.isListening()&&(i[o._id]||(i[o._id]=!0,o._fireAndBubble("touchmove",{evt:t,pointerId:r.id}),n=!0,o.isListening()&&o.preventDefault()&&t.cancelable&&t.preventDefault()))})),n||this._fire("touchmove",{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),this._fire("contentTouchmove",{evt:t})}u.DD.isDragging&&u.DD.node.preventDefault()&&t.cancelable&&t.preventDefault()},n.prototype._touchend=function(t){var e=this;this.setPointersPositions(t);var n=this.clickEndShape,i=!1;c.Konva.inDblClickWindow?(i=!0,clearTimeout(this.dblTimeout)):u.DD.justDragged||(c.Konva.inDblClickWindow=!0,clearTimeout(this.dblTimeout)),this.dblTimeout=setTimeout((function(){c.Konva.inDblClickWindow=!1}),c.Konva.dblClickWindow);var r=!1,o={},a=!1,s=!1;this._changedPointerPositions.forEach((function(l){var u=p.getCapturedShape(l.id)||e.getIntersection(l);u&&u.releaseCapture(l.id),u&&u.isListening()&&(o[u._id]||(o[u._id]=!0,e.clickEndShape=u,u._fireAndBubble("touchend",{evt:t,pointerId:l.id}),r=!0,c.Konva.listenClickTap&&u===e.tapStartShape&&(a=!0,u._fireAndBubble("tap",{evt:t,pointerId:l.id}),i&&n&&n===u&&(s=!0,u._fireAndBubble("dbltap",{evt:t,pointerId:l.id}))),u.isListening()&&u.preventDefault()&&t.cancelable&&t.preventDefault()))})),r||this._fire("touchend",{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),c.Konva.listenClickTap&&!a&&this._fire("tap",{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i&&!s&&this._fire("dbltap",{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),this._fire("contentTouchend",{evt:t}),c.Konva.listenClickTap&&(this._fire("contentTap",{evt:t}),i&&this._fire("contentDbltap",{evt:t})),c.Konva.listenClickTap=!1},n.prototype._wheel=function(t){this.setPointersPositions(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble("wheel",{evt:t}):this._fire("wheel",{evt:t,target:this,currentTarget:this}),this._fire("contentWheel",{evt:t})},n.prototype._pointerdown=function(t){if(c.Konva._pointerEventsEnabled){this.setPointersPositions(t);var e=p.getCapturedShape(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble("pointerdown",p.createEvent(t))}},n.prototype._pointermove=function(t){if(c.Konva._pointerEventsEnabled){this.setPointersPositions(t);var e=p.getCapturedShape(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble("pointermove",p.createEvent(t))}},n.prototype._pointerup=function(t){if(c.Konva._pointerEventsEnabled){this.setPointersPositions(t);var e=p.getCapturedShape(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble("pointerup",p.createEvent(t)),p.releaseCapture(t.pointerId)}},n.prototype._pointercancel=function(t){if(c.Konva._pointerEventsEnabled){this.setPointersPositions(t);var e=p.getCapturedShape(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble("pointerup",p.createEvent(t)),p.releaseCapture(t.pointerId)}},n.prototype._lostpointercapture=function(t){p.releaseCapture(t.pointerId)},n.prototype.setPointersPositions=function(t){var e=this,n=this._getContentPosition(),i=null,r=null;if(void 0!==(t=t||window.event).touches){if(this._pointerPositions=[],this._changedPointerPositions=[],o.Collection.prototype.each.call(t.touches,(function(t){e._pointerPositions.push({id:t.identifier,x:t.clientX-n.left,y:t.clientY-n.top})})),o.Collection.prototype.each.call(t.changedTouches||t.touches,(function(t){e._changedPointerPositions.push({id:t.identifier,x:t.clientX-n.left,y:t.clientY-n.top})})),t.touches.length>0){var a=t.touches[0];i=a.clientX-n.left,r=a.clientY-n.top}}else i=t.clientX-n.left,r=t.clientY-n.top,this.pointerPos={x:i,y:r},this._pointerPositions=[{x:i,y:r,id:o.Util._getFirstPointerId(t)}],this._changedPointerPositions=[{x:i,y:r,id:o.Util._getFirstPointerId(t)}]},n.prototype._setPointerPosition=function(t){o.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)},n.prototype._getContentPosition=function(){var t=this.content.getBoundingClientRect?this.content.getBoundingClientRect():{top:0,left:0};return{top:t.top,left:t.left}},n.prototype._buildDOM=function(){if(this.bufferCanvas=new l.SceneCanvas,this.bufferHitCanvas=new l.HitCanvas({pixelRatio:1}),c.Konva.isBrowser){var t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}},n.prototype.cache=function(){return o.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this},n.prototype.clearCache=function(){return this},n.prototype.batchDraw=function(){return this.children.each((function(t){t.batchDraw()})),this},n}(s.Container);e.Stage=g,g.prototype.nodeType="Stage",h._registerNode(g),a.Factory.addGetterSetter(g,"container")},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(10),s=n(1),c=n(20),l=n(11),u=n(6),h=n(3),p=n(2),d=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],f=d.length,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hitCanvas=new l.HitCanvas({pixelRatio:1}),e}return r(e,t),e.prototype._setCanvasSize=function(t,e){this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._checkSmooth()},e.prototype._validateAdd=function(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&o.Util.throw("You may only add groups and shapes to a layer.")},e.prototype.getIntersection=function(t,e){var n,i,r,o;if(!this.hitGraphEnabled()||!this.isVisible())return null;for(var a=1,s=!1;;){for(i=0;i<f;i++){if(r=d[i],(o=(n=this._getIntersection({x:t.x+r.x*a,y:t.y+r.y*a})).shape)&&e)return o.findAncestor(e,!0);if(o)return o;if(s=!!n.antialiased,!n.antialiased)break}if(!s)return null;a+=1}},e.prototype._getIntersection=function(t){var e,n,i=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(t.x*i),Math.round(t.y*i),1,1).data,a=r[3];return 255===a?(e=o.Util._rgbToHex(r[0],r[1],r[2]),(n=u.shapes["#"+e])?{shape:n}:{antialiased:!0}):a>0?{antialiased:!0}:{}},e.prototype.drawScene=function(t,e){var n=this.getLayer(),i=t||n&&n.getCanvas();return this._fire("beforeDraw",{node:this}),this.clearBeforeDraw()&&i.getContext().clear(),a.Container.prototype.drawScene.call(this,i,e),this._fire("draw",{node:this}),this},e.prototype.drawHit=function(t,e){var n=this.getLayer(),i=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),a.Container.prototype.drawHit.call(this,i,e),this},e.prototype.clear=function(t){return c.BaseLayer.prototype.clear.call(this,t),this.getHitCanvas().getContext().clear(t),this},e.prototype.enableHitGraph=function(){return this.hitGraphEnabled(!0),this},e.prototype.disableHitGraph=function(){return this.hitGraphEnabled(!1),this},e.prototype.toggleHitCanvas=function(){if(this.parent){var t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}},e.prototype.setSize=function(e){var n=e.width,i=e.height;return t.prototype.setSize.call(this,{width:n,height:i}),this.hitCanvas.setSize(n,i),this},e}(c.BaseLayer);e.Layer=m,m.prototype.nodeType="Layer",p._registerNode(m),s.Factory.addGetterSetter(m,"hitGraphEnabled",!0,h.getBooleanValidator()),o.Collection.mapMethods(m)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(10),s=n(20),c=n(2),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._validateAdd=function(t){"Shape"!==t.getType()&&o.Util.throw("You may only add shapes to a fast layer.")},e.prototype._setCanvasSize=function(t,e){this.canvas.setSize(t,e),this._checkSmooth()},e.prototype.hitGraphEnabled=function(){return!1},e.prototype.drawScene=function(t){var e=this.getLayer(),n=t||e&&e.getCanvas();return this.clearBeforeDraw()&&n.getContext().clear(),a.Container.prototype.drawScene.call(this,n),this},e.prototype.draw=function(){return this.drawScene(),this},e}(s.BaseLayer);e.FastLayer=l,l.prototype.nodeType="FastLayer",c._registerNode(l),o.Collection.mapMethods(l)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),r=n(16),o=n(5),a=n(2),s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},c=0,l=["fill","stroke","shadowColor"],u=function(){function t(t,e,n,i,r,o,a){this.prop=t,this.propFunc=e,this.begin=i,this._pos=i,this.duration=o,this._change=0,this.prevPos=0,this.yoyo=a,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=r-this.begin,this.pause()}return t.prototype.fire=function(t){var e=this[t];e&&e()},t.prototype.setTime=function(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())},t.prototype.getTime=function(){return this._time},t.prototype.setPosition=function(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t},t.prototype.getPosition=function(t){return void 0===t&&(t=this._time),this.func(t,this.begin,this._change,this.duration)},t.prototype.play=function(){this.state=2,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")},t.prototype.reverse=function(){this.state=3,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")},t.prototype.seek=function(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")},t.prototype.reset=function(){this.pause(),this._time=0,this.update(),this.fire("onReset")},t.prototype.finish=function(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")},t.prototype.update=function(){this.setPosition(this.getPosition(this._time))},t.prototype.onEnterFrame=function(){var t=this.getTimer()-this._startTime;2===this.state?this.setTime(t):3===this.state&&this.setTime(this.duration-t)},t.prototype.pause=function(){this.state=1,this.fire("onPause")},t.prototype.getTimer=function(){return(new Date).getTime()},t}(),h=function(){function t(n){var o,l,h=this,p=n.node,d=p._id,f=n.easing||e.Easings.Linear,m=!!n.yoyo;o=void 0===n.duration?.3:0===n.duration?.001:n.duration,this.node=p,this._id=c++;var v=p.getLayer()||(p instanceof a.Konva.Stage?p.getLayers():null);for(l in v||i.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation((function(){h.tween.onEnterFrame()}),v),this.tween=new u(l,(function(t){h._tweenFunc(t)}),f,0,1,1e3*o,m),this._addListeners(),t.attrs[d]||(t.attrs[d]={}),t.attrs[d][this._id]||(t.attrs[d][this._id]={}),t.tweens[d]||(t.tweens[d]={}),n)void 0===s[l]&&this._addAttr(l,n[l]);this.reset(),this.onFinish=n.onFinish,this.onReset=n.onReset}return t.prototype._addAttr=function(e,n){var r,o,a,s,c,u,h,p,d=this.node,f=d._id;if((a=t.tweens[f][e])&&delete t.attrs[f][a][e],r=d.getAttr(e),i.Util._isArray(n))if(o=[],c=Math.max(n.length,r.length),"points"===e&&n.length!==r.length&&(n.length>r.length?(h=r,r=i.Util._prepareArrayForTween(r,n,d.closed())):(u=n,n=i.Util._prepareArrayForTween(n,r,d.closed()))),0===e.indexOf("fill"))for(s=0;s<c;s++)if(s%2==0)o.push(n[s]-r[s]);else{var m=i.Util.colorToRGBA(r[s]);p=i.Util.colorToRGBA(n[s]),r[s]=m,o.push({r:p.r-m.r,g:p.g-m.g,b:p.b-m.b,a:p.a-m.a})}else for(s=0;s<c;s++)o.push(n[s]-r[s]);else-1!==l.indexOf(e)?(r=i.Util.colorToRGBA(r),o={r:(p=i.Util.colorToRGBA(n)).r-r.r,g:p.g-r.g,b:p.b-r.b,a:p.a-r.a}):o=n-r;t.attrs[f][this._id][e]={start:r,diff:o,end:n,trueEnd:u,trueStart:h},t.tweens[f][e]=this._id},t.prototype._tweenFunc=function(e){var n,r,o,a,s,c,u,h,p=this.node,d=t.attrs[p._id][this._id];for(n in d){if(o=(r=d[n]).start,a=r.diff,h=r.end,i.Util._isArray(o))if(s=[],u=Math.max(o.length,h.length),0===n.indexOf("fill"))for(c=0;c<u;c++)c%2==0?s.push((o[c]||0)+a[c]*e):s.push("rgba("+Math.round(o[c].r+a[c].r*e)+","+Math.round(o[c].g+a[c].g*e)+","+Math.round(o[c].b+a[c].b*e)+","+(o[c].a+a[c].a*e)+")");else for(c=0;c<u;c++)s.push((o[c]||0)+a[c]*e);else s=-1!==l.indexOf(n)?"rgba("+Math.round(o.r+a.r*e)+","+Math.round(o.g+a.g*e)+","+Math.round(o.b+a.b*e)+","+(o.a+a.a*e)+")":o+a*e;p.setAttr(n,s)}},t.prototype._addListeners=function(){var e=this;this.tween.onPlay=function(){e.anim.start()},this.tween.onReverse=function(){e.anim.start()},this.tween.onPause=function(){e.anim.stop()},this.tween.onFinish=function(){var n=e.node,i=t.attrs[n._id][e._id];i.points&&i.points.trueEnd&&n.setAttr("points",i.points.trueEnd),e.onFinish&&e.onFinish.call(e)},this.tween.onReset=function(){var n=e.node,i=t.attrs[n._id][e._id];i.points&&i.points.trueStart&&n.points(i.points.trueStart),e.onReset&&e.onReset()}},t.prototype.play=function(){return this.tween.play(),this},t.prototype.reverse=function(){return this.tween.reverse(),this},t.prototype.reset=function(){return this.tween.reset(),this},t.prototype.seek=function(t){return this.tween.seek(1e3*t),this},t.prototype.pause=function(){return this.tween.pause(),this},t.prototype.finish=function(){return this.tween.finish(),this},t.prototype.destroy=function(){var e,n=this.node._id,i=this._id,r=t.tweens[n];for(e in this.pause(),r)delete t.tweens[n][e];delete t.attrs[n][i]},t.attrs={},t.tweens={},t}();e.Tween=h,o.Node.prototype.to=function(t){var e=t.onFinish;t.node=this,t.onFinish=function(){this.destroy(),e&&e()},new h(t).play()},e.Easings={BackEaseIn:function(t,e,n,i){var r=1.70158;return n*(t/=i)*t*((r+1)*t-r)+e},BackEaseOut:function(t,e,n,i){var r=1.70158;return n*((t=t/i-1)*t*((r+1)*t+r)+1)+e},BackEaseInOut:function(t,e,n,i){var r=1.70158;return(t/=i/2)<1?n/2*(t*t*((1+(r*=1.525))*t-r))+e:n/2*((t-=2)*t*((1+(r*=1.525))*t+r)+2)+e},ElasticEaseIn:function(t,e,n,i,r,o){var a=0;return 0===t?e:1==(t/=i)?e+n:(o||(o=.3*i),!r||r<Math.abs(n)?(r=n,a=o/4):a=o/(2*Math.PI)*Math.asin(n/r),-r*Math.pow(2,10*(t-=1))*Math.sin((t*i-a)*(2*Math.PI)/o)+e)},ElasticEaseOut:function(t,e,n,i,r,o){var a=0;return 0===t?e:1==(t/=i)?e+n:(o||(o=.3*i),!r||r<Math.abs(n)?(r=n,a=o/4):a=o/(2*Math.PI)*Math.asin(n/r),r*Math.pow(2,-10*t)*Math.sin((t*i-a)*(2*Math.PI)/o)+n+e)},ElasticEaseInOut:function(t,e,n,i,r,o){var a=0;return 0===t?e:2==(t/=i/2)?e+n:(o||(o=i*(.3*1.5)),!r||r<Math.abs(n)?(r=n,a=o/4):a=o/(2*Math.PI)*Math.asin(n/r),t<1?r*Math.pow(2,10*(t-=1))*Math.sin((t*i-a)*(2*Math.PI)/o)*-.5+e:r*Math.pow(2,-10*(t-=1))*Math.sin((t*i-a)*(2*Math.PI)/o)*.5+n+e)},BounceEaseOut:function(t,e,n,i){return(t/=i)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},BounceEaseIn:function(t,n,i,r){return i-e.Easings.BounceEaseOut(r-t,0,i,r)+n},BounceEaseInOut:function(t,n,i,r){return t<r/2?.5*e.Easings.BounceEaseIn(2*t,0,i,r)+n:.5*e.Easings.BounceEaseOut(2*t-r,0,i,r)+.5*i+n},EaseIn:function(t,e,n,i){return n*(t/=i)*t+e},EaseOut:function(t,e,n,i){return-n*(t/=i)*(t-2)+e},EaseInOut:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},StrongEaseIn:function(t,e,n,i){return n*(t/=i)*t*t*t*t+e},StrongEaseOut:function(t,e,n,i){return n*((t=t/i-1)*t*t*t*t+1)+e},StrongEaseInOut:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},Linear:function(t,e,n,i){return n*t/i+e}}},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(6),c=n(2),l=n(3),u=n(2),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){var e=c.Konva.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,n),t.arc(0,0,this.innerRadius(),e,0,!n),t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){return 2*this.outerRadius()},e.prototype.getHeight=function(){return 2*this.outerRadius()},e.prototype.setWidth=function(t){this.outerRadius(t/2)},e.prototype.setHeight=function(t){this.outerRadius(t/2)},e}(s.Shape);e.Arc=h,h.prototype._centroid=!0,h.prototype.className="Arc",h.prototype._attrsAffectingSize=["innerRadius","outerRadius"],u._registerNode(h),a.Factory.addGetterSetter(h,"innerRadius",0,l.getNumberValidator()),a.Factory.addGetterSetter(h,"outerRadius",0,l.getNumberValidator()),a.Factory.addGetterSetter(h,"angle",0,l.getNumberValidator()),a.Factory.addGetterSetter(h,"clockwise",!1,l.getBooleanValidator()),o.Collection.mapMethods(h)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(21),c=n(3),l=n(2),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(e){t.prototype._sceneFunc.call(this,e);var n=2*Math.PI,i=this.points(),r=i,o=0!==this.tension()&&i.length>4;o&&(r=this.getTensionPoints());var a,s,c=i.length;o?(a=i[c-2]-(r[r.length-2]+r[r.length-4])/2,s=i[c-1]-(r[r.length-1]+r[r.length-3])/2):(a=i[c-2]-i[c-4],s=i[c-1]-i[c-3]);var l=(Math.atan2(s,a)+n)%n,u=this.pointerLength(),h=this.pointerWidth();e.save(),e.beginPath(),e.translate(i[c-2],i[c-1]),e.rotate(l),e.moveTo(0,0),e.lineTo(-u,h/2),e.lineTo(-u,-h/2),e.closePath(),e.restore(),this.pointerAtBeginning()&&(e.save(),e.translate(i[0],i[1]),o?(a=(r[0]+r[2])/2-i[0],s=(r[1]+r[3])/2-i[1]):(a=i[2]-i[0],s=i[3]-i[1]),e.rotate((Math.atan2(-s,-a)+n)%n),e.moveTo(0,0),e.lineTo(-u,h/2),e.lineTo(-u,-h/2),e.closePath(),e.restore());var p=this.dashEnabled();p&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),p&&(this.attrs.dashEnabled=!0)},e}(s.Line);e.Arrow=u,u.prototype.className="Arrow",l._registerNode(u),a.Factory.addGetterSetter(u,"pointerLength",10,c.getNumberValidator()),a.Factory.addGetterSetter(u,"pointerWidth",10,c.getNumberValidator()),a.Factory.addGetterSetter(u,"pointerAtBeginning",!1),o.Collection.mapMethods(u)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(6),c=n(3),l=n(2),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){t.beginPath(),t.arc(0,0,this.radius(),0,2*Math.PI,!1),t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){return 2*this.radius()},e.prototype.getHeight=function(){return 2*this.radius()},e.prototype.setWidth=function(t){this.radius()!==t/2&&this.radius(t/2)},e.prototype.setHeight=function(t){this.radius()!==t/2&&this.radius(t/2)},e}(s.Shape);e.Circle=u,u.prototype._centroid=!0,u.prototype.className="Circle",u.prototype._attrsAffectingSize=["radius"],l._registerNode(u),a.Factory.addGetterSetter(u,"radius",0,c.getNumberValidator()),o.Collection.mapMethods(u)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(6),c=n(3),l=n(2),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){var e=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),e!==n&&t.scale(1,n/e),t.arc(0,0,e,0,2*Math.PI,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){return 2*this.radiusX()},e.prototype.getHeight=function(){return 2*this.radiusY()},e.prototype.setWidth=function(t){this.radiusX(t/2)},e.prototype.setHeight=function(t){this.radiusY(t/2)},e}(s.Shape);e.Ellipse=u,u.prototype.className="Ellipse",u.prototype._centroid=!0,u.prototype._attrsAffectingSize=["radiusX","radiusY"],l._registerNode(u),a.Factory.addComponentsGetterSetter(u,"radius",["x","y"]),a.Factory.addGetterSetter(u,"radiusX",0,c.getNumberValidator()),a.Factory.addGetterSetter(u,"radiusY",0,c.getNumberValidator()),o.Collection.mapMethods(u)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(6),c=n(3),l=n(2),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._useBufferCanvas=function(){return!(!this.hasShadow()&&1===this.getAbsoluteOpacity()||!this.hasStroke()||!this.getStage())},e.prototype._sceneFunc=function(t){var e,n,i,r=this.width(),o=this.height(),a=this.image();a&&(e=this.cropWidth(),n=this.cropHeight(),i=e&&n?[a,this.cropX(),this.cropY(),e,n,0,0,r,o]:[a,0,0,r,o]),(this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,r,o),t.closePath(),t.fillStrokeShape(this)),a&&t.drawImage.apply(t,i)},e.prototype._hitFunc=function(t){var e=this.width(),n=this.height();t.beginPath(),t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){var t=this.image();return this.attrs.width||(t?t.width:0)},e.prototype.getHeight=function(){var t=this.image();return this.attrs.height||(t?t.height:0)},e.fromURL=function(t,n){var i=o.Util.createImageElement();i.onload=function(){var t=new e({image:i});n(t)},i.crossOrigin="Anonymous",i.src=t},e}(s.Shape);e.Image=u,u.prototype.className="Image",l._registerNode(u),a.Factory.addGetterSetter(u,"image"),a.Factory.addComponentsGetterSetter(u,"crop",["x","y","width","height"]),a.Factory.addGetterSetter(u,"cropX",0,c.getNumberValidator()),a.Factory.addGetterSetter(u,"cropY",0,c.getNumberValidator()),a.Factory.addGetterSetter(u,"cropWidth",0,c.getNumberValidator()),a.Factory.addGetterSetter(u,"cropHeight",0,c.getNumberValidator()),o.Collection.mapMethods(u)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(6),c=n(15),l=n(3),u=n(2),h=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width"],p=h.length,d=function(t){function e(e){var n=t.call(this,e)||this;return n.on("add.konva",(function(t){this._addListeners(t.child),this._sync()})),n}return r(e,t),e.prototype.getText=function(){return this.find("Text")[0]},e.prototype.getTag=function(){return this.find("Tag")[0]},e.prototype._addListeners=function(t){var e,n=this,i=function(){n._sync()};for(e=0;e<p;e++)t.on(h[e]+"Change.konva",i)},e.prototype.getWidth=function(){return this.getText().width()},e.prototype.getHeight=function(){return this.getText().height()},e.prototype._sync=function(){var t,e,n,i,r,o,a,s=this.getText(),c=this.getTag();if(s&&c){switch(t=s.width(),e=s.height(),n=c.pointerDirection(),i=c.pointerWidth(),a=c.pointerHeight(),r=0,o=0,n){case"up":r=t/2,o=-1*a;break;case"right":r=t+i,o=e/2;break;case"down":r=t/2,o=e+a;break;case"left":r=-1*i,o=e/2}c.setAttrs({x:-1*r,y:-1*o,width:t,height:e}),s.setAttrs({x:-1*r,y:-1*o})}},e}(c.Group);e.Label=d,d.prototype.className="Label",u._registerNode(d),o.Collection.mapMethods(d);var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){var e=this.width(),n=this.height(),i=this.pointerDirection(),r=this.pointerWidth(),o=this.pointerHeight(),a=Math.min(this.cornerRadius(),e/2,n/2);t.beginPath(),a?t.moveTo(a,0):t.moveTo(0,0),"up"===i&&(t.lineTo((e-r)/2,0),t.lineTo(e/2,-1*o),t.lineTo((e+r)/2,0)),a?(t.lineTo(e-a,0),t.arc(e-a,a,a,3*Math.PI/2,0,!1)):t.lineTo(e,0),"right"===i&&(t.lineTo(e,(n-o)/2),t.lineTo(e+r,n/2),t.lineTo(e,(n+o)/2)),a?(t.lineTo(e,n-a),t.arc(e-a,n-a,a,0,Math.PI/2,!1)):t.lineTo(e,n),"down"===i&&(t.lineTo((e+r)/2,n),t.lineTo(e/2,n+o),t.lineTo((e-r)/2,n)),a?(t.lineTo(a,n),t.arc(a,n-a,a,Math.PI/2,Math.PI,!1)):t.lineTo(0,n),"left"===i&&(t.lineTo(0,(n+o)/2),t.lineTo(-1*r,n/2),t.lineTo(0,(n-o)/2)),a&&(t.lineTo(0,a),t.arc(a,a,a,Math.PI,3*Math.PI/2,!1)),t.closePath(),t.fillStrokeShape(this)},e.prototype.getSelfRect=function(){var t=0,e=0,n=this.pointerWidth(),i=this.pointerHeight(),r=this.pointerDirection(),o=this.width(),a=this.height();return"up"===r?(e-=i,a+=i):"down"===r?a+=i:"left"===r?(t-=1.5*n,o+=n):"right"===r&&(o+=1.5*n),{x:t,y:e,width:o,height:a}},e}(s.Shape);e.Tag=f,f.prototype.className="Tag",u._registerNode(f),a.Factory.addGetterSetter(f,"pointerDirection","none"),a.Factory.addGetterSetter(f,"pointerWidth",0,l.getNumberValidator()),a.Factory.addGetterSetter(f,"pointerHeight",0,l.getNumberValidator()),a.Factory.addGetterSetter(f,"cornerRadius",0,l.getNumberValidator()),o.Collection.mapMethods(f)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(6),c=n(3),l=n(2),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){var e,n,i,r=this.sides(),o=this.radius();for(t.beginPath(),t.moveTo(0,0-o),e=1;e<r;e++)n=o*Math.sin(2*e*Math.PI/r),i=-1*o*Math.cos(2*e*Math.PI/r),t.lineTo(n,i);t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){return 2*this.radius()},e.prototype.getHeight=function(){return 2*this.radius()},e.prototype.setWidth=function(t){this.radius(t/2)},e.prototype.setHeight=function(t){this.radius(t/2)},e}(s.Shape);e.RegularPolygon=u,u.prototype.className="RegularPolygon",u.prototype._centroid=!0,u.prototype._attrsAffectingSize=["radius"],l._registerNode(u),a.Factory.addGetterSetter(u,"radius",0,c.getNumberValidator()),a.Factory.addGetterSetter(u,"sides",0,c.getNumberValidator()),o.Collection.mapMethods(u)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(6),c=n(3),l=n(2),u=2*Math.PI,h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,u,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),u,0,!0),t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){return 2*this.outerRadius()},e.prototype.getHeight=function(){return 2*this.outerRadius()},e.prototype.setWidth=function(t){this.outerRadius(t/2)},e.prototype.setHeight=function(t){this.outerRadius(t/2)},e}(s.Shape);e.Ring=h,h.prototype.className="Ring",h.prototype._centroid=!0,h.prototype._attrsAffectingSize=["innerRadius","outerRadius"],l._registerNode(h),a.Factory.addGetterSetter(h,"innerRadius",0,c.getNumberValidator()),a.Factory.addGetterSetter(h,"outerRadius",0,c.getNumberValidator()),o.Collection.mapMethods(h)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(6),c=n(16),l=n(3),u=n(2),h=function(t){function e(e){var n=t.call(this,e)||this;return n._updated=!0,n.anim=new c.Animation((function(){var t=n._updated;return n._updated=!1,t})),n.on("animationChange.konva",(function(){this.frameIndex(0)})),n.on("frameIndexChange.konva",(function(){this._updated=!0})),n.on("frameRateChange.konva",(function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})),n}return r(e,t),e.prototype._sceneFunc=function(t){var e=this.animation(),n=this.frameIndex(),i=4*n,r=this.animations()[e],o=this.frameOffsets(),a=r[i+0],s=r[i+1],c=r[i+2],l=r[i+3],u=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,c,l),t.closePath(),t.fillStrokeShape(this)),u)if(o){var h=o[e],p=2*n;t.drawImage(u,a,s,c,l,h[p+0],h[p+1],c,l)}else t.drawImage(u,a,s,c,l,0,0,c,l)},e.prototype._hitFunc=function(t){var e=this.animation(),n=this.frameIndex(),i=4*n,r=this.animations()[e],o=this.frameOffsets(),a=r[i+2],s=r[i+3];if(t.beginPath(),o){var c=o[e],l=2*n;t.rect(c[l+0],c[l+1],a,s)}else t.rect(0,0,a,s);t.closePath(),t.fillShape(this)},e.prototype._useBufferCanvas=function(){return(this.hasShadow()||1!==this.getAbsoluteOpacity())&&this.hasStroke()},e.prototype._setInterval=function(){var t=this;this.interval=setInterval((function(){t._updateIndex()}),1e3/this.frameRate())},e.prototype.start=function(){if(!this.isRunning()){var t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}},e.prototype.stop=function(){this.anim.stop(),clearInterval(this.interval)},e.prototype.isRunning=function(){return this.anim.isRunning()},e.prototype._updateIndex=function(){var t=this.frameIndex(),e=this.animation();t<this.animations()[e].length/4-1?this.frameIndex(t+1):this.frameIndex(0)},e}(s.Shape);e.Sprite=h,h.prototype.className="Sprite",u._registerNode(h),a.Factory.addGetterSetter(h,"animation"),a.Factory.addGetterSetter(h,"animations"),a.Factory.addGetterSetter(h,"frameOffsets"),a.Factory.addGetterSetter(h,"image"),a.Factory.addGetterSetter(h,"frameIndex",0,l.getNumberValidator()),a.Factory.addGetterSetter(h,"frameRate",17,l.getNumberValidator()),a.Factory.backCompat(h,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),o.Collection.mapMethods(h)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(6),c=n(3),l=n(2),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){var e=this.innerRadius(),n=this.outerRadius(),i=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(var r=1;r<2*i;r++){var o=r%2==0?n:e,a=o*Math.sin(r*Math.PI/i),s=-1*o*Math.cos(r*Math.PI/i);t.lineTo(a,s)}t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){return 2*this.outerRadius()},e.prototype.getHeight=function(){return 2*this.outerRadius()},e.prototype.setWidth=function(t){this.outerRadius(t/2)},e.prototype.setHeight=function(t){this.outerRadius(t/2)},e}(s.Shape);e.Star=u,u.prototype.className="Star",u.prototype._centroid=!0,u.prototype._attrsAffectingSize=["innerRadius","outerRadius"],l._registerNode(u),a.Factory.addGetterSetter(u,"numPoints",5,c.getNumberValidator()),a.Factory.addGetterSetter(u,"innerRadius",0,c.getNumberValidator()),a.Factory.addGetterSetter(u,"outerRadius",0,c.getNumberValidator()),o.Collection.mapMethods(u)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(6),c=n(22),l=n(24),u=n(3),h=n(2);function p(t){t.fillText(this.partialText,0,0)}function d(t){t.strokeText(this.partialText,0,0)}var f=function(t){function e(e){var n=t.call(this,e)||this;return n.dummyCanvas=o.Util.createCanvasElement(),n.dataArray=[],n.dataArray=c.Path.parsePathData(n.attrs.data),n.on("dataChange.konva",(function(){this.dataArray=c.Path.parsePathData(this.attrs.data),this._setTextData()})),n.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva",n._setTextData),e&&e.getKerning&&(o.Util.warn('getKerning TextPath API is deprecated. Please use "kerningFunc" instead.'),n.kerningFunc(e.getKerning)),n._setTextData(),n}return r(e,t),e.prototype._sceneFunc=function(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();var e=this.textDecoration(),n=this.fill(),i=this.fontSize(),r=this.glyphInfo;"underline"===e&&t.beginPath();for(var o=0;o<r.length;o++){t.save();var a=r[o].p0;t.translate(a.x,a.y),t.rotate(r[o].rotation),this.partialText=r[o].text,t.fillStrokeShape(this),"underline"===e&&(0===o&&t.moveTo(0,i/2+1),t.lineTo(i,i/2+1)),t.restore()}"underline"===e&&(t.strokeStyle=n,t.lineWidth=i/20,t.stroke()),t.restore()},e.prototype._hitFunc=function(t){t.beginPath();var e=this.glyphInfo;if(e.length>=1){var n=e[0].p0;t.moveTo(n.x,n.y)}for(var i=0;i<e.length;i++){var r=e[i].p1;t.lineTo(r.x,r.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()},e.prototype.getTextWidth=function(){return this.textWidth},e.prototype.getTextHeight=function(){return o.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight},e.prototype.setText=function(t){return l.Text.prototype.setText.call(this,t)},e.prototype._getContextFont=function(){return l.Text.prototype._getContextFont.call(this)},e.prototype._getTextSize=function(t){var e=this.dummyCanvas.getContext("2d");e.save(),e.font=this._getContextFont();var n=e.measureText(t);return e.restore(),{width:n.width,height:parseInt(this.attrs.fontSize,10)}},e.prototype._setTextData=function(){var t=this,e=this._getTextSize(this.attrs.text),n=this.letterSpacing(),i=this.align(),r=this.kerningFunc();this.textWidth=e.width,this.textHeight=e.height;var o=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);this.glyphInfo=[];for(var a=0,s=0;s<t.dataArray.length;s++)t.dataArray[s].pathLength>0&&(a+=t.dataArray[s].pathLength);var l=0;"center"===i&&(l=Math.max(0,a/2-o/2)),"right"===i&&(l=Math.max(0,a-o));for(var u,h,p,d=this.text().split(""),f=this.text().split(" ").length-1,m=-1,v=0,y=function(){v=0;for(var e=t.dataArray,n=m+1;n<e.length;n++){if(e[n].pathLength>0)return m=n,e[n];"M"===e[n].command&&(u={x:e[n].points[0],y:e[n].points[1]})}return{}},g=function(e){var r=t._getTextSize(e).width+n;" "===e&&"justify"===i&&(r+=(a-o)/f);var s=0,l=0;for(h=void 0;Math.abs(r-s)/r>.01&&l<25;){l++;for(var d=s;void 0===p;)(p=y())&&d+p.pathLength<r&&(d+=p.pathLength,p=void 0);if(p==={}||void 0===u)return;var m=!1;switch(p.command){case"L":c.Path.getLineLength(u.x,u.y,p.points[0],p.points[1])>r?h=c.Path.getPointOnLine(r,u.x,u.y,p.points[0],p.points[1],u.x,u.y):p=void 0;break;case"A":var g=p.points[4],b=p.points[5],_=p.points[4]+b;0===v?v=g+1e-8:r>s?v+=Math.PI/180*b/Math.abs(b):v-=Math.PI/360*b/Math.abs(b),(b<0&&v<_||b>=0&&v>_)&&(v=_,m=!0),h=c.Path.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],v,p.points[6]);break;case"C":0===v?v=r>p.pathLength?1e-8:r/p.pathLength:r>s?v+=(r-s)/p.pathLength:v-=(s-r)/p.pathLength,v>1&&(v=1,m=!0),h=c.Path.getPointOnCubicBezier(v,p.start.x,p.start.y,p.points[0],p.points[1],p.points[2],p.points[3],p.points[4],p.points[5]);break;case"Q":0===v?v=r/p.pathLength:r>s?v+=(r-s)/p.pathLength:v-=(s-r)/p.pathLength,v>1&&(v=1,m=!0),h=c.Path.getPointOnQuadraticBezier(v,p.start.x,p.start.y,p.points[0],p.points[1],p.points[2],p.points[3])}void 0!==h&&(s=c.Path.getLineLength(u.x,u.y,h.x,h.y)),m&&(m=!1,p=void 0)}},b=t._getTextSize("C").width+n,_=0;_<l/b&&(g("C"),void 0!==u&&void 0!==h);_++)u=h;for(var w=0;w<d.length&&(g(d[w]),void 0!==u&&void 0!==h);w++){var x=c.Path.getLineLength(u.x,u.y,h.x,h.y),E=0;if(r)try{E=r(d[w-1],d[w])*this.fontSize()}catch(t){E=0}u.x+=E,h.x+=E,this.textWidth+=E;var S=c.Path.getPointOnLine(E+x/2,u.x,u.y,h.x,h.y),C=Math.atan2(h.y-u.y,h.x-u.x);this.glyphInfo.push({transposeX:S.x,transposeY:S.y,text:d[w],rotation:C,p0:u,p1:h}),u=h}},e.prototype.getSelfRect=function(){var t=[];this.glyphInfo.forEach((function(e){t.push(e.p0.x),t.push(e.p0.y),t.push(e.p1.x),t.push(e.p1.y)}));for(var e,n,i=t[0],r=t[0],o=t[0],a=t[0],s=0;s<t.length/2;s++)e=t[2*s],n=t[2*s+1],i=Math.min(i,e),r=Math.max(r,e),o=Math.min(o,n),a=Math.max(a,n);var c=this.fontSize();return{x:Math.round(i)-c/2,y:Math.round(o)-c/2,width:Math.round(r-i)+c,height:Math.round(a-o)+c}},e}(s.Shape);e.TextPath=f,f.prototype._fillFunc=p,f.prototype._strokeFunc=d,f.prototype._fillFuncHit=p,f.prototype._strokeFuncHit=d,f.prototype.className="TextPath",f.prototype._attrsAffectingSize=["text","fontSize","data"],h._registerNode(f),a.Factory.addGetterSetter(f,"data"),a.Factory.addGetterSetter(f,"fontFamily","Arial"),a.Factory.addGetterSetter(f,"fontSize",12,u.getNumberValidator()),a.Factory.addGetterSetter(f,"fontStyle","normal"),a.Factory.addGetterSetter(f,"align","left"),a.Factory.addGetterSetter(f,"letterSpacing",0,u.getNumberValidator()),a.Factory.addGetterSetter(f,"textBaseline","middle"),a.Factory.addGetterSetter(f,"fontVariant","normal"),a.Factory.addGetterSetter(f,"text",""),a.Factory.addGetterSetter(f,"textDecoration",null),a.Factory.addGetterSetter(f,"kerningFunc",null),o.Collection.mapMethods(f)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(5),c=n(6),l=n(23),u=n(15),h=n(2),p=n(3),d=n(2),f=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange"].map((function(t){return t+".tr-konva"})).join(" "),m=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"].map((function(t){return t+".tr-konva"})).join(" "),v={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};var y=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],g=function(t){function e(e){var n=t.call(this,e)||this;return n._transforming=!1,n._createElements(),n._handleMouseMove=n._handleMouseMove.bind(n),n._handleMouseUp=n._handleMouseUp.bind(n),n.update=n.update.bind(n),n.on(f,n.update),n.getNode()&&n.update(),n}return r(e,t),e.prototype.attachTo=function(t){return this.setNode(t),this},e.prototype.setNode=function(t){var e=this;this._node&&this.detach(),this._node=t,this._resetTransformCache();var n=t._attrsAffectingSize.map((function(t){return t+"Change.tr-konva"})).join(" "),i=function(){e._resetTransformCache(),e._transforming||e.update()};return t.on(n,i),t.on(m,i),t.on("xChange.tr-konva yChange.tr-konva",(function(){return e._resetTransformCache()})),!!this.findOne(".top-left")&&this.update(),this},e.prototype.getNode=function(){return this._node},e.prototype.detach=function(){this.getNode()&&(this.getNode().off(".tr-konva"),this._node=void 0),this._resetTransformCache()},e.prototype._resetTransformCache=function(){this._clearCache("nodeRect"),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")},e.prototype._getNodeRect=function(){return this._getCache("nodeRect",this.__getNodeRect)},e.prototype.__getNodeRect=function(){var t=this.getNode();if(!t)return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};t.parent&&this.parent&&t.parent!==this.parent&&o.Util.warn("Transformer and attached node have different parents. Konva does not support such case right now. Please move Transformer to the parent of attaching node.");var e=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),n=h.Konva.getAngle(t.rotation()),i=e.x*t.scaleX()-t.offsetX()*t.scaleX(),r=e.y*t.scaleY()-t.offsetY()*t.scaleY();return{x:t.x()+i*Math.cos(n)+r*Math.sin(-n),y:t.y()+r*Math.cos(n)+i*Math.sin(n),width:e.width*t.scaleX(),height:e.height*t.scaleY(),rotation:t.rotation()}},e.prototype.getX=function(){return this._getNodeRect().x},e.prototype.getY=function(){return this._getNodeRect().y},e.prototype.getRotation=function(){return this._getNodeRect().rotation},e.prototype.getWidth=function(){return this._getNodeRect().width},e.prototype.getHeight=function(){return this._getNodeRect().height},e.prototype._createElements=function(){this._createBack(),y.forEach(function(t){this._createAnchor(t)}.bind(this)),this._createAnchor("rotater")},e.prototype._createAnchor=function(t){var e=this,n=new l.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0}),i=this;n.on("mousedown touchstart",(function(t){i._handleMouseDown(t)})),n.on("dragstart",(function(t){t.cancelBubble=!0})),n.on("dragmove",(function(t){t.cancelBubble=!0})),n.on("dragend",(function(t){t.cancelBubble=!0})),n.on("mouseenter",(function(){var i=h.Konva.getAngle(e.rotation()),r=e.getNode().getAbsoluteScale(),a=r.y*r.x<0,s=function(t,e,n){if("rotater"===t)return"crosshair";e+=o.Util._degToRad(v[t]||0),n&&(e*=-1);var i=(o.Util._radToDeg(e)%360+360)%360;return o.Util._inRange(i,337.5,360)||o.Util._inRange(i,0,22.5)?"ns-resize":o.Util._inRange(i,22.5,67.5)?"nesw-resize":o.Util._inRange(i,67.5,112.5)?"ew-resize":o.Util._inRange(i,112.5,157.5)?"nwse-resize":o.Util._inRange(i,157.5,202.5)?"ns-resize":o.Util._inRange(i,202.5,247.5)?"nesw-resize":o.Util._inRange(i,247.5,292.5)?"ew-resize":o.Util._inRange(i,292.5,337.5)?"nwse-resize":(o.Util.error("Transformer has unknown angle for cursor detection: "+i),"pointer")}(t,i,a);n.getStage().content.style.cursor=s,e._cursorChange=!0})),n.on("mouseout",(function(){n.getStage()&&n.getParent()&&(n.getStage().content.style.cursor="",e._cursorChange=!1)})),this.add(n)},e.prototype._createBack=function(){var t=new c.Shape({name:"back",width:0,height:0,listening:!1,sceneFunc:function(t){var e=this.getParent(),n=e.padding();t.beginPath(),t.rect(-n,-n,this.width()+2*n,this.height()+2*n),t.moveTo(this.width()/2,-n),e.rotateEnabled()&&t.lineTo(this.width()/2,-e.rotateAnchorOffset()*o.Util._sign(this.height())-n),t.fillStrokeShape(this)}});this.add(t)},e.prototype._handleMouseDown=function(t){this._movingAnchorName=t.target.name().split(" ")[0];var e=this._getNodeRect(),n=e.width,i=e.height,r=Math.sqrt(Math.pow(n,2)+Math.pow(i,2));this.sin=Math.abs(i/r),this.cos=Math.abs(n/r),window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0),this._transforming=!0,this._fire("transformstart",{evt:t}),this.getNode()._fire("transformstart",{evt:t})},e.prototype._handleMouseMove=function(t){var e,n,i,r=this.findOne("."+this._movingAnchorName),a=r.getStage().getContent().getBoundingClientRect(),s=a.left,c=a.top,l={x:(void 0!==t.clientX?t.clientX:t.touches[0].clientX)-s,y:(void 0!==t.clientX?t.clientY:t.touches[0].clientY)-c};r.setAbsolutePosition(l);var u=this.keepRatio()||t.shiftKey,p=this.padding();if("top-left"===this._movingAnchorName){if(u){i=Math.sqrt(Math.pow(this.findOne(".bottom-right").x()-r.x()-2*p,2)+Math.pow(this.findOne(".bottom-right").y()-r.y()-2*p,2));var d=this.findOne(".top-left").x()>this.findOne(".bottom-right").x()?-1:1,f=this.findOne(".top-left").y()>this.findOne(".bottom-right").y()?-1:1;e=i*this.cos*d,n=i*this.sin*f,this.findOne(".top-left").x(this.findOne(".bottom-right").x()-e-2*p),this.findOne(".top-left").y(this.findOne(".bottom-right").y()-n-2*p)}}else if("top-center"===this._movingAnchorName)this.findOne(".top-left").y(r.y());else if("top-right"===this._movingAnchorName){if(u){i=Math.sqrt(Math.pow(r.x()-this.findOne(".bottom-left").x()-2*p,2)+Math.pow(this.findOne(".bottom-left").y()-r.y()-2*p,2));d=this.findOne(".top-right").x()<this.findOne(".top-left").x()?-1:1,f=this.findOne(".top-right").y()>this.findOne(".bottom-left").y()?-1:1;e=i*this.cos*d,n=i*this.sin*f,this.findOne(".top-right").x(e+p),this.findOne(".top-right").y(this.findOne(".bottom-left").y()-n-2*p)}var m=r.position();this.findOne(".top-left").y(m.y),this.findOne(".bottom-right").x(m.x)}else if("middle-left"===this._movingAnchorName)this.findOne(".top-left").x(r.x());else if("middle-right"===this._movingAnchorName)this.findOne(".bottom-right").x(r.x());else if("bottom-left"===this._movingAnchorName){if(u){i=Math.sqrt(Math.pow(this.findOne(".top-right").x()-r.x()-2*p,2)+Math.pow(r.y()-this.findOne(".top-right").y()-2*p,2));d=this.findOne(".top-right").x()<this.findOne(".bottom-left").x()?-1:1,f=this.findOne(".bottom-right").y()<this.findOne(".top-left").y()?-1:1;e=i*this.cos*d,n=i*this.sin*f,this.findOne(".bottom-left").x(this.findOne(".top-right").x()-e-2*p),this.findOne(".bottom-left").y(n+p)}m=r.position(),this.findOne(".top-left").x(m.x),this.findOne(".bottom-right").y(m.y)}else if("bottom-center"===this._movingAnchorName)this.findOne(".bottom-right").y(r.y());else if("bottom-right"===this._movingAnchorName){if(u){i=Math.sqrt(Math.pow(this.findOne(".bottom-right").x()-p,2)+Math.pow(this.findOne(".bottom-right").y()-p,2));d=this.findOne(".top-left").x()>this.findOne(".bottom-right").x()?-1:1,f=this.findOne(".top-left").y()>this.findOne(".bottom-right").y()?-1:1;e=i*this.cos*d,n=i*this.sin*f,this.findOne(".bottom-right").x(e+p),this.findOne(".bottom-right").y(n+p)}}else if("rotater"===this._movingAnchorName){var v=this._getNodeRect();e=r.x()-v.width/2,n=-r.y()+v.height/2;var y=Math.atan2(-n,e)+Math.PI/2;v.height<0&&(y-=Math.PI);for(var g=h.Konva.getAngle(this.rotation()),b=o.Util._radToDeg(g)+o.Util._radToDeg(y),_=h.Konva.getAngle(this.getNode().rotation()),w=o.Util._degToRad(b),x=this.rotationSnaps(),E=0;E<x.length;E++){var S=h.Konva.getAngle(x[E]);Math.abs(S-o.Util._degToRad(b))%(2*Math.PI)<.1&&(b=o.Util._radToDeg(S),w=o.Util._degToRad(b))}var C=p,k=p;this._fitNodeInto({rotation:h.Konva.angleDeg?b:o.Util._degToRad(b),x:v.x+(v.width/2+p)*(Math.cos(_)-Math.cos(w))+(v.height/2+p)*(Math.sin(-_)-Math.sin(-w))-(C*Math.cos(g)+k*Math.sin(-g)),y:v.y+(v.height/2+p)*(Math.cos(_)-Math.cos(w))+(v.width/2+p)*(Math.sin(_)-Math.sin(w))-(k*Math.cos(g)+C*Math.sin(g)),width:v.width+2*p,height:v.height+2*p},t)}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if("rotater"!==this._movingAnchorName){if(this.centeredScaling()||t.altKey){var P=this.findOne(".top-left"),T=this.findOne(".bottom-right"),O=P.x()+p,A=P.y()+p,M=this.getWidth()-T.x()+p,j=this.getHeight()-T.y()+p;T.move({x:-O,y:-A}),P.move({x:M,y:j})}var R=this.findOne(".top-left").getAbsolutePosition(this.getParent());e=R.x,n=R.y;var D=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),N=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodeInto({x:e+this.offsetX(),y:n+this.offsetY(),width:D,height:N},t)}},e.prototype._handleMouseUp=function(t){this._removeEvents(t)},e.prototype._removeEvents=function(t){if(this._transforming){this._transforming=!1,window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0),this._fire("transformend",{evt:t});var e=this.getNode();e&&e.fire("transformend",{evt:t})}},e.prototype._fitNodeInto=function(t,e){var n=this.boundBoxFunc();if(n){var i=this._getNodeRect();t=n.call(this,i,t)}var r=this.getNode();void 0!==t.rotation&&this.getNode().rotation(t.rotation);var o=r.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),a=this.padding(),s=(t.width-2*a)/o.width,c=(t.height-2*a)/o.height,l=h.Konva.getAngle(r.rotation()),u=o.x*s-a-r.offsetX()*s,p=o.y*c-a-r.offsetY()*c;this.getNode().setAttrs({scaleX:s,scaleY:c,x:t.x-(u*Math.cos(l)+p*Math.sin(-l)),y:t.y-(p*Math.cos(l)+u*Math.sin(l))}),this._fire("transform",{evt:e}),this.getNode()._fire("transform",{evt:e}),this.update(),this.getLayer().batchDraw()},e.prototype.forceUpdate=function(){this._resetTransformCache(),this.update()},e.prototype.update=function(){var t=this,e=this._getNodeRect(),n=this.getNode(),i={x:1,y:1};n&&n.getParent()&&(i=n.getParent().getAbsoluteScale());var r={x:1/i.x,y:1/i.y},a=e.width,s=e.height,c=this.enabledAnchors(),l=this.resizeEnabled(),u=this.padding(),h=this.anchorSize();this.find("._anchor").each((function(e){return e.setAttrs({width:h,height:h,offsetX:h/2,offsetY:h/2,stroke:t.anchorStroke(),strokeWidth:t.anchorStrokeWidth(),fill:t.anchorFill(),cornerRadius:t.anchorCornerRadius()})})),this.findOne(".top-left").setAttrs({x:-u,y:-u,scale:r,visible:l&&c.indexOf("top-left")>=0}),this.findOne(".top-center").setAttrs({x:a/2,y:-u,scale:r,visible:l&&c.indexOf("top-center")>=0}),this.findOne(".top-right").setAttrs({x:a+u,y:-u,scale:r,visible:l&&c.indexOf("top-right")>=0}),this.findOne(".middle-left").setAttrs({x:-u,y:s/2,scale:r,visible:l&&c.indexOf("middle-left")>=0}),this.findOne(".middle-right").setAttrs({x:a+u,y:s/2,scale:r,visible:l&&c.indexOf("middle-right")>=0}),this.findOne(".bottom-left").setAttrs({x:-u,y:s+u,scale:r,visible:l&&c.indexOf("bottom-left")>=0}),this.findOne(".bottom-center").setAttrs({x:a/2,y:s+u,scale:r,visible:l&&c.indexOf("bottom-center")>=0}),this.findOne(".bottom-right").setAttrs({x:a+u,y:s+u,scale:r,visible:l&&c.indexOf("bottom-right")>=0});var p=-this.rotateAnchorOffset()*Math.abs(r.y);this.findOne(".rotater").setAttrs({x:a/2,y:p*o.Util._sign(s)-u,scale:r,visible:this.rotateEnabled()}),this.findOne(".back").setAttrs({width:a*i.x,height:s*i.y,scale:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash()})},e.prototype.isTransforming=function(){return this._transforming},e.prototype.stopTransform=function(){if(this._transforming){this._removeEvents();var t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}},e.prototype.destroy=function(){return this.getStage()&&this._cursorChange&&(this.getStage().content.style.cursor=""),u.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this},e.prototype.toObject=function(){return s.Node.prototype.toObject.call(this)},e}(u.Group);e.Transformer=g,g.prototype.className="Transformer",d._registerNode(g),a.Factory.addGetterSetter(g,"enabledAnchors",y,(function(t){return t instanceof Array||o.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach((function(t){-1===y.indexOf(t)&&o.Util.warn("Unknown anchor name: "+t+". Available names are: "+y.join(", "))})),t||[]})),a.Factory.addGetterSetter(g,"resizeEnabled",!0),a.Factory.addGetterSetter(g,"anchorSize",10,p.getNumberValidator()),a.Factory.addGetterSetter(g,"rotateEnabled",!0),a.Factory.addGetterSetter(g,"rotationSnaps",[]),a.Factory.addGetterSetter(g,"rotateAnchorOffset",50,p.getNumberValidator()),a.Factory.addGetterSetter(g,"borderEnabled",!0),a.Factory.addGetterSetter(g,"anchorStroke","rgb(0, 161, 255)"),a.Factory.addGetterSetter(g,"anchorStrokeWidth",1,p.getNumberValidator()),a.Factory.addGetterSetter(g,"anchorFill","white"),a.Factory.addGetterSetter(g,"anchorCornerRadius",0,p.getNumberValidator()),a.Factory.addGetterSetter(g,"borderStroke","rgb(0, 161, 255)"),a.Factory.addGetterSetter(g,"borderStrokeWidth",1,p.getNumberValidator()),a.Factory.addGetterSetter(g,"borderDash"),a.Factory.addGetterSetter(g,"keepRatio",!0),a.Factory.addGetterSetter(g,"centeredScaling",!1),a.Factory.addGetterSetter(g,"ignoreStroke",!1),a.Factory.addGetterSetter(g,"padding",0,p.getNumberValidator()),a.Factory.addGetterSetter(g,"node"),a.Factory.addGetterSetter(g,"boundBoxFunc"),a.Factory.backCompat(g,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),o.Collection.mapMethods(g)},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(6),c=n(2),l=n(3),u=n(2),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){t.beginPath(),t.arc(0,0,this.radius(),0,c.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){return 2*this.radius()},e.prototype.getHeight=function(){return 2*this.radius()},e.prototype.setWidth=function(t){this.radius(t/2)},e.prototype.setHeight=function(t){this.radius(t/2)},e}(s.Shape);e.Wedge=h,h.prototype.className="Wedge",h.prototype._centroid=!0,h.prototype._attrsAffectingSize=["radius"],u._registerNode(h),a.Factory.addGetterSetter(h,"radius",0,l.getNumberValidator()),a.Factory.addGetterSetter(h,"angle",0,l.getNumberValidator()),a.Factory.addGetterSetter(h,"clockwise",!1),a.Factory.backCompat(h,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),o.Collection.mapMethods(h)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(5),o=n(3);function a(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],c=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];e.Blur=function(t){var e=Math.round(this.blurRadius());e>0&&function(t,e){var n,i,r,o,l,u,h,p,d,f,m,v,y,g,b,_,w,x,E,S,C,k,P,T,O=t.data,A=t.width,M=t.height,j=e+e+1,R=A-1,D=M-1,N=e+1,I=N*(N+1)/2,L=new a,B=null,F=L,z=null,G=null,V=s[e],H=c[e];for(r=1;r<j;r++)F=F.next=new a,r===N&&(B=F);for(F.next=L,h=u=0,i=0;i<M;i++){for(_=w=x=E=p=d=f=m=0,v=N*(S=O[u]),y=N*(C=O[u+1]),g=N*(k=O[u+2]),b=N*(P=O[u+3]),p+=I*S,d+=I*C,f+=I*k,m+=I*P,F=L,r=0;r<N;r++)F.r=S,F.g=C,F.b=k,F.a=P,F=F.next;for(r=1;r<N;r++)o=u+((R<r?R:r)<<2),p+=(F.r=S=O[o])*(T=N-r),d+=(F.g=C=O[o+1])*T,f+=(F.b=k=O[o+2])*T,m+=(F.a=P=O[o+3])*T,_+=S,w+=C,x+=k,E+=P,F=F.next;for(z=L,G=B,n=0;n<A;n++)O[u+3]=P=m*V>>H,0!==P?(P=255/P,O[u]=(p*V>>H)*P,O[u+1]=(d*V>>H)*P,O[u+2]=(f*V>>H)*P):O[u]=O[u+1]=O[u+2]=0,p-=v,d-=y,f-=g,m-=b,v-=z.r,y-=z.g,g-=z.b,b-=z.a,o=h+((o=n+e+1)<R?o:R)<<2,p+=_+=z.r=O[o],d+=w+=z.g=O[o+1],f+=x+=z.b=O[o+2],m+=E+=z.a=O[o+3],z=z.next,v+=S=G.r,y+=C=G.g,g+=k=G.b,b+=P=G.a,_-=S,w-=C,x-=k,E-=P,G=G.next,u+=4;h+=A}for(n=0;n<A;n++){for(w=x=E=_=d=f=m=p=0,v=N*(S=O[u=n<<2]),y=N*(C=O[u+1]),g=N*(k=O[u+2]),b=N*(P=O[u+3]),p+=I*S,d+=I*C,f+=I*k,m+=I*P,F=L,r=0;r<N;r++)F.r=S,F.g=C,F.b=k,F.a=P,F=F.next;for(l=A,r=1;r<=e;r++)u=l+n<<2,p+=(F.r=S=O[u])*(T=N-r),d+=(F.g=C=O[u+1])*T,f+=(F.b=k=O[u+2])*T,m+=(F.a=P=O[u+3])*T,_+=S,w+=C,x+=k,E+=P,F=F.next,r<D&&(l+=A);for(u=n,z=L,G=B,i=0;i<M;i++)O[(o=u<<2)+3]=P=m*V>>H,P>0?(P=255/P,O[o]=(p*V>>H)*P,O[o+1]=(d*V>>H)*P,O[o+2]=(f*V>>H)*P):O[o]=O[o+1]=O[o+2]=0,p-=v,d-=y,f-=g,m-=b,v-=z.r,y-=z.g,g-=z.b,b-=z.a,o=n+((o=i+N)<D?o:D)*A<<2,p+=_+=z.r=O[o],d+=w+=z.g=O[o+1],f+=x+=z.b=O[o+2],m+=E+=z.a=O[o+3],z=z.next,v+=S=G.r,y+=C=G.g,g+=k=G.b,b+=P=G.a,_-=S,w-=C,x-=k,E-=P,G=G.next,u+=A}}(t,e)},i.Factory.addGetterSetter(r.Node,"blurRadius",0,o.getNumberValidator(),i.Factory.afterSetFilter)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(5),o=n(3);e.Brighten=function(t){var e,n=255*this.brightness(),i=t.data,r=i.length;for(e=0;e<r;e+=4)i[e]+=n,i[e+1]+=n,i[e+2]+=n},i.Factory.addGetterSetter(r.Node,"brightness",0,o.getNumberValidator(),i.Factory.afterSetFilter)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(5),o=n(3);e.Contrast=function(t){var e,n=Math.pow((this.contrast()+100)/100,2),i=t.data,r=i.length,o=150,a=150,s=150;for(e=0;e<r;e+=4)o=i[e],a=i[e+1],s=i[e+2],o/=255,o-=.5,o*=n,o+=.5,a/=255,a-=.5,a*=n,a+=.5,s/=255,s-=.5,s*=n,s+=.5,o=(o*=255)<0?0:o>255?255:o,a=(a*=255)<0?0:a>255?255:a,s=(s*=255)<0?0:s>255?255:s,i[e]=o,i[e+1]=a,i[e+2]=s},i.Factory.addGetterSetter(r.Node,"contrast",0,o.getNumberValidator(),i.Factory.afterSetFilter)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(5),o=n(4),a=n(3);e.Emboss=function(t){var e=10*this.embossStrength(),n=255*this.embossWhiteLevel(),i=this.embossDirection(),r=this.embossBlend(),a=0,s=0,c=t.data,l=t.width,u=t.height,h=4*l,p=u;switch(i){case"top-left":a=-1,s=-1;break;case"top":a=-1,s=0;break;case"top-right":a=-1,s=1;break;case"right":a=0,s=1;break;case"bottom-right":a=1,s=1;break;case"bottom":a=1,s=0;break;case"bottom-left":a=1,s=-1;break;case"left":a=0,s=-1;break;default:o.Util.error("Unknown emboss direction: "+i)}do{var d=(p-1)*h,f=a;p+f<1&&(f=0),p+f>u&&(f=0);var m=(p-1+f)*l*4,v=l;do{var y=d+4*(v-1),g=s;v+g<1&&(g=0),v+g>l&&(g=0);var b=m+4*(v-1+g),_=c[y]-c[b],w=c[y+1]-c[b+1],x=c[y+2]-c[b+2],E=_,S=E>0?E:-E;if((w>0?w:-w)>S&&(E=w),(x>0?x:-x)>S&&(E=x),E*=e,r){var C=c[y]+E,k=c[y+1]+E,P=c[y+2]+E;c[y]=C>255?255:C<0?0:C,c[y+1]=k>255?255:k<0?0:k,c[y+2]=P>255?255:P<0?0:P}else{var T=n-E;T<0?T=0:T>255&&(T=255),c[y]=c[y+1]=c[y+2]=T}}while(--v)}while(--p)},i.Factory.addGetterSetter(r.Node,"embossStrength",.5,a.getNumberValidator(),i.Factory.afterSetFilter),i.Factory.addGetterSetter(r.Node,"embossWhiteLevel",.5,a.getNumberValidator(),i.Factory.afterSetFilter),i.Factory.addGetterSetter(r.Node,"embossDirection","top-left",null,i.Factory.afterSetFilter),i.Factory.addGetterSetter(r.Node,"embossBlend",!1,null,i.Factory.afterSetFilter)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(5),o=n(3);function a(t,e,n,i,r){var o=n-e,a=r-i;return 0===o?i+a/2:0===a?i:a*((t-e)/o)+i}e.Enhance=function(t){var e,n,i,r,o=t.data,s=o.length,c=o[0],l=c,u=o[1],h=u,p=o[2],d=p,f=this.enhance();if(0!==f){for(r=0;r<s;r+=4)(e=o[r+0])<c?c=e:e>l&&(l=e),(n=o[r+1])<u?u=n:n>h&&(h=n),(i=o[r+2])<p?p=i:i>d&&(d=i);var m,v,y,g,b,_,w,x,E;for(l===c&&(l=255,c=0),h===u&&(h=255,u=0),d===p&&(d=255,p=0),f>0?(v=l+f*(255-l),y=c-f*(c-0),b=h+f*(255-h),_=u-f*(u-0),x=d+f*(255-d),E=p-f*(p-0)):(v=l+f*(l-(m=.5*(l+c))),y=c+f*(c-m),b=h+f*(h-(g=.5*(h+u))),_=u+f*(u-g),x=d+f*(d-(w=.5*(d+p))),E=p+f*(p-w)),r=0;r<s;r+=4)o[r+0]=a(o[r+0],c,l,y,v),o[r+1]=a(o[r+1],u,h,_,b),o[r+2]=a(o[r+2],p,d,E,x)}},i.Factory.addGetterSetter(r.Node,"enhance",0,o.getNumberValidator(),i.Factory.afterSetFilter)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Grayscale=function(t){var e,n,i=t.data,r=i.length;for(e=0;e<r;e+=4)n=.34*i[e]+.5*i[e+1]+.16*i[e+2],i[e]=n,i[e+1]=n,i[e+2]=n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(5),o=n(3);i.Factory.addGetterSetter(r.Node,"hue",0,o.getNumberValidator(),i.Factory.afterSetFilter),i.Factory.addGetterSetter(r.Node,"saturation",0,o.getNumberValidator(),i.Factory.afterSetFilter),i.Factory.addGetterSetter(r.Node,"luminance",0,o.getNumberValidator(),i.Factory.afterSetFilter),e.HSL=function(t){var e,n,i,r,o,a=t.data,s=a.length,c=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,u=127*this.luminance(),h=1*c*Math.cos(l*Math.PI/180),p=1*c*Math.sin(l*Math.PI/180),d=.299+.701*h+.167*p,f=.587-.587*h+.33*p,m=.114-.114*h-.497*p,v=.299-.299*h-.328*p,y=.587+.413*h+.035*p,g=.114-.114*h+.293*p,b=.299-.3*h+1.25*p,_=.587-.586*h-1.05*p,w=.114+.886*h-.2*p;for(e=0;e<s;e+=4)n=a[e+0],i=a[e+1],r=a[e+2],o=a[e+3],a[e+0]=d*n+f*i+m*r+u,a[e+1]=v*n+y*i+g*r+u,a[e+2]=b*n+_*i+w*r+u,a[e+3]=o}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(5),o=n(3);e.HSV=function(t){var e,n,i,r,o,a=t.data,s=a.length,c=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,h=c*l*Math.cos(u*Math.PI/180),p=c*l*Math.sin(u*Math.PI/180),d=.299*c+.701*h+.167*p,f=.587*c-.587*h+.33*p,m=.114*c-.114*h-.497*p,v=.299*c-.299*h-.328*p,y=.587*c+.413*h+.035*p,g=.114*c-.114*h+.293*p,b=.299*c-.3*h+1.25*p,_=.587*c-.586*h-1.05*p,w=.114*c+.886*h-.2*p;for(e=0;e<s;e+=4)n=a[e+0],i=a[e+1],r=a[e+2],o=a[e+3],a[e+0]=d*n+f*i+m*r,a[e+1]=v*n+y*i+g*r,a[e+2]=b*n+_*i+w*r,a[e+3]=o},i.Factory.addGetterSetter(r.Node,"hue",0,o.getNumberValidator(),i.Factory.afterSetFilter),i.Factory.addGetterSetter(r.Node,"saturation",0,o.getNumberValidator(),i.Factory.afterSetFilter),i.Factory.addGetterSetter(r.Node,"value",0,o.getNumberValidator(),i.Factory.afterSetFilter)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Invert=function(t){var e,n=t.data,i=n.length;for(e=0;e<i;e+=4)n[e]=255-n[e],n[e+1]=255-n[e+1],n[e+2]=255-n[e+2]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(5),o=n(4),a=n(3);e.Kaleidoscope=function(t){var e,n,i,r,a,s,c,l,u,h=t.width,p=t.height,d=Math.round(this.kaleidoscopePower()),f=Math.round(this.kaleidoscopeAngle()),m=Math.floor(h*(f%360)/360);if(!(d<1)){var v=o.Util.createCanvasElement();v.width=h,v.height=p;var y=v.getContext("2d").getImageData(0,0,h,p);!function(t,e,n){var i,r,o,a,s=t.data,c=e.data,l=t.width,u=t.height,h=n.polarCenterX||l/2,p=n.polarCenterY||u/2,d=0,f=0,m=0,v=0,y=Math.sqrt(h*h+p*p);r=l-h,o=u-p,y=(a=Math.sqrt(r*r+o*o))>y?a:y;var g,b,_,w,x=u,E=l,S=360/E*Math.PI/180;for(b=0;b<E;b+=1)for(_=Math.sin(b*S),w=Math.cos(b*S),g=0;g<x;g+=1)r=Math.floor(h+y*g/x*w),d=s[(i=4*((o=Math.floor(p+y*g/x*_))*l+r))+0],f=s[i+1],m=s[i+2],v=s[i+3],c[(i=4*(b+g*l))+0]=d,c[i+1]=f,c[i+2]=m,c[i+3]=v}(t,y,{polarCenterX:h/2,polarCenterY:p/2});for(var g=h/Math.pow(2,d);g<=8;)g*=2,d-=1;var b=g=Math.ceil(g),_=0,w=b,x=1;for(m+g>h&&(_=b,w=0,x=-1),n=0;n<p;n+=1)for(e=_;e!==w;e+=x)l=4*(h*n+Math.round(e+m)%h),r=y.data[l+0],a=y.data[l+1],s=y.data[l+2],c=y.data[l+3],u=4*(h*n+e),y.data[u+0]=r,y.data[u+1]=a,y.data[u+2]=s,y.data[u+3]=c;for(n=0;n<p;n+=1)for(b=Math.floor(g),i=0;i<d;i+=1){for(e=0;e<b+1;e+=1)l=4*(h*n+e),r=y.data[l+0],a=y.data[l+1],s=y.data[l+2],c=y.data[l+3],u=4*(h*n+2*b-e-1),y.data[u+0]=r,y.data[u+1]=a,y.data[u+2]=s,y.data[u+3]=c;b*=2}!function(t,e,n){var i,r,o,a,s,c,l=t.data,u=e.data,h=t.width,p=t.height,d=n.polarCenterX||h/2,f=n.polarCenterY||p/2,m=0,v=0,y=0,g=0,b=Math.sqrt(d*d+f*f);r=h-d,o=p-f,b=(c=Math.sqrt(r*r+o*o))>b?c:b;var _,w,x,E=p,S=h,C=n.polarRotation||0;for(r=0;r<h;r+=1)for(o=0;o<p;o+=1)a=r-d,s=o-f,_=Math.sqrt(a*a+s*s)*E/b,w=(w=(180*Math.atan2(s,a)/Math.PI+360+C)%360)*S/360,x=Math.floor(w),m=l[(i=4*(Math.floor(_)*h+x))+0],v=l[i+1],y=l[i+2],g=l[i+3],u[(i=4*(o*h+r))+0]=m,u[i+1]=v,u[i+2]=y,u[i+3]=g}(y,t,{polarRotation:0})}},i.Factory.addGetterSetter(r.Node,"kaleidoscopePower",2,a.getNumberValidator(),i.Factory.afterSetFilter),i.Factory.addGetterSetter(r.Node,"kaleidoscopeAngle",0,a.getNumberValidator(),i.Factory.afterSetFilter)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(5),o=n(3);function a(t,e,n){var i=4*(n*t.width+e),r=[];return r.push(t.data[i++],t.data[i++],t.data[i++],t.data[i++]),r}function s(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}e.Mask=function(t){var e=function(t,e){var n=a(t,0,0),i=a(t,t.width-1,0),r=a(t,0,t.height-1),o=a(t,t.width-1,t.height-1),c=e||10;if(s(n,i)<c&&s(i,o)<c&&s(o,r)<c&&s(r,n)<c){for(var l=function(t){for(var e=[0,0,0],n=0;n<t.length;n++)e[0]+=t[n][0],e[1]+=t[n][1],e[2]+=t[n][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}([i,n,o,r]),u=[],h=0;h<t.width*t.height;h++){var p=s(l,[t.data[4*h],t.data[4*h+1],t.data[4*h+2]]);u[h]=p<c?0:255}return u}}(t,this.threshold());return e&&function(t,e){for(var n=0;n<t.width*t.height;n++)t.data[4*n+3]=e[n]}(t,e=function(t,e,n){for(var i=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],r=Math.round(Math.sqrt(i.length)),o=Math.floor(r/2),a=[],s=0;s<n;s++)for(var c=0;c<e;c++){for(var l=s*e+c,u=0,h=0;h<r;h++)for(var p=0;p<r;p++){var d=s+h-o,f=c+p-o;if(d>=0&&d<n&&f>=0&&f<e){var m=i[h*r+p];u+=t[d*e+f]*m}}a[l]=u}return a}(e=function(t,e,n){for(var i=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(i.length)),o=Math.floor(r/2),a=[],s=0;s<n;s++)for(var c=0;c<e;c++){for(var l=s*e+c,u=0,h=0;h<r;h++)for(var p=0;p<r;p++){var d=s+h-o,f=c+p-o;if(d>=0&&d<n&&f>=0&&f<e){var m=i[h*r+p];u+=t[d*e+f]*m}}a[l]=u>=1020?255:0}return a}(e=function(t,e,n){for(var i=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(i.length)),o=Math.floor(r/2),a=[],s=0;s<n;s++)for(var c=0;c<e;c++){for(var l=s*e+c,u=0,h=0;h<r;h++)for(var p=0;p<r;p++){var d=s+h-o,f=c+p-o;if(d>=0&&d<n&&f>=0&&f<e){var m=i[h*r+p];u+=t[d*e+f]*m}}a[l]=2040===u?255:0}return a}(e,t.width,t.height),t.width,t.height),t.width,t.height)),t},i.Factory.addGetterSetter(r.Node,"threshold",0,o.getNumberValidator(),i.Factory.afterSetFilter)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(5),o=n(3);e.Noise=function(t){var e,n=255*this.noise(),i=t.data,r=i.length,o=n/2;for(e=0;e<r;e+=4)i[e+0]+=o-2*o*Math.random(),i[e+1]+=o-2*o*Math.random(),i[e+2]+=o-2*o*Math.random()},i.Factory.addGetterSetter(r.Node,"noise",.2,o.getNumberValidator(),i.Factory.afterSetFilter)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(4),o=n(5),a=n(3);e.Pixelate=function(t){var e,n,i,o,a,s,c,l,u,h,p,d,f,m,v=Math.ceil(this.pixelSize()),y=t.width,g=t.height,b=Math.ceil(y/v),_=Math.ceil(g/v),w=t.data;if(v<=0)r.Util.error("pixelSize value can not be <= 0");else for(d=0;d<b;d+=1)for(f=0;f<_;f+=1){for(o=0,a=0,s=0,c=0,u=(l=d*v)+v,p=(h=f*v)+v,m=0,e=l;e<u;e+=1)if(!(e>=y))for(n=h;n<p;n+=1)n>=g||(o+=w[(i=4*(y*n+e))+0],a+=w[i+1],s+=w[i+2],c+=w[i+3],m+=1);for(o/=m,a/=m,s/=m,c/=m,e=l;e<u;e+=1)if(!(e>=y))for(n=h;n<p;n+=1)n>=g||(w[(i=4*(y*n+e))+0]=o,w[i+1]=a,w[i+2]=s,w[i+3]=c)}},i.Factory.addGetterSetter(o.Node,"pixelSize",8,a.getNumberValidator(),i.Factory.afterSetFilter)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(5),o=n(3);e.Posterize=function(t){var e,n=Math.round(254*this.levels())+1,i=t.data,r=i.length,o=255/n;for(e=0;e<r;e+=1)i[e]=Math.floor(i[e]/o)*o},i.Factory.addGetterSetter(r.Node,"levels",.5,o.getNumberValidator(),i.Factory.afterSetFilter)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(5),o=n(3);e.RGB=function(t){var e,n,i=t.data,r=i.length,o=this.red(),a=this.green(),s=this.blue();for(e=0;e<r;e+=4)n=(.34*i[e]+.5*i[e+1]+.16*i[e+2])/255,i[e]=n*o,i[e+1]=n*a,i[e+2]=n*s,i[e+3]=i[e+3]},i.Factory.addGetterSetter(r.Node,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),i.Factory.addGetterSetter(r.Node,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),i.Factory.addGetterSetter(r.Node,"blue",0,o.RGBComponent,i.Factory.afterSetFilter)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(5),o=n(3);e.RGBA=function(t){var e,n,i=t.data,r=i.length,o=this.red(),a=this.green(),s=this.blue(),c=this.alpha();for(e=0;e<r;e+=4)n=1-c,i[e]=o*c+i[e]*n,i[e+1]=a*c+i[e+1]*n,i[e+2]=s*c+i[e+2]*n},i.Factory.addGetterSetter(r.Node,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),i.Factory.addGetterSetter(r.Node,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),i.Factory.addGetterSetter(r.Node,"blue",0,o.RGBComponent,i.Factory.afterSetFilter),i.Factory.addGetterSetter(r.Node,"alpha",1,(function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sepia=function(t){var e,n,i,r,o=t.data,a=o.length;for(e=0;e<a;e+=4)n=o[e+0],i=o[e+1],r=o[e+2],o[e+0]=Math.min(255,.393*n+.769*i+.189*r),o[e+1]=Math.min(255,.349*n+.686*i+.168*r),o[e+2]=Math.min(255,.272*n+.534*i+.131*r)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Solarize=function(t){var e=t.data,n=t.width,i=4*n,r=t.height;do{var o=(r-1)*i,a=n;do{var s=o+4*(a-1),c=e[s],l=e[s+1],u=e[s+2];c>127&&(c=255-c),l>127&&(l=255-l),u>127&&(u=255-u),e[s]=c,e[s+1]=l,e[s+2]=u}while(--a)}while(--r)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(5),o=n(3);e.Threshold=function(t){var e,n=255*this.threshold(),i=t.data,r=i.length;for(e=0;e<r;e+=1)i[e]=i[e]<n?0:255},i.Factory.addGetterSetter(r.Node,"threshold",.5,o.getNumberValidator(),i.Factory.afterSetFilter)},function(t,e,n){"use strict";var i=n(25);function r(t,e,n){var r=i.extend(n[e.name]||[],t,e,n);Object.defineProperty(n,e.name,{enumerable:e.enumerable,value:r}),r.length&&r.forEach((function(i){t.set(i,e.inverse,n)}))}function o(t,e){if(!(this instanceof o))return new o(t,e);t.inverse=e,e.inverse=t,this.props={},this.props[t.name]=t,this.props[e.name]=e}o.prototype.bind=function(t,e){if("string"==typeof e){if(!this.props[e])throw new Error("no property <"+e+"> in ref");e=this.props[e]}e.collection?r(this,e,t):function(t,e,n){var i=e.inverse,r=n[e.name];Object.defineProperty(n,e.name,{configurable:e.configurable,enumerable:e.enumerable,get:function(){return r},set:function(e){if(e!==r){var o=r;r=null,o&&t.unset(o,i,n),r=e,t.set(r,i,n)}}})}(this,e,t)},o.prototype.ensureRefsCollection=function(t,e){var n=t[e.name];return i.isExtended(n)||r(this,e,t),n},o.prototype.ensureBound=function(t,e){(function(t,e){return Object.prototype.hasOwnProperty.call(t,e.name||e)})(t,e)||this.bind(t,e)},o.prototype.unset=function(t,e,n){t&&(this.ensureBound(t,e),e.collection?this.ensureRefsCollection(t,e).remove(n):t[e.name]=void 0)},o.prototype.set=function(t,e,n){t&&(this.ensureBound(t,e),e.collection?this.ensureRefsCollection(t,e).add(n):t[e.name]=n)},t.exports=o},function(t,e,n){},function(t,e,n){"use strict";function i(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}n.r(e);var o=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=n):this.el=e,this.data={}}var e,n,o;return e=t,(n=[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,e){var n=i(t.split(".")),r=n[0],o=n.slice(1),a=r;return"mousewheel"===a&&/Firefox/i.test(window.navigator.userAgent)&&(a="DOMMouseScroll"),this.el.addEventListener(a,(function(t){e(t);for(var n=0;n<o.length;n+=1){var i=o[n];if("left"===i&&0!==t.button)return;if("right"===i&&2!==t.button)return;"stop"===i&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(n){e.css(n,"".concat(t[n],"px"))})),this;var n=this.el;return{top:n.offsetTop,left:n.offsetLeft,height:n.offsetHeight,width:n.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return 0===arguments.length?this.el.childNodes:(n.forEach((function(e){return t.child(e)})),this)}},{key:"child",value:function(e){var n=e;return"string"==typeof e?n=document.createTextNode(e):e instanceof t&&(n=e.el),this.el.appendChild(n),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var n=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){n.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return n.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var n=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach((function(e){n.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}])&&r(e.prototype,n),o&&r(e,o),t}(),a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new o(t,e)};function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var c=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function l(t){for(var e="",n=t;n>=c.length;)n/=c.length,n-=1,e+=c[parseInt(n,10)%c.length];var i=t%c.length;return e+=c[i]}function u(t){for(var e=0,n=0;n<t.length-1;n+=1){var i=t.charCodeAt(n)-65,r=t.length-1-n;e+=Math.pow(c.length,r)+c.length*i}return e+=t.charCodeAt(t.length-1)-65}function h(t){for(var e="",n="",i=0;i<t.length;i+=1)t.charAt(i)>="0"&&t.charAt(i)<="9"?n+=t.charAt(i):e+=t.charAt(i);return[u(e),parseInt(n,10)-1]}function p(t,e,n){var i=s(h(t),2),r=i[0],o=i[1];return l(r+e)+(o+n)}function d(t,e){return"".concat(l(t)).concat(e+1)}function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var v=function(){function t(e,n,i,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sri=e,this.sci=n,this.eri=i,this.eci=r,this.w=o,this.h=a}var e,n,i;return e=t,i=[{key:"valueOf",value:function(e){var n=e.split(":"),i=f(h(n[0]),2),r=i[0],o=i[1],a=o,s=r;if(n.length>1){var c=f(h(n[1]),2);s=c[0],a=c[1]}return new t(o,r,a,s)}}],(n=[{key:"set",value:function(t,e,n,i){this.sri=t,this.sci=e,this.eri=n,this.eci=i}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];if(1===i.length){var o=h(i[0]),a=f(o,2);e=a[0],t=a[1]}else 2===i.length&&(t=i[0],e=i[1]);var s=this.sri,c=this.sci,l=this.eri,u=this.eci;return s<=t&&t<=l&&c<=e&&e<=u}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=this.sri,i=this.sci,r=this.eri,o=this.eci,a=n;a<=r;a+=1)if(e(a))for(var s=i;s<=o;s+=1)t(a,s)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var n=this.sri,i=this.sci,r=this.eri,o=this.eci;return new t(e.sri<n?e.sri:n,e.sci<i?e.sci:i,e.eri>r?e.eri:r,e.eci>o?e.eci:o)}},{key:"difference",value:function(e){var n=[],i=function(e,i,r,o){n.push(new t(e,i,r,o))},r=this.sri,o=this.sci,a=this.eri,s=this.eci,c=e.sri-r,l=e.sci-o,u=a-e.eri,h=s-e.eci;return c>0?(i(r,o,e.sri-1,s),u>0?(i(e.eri+1,o,a,s),l>0&&i(e.sri,o,e.eri,e.sci-1),h>0&&i(e.sri,e.eci+1,e.eri,s)):(l>0&&i(e.sri,o,a,e.sci-1),h>0&&i(e.sri,e.eci+1,a,s))):u>0&&(i(e.eri+1,o,a,s),l>0&&i(r,o,e.eri,e.sci-1),h>0&&i(r,e.eci+1,e.eri,s)),l>0?(i(r,o,a,e.sci-1),h>0?(i(r,e.eri+1,a,s),c>0&&i(r,e.sci,e.sri-1,e.eci),u>0&&i(e.sri+1,e.sci,a,e.eci)):(c>0&&i(r,e.sci,e.sri-1,s),u>0&&i(e.sri+1,e.sci,a,s))):h>0&&(i(a,e.eci+1,a,s),c>0&&i(r,o,e.sri-1,e.eci),u>0&&i(e.eri+1,o,a,e.eci)),n}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,n=this.eri,i=this.eci,r=d(e,t);return this.multiple()&&(r="".concat(r,":").concat(d(i,n))),r}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}])&&m(e.prototype,n),i&&m(e,i),t}();function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var g=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=new v(0,0,0,0),this.ri=0,this.ci=0}var e,n,i;return e=t,(n=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}])&&y(e.prototype,n),i&&y(e,i),t}();var b=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0};function _(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var w=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.undoItems=[],this.redoItems=[]}var e,n,i;return e=t,(n=[{key:"add",value:function(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(t,e){var n=this.undoItems,i=this.redoItems;this.canUndo()&&(i.push(JSON.stringify(t)),e(JSON.parse(n.pop())))}},{key:"redo",value:function(t,e){var n=this.undoItems,i=this.redoItems;this.canRedo()&&(n.push(JSON.stringify(t)),e(JSON.parse(i.pop())))}}])&&_(e.prototype,n),i&&_(e,i),t}();function x(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var E=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=null,this.state="clear"}var e,n,i;return e=t,(n=[{key:"copy",value:function(t){return this.range=t,this.state="copy",this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}])&&x(e.prototype,n),i&&x(e,i),t}();function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function k(t,e,n){return e&&C(t.prototype,e),n&&C(t,n),t}var P=function(){function t(e,n,i){S(this,t),this.ci=e,this.operator=n,this.value=i}return k(t,[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,n=this.value;return"all"===e||"in"===e&&n.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}]),t}(),T=function(){function t(e,n){S(this,t),this.ci=e,this.order=n}return k(t,[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}]),t}(),O=function(){function t(){S(this,t),this.ref=null,this.filters=[],this.sort=null}return k(t,[{key:"setData",value:function(t){var e=t.ref,n=t.filters,i=t.sort;null!=e&&(this.ref=e,this.fitlers=n.map((function(t){return new P(t.ci,t.operator,t.value)})),i&&(this.sort=new T(i.ci,i.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,n=this.sort;return{ref:t,filters:e.map((function(t){return t.getData()})),sort:n}}return{}}},{key:"addFilter",value:function(t,e,n){var i=this.getFilter(t);null==i?this.filters.push(new P(t,e,n)):i.set(e,n)}},{key:"setSort",value:function(t,e){this.sort=e?new T(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,n=0;n<e.length;n+=1)if(e[n].ci===t)return e[n];return null}},{key:"filteredRows",value:function(t){var e=new Set,n=new Set;if(this.active())for(var i=this.range(),r=i.sri,o=i.eri,a=this.filters,s=r+1;s<=o;s+=1)for(var c=0;c<a.length;c+=1){var l=a[c],u=t(s,l.ci),h=u?u.text:"";if(!l.includes(h)){e.add(s);break}n.add(s)}return{rset:e,fset:n}}},{key:"items",value:function(t,e){var n={};if(this.active())for(var i=this.range(),r=i.sri,o=i.eri,a=r+1;a<=o;a+=1){var s=e(a,t);if(null===s||/^\s*$/.test(s.text))n[""]=(n[""]||0)+1;else{var c=s.text,l=(n[c]||0)+1;n[c]=l}}return n}},{key:"range",value:function(){return v.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}]),t}();function A(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var M=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._=e}var e,n,i;return e=t,(n=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter((function(e){return!e.within(t)}))}},{key:"getFirstIncludes",value:function(t,e){for(var n=0;n<this._.length;n+=1){var i=this._[n];if(i.includes(t,e))return i}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter((function(t){return t.intersects(e)})))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1)if(this._[e].intersects(t))return!0;return!1}},{key:"union",value:function(t){var e=t;return this._.forEach((function(t){t.intersects(e)&&(e=t.union(e))})),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,n,i){this._.forEach((function(r){var o=r.sri,a=r.sci,s=r.eri,c=r.eci,l=r;"row"===t?o>=e?(l.sri+=n,l.eri+=n):o<e&&e<=s&&(l.eri+=n,i(o,a,n,0)):"column"===t&&(a>=e?(l.sci+=n,l.eci+=n):a<e&&e<=c&&(l.eci+=n,i(o,a,0,n)))}))}},{key:"move",value:function(t,e,n){this._.forEach((function(i){var r=i;r.within(t)&&(r.eri+=e,r.sri+=e,r.sci+=n,r.eci+=n)}))}},{key:"setData",value:function(t){return this._=t.map((function(t){return v.valueOf(t)})),this}},{key:"getData",value:function(){return this._.map((function(t){return t.toString()}))}}])&&A(e.prototype,n),i&&A(e,i),t}();var j=function t(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.forEach((function(n){Object.keys(n).forEach((function(i){var r=n[i];"string"==typeof r||"number"==typeof r||"boolean"==typeof r?e[i]=r:"function"!=typeof r&&!Array.isArray(r)&&r instanceof Object?(e[i]=e[i]||{},t(e[i],r)):e[i]=r}))})),e};var R={cloneDeep:function(t){return JSON.parse(JSON.stringify(t))},merge:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j.apply(void 0,[{}].concat(e))},equals:function t(e,n){var i=Object.keys(e);if(i.length!==Object.keys(n).length)return!1;for(var r=0;r<i.length;r+=1){var o=i[r],a=e[o],s=n[o];if(void 0===s)return!1;if("string"==typeof a||"number"==typeof a||"boolean"==typeof a){if(a!==s)return!1}else if(Array.isArray(a)){if(a.length!==s.length)return!1;for(var c=0;c<a.length;c+=1)if(!t(a[c],s[c]))return!1}else if("function"!=typeof a&&!Array.isArray(a)&&a instanceof Object&&!t(a,s))return!1}return!0},arrayEquals:function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(t[n]!==e[n])return!1;return!0},sum:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n=0,i=0;return Object.keys(t).forEach((function(r){n+=e(t[r],r),i+=1})),[n,i]},rangeEach:function(t,e,n){for(var i=t;i<e;i+=1)n(i)},rangeSum:function(t,e,n){for(var i=0,r=t;r<e;r+=1)i+=n(r);return i},rangeReduceIf:function(t,e,n,i,r,o){for(var a=n,s=i,c=t;c<e&&!(a>r);c+=1)a+=s=o(c);return[c,a-s,s]},deleteProperty:function(t,e){var n=t["".concat(e)];return delete t["".concat(e)],n}};function D(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function N(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var I=function(){function t(e){var n=e.len,i=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.height=i}var e,n,i;return e=t,(n=[{key:"getHeight",value:function(t){var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e,n){var i=this;return R.rangeSum(t,e,(function(t){return n&&n.has(t)?0:i.getHeight(t)}))}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var n=this.get(t);return void 0!==n&&void 0!==n.cells&&void 0!==n.cells[e]?n.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var n=this.getCell(t,e);return n&&n.merge?n.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var n=this.getOrNew(t);return n.cells[e]=n.cells[e]||{},n.cells[e]}},{key:"setCell",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",r=this.getOrNew(t);"all"===i?r.cells[e]=n:"text"===i?(r.cells[e]=r.cells[e]||{},r.cells[e].text=n.text):"format"===i&&(r.cells[e]=r.cells[e]||{},r.cells[e].style=n.style,n.merge&&(r.cells[e].merge=n.merge))}},{key:"setCellText",value:function(t,e,n){this.getCellOrNew(t,e).text=n}},{key:"copyPaste",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o=t.sri,a=t.sci,s=t.eri,c=t.eci,l=e.sri,u=e.sci,h=e.eri,d=e.eci,f=t.size(),m=D(f,2),v=m[0],y=m[1],g=e.size(),b=D(g,2),_=b[0],w=b[1],x=!0,E=0;(h<o||d<a)&&(x=!1,E=h<o?_:w);for(var S=o;S<=s;S+=1)if(this._[S])for(var C=a;C<=c;C+=1)if(this._[S].cells&&this._[S].cells[C])for(var k=l;k<=h;k+=v)for(var P=u;P<=d;P+=y){var T=k+(S-o),O=P+(C-a),A=R.cloneDeep(this._[S].cells[C]);i&&A&&A.text&&A.text.length>0&&function(){var t=A.text,e=P-u+(k-l)+1;if(x||(e-=E+1),"="===t[0])A.text=t.replace(/\w{1,3}\d/g,(function(t){var n=0,i=0;return o===l?n=e:i=e,p(t,n,i)}));else{var n=/[\\.\d]+$/.exec(t);if(null!==n){var i=Number(n[0])+e;A.text=t.substring(0,n.index)+i}}}(),this.setCell(T,O,A,n),r(T,O,A)}}},{key:"cutPaste",value:function(t,e){var n=this,i={};this.each((function(r){n.eachCells(r,(function(o){var a=parseInt(r,10),s=parseInt(o,10);t.includes(r,o)&&(a=e.sri+(a-t.sri),s=e.sci+(s-t.sci)),i[a]=i[a]||{cells:{}},i[a].cells[s]=n._[r].cells[o]}))})),this._=i}},{key:"insert",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n={};this.each((function(i,r){var o=parseInt(i,10);o>=t&&(o+=e),n[o]=r})),this._=n,this.len+=e}},{key:"delete",value:function(t,e){var n=e-t+1,i={};this.each((function(r,o){var a=parseInt(r,10);a<t?i[a]=o:r>e&&(i[a-n]=o)})),this._=i,this.len-=n}},{key:"insertColumn",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each((function(i,r){var o={};e.eachCells(i,(function(e,i){var r=parseInt(e,10);r>=t&&(r+=n),o[r]=i})),r.cells=o}))}},{key:"deleteColumn",value:function(t,e){var n=this,i=e-t+1;this.each((function(r,o){var a={};n.eachCells(r,(function(n,r){var o=parseInt(n,10);o<t?a[o]=r:o>e&&(a[o-i]=r)})),o.cells=a}))}},{key:"deleteCells",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each((function(t,i){e.deleteCell(t,i,n)}))}},{key:"deleteCell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",i=this.get(t);if(null!==i){var r=this.getCell(t,e);null!==r&&("all"===n?delete i.cells[e]:"text"===n?(r.text&&delete r.text,r.value&&delete r.value):"format"===n?(void 0!==r.style&&delete r.style,r.merge&&delete r.merge):"merge"===n&&r.merge&&delete r.merge)}}},{key:"each",value:function(t){Object.entries(this._).forEach((function(e){var n=D(e,2),i=n[0],r=n[1];t(i,r)}))}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach((function(t){var n=D(t,2),i=n[0],r=n[1];e(i,r)}))}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}])&&N(e.prototype,n),i&&N(e,i),t}();function L(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var B=function(){function t(e){var n=e.len,i=e.width,r=e.indexWidth,o=e.minWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.width=i,this.indexWidth=r,this.minWidth=o}var e,n,i;return e=t,(n=[{key:"setData",value:function(t){console.log("col setData:",t),t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){console.log("col setWidth: ",t,e),this.getOrNew(t).width=e}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var n=this;return R.rangeSum(t,e,(function(t){return n.getWidth(t)}))}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&L(e.prototype,n),i&&L(e,i),t}(),F="en",z={en:{toolbar:{undo:"Undo",redo:"Redo",paintformat:"Paint format",clearformat:"Clear format",format:"Format",font:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",textColor:"Text color",fillColor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",overlayer:"OverLayer enable",autofilter:"Filter",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",insertRow:"Insert row",insertColumn:"Insert column",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations"},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}};function G(t,e){if(e&&e[F])for(var n=e[F],i=t.split("."),r=0;r<i.length;r+=1){var o=n[i[r]];if(r===i.length-1)return o;if(!o)return;n=o}}function V(t){var e=G(t,z);return!e&&window&&window.x&&window.x.spreadsheet&&window.x.spreadsheet.$messages&&(e=G(t,window.x.spreadsheet.$messages)),e||""}function H(t){return function(){return V(t)}}function U(t,e){F=t,e&&(z[t]=e)}function W(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function $(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var q={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function K(t,e){var n="";if(!t){for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];n=V.apply(void 0,["validation.".concat(e)].concat(r))}return[t,n]}var Y=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.required=n,this.value=i,this.type=e,this.operator=r,this.message=""}var e,n,i;return e=t,(n=[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){var e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?R.arrayEquals(this.value,t.value):this.value===t.value),e}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,n=this.operator,i=this.value,r=this.type;if(e&&/^\s*$/.test(t))return K(!1,"required");if(/^\s*$/.test(t))return[!0];if(q[r]&&!q[r].test(t))return K(!1,"notMatch");if("list"===r)return K(this.values().includes(t),"notIn");if(n){var o=this.parseValue(t);if("be"===n){var a=W(i,2),s=a[0],c=a[1];return K(o>=this.parseValue(s)&&o<=this.parseValue(c),"between",s,c)}if("nbe"===n){var l=W(i,2),u=l[0],h=l[1];return K(o<this.parseValue(u)||o>this.parseValue(h),"notBetween",u,h)}if("eq"===n)return K(o===this.parseValue(i),"equal",i);if("neq"===n)return K(o!==this.parseValue(i),"notEqual",i);if("lt"===n)return K(o<this.parseValue(i),"lessThan",i);if("lte"===n)return K(o<=this.parseValue(i),"lessThanEqual",i);if("gt"===n)return K(o>this.parseValue(i),"greaterThan",i);if("gte"===n)return K(o>=this.parseValue(i),"greaterThanEqual",i)}return[!0]}}])&&$(e.prototype,n),i&&$(e,i),t}();function X(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function J(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Q(t,e,n){return e&&J(t.prototype,e),n&&J(t,n),t}var tt=function(){function t(e,n,i){Z(this,t),this.refs=n,this.mode=e,this.validator=i}return Q(t,[{key:"includes",value:function(t,e){for(var n=this.refs,i=0;i<n.length;i+=1){if(v.valueOf(n[i]).includes(t,e))return!0}return!1}},{key:"addRef",value:function(t){this.remove(v.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(t){var e=[];this.refs.forEach((function(n){var i=v.valueOf(n);i.intersects(t)?i.difference(t).forEach((function(t){return e.push(t.toString())})):e.push(n)})),this.refs=e}},{key:"getData",value:function(){var t=this.refs,e=this.mode,n=this.validator;return{refs:t,mode:e,type:n.type,required:n.required,operator:n.operator,value:n.value}}}],[{key:"valueOf",value:function(e){var n=e.refs,i=e.mode,r=e.type,o=e.required,a=e.operator,s=e.value;return new t(i,n,new Y(r,o,s,a))}}]),t}(),et=function(){function t(){Z(this,t),this._=[],this.errors=new Map}return Q(t,[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,n){var i=this.get(t,e),r="".concat(t,"_").concat(e),o=this.errors;if(null!==i){var a=X(i.validator.validate(n),2),s=a[0],c=a[1];s?o.delete(r):o.set(r,c)}else o.delete(r);return!0}},{key:"add",value:function(t,e,n){var i=n.type,r=n.required,o=n.value,a=n.operator,s=new Y(i,r,o,a),c=this.getByValidator(s);null!==c?c.addRef(e):this._.push(new tt(t,[e],s))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var n=this._[e];if(n.validator.equals(t))return n}return null}},{key:"get",value:function(t,e){for(var n=0;n<this._.length;n+=1){var i=this._[n];if(i.includes(t,e))return i}return null}},{key:"remove",value:function(t){this.each((function(e){e.remove(t)}))}},{key:"each",value:function(t){this._.forEach((function(e){return t(e)}))}},{key:"getData",value:function(){return this._.filter((function(t){return t.refs.length>0})).map((function(t){return t.getData()}))}},{key:"setData",value:function(t){this._=t.map((function(t){return tt.valueOf(t)}))}}]),t}();function nt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var it=function(){function t(e){var n=e.draggable;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.draggable=n}var e,n,i;return e=t,(n=[{key:"setData",value:function(t){console.log("shapes setData:",t),this._=t}},{key:"getData",value:function(){return Object.assign(this._)}}])&&nt(e.prototype,n),i&&nt(e,i),t}();function rt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ot(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function at(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var st={view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showGrid:!0,showToolbar:!0,showContextmenu:!0,row:{len:1e3,height:20},col:{len:1e3,width:100,indexWidth:60,minWidth:60},shape:{draggable:!0},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1}}};function ct(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=this.merges,r=e.clone(),o=at(t.size(),2),a=o[0],s=o[1],c=at(e.size(),2),l=c[0],u=c[1];return a>l&&(r.eri=e.sri+a-1),s>u&&(r.eci=e.sci+s-1),!i.intersects(r)||(n(V("error.pasteForMergedCell")),!1)}function lt(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.rows,o=this.merges;"all"!==n&&"format"!==n||(r.deleteCells(e,n),o.deleteWithin(e)),r.copyPaste(t,e,n,i,(function(t,e,n){if(n&&n.merge){var i=at(n.merge,2),r=i[0],a=i[1];if(r<=0&&a<=0)return;o.add(new v(t,e,t+r,e+a))}}))}function ut(t,e){var n=this.clipboard,i=this.rows,r=this.merges;i.cutPaste(t,e),r.move(t,e.sri-t.sri,e.sci-t.sci),n.clear()}function ht(t,e,n){var i=this.styles,r=this.rows.getCellOrNew(t,e),o={};void 0!==r.style&&(o=R.cloneDeep(i[r.style])),Object.assign(o,{border:n}),r.style=this.addStyle(o)}function pt(t){var e=this,n=t.mode,i=t.style,r=t.color,o=this.styles,a=this.selector,s=this.rows,c=a.range,l=c.sri,u=c.sci,h=c.eri,p=c.eci,d=!this.isSignleSelected();if(d||"inside"!==n&&"horizontal"!==n&&"vertical"!==n)if("outside"!==n||d){if("none"===n)a.range.each((function(t,n){var i=s.getCell(t,n);if(i&&void 0!==i.style){var r=R.cloneDeep(o[i.style]);delete r.border,i.style=e.addStyle(r)}}));else if("all"===n||"inside"===n||"outside"===n||"horizontal"===n||"vertical"===n)!function(){for(var t=[],o=l;o<=h;o+=1)for(var a=u;a<=p;a+=1){for(var c=[],f=0;f<t.length;f+=1){var m=at(t[f],4),v=m[0],y=m[1],g=m[2],b=m[3];if(o===v+g+1&&c.push(f),v<=o&&o<=v+g&&a===y){a+=b+1;break}}if(c.forEach((function(e){return t.splice(e,1)})),a>p)break;var _=s.getCell(o,a),w=0,x=0;if(_&&_.merge){var E=at(_.merge,2);w=E[0],x=E[1],t.push([o,a,w,x])}var S=w>0&&o+w===h,C=x>0&&a+x===p,k={};"all"===n?k={bottom:[i,r],top:[i,r],left:[i,r],right:[i,r]}:"inside"===n?(!C&&a<p&&(k.right=[i,r]),!S&&o<h&&(k.bottom=[i,r])):"horizontal"===n?!S&&o<h&&(k.bottom=[i,r]):"vertical"===n?!C&&a<p&&(k.right=[i,r]):"outside"===n&&d&&(l===o&&(k.top=[i,r]),(S||h===o)&&(k.bottom=[i,r]),u===a&&(k.left=[i,r]),(C||p===a)&&(k.right=[i,r])),Object.keys(k).length>0&&ht.call(e,o,a,k),a+=x}}();else if("top"===n||"bottom"===n)for(var f=u;f<=p;f+=1)"top"===n&&(ht.call(this,l,f,{top:[i,r]}),f+=s.getCellMerge(l,f)[1]),"bottom"===n&&(ht.call(this,h,f,{bottom:[i,r]}),f+=s.getCellMerge(h,f)[1]);else if("left"===n||"right"===n)for(var m=l;m<=h;m+=1)"left"===n&&(ht.call(this,m,u,{left:[i,r]}),m+=s.getCellMerge(m,u)[0]),"right"===n&&(ht.call(this,m,p,{right:[i,r]}),m+=s.getCellMerge(m,p)[0])}else ht.call(this,l,u,{top:[i,r],bottom:[i,r],left:[i,r],right:[i,r]})}function dt(t,e){var n=this.rows,i=this.freezeTotalHeight(),r=n.height;i+n.height<t&&(r-=e);for(var o=this.exceptRowSet,a=0,s=r,c=n.height;a<n.len&&!(s>t);a+=1)o.has(a)||(s+=c=n.getHeight(a));return(s-=c)<=0?{ri:-1,top:0,height:c}:{ri:a-1,top:s,height:c}}function ft(t,e){var n=this.cols,i=this.freezeTotalWidth(),r=n.indexWidth;i+n.indexWidth<t&&(r-=e);var o=at(R.rangeReduceIf(0,n.len,r,n.indexWidth,t,(function(t){return n.getWidth(t)})),3),a=o[0],s=o[1],c=o[2];return s<=0?{ci:-1,left:0,width:n.indexWidth}:{ci:a-1,left:s,width:c}}var mt=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=R.merge(st,n||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new M,this.rows=new I(this.settings.row),this.cols=new B(this.settings.col),this.shapes=new it(this.settings.shape),console.log(this.rows),console.log(this.cols),console.log(this.shapes),this.validations=new et,this.hyperlinks={},this.comments={},this.selector=new g,this.scroll=new b,this.history=new w,this.clipboard=new E,this.autoFilter=new O,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,this.h_splitSheets=new Array,this.v_splitSheets=new Array}var e,n,i;return e=t,(n=[{key:"addValidation",value:function(t,e,n){var i=this;this.changeData((function(){i.validations.add(t,e,n)}))}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData((function(){t.validations.remove(e)}))}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,n=t.ci,i=this.validations.get(e,n);return i?i.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,n=t.ci,i=t.range,r=this.validations.get(e,n),o={ref:i.toString()};return null!==r&&(o.mode=r.mode,o.validator=r.validator),o}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var t=this;this.history.undo(this.getData(),(function(e){t.setData(e)}))}},{key:"redo",value:function(){var t=this;this.history.redo(this.getData(),(function(e){t.setData(e)}))}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},i=this.clipboard,r=this.selector;return!i.isClear()&&!!ct.call(this,i.range,r.range,n)&&(this.changeData((function(){i.isCopy()?lt.call(t,i.range,r.range,e):i.isCut()&&ut.call(t,i.range,r.range)})),!0)}},{key:"autofill",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=this.selector.range;return!!ct.call(this,r,t,i)&&(this.changeData((function(){lt.call(n,r,t,e,!0)})),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var n=this.selector,i=this.rows,r=this.cols,o=this.merges,a=n.range,s=a.sri,c=a.sci,l=a.eri,u=a.eci,h=n.ri,p=n.ci,d=t,f=e;return t<0&&(d=i.len-1),e<0&&(f=r.len-1),d>h?(s=h,l=d):(s=d,l=h),f>p?(c=p,u=f):(c=f,u=p),n.range=o.union(new v(s,c,l,u)),n.range=o.union(n.range),n.range}},{key:"calSelectedRangeByStart",value:function(t,e){var n=this.selector,i=this.rows,r=this.cols,o=this.merges.getFirstIncludes(t,e);return null===o&&(o=new v(t,e,t,e),-1===t&&(o.sri=0,o.eri=i.len-1),-1===e&&(o.sci=0,o.eci=r.len-1)),n.range=o,o}},{key:"setSelectedCellAttr",value:function(t,e){var n=this;this.changeData((function(){var i=n.selector,r=n.styles,o=n.rows;"merge"===t?e?n.merge():n.unmerge():"border"===t?pt.call(n,e):"formula"===t?o.getCellOrNew(i.ri,i.ci).text="=".concat(e,"()"):i.range.each((function(i,a){var s=o.getCellOrNew(i,a),c={};if(void 0!==s.style&&(c=R.cloneDeep(r[s.style])),"format"===t)c.format=e,s.style=n.addStyle(c);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var l={};l[t.split("-")[1]]=e,c.font=Object.assign(c.font||{},l),s.style=n.addStyle(c)}else"strike"!==t&&"textwrap"!==t&&"underline"!==t&&"align"!==t&&"valign"!==t&&"color"!==t&&"bgcolor"!==t||(c[t]=e,s.style=n.addStyle(c))}))}))}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",n=this.selector,i=n.ri,r=n.ci,o=i;this.unsortedRowMap.has(i)&&(o=this.unsortedRowMap.get(i)),this.setCellText(o,r,t,e),this.resetAutoFilter()}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,n=t.ci,i=e;return this.unsortedRowMap.has(e)&&(i=this.unsortedRowMap.get(e)),this.rows.getCell(i,n)}},{key:"xyInSelectedRect",value:function(t,e){var n=this.getSelectedRect(),i=n.left,r=n.top,o=n.width,a=n.height,s=t-this.cols.indexWidth,c=e-this.rows.height;return s>i&&s<i+o&&c>r&&c<r+a}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,n=this.rows,i=this.cols,r=this.exceptRowSet,o=t.sri,a=t.sci,s=t.eri,c=t.eci;if(o<0&&a<0)return{left:0,l:0,top:0,t:0,scroll:e};var l=i.sumWidth(0,a),u=n.sumHeight(0,o,r),h=n.sumHeight(o,s+1,r),p=i.sumWidth(a,c+1),d=l-e.x,f=u-e.y,m=this.freezeTotalHeight(),v=this.freezeTotalWidth();return v>0&&v>l&&(d=l),m>0&&m>u&&(f=u),{l:l,t:u,left:d,top:f,height:h,width:p,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var n=this.scroll,i=this.merges,r=this.rows,o=this.cols,a=dt.call(this,e,n.y),s=a.ri,c=a.top,l=a.height,u=ft.call(this,t,n.x),h=u.ci,p=u.left,d=u.width;if(-1===h&&(d=o.totalWidth()),-1===s&&(l=r.totalHeight()),s>=0||h>=0){var f=i.getFirstIncludes(s,h);if(f){s=f.sri,h=f.sci;var m=this.cellRect(s,h);p=m.left,c=m.top,d=m.width,l=m.height}}return{ri:s,ci:h,left:p,top:c,width:d,height:l}}},{key:"isSignleSelected",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,i=t.eri,r=t.eci,o=this.getCell(e,n);if(o&&o.merge){var a=at(o.merge,2),s=a[0],c=a[1];if(e+s===i&&n+c===r)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,i=t.eri,r=t.eci,o=this.getCell(e,n);if(o&&o.merge){var a=at(o.merge,2),s=a[0],c=a[1];if(e+s===i&&n+c===r)return!0}return!1}},{key:"merge",value:function(){var t=this,e=this.selector,n=this.rows;if(!this.isSignleSelected()){var i=at(e.size(),2),r=i[0],o=i[1];if(r>1||o>1){var a=e.range,s=a.sri,c=a.sci;this.changeData((function(){var i=n.getCellOrNew(s,c);i.merge=[r-1,o-1],t.merges.add(e.range),t.rows.deleteCells(e.range),t.rows.setCell(s,c,i)}))}}}},{key:"unmerge",value:function(){var t=this,e=this.selector;if(this.isSignleSelected()){var n=e.range,i=n.sri,r=n.sci;this.changeData((function(){t.rows.deleteCell(i,r,"merge"),t.merges.deleteWithin(e.range)}))}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,n=this.selector;this.changeData((function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=n.range.toString()}))}},{key:"setAutoFilter",value:function(t,e,n,i){var r=this.autoFilter;r.addFilter(t,n,i),r.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.autoFilter,n=this.rows;if(e.active()){var i=e.sort,r=e.filteredRows((function(t,e){return n.getCell(t,e)})),o=r.rset,a=r.fset,s=Array.from(a),c=Array.from(a);i&&s.sort((function(t,e){return"asc"===i.order?t-e:"desc"===i.order?e-t:0})),this.exceptRowSet=o,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,s.forEach((function(e,n){t.sortedRowMap.set(c[n],e),t.unsortedRowMap.set(e,c[n])}))}}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=this.selector;this.changeData((function(){t.rows.deleteCells(n.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(n.range)}))}},{key:"insert",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData((function(){var i=e.selector.range,r=i.sri,o=i.sci,a=e.rows,s=e.merges,c=e.cols,l=r;"row"===t?a.insert(r,n):"column"===t&&(a.insertColumn(o,n),l=o,c.len+=1),s.shift(t,l,n,(function(t,e,n,i){var r=a.getCell(t,e);r.merge[0]+=n,r.merge[1]+=i}))}))}},{key:"delete",value:function(t){var e=this;this.changeData((function(){var n=e.rows,i=e.merges,r=e.selector,o=e.cols,a=r.range,s=r.range,c=s.sri,l=s.sci,u=s.eri,h=s.eci,p=at(r.range.size(),2),d=p[0],f=p[1],m=c,v=d;"row"===t?n.delete(c,u):"column"===t&&(n.deleteColumn(l,h),m=a.sci,v=f,o.len-=1),i.shift(t,m,-v,(function(t,e,i,r){var o=n.getCell(t,e);o.merge[0]+=i,o.merge[1]+=r,0===o.merge[0]&&0===o.merge[1]&&delete o.merge}))}))}},{key:"scrollx",value:function(t,e){console.log("scrollx: ");var n=this.scroll,i=this.freeze,r=this.cols,o=at(i,2)[1],a=at(R.rangeReduceIf(o,r.len,0,0,t,(function(t){return r.getWidth(t)})),3),s=a[0],c=a[1],l=a[2],u=c;t>0&&(u+=l),n.x!==u&&(n.ci=t>0?s:0,n.x=u,e()),this.v_splitSheets.forEach((function(e){console.log("movex: ",t),e.sync_movex(t)}))}},{key:"sync_scrollx",value:function(t,e){var n=this.scroll,i=this.freeze,r=this.cols,o=at(i,2)[1],a=at(R.rangeReduceIf(o,r.len,0,0,t,(function(t){return r.getWidth(t)})),3),s=a[0],c=a[1],l=a[2],u=c;t>0&&(u+=l),n.x!==u&&(n.ci=t>0?s:0,n.x=u,e())}},{key:"scrolly",value:function(t,e){console.log("scrolly: ");var n=this.scroll,i=this.freeze,r=this.rows,o=at(i,1)[0],a=at(R.rangeReduceIf(o,r.len,0,0,t,(function(t){return r.getHeight(t)})),3),s=a[0],c=a[1],l=a[2],u=c;t>0&&(u+=l),n.y!==u&&(n.ri=t>0?s:0,n.y=u,e()),this.h_splitSheets.forEach((function(e){console.log("movey: ",t),e.sync_movey(t)}))}},{key:"sync_scrolly",value:function(t,e){var n=this.scroll,i=this.freeze,r=this.rows,o=at(i,1)[0],a=at(R.rangeReduceIf(o,r.len,0,0,t,(function(t){return r.getHeight(t)})),3),s=a[0],c=a[1],l=a[2],u=c;t>0&&(u+=l),n.y!==u&&(n.ri=t>0?s:0,n.y=u,e())}},{key:"cellRect",value:function(t,e){var n=this.rows,i=this.cols,r=i.sumWidth(0,e),o=n.sumHeight(0,t),a=n.getCell(t,e),s=i.getWidth(e),c=n.getHeight(t);if(null!==a&&a.merge){var l=at(a.merge,2),u=l[0],h=l[1];if(u>0)for(var p=1;p<=u;p+=1)c+=n.getHeight(t+p);if(h>0)for(var d=1;d<=h;d+=1)s+=i.getWidth(e+d)}return{left:r,top:o,width:s,height:c,cell:a}}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){var n=this.getCell(t,e);return n&&n.text?n.text:""}},{key:"getCellStyle",value:function(t,e){var n=this.getCell(t,e);return n&&void 0!==n.style?this.styles[n.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var n=this.styles,i=this.rows.getCell(t,e),r=i&&void 0!==i.style?n[i.style]:{};return R.merge(this.defaultStyle(),r)}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,n=t.ci;return this.getCellStyleOrDefault(e,n)}},{key:"setCellText",value:function(t,e,n,i){var r=this,o=this.rows,a=this.history,s=this.validations;"finished"===i?(o.setCellText(t,e,""),a.add(this.getData()),this.changeData((function(){r.rows.setCellText(t,e,n)}))):(o.setCellText(t,e,n),this.change(this.getData())),s.validate(t,e,n)}},{key:"freezeIsActive",value:function(){var t=at(this.freeze,2),e=t[0],n=t[1];return e>0||n>0}},{key:"setFreeze",value:function(t,e){var n=this;this.changeData((function(){n.freeze=[t,e]}))}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(t,e){var n=this;this.changeData((function(){n.rows.setHeight(t,e)}))}},{key:"setColWidth",value:function(t,e){var n=this;this.changeData((function(){n.cols.setWidth(t,e)}))}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,n=t.showToolbar,i=e.height();return n&&(i-=41),i}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=at(this.freeze,2),e=t[0],n=t[1];return new v(0,0,e-1,n-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,n=this.cols,i=this.freeze,r=t.ri,o=t.ci;r<=0&&(r=at(i,1)[0]),o<=0&&(o=at(i,2)[1]);for(var a=0,s=0,c=[e.len,n.len],l=c[0],u=c[1],h=r;h<e.len&&(l=h,!((s+=e.getHeight(h))>this.viewHeight()));h+=1);for(var p=o;p<n.len&&(u=p,!((a+=n.getWidth(p))>this.viewWidth()));p+=1);return new v(r,o,l,u,a,s)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach((function(t){return e(t)}))}},{key:"rowEach",value:function(t,e,n){for(var i=0,r=this.rows,o=this.exceptRowSet,a=rt(o),s=0,c=0;c<a.length;c+=1)a[c]<t&&(s+=1);for(var l=t+s;l<=e+s;l+=1)if(o.has(l))s+=1;else{var u=r.getHeight(l);if(n(l,i,u),(i+=u)>this.viewHeight())break}}},{key:"colEach",value:function(t,e,n){for(var i=0,r=this.cols,o=t;o<=e;o+=1){var a=r.getWidth(o);if(n(o,i,a),(i+=a)>this.viewWidth())break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,n=0;n<e.length;n+=1){var i=e[n];if(R.equals(i,t))return n}return e.push(t),e.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData()),this.v_splitSheets.forEach((function(t){t.sync()})),this.h_splitSheets.forEach((function(t){t.sync()}))}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach((function(n){if("merges"===n||"rows"===n||"cols"===n||"validations"===n||"shapes"===n)e[n].setData(t[n]);else if("freeze"===n){var i=at(h(t[n]),2),r=i[0],o=i[1];e.freeze=[o,r]}else void 0!==t[n]&&(e[n]=t[n])})),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,n=this.styles,i=this.merges,r=this.rows,o=this.cols,a=this.validations,s=this.autoFilter;return{name:t,freeze:d(e[1],e[0]),styles:n,merges:i.getData(),rows:r.getData(),cols:o.getData(),validations:a.getData(),autofilter:s.getData()}}},{key:"horizontalAddSplitSheet",value:function(t){this.h_splitSheets.push(t)}},{key:"verticalAddSplitSheet",value:function(t){this.v_splitSheets.push(t)}}])&&ot(e.prototype,n),i&&ot(e,i),t}();function vt(t,e,n){t.addEventListener(e,n)}function yt(t,e,n){t.removeEventListener(e,n)}function gt(t){t.xclickoutside&&(yt(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function bt(t,e){t.xclickoutside=function(n){2===n.detail||t.contains(n.target)||(e?e(t):(t.hide(),gt(t)))},vt(window.document.body,"click",t.xclickoutside)}function _t(t,e,n){vt(t,"mousemove",e),t.xEvtUp=function(i){yt(t,"mousemove",e),yt(t,"mouseup",t.xEvtUp),n(i)},vt(t,"mouseup",t.xEvtUp)}function wt(t,e,n,i){Math.abs(t)>Math.abs(e)?i(t>0?"right":"left",t,n):i(e>0?"down":"up",e,n)}var xt="x-spreadsheet";window.devicePixelRatio;function Et(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var St=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1?arguments[1]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.moving=!1,this.vertical=n,this.el=a("div","".concat(xt,"-resizer ").concat(n?"vertical":"horizontal")).children(this.hoverEl=a("div","".concat(xt,"-resizer-hover")).on("mousedown.stop",(function(t){return e.mousedownHandler(t)})),this.lineEl=a("div","".concat(xt,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=i}var e,n,i;return e=t,(n=[{key:"show",value:function(t,e){var n=this.moving,i=this.vertical,r=this.hoverEl,o=this.lineEl,a=this.el;if(!n){this.cRect=t;var s=t.left,c=t.top,l=t.width,u=t.height;a.offset({left:i?s+l-5:s,top:i?c:c+u-5}).show(),r.offset({width:i?5:l,height:i?u:5}),o.offset({width:i?0:e.width,height:i?e.height:0})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide()}},{key:"mousedownHandler",value:function(t){var e=this,n=t,i=this.el,r=this.lineEl,o=this.cRect,a=this.vertical,s=this.minDistance,c=a?o.width:o.height;r.show(),_t(window,(function(t){e.moving=!0,null!==n&&1===t.buttons&&(a?(c+=t.movementX)>s&&i.css("left","".concat(o.left+c,"px")):(c+=t.movementY)>s&&i.css("top","".concat(o.top+c,"px")),n=t)}),(function(){n=null,r.hide(),e.moving=!1,e.hide(),e.finishedFn&&(c<s&&(c=s),e.finishedFn(o,c))}))}}])&&Et(e.prototype,n),i&&Et(e,i),t}();function Ct(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var kt=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertical=e,this.moveFn=null,this.el=a("div","".concat(xt,"-scrollbar ").concat(e?"vertical":"horizontal")).child(this.contentEl=a("div","")).on("mousemove.stop",(function(){})).on("scroll.stop",(function(t){var e=t.target,i=e.scrollTop,r=e.scrollLeft;n.moveFn&&n.moveFn(n.vertical?i:r,t)}))}var e,n,i;return e=t,(n=[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var n=t-1;if(e>n){var i=this.vertical?"height":"width";this.el.css(i,"".concat(n,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(i,"".concat(e,"px"))}else this.el.hide();return this}}])&&Ct(e.prototype,n),i&&Ct(e,i),t}();function Pt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ot(t,e,n){return e&&Tt(t.prototype,e),n&&Tt(t,n),t}var At=10,Mt=function(){function t(){Pt(this,t),this.cornerEl=a("div","".concat(xt,"-selector-corner")),this.areaEl=a("div","".concat(xt,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=a("div","".concat(xt,"-selector-clipboard")).hide(),this.autofillEl=a("div","".concat(xt,"-selector-autofill")).hide(),this.el=a("div","".concat(xt,"-selector")).css("z-index","".concat(At)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),At+=1}return Ot(t,[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,n=t.top,i=t.width,r=t.height;this.areaEl.offset({width:i-3+.8,height:r-3+.8,left:e-.8,top:n-.8}).show()}},{key:"setClipboardOffset",value:function(t){var e=t.left,n=t.top,i=t.width,r=t.height;this.clipboardEl.offset({left:e,top:n,width:i-5,height:r-5})}},{key:"showAutofill",value:function(t){var e=t.left,n=t.top,i=t.width,r=t.height;this.autofillEl.offset({width:i-3,height:r-3,left:e,top:n}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),t}();function jt(t){var e=this.data,n=t.left,i=t.top,r=t.width,o=t.height,a=t.scroll,s=t.l,c=t.t,l=e.freezeTotalWidth(),u=e.freezeTotalHeight(),h=n-l;l>s&&(h-=a.x);var p=i-u;return u>c&&(p-=a.y),{left:h,top:p,width:r,height:o}}function Rt(t){var e=this.data,n=t.left,i=t.width,r=t.height,o=t.l,a=t.t,s=t.scroll,c=e.freezeTotalWidth(),l=n-c;return c>o&&(l-=s.x),{left:l,top:a,width:i,height:r}}function Dt(t){var e=this.data,n=t.top,i=t.width,r=t.height,o=t.l,a=t.t,s=t.scroll,c=e.freezeTotalHeight(),l=n-c;return c>a&&(l-=s.y),{left:o,top:l,width:i,height:r}}function Nt(t){this.br.setAreaOffset(jt.call(this,t))}function It(t){this.tl.setAreaOffset(t)}function Lt(t){this.t.setAreaOffset(Rt.call(this,t))}function Bt(t){this.l.setAreaOffset(Dt.call(this,t))}function Ft(t){this.l.setClipboardOffset(Dt.call(this,t))}function zt(t){this.br.setClipboardOffset(jt.call(this,t))}function Gt(t){this.tl.setClipboardOffset(t)}function Vt(t){this.t.setClipboardOffset(Rt.call(this,t))}function Ht(t){Nt.call(this,t),It.call(this,t),Lt.call(this,t),Bt.call(this,t)}function Ut(t){zt.call(this,t),Gt.call(this,t),Vt.call(this,t),Ft.call(this,t)}var Wt=function(){function t(e){Pt(this,t),this.data=e,this.br=new Mt,this.t=new Mt,this.l=new Mt,this.tl=new Mt,this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=a("div","".concat(xt,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,At+=1}return Ot(t,[{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,n=this.t,i=this.l,r=this.br,o=t.freezeTotalHeight(),a=t.freezeTotalWidth();o>0||a>0?(e.setOffset({width:a,height:o}),n.setOffset({left:a,height:o}),i.setOffset({top:o,width:a}),r.setOffset({left:a,top:o})):(e.hide(),n.hide(),i.hide(),r.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Ht.call(this,t),Ut.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Nt.call(this,t),Lt.call(this,t),zt.call(this,e),Vt.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Nt.call(this,t),Bt.call(this,t),zt.call(this,e),Ft.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.data,r=i.calSelectedRangeByStart(t,e),o=r.sri,a=r.sci;if(n){var s=t,c=e;t<0&&(s=0),e<0&&(c=0),i.selector.setIndexes(s,c),this.indexes=[s,c]}this.moveIndexes=[o,a],this.range=r,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.data,r=this.lastri,o=this.lastci;if(n){if(t===r&&e===o)return;this.lastri=t,this.lastci=e}this.range=i.calSelectedRangeByEnd(t,e),Ht.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,n=t.eci;this.setEnd(e,n)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var n=this.range,i=n.sri,r=n.sci,o=n.eri,a=n.eci,s=t,c=e,l=i-t,u=o-t,h=a-e;if(r-e>0)this.arange=new v(i,c,o,r-1);else if(l>0)this.arange=new v(s,r,i-1,a);else if(h<0)this.arange=new v(i,a+1,o,c);else{if(!(u<0))return void(this.arange=null);this.arange=new v(o+1,r,s,a)}if(null!==this.arange){var p=this.data.getRect(this.arange);p.width+=2,p.height+=2;var d=this.br,f=this.l,m=this.t,y=this.tl;d.showAutofill(jt.call(this,p)),f.showAutofill(Dt.call(this,p)),m.showAutofill(Rt.call(this,p)),y.showAutofill(p)}}}},{key:"hideAutofill",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideAutofill()}))}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();Ut.call(this,e),["br","l","t","tl"].forEach((function(e){t[e].showClipboard()}))}},{key:"hideClipboard",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideClipboard()}))}}]),t}();function $t(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function qt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Kt(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}function Yt(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}function Xt(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}function Zt(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:t.stopPropagation();break;case 38:Kt.call(this,t);break;case 39:t.stopPropagation();break;case 40:Yt.call(this,t);break;case 13:case 9:Xt.call(this,t);break;default:t.stopPropagation()}}var Jt=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterItems=[],this.items=e,this.el=a("div","".concat(xt,"-suggest")).css("width",i).hide(),this.itemClick=n,this.itemIndex=-1}var e,n,i;return e=t,(n=[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),gt(this.el.parent())}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,n=this,i=this.items;if(/^\s*$/.test(t)||(i=i.filter((function(e){return(e.key||e).startsWith(t.toUpperCase())}))),i=i.map((function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;var i=a("div","".concat(xt,"-item")).child(e).on("click.stop",(function(){n.itemClick(t),n.hide()}));return t.label&&i.child(a("div","label").html(t.label)),i})),this.filterItems=i,!(i.length<=0)){var r=this.el;(e=r.html("")).children.apply(e,$t(i)).show(),bt(r.parent(),(function(){n.hide()}))}}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",(function(t){return Zt.call(e,t)}))}}])&&qt(e.prototype,n),i&&qt(e,i),t}();function Qt(t){return(Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function te(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ee(t,e){return!e||"object"!==Qt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ne(t){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ie(t,e){return(ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var re=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ee(this,ne(e).call(this,"div","".concat(xt,"-icon")))).iconNameEl=a("div","".concat(xt,"-icon-img ").concat(t)),n.child(n.iconNameEl),n}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ie(t,e)}(e,t),n=e,(i=[{key:"setName",value:function(t){this.iconNameEl.className("".concat(xt,"-icon-img ").concat(t))}}])&&te(n.prototype,i),r&&te(n,r),e}(o);function oe(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ae(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function se(t,e){t.setMonth(t.getMonth()+e)}function ce(t,e){var n=new Date(t);return n.setDate(e-t.getDay()+1),n}var le=function(){function t(e){var n,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=a("div","calendar-header-left"),this.bodyEl=a("tbody",""),this.buildAll(),this.el=a("div","x-spreadsheet-calendar").children(a("div","calendar-header").children(this.headerLeftEl,a("div","calendar-header-right").children(a("a","calendar-prev").on("click.stop",(function(){return i.prev()})).child(new re("chevron-left")),a("a","calendar-next").on("click.stop",(function(){return i.next()})).child(new re("chevron-right")))),a("table","calendar-body").children(a("thead","").child((n=a("tr","")).children.apply(n,oe(V("calendar.weeks").map((function(t){return a("th","cell").child(t)}))))),this.bodyEl)),this.selectChange=function(){}}var e,n,i;return e=t,(n=[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){se(this.value,-1),this.buildAll()}},{key:"next",value:function(){se(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(V("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,n=this.value,i=this.cvalue,r=this.bodyEl,o=function(t,e,n){for(var i=new Date(t,e,1,23,59,59),r=[[],[],[],[],[],[]],o=0;o<6;o+=1)for(var a=0;a<7;a+=1){var s=ce(i,7*o+a),c=s.getMonth()!==e,l=s.getMonth()===n.getMonth()&&s.getDate()===n.getDate();r[o][a]={d:s,disabled:c,active:l}}return r}(n.getFullYear(),n.getMonth(),i).map((function(t){var n,i=t.map((function(t){var n="cell";return t.disabled&&(n+=" disabled"),t.active&&(n+=" active"),a("td","").child(a("div",n).on("click.stop",(function(){e.selectChange(t.d)})).child(t.d.getDate().toString()))}));return(n=a("tr","")).children.apply(n,oe(i))}));(t=r.html("")).children.apply(t,oe(o))}}])&&ae(e.prototype,n),i&&ae(e,i),t}();function ue(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var he=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendar=new le(new Date),this.el=a("div","".concat(xt,"-datepicker")).child(this.calendar.el).hide()}var e,n,i;return e=t,(n=[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(n){t(n),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&ue(e.prototype,n),i&&ue(e,i),t}();function pe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function de(){var t=this.textlineEl,e=this.textEl,n=this.areaOffset,i=t.offset().width+9,r=this.viewFn().width-n.left-9;if(i>n.width){var o=i;if(i>r){o=r;var a=parseInt(i/r,10);a+=i%r>0?1:0,(a*=this.rowHeight)>n.height&&e.css("height","".concat(a,"px"))}e.css("width","".concat(o,"px"))}}function fe(t){var e=t.keyCode||t.which,n=(t.key,t.ctrlKey,t.shiftKey,t.altKey),i=(t.metaKey,t.target.value),r=t.target;if(n)switch(e){case 13:var o=String.fromCharCode(13,10);r.value=r.value+o}var a=this.suggest,s=this.textlineEl,c=this.validator;if(this.inputText=i,c)"list"===c.type?a.search(i):a.hide();else if("string"==typeof i||i instanceof String){var l=i.lastIndexOf("=");-1!==l?a.search(i.substring(l+1)):a.hide()}s.html(i),de.call(this),this.change("textarea",i);var u=t.target;u.style.height="",u.style.height=u.scrollHeight+"px"}function me(t){var e=this.textEl.el;setTimeout((function(){e.focus(),e.setSelectionRange(t,t)}),0)}function ve(t,e){var n=this.textEl,i=this.textlineEl;n.el.blur(),n.val(t),i.html(t),me.call(this,e)}function ye(t){var e=this.inputText,n=this.validator,i=0;if(n&&"list"===n.type)this.inputText=t,i=this.inputText.length;else{var r=e.lastIndexOf("="),o=e.substring(0,r+1),a=e.substring(r+1);a=-1!==a.indexOf(")")?a.substring(a.indexOf(")")):"",this.inputText="".concat(o+t.key,"("),i=this.inputText.length,this.inputText+=")".concat(a)}ve.call(this,this.inputText,i)}function ge(){this.suggest.setItems(this.formulas)}var be=function(){function t(e,n,i){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewFn=n,this.rowHeight=i,this.formulas=e,this.suggest=new Jt(e,(function(t){ye.call(r,t)})),this.datepicker=new he,this.datepicker.change((function(t){r.setText(function(t){var e=t.getMonth()+1,n=t.getDate();return e<10&&(e="0".concat(e)),n<10&&(n="0".concat(n)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(n)}(t)),r.clear()})),this.areaEl=a("div","".concat(xt,"-editor-area")).children(this.textEl=a("textarea","").on("keydown",(function(t){return fe.call(r,t)})),this.textlineEl=a("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",(function(){})).on("mousedown.stop",(function(){})),this.el=a("div","".concat(xt,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}}var e,n,i;return e=t,(n=[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),ge.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",n=this.textEl,i=this.areaEl,r=this.suggest,o=this.freeze,a=this.el;if(t){this.areaOffset=t;var s=t.left,c=t.top,l=t.width,u=t.height,h=t.l,p=t.t,d={left:0,top:0};o.w>h&&o.h>p||(o.w<h&&o.h<p?(d.left=o.w,d.top=o.h):o.w>h?d.top=o.h:o.h>p&&(d.left=o.w)),a.offset(d),i.offset({left:s-d.left-.8,top:c-d.top-.8}),n.offset({width:l-9+.8,height:u-3+.8});var f={left:0};f[e]=u,r.setOffset(f),r.hide()}}},{key:"setCell",value:function(t,e){var n=this.el,i=this.datepicker,r=this.suggest;n.show(),this.cell=t;var o=t&&t.text||"";if(this.setText(o),this.validator=e,e){var a=e.type;"date"===a&&(i.show(),/^\s*$/.test(o)||i.setValue(o)),"list"===a&&(r.setItems(e.values()),r.search(""))}}},{key:"setText",value:function(t){this.inputText=t,ve.call(this,t,t.length),de.call(this)}}])&&pe(e.prototype,n),i&&pe(e,i),t}();function _e(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function we(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var xe=[{key:"copy",title:H("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:H("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:H("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:H("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:H("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:H("contextmenu.insertRow")},{key:"insert-column",title:H("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:H("contextmenu.deleteRow")},{key:"delete-column",title:H("contextmenu.deleteColumn")},{key:"delete-cell-text",title:H("contextmenu.deleteCellText")},{key:"divider"},{key:"validation",title:H("contextmenu.validation")}];function Ee(t){var e=this;return"divider"===t.key?a("div","".concat(xt,"-item divider")):a("div","".concat(xt,"-item")).on("click",(function(){e.itemClick(t.key),e.hide()})).children(t.title(),a("div","label").child(t.label||""))}function Se(){var t=this;return xe.map((function(e){return Ee.call(t,e)}))}var Ce=function(){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=(n=a("div","".concat(xt,"-contextmenu"))).children.apply(n,_e(Se.call(this))).hide(),this.viewFn=e,this.itemClick=function(){},this.isHide=i}var e,n,i;return e=t,(n=[{key:"hide",value:function(){var t=this.el;t.hide(),gt(t)}},{key:"setPosition",value:function(t,e){if(!this.isHide){var n=this.el,i=n.show().offset(),r=i.height,o=i.width,a=this.viewFn(),s=e,c=t;a.height-e<=r&&(s-=r),a.width-t<=o&&(c-=o),n.offset({left:c,top:s}),bt(n)}}}])&&we(e.prototype,n),i&&we(e,i),t}(),ke=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],Pe=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function Te(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Oe=function(t){for(var e=[],n=[],i=[],r=0,o=1,a=0;a<t.length;a+=1){var s=t.charAt(a);if(" "!==s)if(s>="a"&&s<="z")i.push(s.toUpperCase());else if(s>="0"&&s<="9"||s>="A"&&s<="Z"||"."===s)i.push(s);else if('"'===s){for(a+=1;'"'!==t.charAt(a);)i.push(t.charAt(a)),a+=1;n.push('"'.concat(i.join(""))),i=[]}else{if("("!==s&&i.length>0&&n.push(i.join("")),")"===s){var c=e.pop();if(2===r)try{for(var l=Te(h(n.pop()),2),u=l[0],p=l[1],f=Te(h(n.pop()),2),m=f[0],v=f[1],y=0,g=m;g<=u;g+=1)for(var b=v;b<=p;b+=1)n.push(d(g,b)),y+=1;n.push([c,y])}catch(t){}else if(1===r)n.push([c,o]),o=1;else for(;"("!==c&&(n.push(c),!(e.length<=0));)c=e.pop();r=0}else if(":"===s)r=2;else if(","===s)r=1,o+=1;else if("("===s&&i.length>0)e.push(i.join(""));else{if(e.length>0&&("+"===s||"-"===s)){var _=e[e.length-1];if("("!==_&&n.push(e.pop()),"*"===_||"/"===_)for(;e.length>0&&"("!==(_=e[e.length-1]);)n.push(e.pop())}e.push(s)}i=[]}}for(i.length>0&&n.push(i.join(""));e.length>0;)n.push(e.pop());return n},Ae=function(t,e){if(t[0]>="0"&&t[0]<="9")return Number(t);if('"'===t[0])return t.substring(1);var n=Te(h(t),2);return e(n[0],n[1])},Me=function(t,e,n,i){for(var r=[],o=0;o<t.length;o+=1)if("+"===t[o]){var a=r.pop();r.push(Number(r.pop())+Number(a))}else if("-"===t[o]){var s=r.pop();r.push(Number(r.pop())-Number(s))}else if("*"===t[o])r.push(Number(r.pop())*Number(r.pop()));else if("/"===t[o]){var c=r.pop();r.push(Number(r.pop())/Number(c))}else if(Array.isArray(t[o])){for(var l=Te(t[o],2),u=l[0],h=l[1],p=[],d=0;d<h;d+=1)p.push(r.pop());r.push(e[u].render(p.reverse()))}else{if(i.includes(t[o]))return 0;i.push(t[o]),r.push(Ae(t[o],n))}return r[0]},je={render:function t(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("="===e[0]){var o=Oe(e.substring(1));return o.length<=0?e:Me(o,n,(function(e,o){return t(i(e,o),n,i,r)}),r)}return e}};function Re(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var De=[{key:"SUM",title:H("formula.sum"),render:function(t){return t.reduce((function(t,e){return Number(t)+Number(e)}),0)}},{key:"AVERAGE",title:H("formula.average"),render:function(t){return t.reduce((function(t,e){return Number(t)+Number(e)}),0)/t.length}},{key:"MAX",title:H("formula.max"),render:function(t){return Math.max.apply(Math,Re(t.map((function(t){return Number(t)}))))}},{key:"MIN",title:H("formula.min"),render:function(t){return Math.min.apply(Math,Re(t.map((function(t){return Number(t)}))))}},{key:"CONCAT",title:H("formula.concat"),render:function(t){return t.join("")}}],Ne=De,Ie={};function Le(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||Fe(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Be(t){return function(t){if(Array.isArray(t))return t}(t)||Fe(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Fe(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}De.forEach((function(t){Ie[t.key]=t}));var ze=function(t){return t},Ge=function(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=Be(Number(t).toFixed(2).toString().split("\\.")),n=e[0],i=e.slice(1);return[n.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(Le(i))}return t},Ve=[{key:"normal",title:H("format.normal"),type:"string",render:ze},{key:"text",title:H("format.text"),type:"string",render:ze},{key:"number",title:H("format.number"),type:"number",label:"1,000.12",render:Ge},{key:"percent",title:H("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:H("format.rmb"),type:"number",label:"￥10.00",render:function(t){return"￥".concat(Ge(t))}},{key:"usd",title:H("format.usd"),type:"number",label:"$10.00",render:function(t){return"$".concat(Ge(t))}},{key:"date",title:H("format.date"),type:"date",label:"26/09/2008",render:ze},{key:"time",title:H("format.time"),type:"date",label:"15:59:00",render:ze},{key:"datetime",title:H("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:ze},{key:"duration",title:H("format.duration"),type:"date",label:"24:01:00",render:ze}],He={};Ve.forEach((function(t){He[t.key]=t}));var Ue=n(7),We=n.n(Ue);function $e(t){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ke(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ye(t,e,n){return(Ye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xe(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Xe(t){return(Xe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ze(t,e){return(Ze=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Je=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==$e(e)&&"function"!=typeof e?Ke(t):e}(this,Xe(e).call(this,t))).clones=[],n.clones.push(Ke(n)),n.plain="",n}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ze(t,e)}(e,t),n=e,(i=[{key:"clone",value:function(){var t=Ye(Xe(e.prototype),"clone",this).call(this);return t.clones=this.clones,this.clones.push(t),t}},{key:"func1",value:function(){console.log("call func1")}}])&&qe(n.prototype,i),r&&qe(n,r),e}(We.a.Group);function Qe(t){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function en(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function nn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rn(t,e){return(rn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function on(t,e,n){return(on="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=an(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function an(t){return(an=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ln(t,e,n){return e&&cn(t.prototype,e),n&&cn(t,n),t}function un(){return.5}function hn(t){return parseInt(1*t,10)}function pn(t){var e=hn(t);return e>0?e-.5:.5}var dn=function(){function t(e,n,i,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;sn(this,t),this.x=e,this.y=n,this.width=i,this.height=r,this.padding=o,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}return ln(t,[{key:"setBorders",value:function(t){var e=t.top,n=t.bottom,i=t.left,r=t.right;e&&(this.borderTop=e),r&&(this.borderRight=r),n&&(this.borderBottom=n),i&&(this.borderLeft=i)}},{key:"innerWidth",value:function(){return this.width-2*this.padding}},{key:"innerHeight",value:function(){return this.height-2*this.padding}},{key:"textx",value:function(t){var e=this.width,n=this.padding,i=this.x;return"left"===t?i+=n:"center"===t?i+=e/2:"right"===t&&(i+=e-n),i}},{key:"texty",value:function(t,e,n){var i=this.height,r=this.padding,o=this.y;return"top"===t?o+=r:"middle"===t?o=o+i/2-n:"bottom"===t&&(o+=i-2*n-r),o}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,n=this.width;return[[t+n,e],[t+n,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,n=this.width,i=this.height;return[[t,e+i],[t+n,e+i]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}]),t}();function fn(t,e,n,i,r,o,a){var s={x:0,y:0};"underline"===t?s.y="bottom"===r?0:"top"===r?-(o+2):-o/2:"strike"===t&&("bottom"===r?s.y=o/2:"top"===r&&(s.y=-(o/2+2))),"center"===i?s.x=a/2:"right"===i&&(s.x=a),this.line([e-s.x,n-s.y],[e-s.x+a,n-s.y])}var mn=function(t){function e(t,n,i){var r;return sn(this,e),(r=function(t,e){return!e||"object"!==Qe(e)&&"function"!=typeof e?nn(t):e}(this,an(e).call(this))).el=t,r.ctx=on(an(e.prototype),"getContext",nn(r)).call(nn(r)),r.resize(n,i),r.scale(1,1),r.ctx.scale(1,1),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rn(t,e)}(e,t),ln(e,[{key:"resize",value:function(t,n){on(an(e.prototype),"size",this).call(this,{width:t,height:n}),this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(n,"px"),this.el.width=hn(t),this.el.height=hn(n)}},{key:"clear",value:function(){var t=this.el,n=t.width,i=t.height;return this.ctx.clearRect(0,0,n,i),on(an(e.prototype),"clear",this).call(this),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(hn(t),hn(e)),this}},{key:"clearRect",value:function(t,e,n,i){return this.ctx.clearRect(t,e,n,i),this}},{key:"fillRect",value:function(t,e,n,i){return this.ctx.fillRect(hn(t)-.5,hn(e)-.5,hn(n),hn(i)),this}},{key:"fillText",value:function(t,e,n){return this.ctx.fillText(t,hn(e),hn(n)),this}},{key:"text",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=this.ctx,o=n.align,a=n.valign,s=n.font,c=n.color,l=n.strike,u=n.underline,h=e.textx(o);r.save(),r.beginPath(),this.attr({textAlign:o,textBaseline:a,font:"".concat(s.italic?"italic":""," ").concat(s.bold?"bold":""," ").concat(hn(s.size),"px ").concat(s.name),fillStyle:c,strokeStyle:c});var p=r.measureText(t).width,d=0;if(i){var f=Math.ceil(p/e.innerWidth());d=(f-1)*s.size/2}for(var m=e.texty(a,s.size,d),v={len:0,start:0},y=0;y<t.length;y+=1){var g=y-v.start;"\n"==t.substr(v.start+g,1)?(this.fillText(t.substring(v.start,y),h,m),l&&fn.call(this,"strike",h,m,o,a,s.size,v.len),u&&fn.call(this,"underline",h,m,o,a,s.size,v.len),m+=s.size+2,v.len=0,y++,v.start=y):v.len+=r.measureText(t[y]).width}return v.len>0&&(this.fillText(t.substring(v.start),h,m),l&&fn.call(this,"strike",h,m,o,a,s.size,v.len),u&&fn.call(this,"underline",h,m,o,a,s.size,v.len)),r.restore(),this}},{key:"border",value:function(t,e){var n=this.ctx;return n.lineWidth=un,n.strokeStyle=e,"medium"===t?n.lineWidth=hn(2)-.5:"thick"===t?n.lineWidth=hn(3):"dashed"===t?n.setLineDash([hn(3),hn(2)]):"dotted"===t?n.setLineDash([hn(1),hn(1)]):"double"===t&&n.setLineDash([hn(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){var e=arguments.length<=0?void 0:arguments[0],n=en(e,2),i=n[0],r=n[1];t.moveTo(pn(i),pn(r));for(var o=1;o<arguments.length;o+=1){var a=o<0||arguments.length<=o?void 0:arguments[o],s=en(a,2),c=s[0],l=s[1];t.lineTo(pn(c),pn(l))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save(),e.beginPath();var n=t.borderTop,i=t.borderRight,r=t.borderBottom,o=t.borderLeft;n&&(this.border.apply(this,tn(n)),this.line.apply(this,tn(t.topxys()))),i&&(this.border.apply(this,tn(i)),this.line.apply(this,tn(t.rightxys()))),r&&(this.border.apply(this,tn(r)),this.line.apply(this,tn(t.bottomxys()))),o&&(this.border.apply(this,tn(o)),this.line.apply(this,tn(t.leftxys()))),e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,n=t.x,i=t.y,r=n+t.width-15,o=i+t.height-15;e.save(),e.beginPath(),e.moveTo(hn(r),hn(o)),e.lineTo(hn(r+8),hn(o)),e.lineTo(hn(r+4),hn(o+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){var e=this.ctx,n=t.x,i=t.y,r=n+t.width-1;e.save(),e.beginPath(),e.moveTo(hn(r-8),hn(i-1)),e.lineTo(hn(r),hn(i-1)),e.lineTo(hn(r),hn(i+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var n=this.ctx,i=t.x,r=t.y,o=t.width,a=t.height,s=t.bgcolor;n.save(),n.beginPath(),n.fillStyle=s||"#fff",n.rect(pn(i+1),pn(r+1),hn(o-2),hn(a-2)),n.clip(),n.fill(),e(),n.restore()}}]),e}(We.a.Layer);function vn(t){return(vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function gn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function bn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _n(t,e){return(_n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wn(t,e,n){return(wn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=xn(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function xn(t){return(xn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var En=5,Sn={fillStyle:"#f4f5f8"},Cn={fillStyle:"#fff",lineWidth:un,strokeStyle:"#e6e6e6"};function kn(t,e){var n=this.data.cellRect(t,e),i=n.left,r=n.top,o=n.width,a=n.height;return new dn(i,r,o,a,En)}function Pn(t,e,n,i,r,o){e.func1(e),t.some((function(t){if(t.shape===e){t.shape.children[0].width(n),t.shape.children[0].height(i),t.data.rindex=r,t.data.cindex=o;var a=l(o)+String(r+1);return t.shape.children[1].text(t.data.name+" / "+a),!0}}))}function Tn(t,e,n,i){var r,o,a,s,c=this.data,l=(this.layer,this.layer_cell,this.layer_TOP_LEFT,this.layer_cell_TOP_LEFT),u=(this.layer_TOP_RIGHT,this.layer_cell_TOP_RIGHT),h=(this.layer_BOTTOM_LEFT,this.layer_cell_BOTTOM_LEFT),p=(this.layer_BOTTOM_RIGHT,this.layer_cell_BOTTOM_RIGHT),d=c.cellRect(n,i),f=(d.left,d.top,d.width),m=d.height;e.clones.forEach((function(t){"BOTTOM_LEFT"==t.plain&&(r=t),"BOTTOM_RIGHT"==t.plain&&(o=t),"TOP_LEFT"==t.plain&&(a=t),"TOP_RIGHT"==t.plain&&(s=t)})),Pn.call(this,p,o,f,m,n,i),Pn.call(this,h,r,f,m,n,i),Pn.call(this,u,s,f,m,n,i),Pn.call(this,l,a,f,m,n,i),this.render(),c.changeData((function(){}))}function On(t){var e=this.data,n=(this.layer,this.layer_cell,this.layer_TOP_LEFT),i=this.layer_line_TOP_LEFT,r=this.layer_TOP_RIGHT,o=this.layer_line_TOP_RIGHT,a=this.layer_BOTTOM_LEFT,s=this.layer_line_BOTTOM_LEFT,c=this.layer_BOTTOM_RIGHT,l=this.layer_line_BOTTOM_RIGHT,u=e.cellRect(t.srindex,t.scindex),h=u.left,p=u.top,d=u.width,f=u.height,m=e.cellRect(t.erindex,t.ecindex),v=m.left,y=m.top,g=(m.width,m.height),b=e.cols.indexWidth,_=e.rows.height,w=[b+h+d,_+p+f/2,b+v,_+y+g/2],x=new We.a.Line({points:w,stroke:"red",strokeWidth:1,lineCap:"round",lineJoin:"round"}),E=x.clone(),S=x.clone(),C=x.clone();n.add(x),r.add(E),a.add(S),c.add(C),x.plain="TOP_LEFT",E.plain="TOP_RIGHT",S.plain="BOTTOM_LEFT",C.plain="BOTTOM_RIGHT",i.push({data:t,line:x}),o.push({data:t,line:E}),s.push({data:t,line:S}),l.push({data:t,line:C})}function An(t){var e=this.data,n=(this.layer,this.layer_cell,this.layer_TOP_LEFT),i=this.layer_cell_TOP_LEFT,r=this.layer_TOP_RIGHT,o=this.layer_cell_TOP_RIGHT,a=this.layer_BOTTOM_LEFT,s=this.layer_cell_BOTTOM_LEFT,c=this.layer_BOTTOM_RIGHT,u=this.layer_cell_BOTTOM_RIGHT,h=e.cellRect(t.rindex,t.cindex),p=function(t,e,n,i){var r=t.left,o=t.top,a=t.width,s=t.height,c=t.left_pad,l=t.cell_address,u=new Je({x:r+c,y:o,draggable:!0,name:e.name}),h=new We.a.Text({x:10,y:3,text:e.name+" / "+l,fontSize:14,fontFamily:"Calibri",fill:"red"}),p=new We.a.Rect({x:0,y:0,width:a,height:s,fill:"green",stroke:"black",strokeWidth:0,cornerRadius:10,opacity:.5,shadowEnabled:!0});return u.on("mouseover",(function(){document.body.style.cursor="pointer"})),u.on("mouseout",(function(){document.body.style.cursor="default"})),u.on("dragstart",(function(){})),u.on("dragend",(function(t){var e=t.target.attrs.x+t.target.children[0].attrs.width/2,r=t.target.attrs.y+t.target.children[0].attrs.height/2,o=n.getCellRectByXY(e,r),a=t.target.parent.parent,s=t.target.attrs.name,c=t.target,l=o.ri,u=o.ci;i.call(a,s,c,l,u)})),u.add(p),u.add(h),u}({left:h.left,top:h.top,width:h.width,height:h.height,left_pad:e.cols.indexWidth,cell_address:l(t.cindex)+String(t.rindex+1)},t,e,Tn),d=p.clone(),f=p.clone(),m=p.clone();n.add(p),r.add(d),a.add(f),c.add(m),p.plain="TOP_LEFT",d.plain="TOP_RIGHT",f.plain="BOTTOM_LEFT",m.plain="BOTTOM_RIGHT",i.push({data:t,shape:p}),o.push({data:t,shape:d}),s.push({data:t,shape:f}),u.push({data:t,shape:m})}function Mn(t,e,n,i,r,o,a){var s=this.data;this.data.cols.indexWidth;e.forEach((function(t){if(t.data.rindex>=n.sri&&t.data.rindex<=n.eri&&t.data.cindex>=n.sci&&t.data.cindex<=n.eci){var e=s.cellRect(t.data.rindex,t.data.cindex),c=e.left,u=e.top,h=e.width,p=e.height;t.shape.absolutePosition({x:c+i+o,y:u+r+a}),t.shape.children[0].width(h),t.shape.children[0].height(p);var d=l(t.data.cindex)+String(t.data.rindex+1);t.shape.children[1].text(t.data.name+" / "+d),t.shape.show()}else t.shape.hide()}))}function jn(t,e){var n=this.draw,i=this.data,r=i.sortedRowMap,o=t;r.has(t)&&(o=r.get(t));var a=i.getCell(o,e);if(null!==a){var s=i.getCellStyleOrDefault(o,e),c=kn.call(this,t,e);c.bgcolor=s.bgcolor,void 0!==s.border&&(c.setBorders(s.border),n.strokeBorders(c)),n.rect(c,(function(){var r=je.render(a.text||"",Ie,(function(t,e){return i.getCellTextOrDefault(e,t)}));s.format&&(r=He[s.format].render(r));var o=Object.assign({},s.font);o.size=function(t){for(var e=0;e<Pe.length;e+=1){var n=Pe[e];if(n.pt===t)return n.px}return t}(o.size),n.text(r,c,{align:s.align,valign:s.valign,font:o,color:s.color,strike:s.strike,underline:s.underline},s.textwrap),i.validations.getError(t,e)&&n.error(c)}))}}function Rn(t){var e=this,n=this.data,i=this.draw;if(t){var r=n.autoFilter;if(!r.active())return;var o=r.hrange();t.intersects(o)&&o.each((function(t,n){var r=kn.call(e,t,n);i.dropdown(r)}))}}function Dn(t,e,n,i,r){var o=this,a=this.draw,s=this.data;this.layer;a.save(),a.translate(e,n).translate(i,r);var c=s.exceptRowSet;a.save(),t.each((function(t,e){jn.call(o,t,e)}),(function(t){return function(t){var e=c.has(t);if(e){var n=s.rows.getHeight(t);a.translate(0,-n)}return!e}(t)})),a.restore();var l=new Set;a.save(),s.eachMergesInView(t,(function(t){var e=t.sri,n=t.sci,i=t.eri;if(c.has(e)){if(!l.has(e)){l.add(e);var r=s.rows.sumHeight(e,i+1);a.translate(0,-r)}}else jn.call(o,e,n)})),a.restore(),Rn.call(this,t),a.restore()}function Nn(t,e,n,i){var r=this.draw;r.save(),r.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(t,e,n,i),r.restore()}function In(t,e,n,i,r,o){var a=this,s=this.draw,c=this.data,u=e.h,h=e.w,p=o+i,d=r+n;s.save(),s.attr(Sn),"all"!==t&&"left"!==t||s.fillRect(0,p,n,u),"all"!==t&&"top"!==t||s.fillRect(d,0,h,i);var f=c.selector.range,m=f.sri,v=f.sci,y=f.eri,g=f.eci;s.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(hn(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:.5,strokeStyle:"#e6e6e6"}),"all"!==t&&"left"!==t||(c.rowEach(e.sri,e.eri,(function(t,e,i){var r=p+e,o=t;s.line([0,r],[n,r]),m<=o&&o<y+1&&Nn.call(a,0,r,n,i),s.fillText(o+1,n/2,r+i/2)})),s.line([0,u+p],[n,u+p]),s.line([n,p],[n,u+p])),"all"!==t&&"top"!==t||(c.colEach(e.sci,e.eci,(function(t,e,n){var r=d+e,o=t;s.line([r,0],[r,i]),v<=o&&o<g+1&&Nn.call(a,r,0,n,i),s.fillText(l(o),r+n/2,i/2)})),s.line([h+d,0],[h+d,i]),s.line([0,i],[h+d,i])),s.restore()}function Ln(t,e){var n=this.draw;n.save(),n.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,t,e),n.restore()}function Bn(t,e,n,i,r){var o=t.sri,a=t.sci,s=t.eri,c=t.eci,l=t.w,u=t.h,h=this.draw,p=this.data,d=p.settings;h.save(),h.attr(Cn).translate(e+i,n+r),h.clearRect(0,0,l,u),d.showGrid?(p.rowEach(o,s,(function(t,e,n){t!==o&&h.line([0,e],[l,e]),t===s&&h.line([0,e+n],[l,e+n])})),p.colEach(a,c,(function(t,e,n){t!==a&&h.line([e,0],[e,u]),t===c&&h.line([e+n,0],[e+n,u])})),h.restore()):h.restore()}function Fn(t,e,n,i){var r=this.draw,o=this.data,a=o.viewWidth()-t,s=o.viewHeight()-e;r.save().translate(t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),r.line([0,i],[a,i]),r.line([n,0],[n,s]),r.restore()}var zn=function(t){function e(t,n){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==vn(e)&&"function"!=typeof e?bn(t):e}(this,xn(e).call(this,{container:t,width:n.viewWidth(),height:n.viewHeight(),scaleX:window.devicePixelRatio,scaleY:window.devicePixelRatio}))).el=t,i.draw=new mn(t,n.viewWidth(),n.viewHeight()),wn(xn(e.prototype),"add",bn(i)).call(bn(i),i.draw),i.draw.draw(),i.data=n,i.layer_cell=[],i.layer_cell_TOP_LEFT=[],i.layer_cell_TOP_RIGHT=[],i.layer_cell_BOTTOM_LEFT=[],i.layer_cell_BOTTOM_RIGHT=[],i.layer_line_TOP_LEFT=[],i.layer_line_TOP_RIGHT=[],i.layer_line_BOTTOM_LEFT=[],i.layer_line_BOTTOM_RIGHT=[],i.layer=new We.a.Layer,i.layer_TOP_LEFT=new We.a.Layer,i.layer_TOP_RIGHT=new We.a.Layer,i.layer_BOTTOM_LEFT=new We.a.Layer,i.layer_BOTTOM_RIGHT=new We.a.Layer;var r=new We.a.Circle({x:170,y:170,radius:30,fill:"red",stroke:"black",strokeWidth:2,draggable:!0});return r.on("mouseover",(function(){document.body.style.cursor="pointer"})),r.on("mouseout",(function(){document.body.style.cursor="default"})),i.layer.add(r),wn(xn(e.prototype),"add",bn(i)).call(bn(i),i.layer),wn(xn(e.prototype),"add",bn(i)).call(bn(i),i.layer_TOP_LEFT),wn(xn(e.prototype),"add",bn(i)).call(bn(i),i.layer_TOP_RIGHT),wn(xn(e.prototype),"add",bn(i)).call(bn(i),i.layer_BOTTOM_LEFT),wn(xn(e.prototype),"add",bn(i)).call(bn(i),i.layer_BOTTOM_RIGHT),i.layer.draw(),i.layer_TOP_LEFT.draw(),i.layer_TOP_RIGHT.draw(),i.layer_BOTTOM_LEFT.draw(),i.layer_BOTTOM_RIGHT.draw(),i}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_n(t,e)}(e,t),n=e,(i=[{key:"setlayer",value:function(){for(var t=this.data.shapes.getData(),e=0;e<t.length;e++)"shape"==t[e].type?An.call(this,t[e]):"line"==t[e].type&&On.call(this,t[e])}},{key:"render",value:function(){var t=this.data,e=t.rows,n=t.cols.indexWidth,i=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var r=t.viewRange(),o=t.freezeTotalWidth(),a=t.freezeTotalHeight(),s=t.scroll,c=s.x,l=s.y;Bn.call(this,r,n,i,o,a),Dn.call(this,r,n,i,-c,-l),In.call(this,"all",r,n,i,o,a),Ln.call(this,n,i),Mn.call(this,this.layer_BOTTOM_RIGHT,this.layer_cell_BOTTOM_RIGHT,r,n,i,-c,-l);var u=yn(t.freeze,2),h=u[0],p=u[1];if(h>0||p>0){if(h>0){var d=r.clone();d.sri=0,d.eri=h-1,d.h=a,Bn.call(this,d,n,i,o,0),Dn.call(this,d,n,i,-c,0),In.call(this,"top",d,n,i,o,0),Mn.call(this,this.layer_TOP_RIGHT,this.layer_cell_TOP_RIGHT,d,n,i,-c,0)}if(p>0){var f=r.clone();f.sci=0,f.eci=p-1,f.w=o,Bn.call(this,f,n,i,0,a),In.call(this,"left",f,n,i,0,a),Dn.call(this,f,n,i,0,-l),Mn.call(this,this.layer_BOTTOM_LEFT,this.layer_cell_BOTTOM_LEFT,f,n,i,0,-l)}var m=t.freezeViewRange();Bn.call(this,m,n,i,0,0),In.call(this,"all",m,n,i,0,0),Dn.call(this,m,n,i,0,0),Fn.call(this,n,i,o,a),Mn.call(this,this.layer_TOP_LEFT,this.layer_cell_TOP_LEFT,m,n,i,0,0)}this.layer.draw(),this.layer_TOP_LEFT.draw(),this.layer_TOP_RIGHT.draw(),this.layer_BOTTOM_LEFT.draw(),this.layer_BOTTOM_RIGHT.draw()}},{key:"clear",value:function(){this.draw.clear()}}])&&gn(n.prototype,i),r&&gn(n,r),e}(We.a.Stage);function Gn(t){return(Gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Hn(t,e){return!e||"object"!==Gn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Un(t){return(Un=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wn(t,e){return(Wn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $n=function(t){function e(t,n,i,r){var o,s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(s=Hn(this,Un(e).call(this,"div","".concat(xt,"-dropdown ").concat(r)))).title=t,s.change=function(){},"string"==typeof t?s.title=a("div","".concat(xt,"-dropdown-title")).child(t):i&&s.title.addClass("arrow-left");for(var c=arguments.length,l=new Array(c>4?c-4:0),u=4;u<c;u++)l[u-4]=arguments[u];return s.contentEl=(o=a("div","".concat(xt,"-dropdown-content"))).children.apply(o,l).css("width",n).hide(),s.headerEl=a("div","".concat(xt,"-dropdown-header")),s.headerEl.on("click",(function(){"block"!==s.contentEl.css("display")?s.show():s.hide()})).children(s.title,i?a("div","".concat(xt,"-icon arrow-right")).child(a("div","".concat(xt,"-icon-img arrow-down"))):""),s.children(s.headerEl,s.contentEl),s}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wn(t,e)}(e,t),n=e,(i=[{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active(),bt(this.parent(),(function(){t.hide()}))}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),gt(this.parent())}}])&&Vn(n.prototype,i),r&&Vn(n,r),e}(o);function qn(t){return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Yn(t,e){return!e||"object"!==qn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xn(t){return(Xn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zn(t,e){return(Zn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jn=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=ke.map((function(t){return a("div","".concat(xt,"-item")).on("click",(function(){n.setTitle(t.title),n.change(t)})).child(t.title)}));return n=Yn(this,(t=Xn(e)).call.apply(t,[this,ke[0].title,"160px",!0,"bottom-left"].concat(Kn(i))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zn(t,e)}(e,t),e}($n);function Qn(t){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ti(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ei(t,e){return!e||"object"!==Qn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ni(t){return(ni=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ii(t,e){return(ii=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ri=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=Pe.map((function(t){return a("div","".concat(xt,"-item")).on("click",(function(){n.setTitle("".concat(t.pt)),n.change(t)})).child("".concat(t.pt))}));return n=ei(this,(t=ni(e)).call.apply(t,[this,"10","60px",!0,"bottom-left"].concat(ti(i))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ii(t,e)}(e,t),e}($n);function oi(t){return(oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ai(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function si(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ci(t,e){return!e||"object"!==oi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function li(t){return(li=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ui(t,e){return(ui=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hi=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=Ve.slice(0);return i.splice(2,0,{key:"divider"}),i.splice(7,0,{key:"divider"}),i=i.map((function(t){var e=a("div","".concat(xt,"-item"));return"divider"===t.key?e.addClass("divider"):(e.child(t.title()).on("click",(function(){n.setTitle(t.title()),n.change(t)})),t.label&&e.child(a("div","label").html(t.label))),e})),n=ci(this,(t=li(e)).call.apply(t,[this,"Normal","220px",!0,"bottom-left"].concat(ai(i))))}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ui(t,e)}(e,t),n=e,(i=[{key:"setTitle",value:function(t){for(var e=0;e<Ve.length;e+=1)Ve[e].key===t&&this.title.html(Ve[e].title);this.hide()}}])&&si(n.prototype,i),r&&si(n,r),e}($n);function pi(t){return(pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function di(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function fi(t,e){return!e||"object"!==pi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mi(t){return(mi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vi(t,e){return(vi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yi=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=De.map((function(t){return a("div","".concat(xt,"-item")).on("click",(function(){n.hide(),n.change(t)})).child(t.key)}));return n=fi(this,(t=mi(e)).call.apply(t,[this,new re("formula"),"180px",!0,"bottom-left"].concat(di(i))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vi(t,e)}(e,t),e}($n);function gi(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var bi=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],_i=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],wi=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function xi(t){var e=this;return a("td","").child(a("div","".concat(xt,"-color-palette-cell")).on("click.stop",(function(){return e.change(t)})).css("background-color",t))}var Ei=function t(){var e,n,i,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=a("div","".concat(xt,"-color-palette")),this.change=function(){};var o=a("table","").children((e=a("tbody","")).children.apply(e,[(n=a("tr","".concat(xt,"-theme-color-placeholders"))).children.apply(n,gi(bi.map((function(t){return xi.call(r,t)}))))].concat(gi(_i.map((function(t){var e;return(e=a("tr","".concat(xt,"-theme-colors"))).children.apply(e,gi(t.map((function(t){return xi.call(r,t)}))))}))),[(i=a("tr","".concat(xt,"-standard-colors"))).children.apply(i,gi(wi.map((function(t){return xi.call(r,t)}))))])));this.el.child(o)};function Si(t){return(Si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ci(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ki(t,e){return!e||"object"!==Si(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pi(t){return(Pi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ti(t,e){return(Ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Oi=function(t){function e(t,n){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=new re(t).css("height","16px").css("border-bottom","3px solid ".concat(n)),o=new Ei;return o.change=function(t){i.setTitle(t),i.change(t)},i=ki(this,Pi(e).call(this,r,"auto",!1,"bottom-left",o.el))}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ti(t,e)}(e,t),n=e,(i=[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}])&&Ci(n.prototype,i),r&&Ci(n,r),e}($n);function Ai(t){return(Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mi(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ji(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ri(t,e){return!e||"object"!==Ai(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Di(t){return(Di=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ni(t,e){return(Ni=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ii=function(t){function e(t,n){var i,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=new re("align-".concat(n)),s=t.map((function(t){return(e="align-".concat(t),a("div","".concat(xt,"-item")).child(new re(e))).on("click",(function(){r.setTitle(t),r.change(t)}));var e}));return r=Ri(this,(i=Di(e)).call.apply(i,[this,o,"auto",!0,"bottom-left"].concat(Mi(s))))}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ni(t,e)}(e,t),n=e,(i=[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}])&&ji(n.prototype,i),r&&ji(n,r),e}($n);function Li(t){return(Li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bi(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Fi(t,e){return!e||"object"!==Li(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zi(t){return(zi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gi(t,e){return(Gi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vi=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],Hi=function(t){function e(t){var n,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=new re("line-type"),o=0,s=Vi.map((function(e,n){return a("div","".concat(xt,"-item state ").concat(t===e[0]?"checked":"")).on("click",(function(){s[o].toggle("checked"),s[n].toggle("checked"),o=n,i.hide(),i.change(e)})).child(a("div","".concat(xt,"-line-type")).html(e[1]))}));return i=Fi(this,(n=zi(e)).call.apply(n,[this,r,"auto",!1,"bottom-left"].concat(Bi(s))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gi(t,e)}(e,t),e}($n);function Ui(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Wi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function $i(){var t;return a("table","").child((t=a("tbody","")).children.apply(t,arguments))}function qi(t){var e=this;return a("td","").child(a("div","".concat(xt,"-border-palette-cell")).child(new re("border-".concat(t))).on("click",(function(){e.mode=t;var n=e.mode,i=e.style,r=e.color;e.change({mode:n,style:i,color:r})})))}var Ki=function t(){var e,n,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new Oi("line-color",this.color),this.ddColor.change=function(t){i.color=t},this.ddType=new Hi(this.style),this.ddType.change=function(t){var e=Wi(t,1)[0];i.style=e},this.el=a("div","".concat(xt,"-border-palette"));var r=$i(a("tr","").children(a("td","".concat(xt,"-border-palette-left")).child($i((e=a("tr","")).children.apply(e,Ui(["all","inside","horizontal","vertical","outside"].map((function(t){return qi.call(i,t)})))),(n=a("tr","")).children.apply(n,Ui(["left","top","right","bottom","none"].map((function(t){return qi.call(i,t)})))))),a("td","".concat(xt,"-border-palette-right")).children(a("div","".concat(xt,"-toolbar-btn")).child(this.ddColor.el),a("div","".concat(xt,"-toolbar-btn")).child(this.ddType.el))));this.el.child(r)};function Yi(t){return(Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xi(t,e){return!e||"object"!==Yi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zi(t){return(Zi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ji(t,e){return(Ji=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qi=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new re("border-all"),i=new Ki;return i.change=function(e){t.change(e),t.hide()},t=Xi(this,Zi(e).call(this,n,"auto",!1,"bottom-left",i.el))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ji(t,e)}(e,t),e}($n);function tr(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function er(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function nr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ir(t){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function or(t,e){return!e||"object"!==ir(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ar(t){return(ar=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sr(t,e){return(sr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function cr(t){return a("div","".concat(xt,"-toolbar-btn")).on("mouseenter",(function(e){!function(t,e){if(!e.classList.contains("active")){var n=e.getBoundingClientRect(),i=n.left,r=n.top,o=n.width,s=n.height,c=a("div","".concat(xt,"-tooltip")).html(t).show();document.body.appendChild(c.el);var l=c.box();c.css("left","".concat(i+o/2-l.width/2,"px")).css("top","".concat(r+s+2,"px")),vt(e,"mouseleave",(function(){document.body.contains(c.el)&&document.body.removeChild(c.el)})),vt(e,"click",(function(){document.body.contains(c.el)&&document.body.removeChild(c.el)}))}}(t,e.target)})).attr("data-tooltip",t)}function lr(){return a("div","".concat(xt,"-toolbar-divider"))}function ur(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return cr(t).child((n=e,new re(n))).on("click",(function(){return i()}))}function hr(){var t=this;this.ddFormat.change=function(e){return t.change("format",e.key)},this.ddFont.change=function(e){return t.change("font-name",e.key)},this.ddFormula.change=function(e){return t.change("formula",e.key)},this.ddFontSize.change=function(e){return t.change("font-size",e.pt)},this.ddTextColor.change=function(e){return t.change("color",e)},this.ddFillColor.change=function(e){return t.change("bgcolor",e)},this.ddAlign.change=function(e){return t.change("align",e)},this.ddVAlign.change=function(e){return t.change("valign",e)},this.ddBorder.change=function(e){return t.change("border",e)}}function pr(t){var e=t,n=t.split("-");n.length>1&&n.forEach((function(t,n){0===n?e=t:e+=t[0].toUpperCase()+t.substring(1)}));var i=this["".concat(e,"El")];i.toggle(),this.change(t,i.hasClass("active"))}var dr=function(t){function e(){var t;rr(this,e);var n=new re("ellipsis"),i=a("div","".concat(xt,"-toolbar-more"));return(t=or(this,ar(e).call(this,n,"auto",!1,"bottom-right",i))).moreBtns=i,t.contentEl.css("max-width","420px"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sr(t,e)}(e,t),e}($n);function fr(){this.btns2=this.btnChildren.map((function(t){var e=t.box(),n=t.computedStyle(),i=n.marginLeft,r=n.marginRight;return[t,e.width+parseInt(i,10)+parseInt(r,10)]}))}function mr(){var t,e,n=this.el,i=this.btns,r=this.moreEl,o=this.ddMore,a=this.btns2,s=o.moreBtns,c=o.contentEl;n.css("width","".concat(this.widthFn()-60,"px"));var l=n.box(),u=160,h=12,p=[],d=[];a.forEach((function(t,e){var n=nr(t,2),i=n[0],r=n[1];u+=r,e===a.length-1||u<l.width?p.push(i):(h+=r,d.push(i))})),(t=i.html("")).children.apply(t,p),(e=s.html("")).children.apply(e,d),c.css("width","".concat(h,"px")),d.length>0?r.show():r.hide()}var vr=function(){function t(e,n){var i,r=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];rr(this,t),this.data=e,this.change=function(){},this.widthFn=n;var s=e.defaultStyle();this.ddFormat=new hi,this.ddFont=new Jn,this.ddFormula=new yi,this.ddFontSize=new ri,this.ddTextColor=new Oi("text-color",s.color),this.ddFillColor=new Oi("fill-color",s.bgcolor),this.ddAlign=new Ii(["left","center","right"],s.align),this.ddVAlign=new Ii(["top","middle","bottom"],s.valign),this.ddBorder=new Qi,this.ddMore=new dr,this.btnChildren=[this.undoEl=ur("".concat(V("toolbar.undo")," (Ctrl+Z)"),"undo",(function(){return r.change("undo")})),this.redoEl=ur("".concat(V("toolbar.undo")," (Ctrl+Y)"),"redo",(function(){return r.change("redo")})),this.paintformatEl=ur("".concat(V("toolbar.paintformat")),"paintformat",(function(){return pr.call(r,"paintformat")})),this.clearformatEl=ur("".concat(V("toolbar.clearformat")),"clearformat",(function(){return r.change("clearformat")})),lr(),cr("".concat(V("toolbar.format"))).child(this.ddFormat.el),lr(),cr("".concat(V("toolbar.font"))).child(this.ddFont.el),cr("".concat(V("toolbar.fontSize"))).child(this.ddFontSize.el),lr(),this.fontBoldEl=ur("".concat(V("toolbar.fontBold")," (Ctrl+B)"),"bold",(function(){return pr.call(r,"font-bold")})),this.fontItalicEl=ur("".concat(V("toolbar.fontItalic")," (Ctrl+I)"),"italic",(function(){return pr.call(r,"font-italic")})),this.underlineEl=ur("".concat(V("toolbar.underline")," (Ctrl+U)"),"underline",(function(){return pr.call(r,"underline")})),this.strikeEl=ur("".concat(V("toolbar.strike")),"strike",(function(){return pr.call(r,"strike")})),cr("".concat(V("toolbar.textColor"))).child(this.ddTextColor.el),lr(),cr("".concat(V("toolbar.fillColor"))).child(this.ddFillColor.el),cr("".concat(V("toolbar.border"))).child(this.ddBorder.el),this.mergeEl=ur("".concat(V("toolbar.merge")),"merge",(function(){return pr.call(r,"merge")})),lr(),cr("".concat(V("toolbar.align"))).child(this.ddAlign.el),cr("".concat(V("toolbar.valign"))).child(this.ddVAlign.el),this.textwrapEl=ur("".concat(V("toolbar.textwrap")),"textwrap",(function(){return pr.call(r,"textwrap")})),lr(),this.freezeEl=ur("".concat(V("toolbar.freeze")),"freeze",(function(){return pr.call(r,"freeze")})),this.overlayerEl=ur("".concat(V("toolbar.overlayer")),"overlayer",(function(){return pr.call(r,"overlayer")})),this.autofilterEl=ur("".concat(V("toolbar.autofilter")),"autofilter",(function(){return pr.call(r,"autofilter")})),cr("".concat(V("toolbar.formula"))).child(this.ddFormula.el),this.moreEl=cr("".concat(V("toolbar.more"))).child(this.ddMore.el).hide()],this.el=a("div","".concat(xt,"-toolbar")),this.btns=(i=a("div","".concat(xt,"-toolbar-btns"))).children.apply(i,tr(this.btnChildren)),this.el.child(this.btns),o&&this.el.hide(),hr.call(this),this.reset(),setTimeout((function(){fr.call(r),mr.call(r)}),0),vt(window,"resize",(function(){mr.call(r)}))}var e,n,i;return e=t,(n=[{key:"paintformatActive",value:function(){return this.paintformatEl.hasClass("active")}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){pr.call(this,t)}},{key:"reset",value:function(){var t=this.data,e=t.getSelectedCellStyle(),n=t.getSelectedCell();this.undoEl.disabled(!t.canUndo()),this.redoEl.disabled(!t.canRedo()),this.mergeEl.active(t.canUnmerge()).disabled(!t.selector.multiple()),this.autofilterEl.active(!t.canAutofilter());var i=e.font;this.ddFont.setTitle(i.name),this.ddFontSize.setTitle(i.size),this.fontBoldEl.active(i.bold),this.fontItalicEl.active(i.italic),this.underlineEl.active(e.underline),this.strikeEl.active(e.strike),this.ddTextColor.setTitle(e.color),this.ddFillColor.setTitle(e.bgcolor),this.ddAlign.setTitle(e.align),this.ddVAlign.setTitle(e.valign),this.textwrapEl.active(e.textwrap),this.freezeEl.active(t.freezeIsActive()),n&&n.format&&this.ddFormat.setTitle(n.format),this.overlayerEl.active(!0)}}])&&er(e.prototype,n),i&&er(e,i),t}();function yr(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function gr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var br=function(){function t(e,n){var i,r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.title=e,this.el=a("div","".concat(xt,"-modal")).css("width",o).children(a("div","".concat(xt,"-modal-header")).children(new re("close").on("click.stop",(function(){return r.hide()})),this.title),(i=a("div","".concat(xt,"-modal-content"))).children.apply(i,yr(n))).hide()}var e,n,i;return e=t,(n=[{key:"show",value:function(){var t=this;this.dimmer=a("div","".concat(xt,"-dimmer active")),document.body.appendChild(this.dimmer.el);var e=this.el.show().box(),n=e.width,i=e.height,r=document.documentElement,o=r.clientHeight,s=r.clientWidth;this.el.offset({left:(s-n)/2,top:(o-i)/3}),window.xkeydownEsc=function(e){27===e.keyCode&&t.hide()},vt(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),document.body.removeChild(this.dimmer.el),yt(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}])&&gr(e.prototype,n),i&&gr(e,i),t}();function _r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var wr=function(){function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vchange=function(){},this.el=a("div","".concat(xt,"-form-input")),this.input=a("input","").css("width",e).on("input",(function(t){return i.vchange(t)})).attr("placeholder",n),this.el.child(this.input)}var e,n,i;return e=t,(n=[{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}])&&_r(e.prototype,n),i&&_r(e,i),t}();function xr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Er=function(){function t(e,n,i){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.key=e,this.getTitle=o,this.vchange=function(){},this.el=a("div","".concat(xt,"-form-select")),this.suggest=new Jt(n.map((function(t){return{key:t,title:r.getTitle(t)}})),(function(t){r.itemClick(t.key),s(t.key),r.vchange(t.key)}),i,this.el),this.el.children(this.itemEl=a("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",(function(){return r.show()}))}var e,n,i;return e=t,(n=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(t){this.key=t,this.itemEl.html(this.getTitle(t))}},{key:"val",value:function(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}])&&xr(e.prototype,n),i&&xr(e,i),t}();function Sr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Cr={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},kr=function(){function t(e,n,i,r){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.label="",this.rule=n,i&&(this.label=a("label","label").css("width","".concat(r,"px")).html(i)),this.tip=a("div","tip").child("tip").hide(),this.input=e,this.input.vchange=function(){return o.validate()},this.el=a("div","".concat(xt,"-form-field")).children(this.label,e.el,this.tip)}var e,n,i;return e=t,(n=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(t){return this.input.val(t)}},{key:"hint",value:function(t){this.input.hint(t)}},{key:"validate",value:function(){var t=this.input,e=this.rule,n=this.tip,i=this.el,r=t.val();return e.required&&/^\s*$/.test(r)?(n.html(V("validation.required")),i.addClass("error"),!1):!e.type&&!e.pattern||(e.pattern||Cr[e.type]).test(r)?(i.removeClass("error"),!0):(n.html(V("validation.notMatch")),i.addClass("error"),!1)}}])&&Sr(e.prototype,n),i&&Sr(e,i),t}();function Pr(t){return(Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tr(t,e){return!e||"object"!==Pr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Or(t){return(Or=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ar(t,e){return(Ar=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mr=function(t){function e(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Tr(this,Or(e).call(this,"div","".concat(xt,"-button ").concat(i)))).child(V("button.".concat(t))),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ar(t,e)}(e,t),e}(o);function jr(t){return(jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Dr(t,e){return!e||"object"!==jr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Nr(t){return(Nr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ir(t,e){return(Ir=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lr=100,Br=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new kr(new Er("cell",["cell"],"100%",(function(t){return V("dataValidation.modeType.".concat(t))})),{required:!0},"".concat(V("dataValidation.range"),":"),Lr),i=new kr(new wr("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),r=new kr(new Er("list",["list","number","date","phone","email"],"100%",(function(t){return V("dataValidation.type.".concat(t))}),(function(e){return t.criteriaSelected(e)})),{required:!0},"".concat(V("dataValidation.criteria"),":"),Lr),o=new kr(new Er("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",(function(t){return V("dataValidation.operator.".concat(t))}),(function(e){return t.criteriaOperatorSelected(e)})),{required:!0}).hide(),s=new kr(new wr("70px","10"),{required:!0}).hide(),c=new kr(new wr("70px","100"),{required:!0,type:"number"}).hide(),l=new kr(new wr("120px","a,b,c"),{required:!0}),u=new kr(new wr("70px","10"),{required:!0,type:"number"}).hide();return(t=Dr(this,Nr(e).call(this,V("contextmenu.validation"),[a("div","".concat(xt,"-form-fields")).children(n.el,i.el),a("div","".concat(xt,"-form-fields")).children(r.el,o.el,s.el,c.el,u.el,l.el),a("div","".concat(xt,"-buttons")).children(new Mr("cancel").on("click",(function(){return t.btnClick("cancel")})),new Mr("remove").on("click",(function(){return t.btnClick("remove")})),new Mr("save","primary").on("click",(function(){return t.btnClick("save")})))]))).mf=n,t.rf=i,t.cf=r,t.of=o,t.minvf=s,t.maxvf=c,t.vf=u,t.svf=l,t.change=function(){},t}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ir(t,e)}(e,t),n=e,(i=[{key:"showVf",value:function(t){var e="date"===t?"2018-11-12":"10",n=this.vf;n.input.hint(e),n.show()}},{key:"criteriaSelected",value:function(t){var e=this.of,n=this.minvf,i=this.maxvf,r=this.vf,o=this.svf;"date"===t||"number"===t?(e.show(),n.rule.type=t,i.rule.type=t,"date"===t?(n.hint("2018-11-12"),i.hint("2019-11-12")):(n.hint("10"),i.hint("100")),n.show(),i.show(),r.hide(),o.hide()):("list"===t?o.show():o.hide(),r.hide(),e.hide(),n.hide(),i.hide())}},{key:"criteriaOperatorSelected",value:function(t){if(t){var e=this.minvf,n=this.maxvf,i=this.vf;if("be"===t||"nbe"===t)e.show(),n.show(),i.hide();else{var r=this.cf.val();i.rule.type=r,"date"===r?i.hint("2018-11-12"):i.hint("10"),i.show(),e.hide(),n.hide()}}}},{key:"btnClick",value:function(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){for(var e=["mf","rf","cf","of","svf","vf","minvf","maxvf"],n=0;n<e.length;n+=1){var i=this[e[n]];if(i.isShow()&&!i.validate())return}var r=this.mf.val(),o=this.rf.val(),a=this.cf.val(),s=this.of.val(),c=this.svf.val();"number"!==a&&"date"!==a||(c="be"===s||"nbe"===s?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",r,o,{type:a,operator:s,required:!1,value:c}),this.hide()}}},{key:"setValue",value:function(t){if(t){var e=this.mf,n=this.rf,i=this.cf,r=this.of,o=this.svf,a=this.vf,s=this.minvf,c=this.maxvf,l=t.mode,u=t.ref,h=t.validator||{type:"list"},p=h.type,d=h.operator,f=h.value;e.val(l||"cell"),n.val(u),i.val(p),r.val(d),Array.isArray(f)?(s.val(f[0]),c.val(f[1])):(o.val(f||""),a.val(f||"")),this.criteriaSelected(p),this.criteriaOperatorSelected(d)}this.show()}}])&&Rr(n.prototype,i),r&&Rr(n,r),e}(br);function Fr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function zr(t){return a("div","".concat(xt,"-item ").concat(t))}function Gr(t){var e=this;return zr("state").child(V("sort.".concat(t))).on("click.stop",(function(){return e.itemClick(t)}))}function Vr(t){var e=this,n=this.filterbEl,i=this.filterValues;n.html(""),Object.keys(t).forEach((function(r,o){var s=t[r],c=i.includes(r)?"checked":"";n.child(a("div","".concat(xt,"-item state ").concat(c)).on("click.stop",(function(){return e.filterClick(o,r)})).children(""===r?V("filter.empty"):r,a("div","label").html("(".concat(s,")"))))}))}function Hr(){var t=this.filterhEl,e=this.filterValues,n=this.values;t.html("".concat(e.length," / ").concat(n.length)),t.checked(e.length===n.length)}var Ur=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterbEl=a("div","".concat(xt,"-body")),this.filterhEl=a("div","".concat(xt,"-header state")).on("click.stop",(function(){return e.filterClick(0,"all")})),this.el=a("div","".concat(xt,"-sort-filter")).children(this.sortAscEl=Gr.call(this,"asc"),this.sortDescEl=Gr.call(this,"desc"),zr("divider"),a("div","".concat(xt,"-filter")).children(this.filterhEl,this.filterbEl),a("div","".concat(xt,"-buttons")).children(new Mr("cancel").on("click",(function(){return e.btnClick("cancel")})),new Mr("ok","primary").on("click",(function(){return e.btnClick("ok")})))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}var e,n,i;return e=t,(n=[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,n=this.sort,i=this.filterValues;this.ok&&this.ok(e,n,"in",i)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,n=this.sortDescEl;e.checked("asc"===t),n.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var n=this.filterbEl,i=this.filterValues,r=this.values,o=n.children();"all"===e?o.length===i.length?(this.filterValues=[],o.forEach((function(t){return a(t).checked(!1)}))):(this.filterValues=Array.from(r),o.forEach((function(t){return a(t).checked(!0)}))):a(o[t]).toggle("checked")?i.push(e):i.splice(i.findIndex((function(t){return t===e})),1),Hr.call(this)}},{key:"set",value:function(t,e,n,i){this.ci=t;var r=this.sortAscEl,o=this.sortDescEl;null!==i?(this.sort=i.order,r.checked(i.asc()),o.checked(i.desc())):(this.sortDesc=null,r.checked(!1),o.checked(!1)),this.values=Object.keys(e),this.filterValues=n?Array.from(n.value):Object.keys(e),Vr.call(this,e,n),Hr.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var n=1;bt(this.el,(function(){n<=0&&e.hide(),n-=1}))}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),gt(this.el)}}])&&Fr(e.prototype,n),i&&Fr(e,i),t}();function Wr(t,e){var n=a("div","".concat(xt,"-toast")),i=a("div","".concat(xt,"-dimmer active"));n.children(a("div","".concat(xt,"-toast-header")).children(new re("close").on("click.stop",(function(){return document.body.removeChild(n.el),void document.body.removeChild(i.el)})),t),a("div","".concat(xt,"-toast-content")).html(e)),document.body.appendChild(n.el),document.body.appendChild(i.el);var r=n.box(),o=r.width,s=r.height,c=document.documentElement,l=c.clientHeight,u=c.clientWidth;n.offset({left:(u-o)/2,top:(l-s)/3})}function $r(t){return Array.prototype.concat.apply([],t)}var qr=Object.prototype.toString,Kr=Object.prototype.hasOwnProperty;function Yr(t){return void 0===t}function Xr(t){return void 0!==t}function Zr(t){return"[object Array]"===qr.call(t)}function Jr(t){return"[object Object]"===qr.call(t)}function Qr(t){return"[object Number]"===qr.call(t)}function to(t){var e=qr.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e||"[object GeneratorFunction]"===e||"[object AsyncGeneratorFunction]"===e||"[object Proxy]"===e}function eo(t){return"[object String]"===qr.call(t)}function no(t,e){return Kr.call(t,e)}function io(t,e){var n;return e=_o(e),oo(t,(function(t,i){if(e(t,i))return n=t,!1})),n}function ro(t,e){var n=[];return oo(t,(function(t,i){e(t,i)&&n.push(t)})),n}function oo(t,e){var n;if(!Yr(t)){var i=Zr(t)?xo:wo;for(var r in t)if(no(t,r)&&!1===e(n=t[r],i(r)))return n}}function ao(t,e){return Yr(t)?[]:(function(t){if(!Zr(t))throw new Error("must supply array")}(t),e=_o(e),t.filter((function(t,n){return!e(t,n)})))}function so(t,e,n){return oo(t,(function(t,i){n=e(n,t,i)})),n}function co(t,e){return!!so(t,(function(t,n,i){return t&&e(n,i)}),!0)}function lo(t,e){return!!io(t,e)}function uo(t,e){var n=[];return oo(t,(function(t,i){n.push(e(t,i))})),n}function ho(t){return t&&Object.keys(t)||[]}function po(t){return uo(t,(function(t){return t}))}function fo(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e=bo(e),oo(t,(function(t){var i=e(t)||"_",r=n[i];r||(r=n[i]=[]),r.push(t)})),n}function mo(t){t=bo(t);for(var e={},n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return oo(i,(function(n){return fo(n,t,e)})),uo(e,(function(t,e){return t[0]}))}var vo=mo;function yo(t,e){e=bo(e);var n=[];return oo(t,(function(t,i){for(var r=e(t,i),o={d:r,v:t},a=0;a<n.length;a++){if(r<n[a].d)return void n.splice(a,0,o)}n.push(o)})),uo(n,(function(t){return t.v}))}function go(t){return function(e){return co(t,(function(t,n){return e[n]===t}))}}function bo(t){return to(t)?t:function(e){return e[t]}}function _o(t){return to(t)?t:function(e){return e===t}}function wo(t){return t}function xo(t){return Number(t)}function Eo(t,e){var n,i,r,o;function a(){var a=Date.now(),c=o+e-a;if(c>0)return s(c);t.apply(r,i),n=o=i=r=void 0}function s(t){n=setTimeout(a,t)}return function(){o=Date.now();for(var t=arguments.length,a=new Array(t),c=0;c<t;c++)a[c]=arguments[c];i=a,r=this,n||s(e)}}function So(t,e){return t.bind(e)}function Co(){return(Co=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function ko(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Co.apply(void 0,[t].concat(n))}function Po(t,e){var n={},i=Object(t);return oo(e,(function(e){e in i&&(n[e]=t[e])})),n}function To(t,e){var n={};return oo(Object(t),(function(t,i){-1===e.indexOf(i)&&(n[i]=t)})),n}function Oo(t,e,n){return 2==arguments.length?t.getAttribute(e):null===n?t.removeAttribute(e):(t.setAttribute(e,n),t)}var Ao=[].indexOf,Mo=function(t,e){if(Ao)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1},jo=/\s+/,Ro=Object.prototype.toString;function Do(t){return new No(t)}function No(t){if(!t||!t.nodeType)throw new Error("A DOM element reference is required");this.el=t,this.list=t.classList}function Io(t){for(var e;t.childNodes.length;)e=t.childNodes[0],t.removeChild(e);return t}No.prototype.add=function(t){if(this.list)return this.list.add(t),this;var e=this.array();return~Mo(e,t)||e.push(t),this.el.className=e.join(" "),this},No.prototype.remove=function(t){if("[object RegExp]"==Ro.call(t))return this.removeMatching(t);if(this.list)return this.list.remove(t),this;var e=this.array(),n=Mo(e,t);return~n&&e.splice(n,1),this.el.className=e.join(" "),this},No.prototype.removeMatching=function(t){for(var e=this.array(),n=0;n<e.length;n++)t.test(e[n])&&this.remove(e[n]);return this},No.prototype.toggle=function(t,e){return this.list?(void 0!==e?e!==this.list.toggle(t,e)&&this.list.toggle(t):this.list.toggle(t),this):(void 0!==e?e?this.add(t):this.remove(t):this.has(t)?this.remove(t):this.add(t),this)},No.prototype.array=function(){var t=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(jo);return""===t[0]&&t.shift(),t},No.prototype.has=No.prototype.contains=function(t){return this.list?this.list.contains(t):!!~Mo(this.array(),t)};var Lo=Element.prototype,Bo=Lo.matchesSelector||Lo.webkitMatchesSelector||Lo.mozMatchesSelector||Lo.msMatchesSelector||Lo.oMatchesSelector,Fo=function(t,e){if(Bo)return Bo.call(t,e);for(var n=t.parentNode.querySelectorAll(e),i=0;i<n.length;++i)if(n[i]==t)return!0;return!1};var zo,Go=function(t,e,n){for(var i=n?t:t.parentNode;i&&i!==document;){if(Fo(i,e))return i;i=i.parentNode}},Vo=window.addEventListener?"addEventListener":"attachEvent",Ho=window.removeEventListener?"removeEventListener":"detachEvent",Uo="addEventListener"!==Vo?"on":"",Wo={bind:function(t,e,n,i){return t[Vo](Uo+e,n,i||!1),n},unbind:function(t,e,n,i){return t[Ho](Uo+e,n,i||!1),n}},$o=["focus","blur"],qo={bind:function(t,e,n,i,r){return-1!==$o.indexOf(n)&&(r=!0),Wo.bind(t,n,(function(n){var r=n.target||n.srcElement;n.delegateTarget=Go(r,e,!0,t),n.delegateTarget&&i.call(t,n)}),r)},unbind:function(t,e,n,i){-1!==$o.indexOf(e)&&(i=!0),Wo.unbind(t,e,n,i)}},Ko=function(t,e){if("string"!=typeof t)throw new TypeError("String expected");e||(e=document);var n=/<([\w:]+)/.exec(t);if(!n)return e.createTextNode(t);t=t.replace(/^\s+|\s+$/g,"");var i=n[1];if("body"==i){return(r=e.createElement("html")).innerHTML=t,r.removeChild(r.lastChild)}var r,o=Xo[i]||Xo._default,a=o[0],s=o[1],c=o[2];(r=e.createElement("div")).innerHTML=s+t+c;for(;a--;)r=r.lastChild;if(r.firstChild==r.lastChild)return r.removeChild(r.firstChild);var l=e.createDocumentFragment();for(;r.firstChild;)l.appendChild(r.removeChild(r.firstChild));return l},Yo=!1;"undefined"!=typeof document&&((zo=document.createElement("div")).innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',Yo=!zo.getElementsByTagName("link").length,zo=void 0);var Xo={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:Yo?[1,"X<div>","</div>"]:[0,"",""]};Xo.td=Xo.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],Xo.option=Xo.optgroup=[1,'<select multiple="multiple">',"</select>"],Xo.thead=Xo.tbody=Xo.colgroup=Xo.caption=Xo.tfoot=[1,"<table>","</table>"],Xo.polyline=Xo.ellipse=Xo.polygon=Xo.circle=Xo.text=Xo.line=Xo.path=Xo.rect=Xo.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];var Zo="undefined"!=typeof Element?Element.prototype:{},Jo=Zo.matches||Zo.matchesSelector||Zo.webkitMatchesSelector||Zo.mozMatchesSelector||Zo.msMatchesSelector||Zo.oMatchesSelector,Qo=function(t,e){if(!t||1!==t.nodeType)return!1;if(Jo)return Jo.call(t,e);for(var n=t.parentNode.querySelectorAll(e),i=0;i<n.length;i++)if(n[i]==t)return!0;return!1};function ta(t,e){return(e=e||document).querySelector(t)}function ea(t,e){return(e=e||document).querySelectorAll(t)}function na(t){t.parentNode&&t.parentNode.removeChild(t)}function ia(t,e){if(t.ownerDocument!==e.ownerDocument)try{return e.ownerDocument.importNode(t,!0)}catch(t){}return t}function ra(t,e){return e.appendChild(ia(t,e))}function oa(t,e){return ra(e,t),t}var aa=2,sa={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":aa,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":aa,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function ca(t,e,n){var i=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=sa[i];r?(r===aa&&"number"==typeof n&&(n=String(n)+"px"),t.style[i]=n):t.setAttributeNS(null,e,n)}function la(t,e,n){if("string"==typeof e){if(void 0===n)return function(t,e){return sa[e]?t.style[e]:t.getAttributeNS(null,e)}(t,e);ca(t,e,n)}else!function(t,e){var n,i,r=Object.keys(e);for(n=0;i=r[n];n++)ca(t,i,e[i])}(t,e);return t}function ua(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}var ha=/\s+/,pa=Object.prototype.toString;function da(t){return void 0!==t}function fa(t){return new ma(t)}function ma(t){if(!t||!t.nodeType)throw new Error("A DOM element reference is required");this.el=t,this.list=t.classList}function va(t){var e=t.parentNode;return e&&e.removeChild(t),t}function ya(t){for(var e;e=t.firstChild;)va(e);return t}function ga(t){return t.cloneNode(!0)}ma.prototype.add=function(t){if(this.list)return this.list.add(t),this;var e=this.array();return~ua(e,t)||e.push(t),da(this.el.className.baseVal)?this.el.className.baseVal=e.join(" "):this.el.className=e.join(" "),this},ma.prototype.remove=function(t){if("[object RegExp]"===pa.call(t))return this.removeMatching(t);if(this.list)return this.list.remove(t),this;var e=this.array(),n=ua(e,t);return~n&&e.splice(n,1),this.el.className.baseVal=e.join(" "),this},ma.prototype.removeMatching=function(t){for(var e=this.array(),n=0;n<e.length;n++)t.test(e[n])&&this.remove(e[n]);return this},ma.prototype.toggle=function(t,e){return this.list?(da(e)?e!==this.list.toggle(t,e)&&this.list.toggle(t):this.list.toggle(t),this):(da(e)?e?this.add(t):this.remove(t):this.has(t)?this.remove(t):this.add(t),this)},ma.prototype.array=function(){var t=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(ha);return""===t[0]&&t.shift(),t},ma.prototype.has=ma.prototype.contains=function(t){return this.list?this.list.contains(t):!!~ua(this.array(),t)};var ba={svg:"http://www.w3.org/2000/svg"},_a='<svg xmlns="'+ba.svg+'"';function wa(t){var e=!1;"<svg"===t.substring(0,4)?-1===t.indexOf(ba.svg)&&(t=_a+t.substring(4)):(t=_a+">"+t+"</svg>",e=!0);var n=function(t){var e;return(e=new DOMParser).async=!1,e.parseFromString(t,"text/xml")}(t);if(!e)return n;for(var i=document.createDocumentFragment(),r=n.firstChild;r.firstChild;)i.appendChild(r.firstChild);return i}function xa(t,e){var n;return"<"===t.charAt(0)?(n=wa(t).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(ba.svg,t),e&&la(n,e),n}var Ea=xa("svg");function Sa(t,e){var n,i,r=Object.keys(e);for(n=0;i=r[n];n++)t[i]=e[i];return t}function Ca(t){return t?Ea.createSVGTransformFromMatrix(t):Ea.createSVGTransform()}var ka=/([&<>]{1})/g,Pa=/([\n\r"]{1})/g,Ta={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"'"};function Oa(t,e){return t.replace(e,(function(t,e){return Ta[e]||e}))}function Aa(t,e){var n,i,r,o,a;switch(t.nodeType){case 3:e.push(Oa(t.textContent,ka));break;case 1:if(e.push("<",t.tagName),t.hasAttributes())for(n=0,i=(r=t.attributes).length;n<i;++n)o=r.item(n),e.push(" ",o.name,'="',Oa(o.value,Pa),'"');if(t.hasChildNodes()){for(e.push(">"),n=0,i=(a=t.childNodes).length;n<i;++n)Aa(a.item(n),e);e.push("</",t.tagName,">")}else e.push("/>");break;case 8:e.push("\x3c!--",Oa(t.nodeValue,ka),"--\x3e");break;case 4:e.push("<![CDATA[",t.nodeValue,"]]>");break;default:throw new Error("unable to handle node "+t.nodeType)}return e}function Ma(t,e){var n=wa(e);if(ya(t),e){"#document-fragment"!==n.nodeName&&(n=n.documentElement);for(var i,r=(i=n.childNodes,Array.prototype.slice.call(i)),o=0;o<r.length;o++)ra(r[o],t)}}function ja(t,e){if(void 0!==e){try{Ma(t,e)}catch(t){throw new Error("error parsing SVG: "+t.message)}return t}return function(t){for(var e=t.firstChild,n=[];e;)Aa(e,n),e=e.nextSibling;return n.join("")}(t)}function Ra(t,e){return e instanceof SVGMatrix?t.createSVGTransformFromMatrix(e):e}function Da(t,e){var n=t.transform.baseVal;return e&&(Array.isArray(e)||(e=[e]),function(t,e){var n,i;for(t.clear(),n=0;i=e[n];n++)t.appendItem(Ra(t,i))}(n,e)),n.consolidate()}var Na=/^class /;function Ia(t){return"[object Array]"===Object.prototype.toString.call(t)}function La(){var t=Array.prototype.slice.call(arguments);1===t.length&&Ia(t[0])&&(t=t[0]);var e=t.pop();return e.$inject=t,e}var Ba=/constructor\s*[^(]*\(\s*([^)]*)\)/m,Fa=/^function\s*[^(]*\(\s*([^)]*)\)/m,za=/\/\*([^*]*)\*\//m;function Ga(t){if("function"!=typeof t)throw new Error('Cannot annotate "'+t+'". Expected a function!');var e=t.toString().match(function(t){return Na.test(t.toString())}(t)?Ba:Fa);return e&&e[1]&&e[1].split(",").map((function(t){return(e=t.match(za))?e[1].trim():t.trim()}))||[]}function Va(){var t=[];this.factory=function(e,n){return t.push([e,"factory",n]),this},this.value=function(e,n){return t.push([e,"value",n]),this},this.type=function(e,n){return t.push([e,"type",n]),this},this.forEach=function(e){t.forEach(e)}}var Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function Ua(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function Wa(t,e){e=e||{get:function(t,e){if(n.push(t),!1===e)return null;throw a('No provider for "'+t+'"!')}};var n=[],i=this._providers=Object.create(e._providers||null),r=this._instances=Object.create(null),o=r.injector=this,a=function(t){var e=n.join(" -> ");return n.length=0,new Error(e?t+" (Resolving: "+e+")":t)},s=function t(o,s){if(!i[o]&&-1!==o.indexOf(".")){for(var c=o.split("."),l=t(c.shift());c.length;)l=l[c.shift()];return l}if($a(r,o))return r[o];if($a(i,o)){if(-1!==n.indexOf(o))throw n.push(o),a("Cannot resolve circular dependency!");return n.push(o),r[o]=i[o][0](i[o][1]),n.pop(),r[o]}return e.get(o,s)},c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("function"!=typeof t){if(!Ia(t))throw new Error('Cannot invoke "'+t+'". Expected a function!');t=La(t.slice())}var n=t.$inject||Ga(t),i=n.map((function(t){return $a(e,t)?e[t]:s(t)}));return{fn:t,dependencies:i}},l=function(t){var e=c(t),n=e.dependencies,i=e.fn;return new(Function.prototype.bind.apply(i,[null].concat(Ua(n))))},u=function(t,e,n){var i=c(t,n),r=i.dependencies,o=i.fn;return o.call.apply(o,[e].concat(Ua(r)))},h=function(t){return La((function(e){return t.get(e)}))},p={factory:u,type:l,value:function(t){return t}};t.forEach((function(t){function e(t,e){return"value"!==t&&Ia(e)&&(e=La(e.slice())),e}if(t instanceof Va)t.forEach((function(t){var n=t[0],r=t[1],o=t[2];i[n]=[p[r],e(r,o),r]}));else if("object"===(void 0===t?"undefined":Ha(t)))if(t.__exports__){var n=Object.keys(t).reduce((function(e,n){return"__"!==n.substring(0,2)&&(e[n]=t[n]),e}),Object.create(null)),r=new Wa((t.__modules__||[]).concat([n]),o),a=La((function(t){return r.get(t)}));t.__exports__.forEach((function(t){i[t]=[a,t,"private",r]}))}else Object.keys(t).forEach((function(n){if("private"!==t[n][2]){var r=t[n][0],o=t[n][1];i[n]=[p[r],e(r,o),r]}else i[n]=t[n]}))})),this.get=s,this.invoke=u,this.instantiate=l,this.createChild=function(t,e){if(e&&e.length){var n,r,a,s,c=Object.create(null),l=Object.create(null),u=[],p=[],d=[];for(var f in i)n=i[f],-1!==e.indexOf(f)&&("private"===n[2]?-1===(r=u.indexOf(n[3]))?(a=n[3].createChild([],e),s=h(a),u.push(n[3]),p.push(a),d.push(s),c[f]=[s,f,"private",a]):c[f]=[d[r],f,"private",p[r]]:c[f]=[n[2],n[1]],l[f]=!0),"factory"!==n[2]&&"type"!==n[2]||!n[1].$scope||e.forEach((function(t){-1!==n[1].$scope.indexOf(t)&&(c[f]=[n[2],n[1]],l[t]=!0)}));e.forEach((function(t){if(!l[t])throw new Error('No provider for "'+t+'". Cannot use provider from the parent!')})),t.unshift(c)}return new Wa(t,o)}}function $a(t,e){return Object.hasOwnProperty.call(t,e)}var qa=n(0),Ka=n.n(qa),Ya=1e3;function Xa(t,e){var n=this;e=e||Ya,t.on(["render.shape","render.connection"],e,(function(t,e){var i=t.type,r=e.element,o=e.gfx;if(n.canRender(r))return"render.shape"===i?n.drawShape(o,r):n.drawConnection(o,r)})),t.on(["render.getShapePath","render.getConnectionPath"],e,(function(t,e){if(n.canRender(e))return"render.getShapePath"===t.type?n.getShapePath(e):n.getConnectionPath(e)}))}function Za(t){return t.join(",").replace(/,?([A-z]),?/g,"$1")}function Ja(t){for(var e,n="",i=0;e=t[i];i++)n+=e.x+","+e.y+" ";return n}function Qa(t,e){var n=xa("polyline");return la(n,{points:Ja(t)}),e&&la(n,e),n}function ts(t){return ro(t,(function(e){return!io(t,(function(t){return t!==e&&function t(e,n){if(!n)return;if(e===n)return n;if(!e.parent)return;return t(e.parent,n)}(e,t)}))}))}function es(t,e,n){var i=!n||-1===t.indexOf(e);return i&&t.push(e),i}function ns(t,e,n){n=n||0,Zr(t)||(t=[t]),oo(t,(function(t,i){var r=e(t,i,n);Zr(r)&&r.length&&ns(r,e,n+1)}))}function is(t,e,n){var i=[],r=[];return ns(t,(function(t,o,a){es(i,t,e);var s=t.children;if((-1===n||a<n)&&s&&es(r,s,e))return s})),i}function rs(t,e){return is(t,!e,-1)}function os(t,e){var n,i,r,o;return e=!!e,Zr(t)||(t=[t]),oo(t,(function(t){var a=t;t.waypoints&&!e&&(a=os(t.waypoints,!0));var s=a.x,c=a.y,l=a.height||0,u=a.width||0;(s<n||void 0===n)&&(n=s),(c<i||void 0===i)&&(i=c),(s+u>r||void 0===r)&&(r=s+u),(c+l>o||void 0===o)&&(o=c+l)})),{x:n,y:i,height:o-i,width:r-n}}function as(t){return"waypoints"in t?"connection":"x"in t?"shape":"root"}function ss(t){return!(!t||!t.isFrame)}function cs(t,e){return ko({},t||{},e||{})}Xa.prototype.canRender=function(){},Xa.prototype.drawShape=function(){},Xa.prototype.drawConnection=function(){},Xa.prototype.getShapePath=function(){},Xa.prototype.getConnectionPath=function(){};var ls=1;function us(t,e){Xa.call(this,t,ls),this.CONNECTION_STYLE=e.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=e.style({fill:"white",stroke:"fuchsia",strokeWidth:2}),this.FRAME_STYLE=e.style(["no-fill"],{stroke:"fuchsia",strokeDasharray:4,strokeWidth:2})}Ka()(us,Xa),us.prototype.canRender=function(){return!0},us.prototype.drawShape=function(t,e){var n=xa("rect");return la(n,{x:0,y:0,width:e.width||0,height:e.height||0}),ss(e)?la(n,this.FRAME_STYLE):la(n,this.SHAPE_STYLE),oa(t,n),n},us.prototype.drawConnection=function(t,e){var n=Qa(e.waypoints,this.CONNECTION_STYLE);return oa(t,n),n},us.prototype.getShapePath=function(t){var e=t.x,n=t.y,i=t.width;return Za([["M",e,n],["l",i,0],["l",0,t.height],["l",-i,0],["z"]])},us.prototype.getConnectionPath=function(t){var e,n,i=t.waypoints,r=[];for(e=0;n=i[e];e++)n=n.original||n,r.push([0===e?"M":"L",n.x,n.y]);return Za(r)},us.$inject=["eventBus","styles"];var hs={__init__:["defaultRenderer"],defaultRenderer:["type",us],styles:["type",function(){var t={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},e=this;this.cls=function(t,e,n){return ko(this.style(e,n),{class:t})},this.style=function(e,n){Zr(e)||n||(n=e,e=[]);var i=so(e,(function(e,n){return ko(e,t[n]||{})}),{});return n?ko(i,n):i},this.computeStyle=function(t,n,i){return Zr(n)||(i=n,n=[]),e.style(n||[],ko({},i,t||{}))}}]};function ps(t,e){if(!t||!e)return-1;var n=t.indexOf(e);return-1!==n&&t.splice(n,1),n}function ds(t,e,n){if(t&&e){"number"!=typeof n&&(n=-1);var i=t.indexOf(e);if(-1!==i){if(i===n)return;if(-1===n)return;t.splice(i,1)}-1!==n?t.splice(n,0,e):t.push(e)}}function fs(t,e){return t&&e?t.indexOf(e):-1}function ms(t,e){return Math.round(t*e)/e}function vs(t){return Qr(t)?t+"px":t}function ys(t,e,n){var i=xa("g");fa(i).add(e);var r=void 0!==n?n:t.childNodes.length-1;return t.insertBefore(i,t.childNodes[r]||null),i}var gs={shape:["x","y","width","height"],connection:["waypoints"]};function bs(t,e,n,i){this._eventBus=e,this._elementRegistry=i,this._graphicsFactory=n,this._init(t||{})}function _s(t,e){var n="matrix("+e.a+","+e.b+","+e.c+","+e.d+","+e.e+","+e.f+")";t.setAttribute("transform",n)}bs.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"],bs.prototype._init=function(t){var e=this._eventBus,n=this._container=function(t){var e=(t=ko({},{width:"100%",height:"100%"},t)).container||document.body,n=document.createElement("div");return n.setAttribute("class","djs-container"),ko(n.style,{position:"relative",overflow:"hidden",width:vs(t.width),height:vs(t.height)}),e.appendChild(n),n}(t),i=this._svg=xa("svg");la(i,{width:"100%",height:"100%"}),oa(n,i);var r=this._viewport=ys(i,"viewport");this._layers={},!1!==t.deferUpdate&&(this._viewboxChanged=Eo(So(this._viewboxChanged,this),300)),e.on("diagram.init",(function(){e.fire("canvas.init",{svg:i,viewport:r})}),this),e.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed"],(function(){delete this._cachedViewbox}),this),e.on("diagram.destroy",500,this._destroy,this),e.on("diagram.clear",500,this._clear,this)},bs.prototype._destroy=function(t){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});var e=this._container.parentNode;e&&e.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._rootElement,delete this._viewport},bs.prototype._clear=function(){var t=this;this._elementRegistry.getAll().forEach((function(e){var n=as(e);"root"===n?t.setRootElement(null,!0):t._removeElement(e,n)})),delete this._cachedViewbox},bs.prototype.getDefaultLayer=function(){return this.getLayer("base",0)},bs.prototype.getLayer=function(t,e){if(!t)throw new Error("must specify a name");var n=this._layers[t];if(n||(n=this._layers[t]=this._createLayer(t,e)),void 0!==e&&n.index!==e)throw new Error("layer <"+t+"> already created at index <"+e+">");return n.group},bs.prototype._createLayer=function(t,e){e||(e=0);var n=so(this._layers,(function(t,n){return e>=n.index&&t++,t}),0);return{group:ys(this._viewport,"layer-"+t,n),index:e}},bs.prototype.getContainer=function(){return this._container},bs.prototype._updateMarker=function(t,e,n){var i;t.id||(t=this._elementRegistry.get(t)),(i=this._elementRegistry._elements[t.id])&&(oo([i.gfx,i.secondaryGfx],(function(t){t&&(n?fa(t).add(e):fa(t).remove(e))})),this._eventBus.fire("element.marker.update",{element:t,gfx:i.gfx,marker:e,add:!!n}))},bs.prototype.addMarker=function(t,e){this._updateMarker(t,e,!0)},bs.prototype.removeMarker=function(t,e){this._updateMarker(t,e,!1)},bs.prototype.hasMarker=function(t,e){return t.id||(t=this._elementRegistry.get(t)),fa(this.getGraphics(t)).has(e)},bs.prototype.toggleMarker=function(t,e){this.hasMarker(t,e)?this.removeMarker(t,e):this.addMarker(t,e)},bs.prototype.getRootElement=function(){return this._rootElement||this.setRootElement({id:"__implicitroot",children:[]}),this._rootElement},bs.prototype.setRootElement=function(t,e){t&&this._ensureValid("root",t);var n=this._rootElement,i=this._elementRegistry,r=this._eventBus;if(n){if(!e)throw new Error("rootElement already set, need to specify override");r.fire("root.remove",{element:n}),r.fire("root.removed",{element:n}),i.remove(n)}if(t){var o=this.getDefaultLayer();r.fire("root.add",{element:t}),i.add(t,o,this._svg),r.fire("root.added",{element:t,gfx:o})}return this._rootElement=t,t},bs.prototype._ensureValid=function(t,e){if(!e.id)throw new Error("element must have an id");if(this._elementRegistry.get(e.id))throw new Error("element with id "+e.id+" already exists");var n=gs[t];if(!co(n,(function(t){return void 0!==e[t]})))throw new Error("must supply { "+n.join(", ")+" } with "+t)},bs.prototype._setParent=function(t,e,n){ds(e.children,t,n),t.parent=e},bs.prototype._addElement=function(t,e,n,i){n=n||this.getRootElement();var r=this._eventBus,o=this._graphicsFactory;this._ensureValid(t,e),r.fire(t+".add",{element:e,parent:n}),this._setParent(e,n,i);var a=o.create(t,e,i);return this._elementRegistry.add(e,a),o.update(t,e,a),r.fire(t+".added",{element:e,gfx:a}),e},bs.prototype.addShape=function(t,e,n){return this._addElement("shape",t,e,n)},bs.prototype.addConnection=function(t,e,n){return this._addElement("connection",t,e,n)},bs.prototype._removeElement=function(t,e){var n=this._elementRegistry,i=this._graphicsFactory,r=this._eventBus;if(t=n.get(t.id||t))return r.fire(e+".remove",{element:t}),i.remove(t),ps(t.parent&&t.parent.children,t),t.parent=null,r.fire(e+".removed",{element:t}),n.remove(t),t},bs.prototype.removeShape=function(t){return this._removeElement(t,"shape")},bs.prototype.removeConnection=function(t){return this._removeElement(t,"connection")},bs.prototype.getGraphics=function(t,e){return this._elementRegistry.getGraphics(t,e)},bs.prototype._changeViewbox=function(t){this._eventBus.fire("canvas.viewbox.changing"),t.apply(this),this._cachedViewbox=null,this._viewboxChanged()},bs.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})},bs.prototype.viewbox=function(t){if(void 0===t&&this._cachedViewbox)return this._cachedViewbox;var e,n,i,r,o,a,s=this._viewport,c=this.getSize();return t?(this._changeViewbox((function(){r=Math.min(c.width/t.width,c.height/t.height);var e=this._svg.createSVGMatrix().scale(r).translate(-t.x,-t.y);Da(s,e)})),t):(e=this.getDefaultLayer().getBBox(),n=(i=Da(s))?i.matrix:function(t,e,n,i,r,o){var a=Ea.createSVGMatrix();switch(arguments.length){case 0:return a;case 1:return Sa(a,t);case 6:return Sa(a,{a:t,b:e,c:n,d:i,e:r,f:o})}}(),r=ms(n.a,1e3),o=ms(-n.e||0,1e3),a=ms(-n.f||0,1e3),t=this._cachedViewbox={x:o?o/r:0,y:a?a/r:0,width:c.width/r,height:c.height/r,scale:r,inner:{width:e.width,height:e.height,x:e.x,y:e.y},outer:c})},bs.prototype.scroll=function(t){var e=this._viewport,n=e.getCTM();return t&&this._changeViewbox((function(){t=ko({dx:0,dy:0},t||{}),n=this._svg.createSVGMatrix().translate(t.dx,t.dy).multiply(n),_s(e,n)})),{x:n.e,y:n.f}},bs.prototype.zoom=function(t,e){return t?"fit-viewport"===t?this._fitViewport(e):(this._changeViewbox((function(){"object"!=typeof e&&(n=this.viewbox().outer,e={x:n.width/2,y:n.height/2}),i=this._setZoom(t,e)})),ms(i.a,1e3)):this.viewbox(t).scale;var n,i},bs.prototype._fitViewport=function(t){var e,n,i=this.viewbox(),r=i.outer,o=i.inner;return o.x>=0&&o.y>=0&&o.x+o.width<=r.width&&o.y+o.height<=r.height&&!t?n={x:0,y:0,width:Math.max(o.width+o.x,r.width),height:Math.max(o.height+o.y,r.height)}:(e=Math.min(1,r.width/o.width,r.height/o.height),n={x:o.x+(t?o.width/2-r.width/e/2:0),y:o.y+(t?o.height/2-r.height/e/2:0),width:r.width/e,height:r.height/e}),this.viewbox(n),this.viewbox(!1).scale},bs.prototype._setZoom=function(t,e){var n,i,r,o,a=this._svg,s=this._viewport,c=a.createSVGMatrix(),l=a.createSVGPoint(),u=(i=s.getCTM()).a;return e?(n=ko(l,e).matrixTransform(i.inverse()),r=c.translate(n.x,n.y).scale(1/u*t).translate(-n.x,-n.y),o=i.multiply(r)):o=c.scale(t),_s(this._viewport,o),o},bs.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}},bs.prototype.getAbsoluteBBox=function(t){var e,n=this.viewbox();t.waypoints?e=this.getGraphics(t).getBBox():e=t;return{x:e.x*n.scale-n.x*n.scale,y:e.y*n.scale-n.y*n.scale,width:e.width*n.scale,height:e.height*n.scale}},bs.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var ws="data-element-id";function xs(t){this._elements={},this._eventBus=t}xs.$inject=["eventBus"],xs.prototype.add=function(t,e,n){var i=t.id;this._validateId(i),la(e,ws,i),n&&la(n,ws,i),this._elements[i]={element:t,gfx:e,secondaryGfx:n}},xs.prototype.remove=function(t){var e=this._elements,n=t.id||t,i=n&&e[n];i&&(la(i.gfx,ws,""),i.secondaryGfx&&la(i.secondaryGfx,ws,""),delete e[n])},xs.prototype.updateId=function(t,e){this._validateId(e),"string"==typeof t&&(t=this.get(t)),this._eventBus.fire("element.updateId",{element:t,newId:e});var n=this.getGraphics(t),i=this.getGraphics(t,!0);this.remove(t),t.id=e,this.add(t,n,i)},xs.prototype.get=function(t){var e;e="string"==typeof t?t:t&&la(t,ws);var n=this._elements[e];return n&&n.element},xs.prototype.filter=function(t){var e=[];return this.forEach((function(n,i){t(n,i)&&e.push(n)})),e},xs.prototype.getAll=function(){return this.filter((function(t){return t}))},xs.prototype.forEach=function(t){var e=this._elements;Object.keys(e).forEach((function(n){var i=e[n],r=i.element,o=i.gfx;return t(r,o)}))},xs.prototype.getGraphics=function(t,e){var n=t.id||t,i=this._elements[n];return i&&(e?i.secondaryGfx:i.gfx)},xs.prototype._validateId=function(t){if(!t)throw new Error("element must have an id");if(this._elements[t])throw new Error("element with id "+t+" already added")};var Es=n(8),Ss=n.n(Es),Cs=new Ss.a({name:"children",enumerable:!0,collection:!0},{name:"parent"}),ks=new Ss.a({name:"labels",enumerable:!0,collection:!0},{name:"labelTarget"}),Ps=new Ss.a({name:"attachers",collection:!0},{name:"host"}),Ts=new Ss.a({name:"outgoing",collection:!0},{name:"source"}),Os=new Ss.a({name:"incoming",collection:!0},{name:"target"});function As(){Object.defineProperty(this,"businessObject",{writable:!0}),Object.defineProperty(this,"label",{get:function(){return this.labels[0]},set:function(t){var e=this.label,n=this.labels;!t&&e?n.remove(e):n.add(t,0)}}),Cs.bind(this,"parent"),ks.bind(this,"labels"),Ts.bind(this,"outgoing"),Os.bind(this,"incoming")}function Ms(){As.call(this),Cs.bind(this,"children"),Ps.bind(this,"host"),Ps.bind(this,"attachers")}function js(){Ms.call(this)}function Rs(){Ms.call(this),ks.bind(this,"labelTarget")}function Ds(){As.call(this),Ts.bind(this,"source"),Os.bind(this,"target")}Ka()(Ms,As),Ka()(js,Ms),Ka()(Rs,Ms),Ka()(Ds,As);var Ns={connection:Ds,shape:Ms,label:Rs,root:js};function Is(){this._uid=12}Is.prototype.createRoot=function(t){return this.create("root",t)},Is.prototype.createLabel=function(t){return this.create("label",t)},Is.prototype.createShape=function(t){return this.create("shape",t)},Is.prototype.createConnection=function(t){return this.create("connection",t)},Is.prototype.create=function(t,e){return(e=ko({},e||{})).id||(e.id=t+"_"+this._uid++),function(t,e){var n=Ns[t];if(!n)throw new Error("unknown type: <"+t+">");return ko(new n,e)}(t,e)};var Ls=Array.prototype.slice;function Bs(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}function Fs(){}function zs(t){return t.childNodes[0]}function Gs(t,e,n,i,r){var o=Ca();o.setTranslate(e,n);var a=Ca();a.setRotate(i,0,0);var s=Ca();s.setScale(r||1,r||1),Da(t,[o,a,s])}function Vs(t,e,n){var i=Ca();i.setTranslate(e,n),Da(t,i)}function Hs(t,e){var n=Ca();n.setRotate(e,0,0),Da(t,n)}function Us(t,e){this._eventBus=t,this._elementRegistry=e}function Ws(t,e,n){var i=n||e.firstChild;t!==i&&e.insertBefore(t,i)}Bs.prototype.on=function(t,e,n,i){if(t=Zr(t)?t:[t],to(e)&&(i=n,n=e,e=1e3),!Qr(e))throw new Error("priority must be a number");var r=n;i&&((r=So(n,i)).__fn=n.__fn||n);var o=this;t.forEach((function(t){o._addListener(t,{priority:e,callback:r,next:null})}))},Bs.prototype.once=function(t,e,n,i){var r=this;if(to(e)&&(i=n,n=e,e=1e3),!Qr(e))throw new Error("priority must be a number");function o(){var e=n.apply(i,arguments);return r.off(t,o),e}o.__fn=n,this.on(t,e,o)},Bs.prototype.off=function(t,e){t=Zr(t)?t:[t];var n=this;t.forEach((function(t){n._removeListener(t,e)}))},Bs.prototype.createEvent=function(t){var e=new Fs;return e.init(t),e},Bs.prototype.fire=function(t,e){var n,i,r,o;if(o=Ls.call(arguments),"object"==typeof t&&(t=(n=t).type),!t)throw new Error("no event type specified");if(i=this._listeners[t]){n=e instanceof Fs?e:this.createEvent(e),o[0]=n;var a=n.type;t!==a&&(n.type=t);try{r=this._invokeListeners(n,o,i)}finally{t!==a&&(n.type=a)}return void 0===r&&n.defaultPrevented&&(r=!1),r}},Bs.prototype.handleError=function(t){return!1===this.fire("error",{error:t})},Bs.prototype._destroy=function(){this._listeners={}},Bs.prototype._invokeListeners=function(t,e,n){for(var i;n&&!t.cancelBubble;)i=this._invokeListener(t,e,n),n=n.next;return i},Bs.prototype._invokeListener=function(t,e,n){var i;try{void 0!==(i=function(t,e){return t.apply(null,e)}(n.callback,e))&&(t.returnValue=i,t.stopPropagation()),!1===i&&t.preventDefault()}catch(t){if(!this.handleError(t))throw console.error("unhandled error in event listener"),console.error(t.stack),t}return i},Bs.prototype._addListener=function(t,e){var n,i=this._getListeners(t);if(i){for(;i;){if(i.priority<e.priority)return e.next=i,void(n?n.next=e:this._setListeners(t,e));n=i,i=i.next}n.next=e}else this._setListeners(t,e)},Bs.prototype._getListeners=function(t){return this._listeners[t]},Bs.prototype._setListeners=function(t,e){this._listeners[t]=e},Bs.prototype._removeListener=function(t,e){var n,i,r,o=this._getListeners(t);if(e)for(;o;)n=o.next,(r=o.callback)!==e&&r.__fn!==e||(i?i.next=n:this._setListeners(t,n)),i=o,o=n;else this._setListeners(t,null)},Fs.prototype.stopPropagation=function(){this.cancelBubble=!0},Fs.prototype.preventDefault=function(){this.defaultPrevented=!0},Fs.prototype.init=function(t){ko(this,t||{})},Us.$inject=["eventBus","elementRegistry"],Us.prototype._getChildren=function(t){var e,n=this._elementRegistry.getGraphics(t);return t.parent?(e=function(t){return t.parentNode.childNodes[1]}(n))||(fa(e=xa("g")).add("djs-children"),oa(n.parentNode,e)):e=n,e},Us.prototype._clear=function(t){var e=zs(t);return Io(e),e},Us.prototype._createContainer=function(t,e,n,i){var r=xa("g");fa(r).add("djs-group"),void 0!==n?Ws(r,e,e.childNodes[n]):oa(e,r);var o=xa("g");fa(o).add("djs-element"),fa(o).add("djs-"+t),i&&fa(o).add("djs-frame"),oa(r,o);var a=xa("g");return fa(a).add("djs-visual"),oa(o,a),o},Us.prototype.create=function(t,e,n){var i=this._getChildren(e.parent);return this._createContainer(t,i,n,ss(e))},Us.prototype.updateContainments=function(t){var e=this,n=this._elementRegistry;oo(so(t,(function(t,e){return e.parent&&(t[e.parent.id]=e.parent),t}),{}),(function(t){var i=t.children;if(i){var r=e._getChildren(t);oo(i.slice().reverse(),(function(t){Ws(n.getGraphics(t).parentNode,r)}))}}))},Us.prototype.drawShape=function(t,e){return this._eventBus.fire("render.shape",{gfx:t,element:e})},Us.prototype.getShapePath=function(t){return this._eventBus.fire("render.getShapePath",t)},Us.prototype.drawConnection=function(t,e){return this._eventBus.fire("render.connection",{gfx:t,element:e})},Us.prototype.getConnectionPath=function(t){return this._eventBus.fire("render.getConnectionPath",t)},Us.prototype.update=function(t,e,n){if(e.parent){var i=this._clear(n);if("shape"===t)this.drawShape(i,e),Vs(n,e.x,e.y);else{if("connection"!==t)throw new Error("unknown type: "+t);this.drawConnection(i,e)}e.hidden?la(n,"display","none"):la(n,"display","block")}},Us.prototype.remove=function(t){va(this._elementRegistry.getGraphics(t).parentNode)};var $s={__depends__:[hs],__init__:["canvas"],canvas:["type",bs],elementRegistry:["type",xs],elementFactory:["type",Is],eventBus:["type",Bs],graphicsFactory:["type",Us]};function qs(t){var e=[],n=[];function i(t){return e.indexOf(t)>=0}t.forEach((function t(r){i(r)||((r.__depends__||[]).forEach(t),i(r)||(!function(t){e.push(t)}(r),(r.__init__||[]).forEach((function(t){n.push(t)}))))}));var r=new Wa(e);return n.forEach((function(t){try{r["string"==typeof t?"get":"invoke"](t)}catch(t){throw console.error("Failed to instantiate component"),console.error(t.stack),t}})),r}function Ks(t,e){this.injector=e=e||function(t){return qs([{config:["value",t=t||{}]},$s].concat(t.modules||[]))}(t),this.get=e.get,this.invoke=e.invoke,this.get("eventBus").fire("diagram.init")}function Ys(){}function Xs(t,e){this.model=t,this.properties=e}Ks.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")},Ks.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")},Ys.prototype.get=function(t){return this.$model.properties.get(this,t)},Ys.prototype.set=function(t,e){this.$model.properties.set(this,t,e)},Xs.prototype.createType=function(t){var e=this.model,n=this.properties,i=Object.create(Ys.prototype);oo(t.properties,(function(t){t.isMany||void 0===t.default||(i[t.name]=t.default)})),n.defineModel(i,e),n.defineDescriptor(i,t);var r=t.ns.name;function o(t){n.define(this,"$type",{value:r,enumerable:!0}),n.define(this,"$attrs",{value:{}}),n.define(this,"$parent",{writable:!0}),oo(t,So((function(t,e){this.set(e,t)}),this))}return o.prototype=i,o.hasType=i.$instanceOf=this.model.hasType,n.defineModel(o,e),n.defineDescriptor(o,t),o};var Zs={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},Js={String:function(t){return t},Boolean:function(t){return"true"===t},Integer:function(t){return parseInt(t,10)},Real:function(t){return parseFloat(t,10)}};function Qs(t,e){var n=Js[t];return n?n(e):e}function tc(t){return!!Zs[t]}function ec(t){return!!Js[t]}function nc(t,e){var n,i,r=t.split(/:/);if(1===r.length)n=t,i=e;else{if(2!==r.length)throw new Error("expected <prefix:localName> or <localName>, got "+t);n=r[1],i=r[0]}return{name:t=(i?i+":":"")+n,prefix:i,localName:n}}function ic(t){this.ns=t,this.name=t.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={}}function rc(t,e){this.packageMap={},this.typeMap={},this.packages=[],this.properties=e,oo(t,So(this.registerPackage,this))}function oc(t,e,n){var i=e[n];if(i in t)throw new Error("package with "+n+" <"+i+"> already defined")}function ac(t){this.model=t}function sc(t,e,n){Object.defineProperty(t,e.name,{enumerable:!e.isReference,writable:!0,value:n,configurable:!0})}function cc(t){this.properties=new ac(this),this.factory=new Xs(this,this.properties),this.registry=new rc(t,this.properties),this.typeCache={}}ic.prototype.build=function(){return Po(this,["ns","name","allTypes","allTypesByName","properties","propertiesByName","bodyProperty","idProperty"])},ic.prototype.addProperty=function(t,e,n){"boolean"==typeof e&&(n=e,e=void 0),this.addNamedProperty(t,!1!==n);var i=this.properties;void 0!==e?i.splice(e,0,t):i.push(t)},ic.prototype.replaceProperty=function(t,e,n){var i=t.ns,r=this.properties,o=this.propertiesByName,a=t.name!==e.name;if(t.isId){if(!e.isId)throw new Error("property <"+e.ns.name+"> must be id property to refine <"+t.ns.name+">");this.setIdProperty(e,!1)}if(t.isBody){if(!e.isBody)throw new Error("property <"+e.ns.name+"> must be body property to refine <"+t.ns.name+">");this.setBodyProperty(e,!1)}var s=r.indexOf(t);if(-1===s)throw new Error("property <"+i.name+"> not found in property list");r.splice(s,1),this.addProperty(e,n?void 0:s,a),o[i.name]=o[i.localName]=e},ic.prototype.redefineProperty=function(t,e,n){var i=t.ns.prefix,r=e.split("#"),o=nc(r[0],i),a=nc(r[1],o.prefix).name,s=this.propertiesByName[a];if(!s)throw new Error("refined property <"+a+"> not found");this.replaceProperty(s,t,n),delete t.redefines},ic.prototype.addNamedProperty=function(t,e){var n=t.ns,i=this.propertiesByName;e&&(this.assertNotDefined(t,n.name),this.assertNotDefined(t,n.localName)),i[n.name]=i[n.localName]=t},ic.prototype.removeNamedProperty=function(t){var e=t.ns,n=this.propertiesByName;delete n[e.name],delete n[e.localName]},ic.prototype.setBodyProperty=function(t,e){if(e&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+t.ns.name+">)");this.bodyProperty=t},ic.prototype.setIdProperty=function(t,e){if(e&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+t.ns.name+">)");this.idProperty=t},ic.prototype.assertNotDefined=function(t,e){var n=t.name,i=this.propertiesByName[n];if(i)throw new Error("property <"+n+"> already defined; override of <"+i.definedBy.ns.name+"#"+i.ns.name+"> by <"+t.definedBy.ns.name+"#"+t.ns.name+"> not allowed without redefines")},ic.prototype.hasProperty=function(t){return this.propertiesByName[t]},ic.prototype.addTrait=function(t,e){var n=this.allTypesByName,i=this.allTypes,r=t.name;r in n||(oo(t.properties,So((function(n){n=ko({},n,{name:n.ns.localName,inherited:e}),Object.defineProperty(n,"definedBy",{value:t});var i=n.replaces,r=n.redefines;i||r?this.redefineProperty(n,i||r,i):(n.isBody&&this.setBodyProperty(n),n.isId&&this.setIdProperty(n),this.addProperty(n))}),this)),i.push(t),n[r]=t)},rc.prototype.getPackage=function(t){return this.packageMap[t]},rc.prototype.getPackages=function(){return this.packages},rc.prototype.registerPackage=function(t){t=ko({},t);var e=this.packageMap;oc(e,t,"prefix"),oc(e,t,"uri"),oo(t.types,So((function(e){this.registerType(e,t)}),this)),e[t.uri]=e[t.prefix]=t,this.packages.push(t)},rc.prototype.registerType=function(t,e){var n=nc((t=ko({},t,{superClass:(t.superClass||[]).slice(),extends:(t.extends||[]).slice(),properties:(t.properties||[]).slice(),meta:ko(t.meta||{})})).name,e.prefix),i=n.name,r={};oo(t.properties,So((function(t){var e=nc(t.name,n.prefix),i=e.name;tc(t.type)||(t.type=nc(t.type,e.prefix).name),ko(t,{ns:e,name:i}),r[i]=t}),this)),ko(t,{ns:n,name:i,propertiesByName:r}),oo(t.extends,So((function(t){var e=this.typeMap[t];e.traits=e.traits||[],e.traits.push(i)}),this)),this.definePackage(t,e),this.typeMap[i]=t},rc.prototype.mapTypes=function(t,e,n){var i=tc(t.name)?{name:t.name}:this.typeMap[t.name],r=this;function o(t){return a(t,!0)}function a(n,i){var o=nc(n,tc(n)?"":t.prefix);r.mapTypes(o,e,i)}if(!i)throw new Error("unknown type <"+t.name+">");oo(i.superClass,n?o:a),e(i,!n),oo(i.traits,o)},rc.prototype.getEffectiveDescriptor=function(t){var e=nc(t),n=new ic(e);this.mapTypes(e,(function(t,e){n.addTrait(t,e)}));var i=n.build();return this.definePackage(i,i.allTypes[i.allTypes.length-1].$pkg),i},rc.prototype.definePackage=function(t,e){this.properties.define(t,"$pkg",{value:e})},ac.prototype.set=function(t,e,n){var i=this.model.getPropertyDescriptor(t,e),r=i&&i.name;void 0===n?i?delete t[r]:delete t.$attrs[e]:i?r in t?t[r]=n:sc(t,i,n):t.$attrs[e]=n},ac.prototype.get=function(t,e){var n=this.model.getPropertyDescriptor(t,e);if(!n)return t.$attrs[e];var i=n.name;return!t[i]&&n.isMany&&sc(t,n,[]),t[i]},ac.prototype.define=function(t,e,n){Object.defineProperty(t,e,n)},ac.prototype.defineDescriptor=function(t,e){this.define(t,"$descriptor",{value:e})},ac.prototype.defineModel=function(t,e){this.define(t,"$model",{value:e})},cc.prototype.create=function(t,e){var n=this.getType(t);if(!n)throw new Error("unknown type <"+t+">");return new n(e)},cc.prototype.getType=function(t){var e=this.typeCache,n=eo(t)?t:t.ns.name,i=e[n];return i||(t=this.registry.getEffectiveDescriptor(n),i=e[n]=this.factory.createType(t)),i},cc.prototype.createAny=function(t,e,n){var i=nc(t),r={$type:t,$instanceOf:function(t){return t===this.$type}},o={name:t,isGeneric:!0,ns:{prefix:i.prefix,localName:i.localName,uri:e}};return this.properties.defineDescriptor(r,o),this.properties.defineModel(r,this),this.properties.define(r,"$parent",{enumerable:!1,writable:!0}),oo(n,(function(t,e){Jr(t)&&void 0!==t.value?r[t.name]=t.value:r[e]=t})),r},cc.prototype.getPackage=function(t){return this.registry.getPackage(t)},cc.prototype.getPackages=function(){return this.registry.getPackages()},cc.prototype.getElementDescriptor=function(t){return t.$descriptor},cc.prototype.hasType=function(t,e){return void 0===e&&(e=t,t=this),e in t.$model.getElementDescriptor(t).allTypesByName},cc.prototype.getPropertyDescriptor=function(t,e){return this.getElementDescriptor(t).propertiesByName[e]},cc.prototype.getTypeDescriptor=function(t){return this.registry.typeMap[t]};var lc=String.fromCharCode,uc=Object.prototype.hasOwnProperty,hc=/&#(\d+);|&#x([0-9a-f]+);|&(\w+);/gi,pc={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'};function dc(t,e,n,i){return i?uc.call(pc,i)?pc[i]:"&"+i+";":lc(e||parseInt(n,16))}function fc(t){return t.length>3&&-1!==t.indexOf("&")?t.replace(hc,dc):t}Object.keys(pc).forEach((function(t){pc[t.toUpperCase()]=pc[t]}));var mc="http://www.w3.org/2001/XMLSchema-instance",vc="xsi",yc="xsi:type",gc="non-whitespace outside of root node";function bc(t){return new Error(t)}function _c(t){return"missing namespace for prefix <"+t+">"}function wc(t){return{get:t,enumerable:!0}}function xc(t){var e,n={};for(e in t)n[e]=t[e];return n}function Ec(t){return t+"$uri"}function Sc(){return{line:0,column:0}}function Cc(t){throw t}function kc(t){if(!this)return new kc(t);var e,n,i,r,o,a,s,c,l,u=t&&t.proxy,h=Cc,p=Sc,d=!1,f=!1,m=null,v=!1;function y(t){t instanceof Error||(t=bc(t)),m=t,h(t,p)}function g(t){o&&(t instanceof Error||(t=bc(t)),o(t,p))}this.on=function(t,l){if("function"!=typeof l)throw bc("required args <name, cb>");switch(t){case"openTag":n=l;break;case"text":e=l;break;case"closeTag":i=l;break;case"error":h=l;break;case"warn":o=l;break;case"cdata":r=l;break;case"attention":c=l;break;case"question":s=l;break;case"comment":a=l;break;default:throw bc("unsupported event: "+t)}return this},this.ns=function(t){if(void 0===t&&(t={}),"object"!=typeof t)throw bc("required args <nsMap={}>");var e,n={};for(e in t)n[e]=t[e];return n[mc]=vc,f=!0,l=n,this},this.parse=function(t){if("string"!=typeof t)throw bc("required args <xml=string>");return m=null,function(t){var o,h,m,b,_,w,x,E,S,C,k=f?[]:null,P=f?function(t){var e,n,i={};for(e in t)i[n=t[e]]=n,i[Ec(n)]=e;return i}(l):null,T=[],O=0,A=!1,M=!1,j=0,R=0,D="",N=0;function I(){if(null!==C)return C;var t,e,n,i,r,o,a,s,c,u,h,p=f&&P.xmlns,m=f&&d?[]:null,v=N,y=D,b=y.length,_={},w={};t:for(;v<b;v++)if(c=!1,!(32===(u=y.charCodeAt(v))||u<14&&u>8)){for((u<65||u>122||u>90&&u<97)&&95!==u&&58!==u&&(g("illegal first char attribute name"),c=!0),h=v+1;h<b;h++)if(!((u=y.charCodeAt(h))>96&&u<123||u>64&&u<91||u>47&&u<59||46===u||45===u||95===u)){if(32===u||u<14&&u>8){g("missing attribute value"),v=h;continue t}if(61===u)break;g("illegal attribute name char"),c=!0}if("xmlns:xmlns"===(s=y.substring(v,h))&&(g("illegal declaration of xmlns"),c=!0),34===(u=y.charCodeAt(h+1)))-1===(h=y.indexOf('"',v=h+2))&&-1!==(h=y.indexOf("'",v))&&(g("attribute value quote missmatch"),c=!0);else if(39===u)-1===(h=y.indexOf("'",v=h+2))&&-1!==(h=y.indexOf('"',v))&&(g("attribute value quote missmatch"),c=!0);else for(g("missing attribute value quotes"),c=!0,h+=1;h<b&&!(32===(u=y.charCodeAt(h+1))||u<14&&u>8);h++);for(-1===h&&(g("missing closing quotes"),h=b,c=!0),c||(o=y.substring(v,h)),v=h;h+1<b&&!(32===(u=y.charCodeAt(h+1))||u<14&&u>8);h++)v===h&&(g("illegal character after attribute end"),c=!0);if(v=h+1,!c)if(s in w)g("attribute <"+s+"> already defined");else if(w[s]=!0,f)if(d){if(null!==(r="xmlns"===s?"xmlns":120===s.charCodeAt(0)&&"xmlns:"===s.substr(0,6)?s.substr(6):null)){if(t=fc(o),e=Ec(r),!(a=l[t])){if("xmlns"===r||e in P&&P[e]!==t)do{a="ns"+O++}while(void 0!==P[a]);else a=r;l[t]=a}P[r]!==a&&(i||(P=xc(P),i=!0),P[r]=a,"xmlns"===r&&(P[Ec(a)]=t,p=a),P[e]=t),_[s]=o;continue}m.push(s,o)}else-1!==(u=s.indexOf(":"))?(n=P[s.substring(0,u)])?((s=p===n?s.substr(u+1):n+s.substr(u))===yc&&(-1!==(u=o.indexOf(":"))?(n=o.substring(0,u),o=(n=P[n]||n)+o.substring(u)):o=p+":"+o),_[s]=o):g(_c(s.substring(0,u))):_[s]=o;else _[s]=o}if(d)for(v=0,b=m.length;v<b;v++){if(s=m[v++],o=m[v],-1!==(u=s.indexOf(":"))){if(!(n=P[s.substring(0,u)])){g(_c(s.substring(0,u)));continue}(s=p===n?s.substr(u+1):n+s.substr(u))===yc&&(-1!==(u=o.indexOf(":"))?(n=o.substring(0,u),o=(n=P[n]||n)+o.substring(u)):o=p+":"+o)}_[s]=o}return C=_}p=function(){var e,n,i=/(\r\n|\r|\n)/g,r=0,o=0,a=0,s=R;for(;j>=a&&(e=i.exec(t))&&!((s=e[0].length+e.index)>j);)r+=1,a=s;-1==j?(o=s,n=t.substring(R)):0===R?(console.log(j-a),n=t.substring(R,j)):(o=j-a,n=-1==R?t.substring(j):t.substring(j,R+1));return{data:n,line:r,column:o}},u&&(S=Object.create({},{name:wc((function(){return x})),originalName:wc((function(){return E})),attrs:wc(I),ns:wc((function(){return P}))}));for(;-1!==R;){if(-1===(j=60===t.charCodeAt(R)?R:t.indexOf("<",R)))return T.length?y("unexpected end of file"):0===R?y("missing start tag"):void(R<t.length&&t.substring(R).trim()&&g(gc));if(R!==j)if(T.length){if(e&&(e(t.substring(R,j),fc,p),v))return}else if(t.substring(R,j).trim()&&(g(gc),v))return;if(33!==(_=t.charCodeAt(j+1)))if(63!==_){if(-1==(R=t.indexOf(">",j+1)))return y("unclosed tag");if(C={},47===_){if(A=!1,M=!0,!T.length)return y("missing open tag");if(h=x=T.pop(),b=j+2+h.length,t.substring(j+2,b)!==h)return y("closing tag mismatch");for(;b<R;b++)if(!(32===(_=t.charCodeAt(b))||_>8&&_<14))return y("close tag")}else{if(47===t.charCodeAt(R-1)?(h=x=t.substring(j+1,R-1),A=!0,M=!0):(h=x=t.substring(j+1,R),A=!0,M=!1),!(_>96&&_<123||_>64&&_<91||95===_||58===_))return y("illegal first char nodeName");for(b=1,m=h.length;b<m;b++)if(!((_=h.charCodeAt(b))>96&&_<123||_>64&&_<91||_>47&&_<59||45===_||95===_||46==_)){if(32===_||_<14&&_>8){x=h.substring(0,b),C=null;break}return y("invalid nodeName")}M||T.push(x)}if(f){if(o=P,A&&(M||k.push(o),null===C&&(d=-1!==h.indexOf("xmlns",b))&&(N=b,D=h,I(),d=!1)),E=x,-1!==(_=x.indexOf(":"))){if(!(w=P[x.substring(0,_)]))return y("missing namespace on <"+E+">");x=x.substr(_+1)}else w=P.xmlns;w&&(x=w+":"+x)}if(A&&(N=b,D=h,n&&(u?n(S,fc,M,p):n(x,I,fc,M,p),v)))return;if(M){if(i&&(i(u?S:x,fc,A,p),v))return;f&&(P=A?o:k.pop())}R+=1}else{if(-1===(R=t.indexOf("?>",j)))return y("unclosed question");if(s&&(s(t.substring(j,R+2),p),v))return;R+=2}else{if(91===(_=t.charCodeAt(j+2))&&"CDATA["===t.substr(j+3,6)){if(-1===(R=t.indexOf("]]>",j)))return y("unclosed cdata");if(r&&(r(t.substring(j+9,R),p),v))return;R+=3;continue}if(45===_&&45===t.charCodeAt(j+3)){if(-1===(R=t.indexOf("--\x3e",j)))return y("unclosed comment");if(a&&(a(t.substring(j+4,R),fc,p),v))return;R+=3;continue}if(-1===(R=t.indexOf(">",j+1)))return y("unclosed tag");if(c&&(c(t.substring(j,R+1),fc,p),v))return;R+=1}}}(t),p=Sc,v=!1,m},this.stop=function(){v=!0}}function Pc(t){return t.xml&&"lowerCase"===t.xml.tagAlias}var Tc={xsi:"http://www.w3.org/2001/XMLSchema-instance"},Oc="xsi:type";function Ac(t){return t.xml&&t.xml.serialize}function Mc(t){return Ac(t)===Oc}function jc(t,e){return Pc(e)?t.prefix+":"+((n=t.localName).charAt(0).toUpperCase()+n.slice(1)):t.name;var n}function Rc(t){return new Error(t)}function Dc(t){return t.$descriptor}function Nc(t){ko(this,t),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(t){this.references.push(t)},this.addElement=function(t){if(!t)throw Rc("expected element");var e,n=this.elementsById,i=Dc(t).idProperty;if(i&&(e=t.get(i.name))){if(!/^([a-z][\w-.]*:)?[a-z_][\w-.]*$/i.test(e))throw new Error("illegal ID <"+e+">");if(n[e])throw Rc("duplicate ID <"+e+">");n[e]=t}},this.addWarning=function(t){this.warnings.push(t)}}function Ic(){}function Lc(){}function Bc(){}function Fc(t,e){this.property=t,this.context=e}function zc(t,e){this.element=e,this.propertyDesc=t}function Gc(){}function Vc(t,e,n){this.model=t,this.type=t.getType(e),this.context=n}function Hc(t,e,n){Vc.call(this,t,e,n)}function Uc(t,e,n){this.model=t,this.context=n}function Wc(t){t instanceof cc&&(t={model:t}),ko(this,{lax:!1},t)}Ic.prototype.handleEnd=function(){},Ic.prototype.handleText=function(){},Ic.prototype.handleNode=function(){},Lc.prototype=Object.create(Ic.prototype),Lc.prototype.handleNode=function(){return this},Bc.prototype=Object.create(Ic.prototype),Bc.prototype.handleText=function(t){this.body=(this.body||"")+t},Fc.prototype=Object.create(Bc.prototype),Fc.prototype.handleNode=function(t){if(this.element)throw Rc("expected no sub nodes");return this.element=this.createReference(t),this},Fc.prototype.handleEnd=function(){this.element.id=this.body},Fc.prototype.createReference=function(t){return{property:this.property.ns.name,id:""}},zc.prototype=Object.create(Bc.prototype),zc.prototype.handleEnd=function(){var t=this.body||"",e=this.element,n=this.propertyDesc;t=Qs(n.type,t),n.isMany?e.get(n.name).push(t):e.set(n.name,t)},Gc.prototype=Object.create(Bc.prototype),Gc.prototype.handleNode=function(t){var e=this,n=this.element;return n?e=this.handleChild(t):(n=this.element=this.createElement(t),this.context.addElement(n)),e},Vc.prototype=Object.create(Gc.prototype),Vc.prototype.addReference=function(t){this.context.addReference(t)},Vc.prototype.handleText=function(t){if(!Dc(this.element).bodyProperty)throw Rc("unexpected body text <"+t+">");Bc.prototype.handleText.call(this,t)},Vc.prototype.handleEnd=function(){var t=this.body,e=this.element,n=Dc(e).bodyProperty;n&&void 0!==t&&(t=Qs(n.type,t),e.set(n.name,t))},Vc.prototype.createElement=function(t){var e,n=t.attributes,i=this.type,r=Dc(i),o=this.context,a=new i({}),s=this.model;return oo(n,(function(t,n){var i=r.propertiesByName[n];i&&i.isReference?i.isMany?oo(t.split(" "),(function(t){o.addReference({element:a,property:i.ns.name,id:t})})):o.addReference({element:a,property:i.ns.name,id:t}):(i?t=Qs(i.type,t):"xmlns"!==n&&(e=nc(n,r.ns.prefix),s.getPackage(e.prefix)&&o.addWarning({message:"unknown attribute <"+n+">",element:a,property:n,value:t})),a.set(n,t))})),a},Vc.prototype.getPropertyForNode=function(t){var e,n,i=nc(t.name),r=this.type,o=this.model,a=Dc(r),s=i.name,c=a.propertiesByName[s];if(c)return Mc(c)&&(e=t.attributes[Oc])?(e=function(t,e){var n=nc(t);return function(t,e){var n=t.name,i=t.localName,r=e.xml&&e.xml.typePrefix;return r&&0===i.indexOf(r)?t.prefix+":"+i.slice(r.length):n}(n,e.getPackage(n.prefix))}(e,o),ko({},c,{effectiveType:Dc(n=o.getType(e)).name})):c;var l=o.getPackage(i.prefix);if(l){if(e=jc(i,l),n=o.getType(e),c=io(a.properties,(function(t){return!t.isVirtual&&!t.isReference&&!t.isAttribute&&n.hasType(t.type)})))return ko({},c,{effectiveType:Dc(n).name})}else if(c=io(a.properties,(function(t){return!t.isReference&&!t.isAttribute&&"Element"===t.type})))return c;throw Rc("unrecognized element <"+i.name+">")},Vc.prototype.toString=function(){return"ElementDescriptor["+Dc(this.type).name+"]"},Vc.prototype.valueHandler=function(t,e){return new zc(t,e)},Vc.prototype.referenceHandler=function(t){return new Fc(t,this.context)},Vc.prototype.handler=function(t){return"Element"===t?new Uc(this.model,t,this.context):new Vc(this.model,t,this.context)},Vc.prototype.handleChild=function(t){var e,n,i,r;if(e=this.getPropertyForNode(t),i=this.element,ec(n=e.effectiveType||e.type))return this.valueHandler(e,i);var o=(r=e.isReference?this.referenceHandler(e).handleNode(t):this.handler(n).handleNode(t)).element;return void 0!==o&&(e.isMany?i.get(e.name).push(o):i.set(e.name,o),e.isReference?(ko(o,{element:i}),this.context.addReference(o)):o.$parent=i),r},Hc.prototype=Object.create(Vc.prototype),Hc.prototype.createElement=function(t){var e=t.name,n=nc(e),i=this.model,r=this.type,o=i.getPackage(n.prefix),a=o&&jc(n,o)||e;if(!r.hasType(a))throw Rc("unexpected element <"+t.originalName+">");return Vc.prototype.createElement.call(this,t)},Uc.prototype=Object.create(Gc.prototype),Uc.prototype.createElement=function(t){var e=t.name,n=nc(e).prefix,i=t.ns[n+"$uri"],r=t.attributes;return this.model.createAny(e,i,r)},Uc.prototype.handleChild=function(t){var e=new Uc(this.model,"Element",this.context).handleNode(t),n=this.element,i=e.element;return void 0!==i&&((n.$children=n.$children||[]).push(i),i.$parent=n),e},Uc.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)},Wc.prototype.fromXML=function(t,e,n){var i=e.rootHandler;e instanceof Vc?(i=e,e={}):"string"==typeof e?(i=this.handler(e),e={}):"string"==typeof i&&(i=this.handler(i));var r=this.model,o=this.lax,a=new Nc(ko({},e,{rootHandler:i})),s=new kc({proxy:!0}),c=function(){var t=[];return Object.defineProperty(t,"peek",{value:function(){return this[this.length-1]}}),t}();function l(t,e,n){var i=e(),r=i.line,o=i.column,s=i.data;"<"===s.charAt(0)&&-1!==s.indexOf(" ")&&(s=s.slice(0,s.indexOf(" "))+">");var c="unparsable content "+(s?s+" ":"")+"detected\n\tline: "+r+"\n\tcolumn: "+o+"\n\tnested error: "+t.message;if(n)return a.addWarning({message:c,error:t}),!0;throw Rc(c)}function u(t,e){return l(t,e,!0)}i.context=a,c.push(i);var h=/^<\?xml /i,p=/ encoding="([^"]+)"/i,d=/^utf-8$/i;function f(t,e){try{c.peek().handleText(t)}catch(t){u(t,e)}}var m=r.getPackages().reduce((function(t,e){return t[e.uri]=e.prefix,t}),{});s.ns(m).on("openTag",(function(t,e,n,i){var r=t.attrs||{},a=Object.keys(r).reduce((function(t,n){var i=e(r[n]);return t[n]=i,t}),{});!function(t,e){var n=c.peek();try{c.push(n.handleNode(t))}catch(t){l(t,e,o)&&c.push(new Lc)}}({name:t.name,originalName:t.originalName,attributes:a,ns:t.ns},i)})).on("question",(function(t){if(h.test(t)){var e=p.exec(t),n=e&&e[1];n&&!d.test(n)&&a.addWarning({message:"unsupported document encoding <"+n+">, falling back to UTF-8"})}})).on("closeTag",(function(){c.pop().handleEnd()})).on("cdata",f).on("text",(function(t,e,n){!function(t,e){(t=t.trim())&&f(t,e)}(e(t),n)})).on("error",l).on("warn",u),setTimeout((function(){var e;try{s.parse(t),function(){var t,e,n=a.elementsById,i=a.references;for(t=0;e=i[t];t++){var r=e.element,o=n[e.id],s=Dc(r).propertiesByName[e.property];if(o||a.addWarning({message:"unresolved reference <"+e.id+">",element:e.element,property:e.property,value:e.id}),s.isMany){var c=r.get(s.name),l=c.indexOf(e);-1===l&&(l=c.length),o?c[l]=o:c.splice(l,1)}else r.set(s.name,o)}}()}catch(t){e=t}var r=i.element;e||r||(e=Rc("failed to parse document as <"+i.type.$descriptor.name+">")),n(e,e?void 0:r,a)}),0)},Wc.prototype.handler=function(t){return new Hc(this.model,t)};var $c='<?xml version="1.0" encoding="UTF-8"?>\n',qc=/<|>|'|"|&|\n\r|\n/g,Kc=/<|>|&/g;function Yc(t){var e={},n={},i={},r=[],o=[];this.byUri=function(e){return n[e]||t&&t.byUri(e)},this.add=function(t,e){n[t.uri]=t,e?r.push(t):o.push(t),this.mapPrefix(t.prefix,t.uri)},this.uriByPrefix=function(t){return e[t||"xmlns"]},this.mapPrefix=function(t,n){e[t||"xmlns"]=n},this.logUsed=function(t){var e=t.uri;i[e]=this.byUri(e)},this.getUsed=function(t){return[].concat(r,o).filter((function(t){return i[t.uri]}))}}function Xc(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}function Zc(t){return eo(t)?t:(t.prefix?t.prefix+":":"")+t.localName}var Jc={"\n":"#10","\n\r":"#10",'"':"#34","'":"#39","<":"#60",">":"#62","&":"#38"},Qc={"<":"lt",">":"gt","&":"amp"};function tl(t,e,n){return(t=eo(t)?t:""+t).replace(e,(function(t){return"&"+n[t]+";"}))}function el(t){this.tagName=t}function nl(){}function il(t){this.tagName=t}function rl(t,e){this.body=[],this.attrs=[],this.parent=t,this.propertyDescriptor=e}function ol(t,e){rl.call(this,t,e)}function al(){this.value="",this.write=function(t){this.value+=t}}function sl(t,e){var n=[""];this.append=function(e){return t.write(e),this},this.appendNewLine=function(){return e&&t.write("\n"),this},this.appendIndent=function(){return e&&t.write(n.join("  ")),this},this.indent=function(){return n.push(""),this},this.unindent=function(){return n.pop(),this}}function cl(t){return t=ko({format:!1,preamble:!0},t||{}),{toXML:function(e,n){var i=n||new al,r=new sl(i,t.format);if(t.preamble&&r.append($c),(new rl).build(e).serializeTo(r),!n)return i.value}}}function ll(t,e){cc.call(this,t,e)}el.prototype.build=function(t){return this.element=t,this},el.prototype.serializeTo=function(t){t.appendIndent().append("<"+this.tagName+">"+this.element.id+"</"+this.tagName+">").appendNewLine()},nl.prototype.serializeValue=nl.prototype.serializeTo=function(t){t.append(this.escape?tl(this.value,Kc,Qc):this.value)},nl.prototype.build=function(t,e){return this.value=e,"String"===t.type&&-1!==e.search(Kc)&&(this.escape=!0),this},Xc(il,nl),il.prototype.serializeTo=function(t){t.appendIndent().append("<"+this.tagName+">"),this.serializeValue(t),t.append("</"+this.tagName+">").appendNewLine()},rl.prototype.build=function(t){this.element=t;var e,n,i=t.$descriptor,r=this.propertyDescriptor,o=i.isGeneric;return e=o?this.parseGeneric(t):this.parseNsAttributes(t),this.ns=r?this.nsPropertyTagName(r):this.nsTagName(i),this.tagName=this.addTagName(this.ns),o||(n=function(t){return ro(t.$descriptor.properties,(function(e){var n=e.name;if(e.isVirtual)return!1;if(!t.hasOwnProperty(n))return!1;var i=t[n];return i!==e.default&&(null!==i&&(!e.isMany||i.length))}))}(t),this.parseAttributes(ro(n,(function(t){return t.isAttr}))),this.parseContainments(function(t){return ro(t,(function(t){return!t.isAttr}))}(n))),this.parseGenericAttributes(t,e),this},rl.prototype.nsTagName=function(t){return function(t,e){return e.isGeneric?ko({localName:e.ns.localName},t):ko({localName:(n=e.ns.localName,i=e.$pkg,Pc(i)?(r=n).charAt(0).toLowerCase()+r.slice(1):n)},t);var n,i,r}(this.logNamespaceUsed(t.ns),t)},rl.prototype.nsPropertyTagName=function(t){return function(t,e){return ko({localName:e.ns.localName},t)}(this.logNamespaceUsed(t.ns),t)},rl.prototype.isLocalNs=function(t){return t.uri===this.ns.uri},rl.prototype.nsAttributeName=function(t){var e;if(e=eo(t)?nc(t):t.ns,t.inherited)return{localName:e.localName};var n=this.logNamespaceUsed(e);return this.getNamespaces().logUsed(n),this.isLocalNs(n)?{localName:e.localName}:ko({localName:e.localName},n)},rl.prototype.parseGeneric=function(t){var e=this,n=this.body,i=[];return oo(t,(function(r,o){"$body"===o?n.push((new nl).build({type:"String"},r)):"$children"===o?oo(r,(function(t){n.push(new rl(e).build(t))})):0!==o.indexOf("$")&&e.parseNsAttribute(t,o,r)&&i.push({name:o,value:r})})),i},rl.prototype.parseNsAttribute=function(t,e,n){var i,r=t.$model,o=nc(e);if("xmlns"===o.prefix&&(i={prefix:o.localName,uri:n}),o.prefix||"xmlns"!==o.localName||(i={uri:n}),!i)return{name:e,value:n};if(r&&r.getPackage(n))this.logNamespace(i,!0,!0);else{var a=this.logNamespaceUsed(i,!0);this.getNamespaces().logUsed(a)}},rl.prototype.parseNsAttributes=function(t,e){var n=this,i=t.$attrs,r=[];return oo(i,(function(e,i){var o=n.parseNsAttribute(t,i,e);o&&r.push(o)})),r},rl.prototype.parseGenericAttributes=function(t,e){var n=this;oo(e,(function(e){if(e.name!==Oc)try{n.addAttribute(n.nsAttributeName(e.name),e.value)}catch(n){console.warn("missing namespace information for ",e.name,"=",e.value,"on",t,n)}}))},rl.prototype.parseContainments=function(t){var e=this,n=this.body,i=this.element;oo(t,(function(t){var r=i.get(t.name),o=t.isReference;if(t.isMany||(r=[r]),t.isBody)n.push((new nl).build(t,r[0]));else if(ec(t.type))oo(r,(function(i){n.push(new il(e.addTagName(e.nsPropertyTagName(t))).build(t,i))}));else if(o)oo(r,(function(i){n.push(new el(e.addTagName(e.nsPropertyTagName(t))).build(i))}));else{var a=Mc(t),s=function(t){return"property"===Ac(t)}(t);oo(r,(function(i){var r;r=a?new ol(e,t):s?new rl(e,t):new rl(e),n.push(r.build(i))}))}}))},rl.prototype.getNamespaces=function(t){var e,n=this.namespaces,i=this.parent;return n||(e=i&&i.getNamespaces(),t||!e?this.namespaces=n=new Yc(e):n=e),n},rl.prototype.logNamespace=function(t,e,n){var i=this.getNamespaces(n),r=t.uri,o=t.prefix;return i.byUri(r)||i.add(t,e),i.mapPrefix(o,r),t},rl.prototype.logNamespaceUsed=function(t,e){var n,i,r,o=this.element.$model,a=this.getNamespaces(e),s=t.prefix,c=t.uri;if(!s&&!c)return{localName:t.localName};if(r=Tc[s]||o&&(o.getPackage(s)||{}).uri,!(c=c||r||a.uriByPrefix(s)))throw new Error("no namespace uri given for prefix <"+s+">");if(!(t=a.byUri(c))){for(n=s,i=1;a.uriByPrefix(n);)n=s+"_"+i++;t=this.logNamespace({prefix:n,uri:c},r===c)}return s&&a.mapPrefix(s,c),t},rl.prototype.parseAttributes=function(t){var e=this,n=this.element;oo(t,(function(t){var i=n.get(t.name);if(t.isReference)if(t.isMany){var r=[];oo(i,(function(t){r.push(t.id)})),i=r.join(" ")}else i=i.id;e.addAttribute(e.nsAttributeName(t),i)}))},rl.prototype.addTagName=function(t){var e=this.logNamespaceUsed(t);return this.getNamespaces().logUsed(e),Zc(t)},rl.prototype.addAttribute=function(t,e){var n=this.attrs;eo(e)&&(e=tl(e,qc,Jc)),n.push({name:t,value:e})},rl.prototype.serializeAttributes=function(t){var e=this.attrs,n=this.namespaces;n&&(e=function(t){return uo(t.getUsed(),(function(t){return{name:"xmlns"+(t.prefix?":"+t.prefix:""),value:t.uri}}))}(n).concat(e)),oo(e,(function(e){t.append(" ").append(Zc(e.name)).append('="').append(e.value).append('"')}))},rl.prototype.serializeTo=function(t){var e=this.body[0],n=e&&e.constructor!==nl;t.appendIndent().append("<"+this.tagName),this.serializeAttributes(t),t.append(e?">":" />"),e&&(n&&t.appendNewLine().indent(),oo(this.body,(function(e){e.serializeTo(t)})),n&&t.unindent().appendIndent(),t.append("</"+this.tagName+">")),t.appendNewLine()},Xc(ol,rl),ol.prototype.parseNsAttributes=function(t){var e=rl.prototype.parseNsAttributes.call(this,t),n=t.$descriptor;if(n.name===this.propertyDescriptor.type)return e;var i=this.typeNs=this.nsTagName(n);this.getNamespaces().logUsed(this.typeNs);var r=t.$model.getPackage(i.uri),o=r.xml&&r.xml.typePrefix||"";return this.addAttribute(this.nsAttributeName(Oc),(i.prefix?i.prefix+":":"")+o+n.ns.localName),e},ol.prototype.isLocalNs=function(t){return t.uri===(this.typeNs||this.ns).uri},ll.prototype=Object.create(cc.prototype),ll.prototype.fromXML=function(t,e,n,i){eo(e)||(i=n,n=e,e="bpmn:Definitions"),to(n)&&(i=n,n={});var r=new Wc(ko({model:this,lax:!0},n)),o=r.handler(e);r.fromXML(t,o,i)},ll.prototype.toXML=function(t,e,n){to(e)&&(n=e,e={});var i,r,o=new cl(e);try{i=o.toXML(t)}catch(t){r=t}return n(r,i)};var ul={bpmn:{name:"BPMN20",uri:"http://www.omg.org/spec/BPMN/20100524/MODEL",associations:[],types:[{name:"Interface",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"operations",type:"Operation",isMany:!0},{name:"implementationRef",type:"String",isAttr:!0}]},{name:"Operation",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"inMessageRef",type:"Message",isReference:!0},{name:"outMessageRef",type:"Message",isReference:!0},{name:"errorRef",type:"Error",isMany:!0,isReference:!0},{name:"implementationRef",type:"String",isAttr:!0}]},{name:"EndPoint",superClass:["RootElement"]},{name:"Auditing",superClass:["BaseElement"]},{name:"GlobalTask",superClass:["CallableElement"],properties:[{name:"resources",type:"ResourceRole",isMany:!0}]},{name:"Monitoring",superClass:["BaseElement"]},{name:"Performer",superClass:["ResourceRole"]},{name:"Process",superClass:["FlowElementsContainer","CallableElement"],properties:[{name:"processType",type:"ProcessType",isAttr:!0},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"properties",type:"Property",isMany:!0},{name:"laneSets",type:"LaneSet",isMany:!0,replaces:"FlowElementsContainer#laneSets"},{name:"flowElements",type:"FlowElement",isMany:!0,replaces:"FlowElementsContainer#flowElements"},{name:"artifacts",type:"Artifact",isMany:!0},{name:"resources",type:"ResourceRole",isMany:!0},{name:"correlationSubscriptions",type:"CorrelationSubscription",isMany:!0},{name:"supports",type:"Process",isMany:!0,isReference:!0},{name:"definitionalCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"isExecutable",isAttr:!0,type:"Boolean"}]},{name:"LaneSet",superClass:["BaseElement"],properties:[{name:"lanes",type:"Lane",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Lane",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"partitionElementRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"partitionElement",type:"BaseElement"},{name:"flowNodeRef",type:"FlowNode",isMany:!0,isReference:!0},{name:"childLaneSet",type:"LaneSet",xml:{serialize:"xsi:type"}}]},{name:"GlobalManualTask",superClass:["GlobalTask"]},{name:"ManualTask",superClass:["Task"]},{name:"UserTask",superClass:["Task"],properties:[{name:"renderings",type:"Rendering",isMany:!0},{name:"implementation",isAttr:!0,type:"String"}]},{name:"Rendering",superClass:["BaseElement"]},{name:"HumanPerformer",superClass:["Performer"]},{name:"PotentialOwner",superClass:["HumanPerformer"]},{name:"GlobalUserTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"renderings",type:"Rendering",isMany:!0}]},{name:"Gateway",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"gatewayDirection",type:"GatewayDirection",default:"Unspecified",isAttr:!0}]},{name:"EventBasedGateway",superClass:["Gateway"],properties:[{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"eventGatewayType",type:"EventBasedGatewayType",isAttr:!0,default:"Exclusive"}]},{name:"ComplexGateway",superClass:["Gateway"],properties:[{name:"activationCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ExclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"InclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ParallelGateway",superClass:["Gateway"]},{name:"RootElement",isAbstract:!0,superClass:["BaseElement"]},{name:"Relationship",superClass:["BaseElement"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"direction",type:"RelationshipDirection",isAttr:!0},{name:"source",isMany:!0,isReference:!0,type:"Element"},{name:"target",isMany:!0,isReference:!0,type:"Element"}]},{name:"BaseElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,type:"String",isId:!0},{name:"documentation",type:"Documentation",isMany:!0},{name:"extensionDefinitions",type:"ExtensionDefinition",isMany:!0,isReference:!0},{name:"extensionElements",type:"ExtensionElements"}]},{name:"Extension",properties:[{name:"mustUnderstand",default:!1,isAttr:!0,type:"Boolean"},{name:"definition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"extensionAttributeDefinitions",type:"ExtensionAttributeDefinition",isMany:!0}]},{name:"ExtensionAttributeDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",isAttr:!0,type:"String"},{name:"isReference",default:!1,isAttr:!0,type:"Boolean"},{name:"extensionDefinition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionElements",properties:[{name:"valueRef",isAttr:!0,isReference:!0,type:"Element"},{name:"values",type:"Element",isMany:!0},{name:"extensionAttributeDefinition",type:"ExtensionAttributeDefinition",isAttr:!0,isReference:!0}]},{name:"Documentation",superClass:["BaseElement"],properties:[{name:"text",type:"String",isBody:!0},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Event",isAbstract:!0,superClass:["FlowNode","InteractionNode"],properties:[{name:"properties",type:"Property",isMany:!0}]},{name:"IntermediateCatchEvent",superClass:["CatchEvent"]},{name:"IntermediateThrowEvent",superClass:["ThrowEvent"]},{name:"EndEvent",superClass:["ThrowEvent"]},{name:"StartEvent",superClass:["CatchEvent"],properties:[{name:"isInterrupting",default:!0,isAttr:!0,type:"Boolean"}]},{name:"ThrowEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"inputSet",type:"InputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"CatchEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"parallelMultiple",isAttr:!0,type:"Boolean",default:!1},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"outputSet",type:"OutputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"BoundaryEvent",superClass:["CatchEvent"],properties:[{name:"cancelActivity",default:!0,isAttr:!0,type:"Boolean"},{name:"attachedToRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"EventDefinition",isAbstract:!0,superClass:["RootElement"]},{name:"CancelEventDefinition",superClass:["EventDefinition"]},{name:"ErrorEventDefinition",superClass:["EventDefinition"],properties:[{name:"errorRef",type:"Error",isAttr:!0,isReference:!0}]},{name:"TerminateEventDefinition",superClass:["EventDefinition"]},{name:"EscalationEventDefinition",superClass:["EventDefinition"],properties:[{name:"escalationRef",type:"Escalation",isAttr:!0,isReference:!0}]},{name:"Escalation",properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"escalationCode",isAttr:!0,type:"String"}],superClass:["RootElement"]},{name:"CompensateEventDefinition",superClass:["EventDefinition"],properties:[{name:"waitForCompletion",isAttr:!0,type:"Boolean",default:!0},{name:"activityRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"TimerEventDefinition",superClass:["EventDefinition"],properties:[{name:"timeDate",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeCycle",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeDuration",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"LinkEventDefinition",superClass:["EventDefinition"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"target",type:"LinkEventDefinition",isAttr:!0,isReference:!0},{name:"source",type:"LinkEventDefinition",isMany:!0,isReference:!0}]},{name:"MessageEventDefinition",superClass:["EventDefinition"],properties:[{name:"messageRef",type:"Message",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"ConditionalEventDefinition",superClass:["EventDefinition"],properties:[{name:"condition",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"SignalEventDefinition",superClass:["EventDefinition"],properties:[{name:"signalRef",type:"Signal",isAttr:!0,isReference:!0}]},{name:"Signal",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ImplicitThrowEvent",superClass:["ThrowEvent"]},{name:"DataState",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"ItemAwareElement",superClass:["BaseElement"],properties:[{name:"itemSubjectRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"dataState",type:"DataState"}]},{name:"DataAssociation",superClass:["BaseElement"],properties:[{name:"assignment",type:"Assignment",isMany:!0},{name:"sourceRef",type:"ItemAwareElement",isMany:!0,isReference:!0},{name:"targetRef",type:"ItemAwareElement",isReference:!0},{name:"transformation",type:"FormalExpression",xml:{serialize:"property"}}]},{name:"DataInput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"inputSetRef",type:"InputSet",isVirtual:!0,isMany:!0,isReference:!0},{name:"inputSetWithOptional",type:"InputSet",isVirtual:!0,isMany:!0,isReference:!0},{name:"inputSetWithWhileExecuting",type:"InputSet",isVirtual:!0,isMany:!0,isReference:!0}]},{name:"DataOutput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"outputSetRef",type:"OutputSet",isVirtual:!0,isMany:!0,isReference:!0},{name:"outputSetWithOptional",type:"OutputSet",isVirtual:!0,isMany:!0,isReference:!0},{name:"outputSetWithWhileExecuting",type:"OutputSet",isVirtual:!0,isMany:!0,isReference:!0}]},{name:"InputSet",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"dataInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"optionalInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"whileExecutingInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"outputSetRefs",type:"OutputSet",isMany:!0,isReference:!0}]},{name:"OutputSet",superClass:["BaseElement"],properties:[{name:"dataOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"inputSetRefs",type:"InputSet",isMany:!0,isReference:!0},{name:"optionalOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"whileExecutingOutputRefs",type:"DataOutput",isMany:!0,isReference:!0}]},{name:"Property",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"DataInputAssociation",superClass:["DataAssociation"]},{name:"DataOutputAssociation",superClass:["DataAssociation"]},{name:"InputOutputSpecification",superClass:["BaseElement"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"inputSets",type:"InputSet",isMany:!0},{name:"outputSets",type:"OutputSet",isMany:!0}]},{name:"DataObject",superClass:["FlowElement","ItemAwareElement"],properties:[{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"}]},{name:"InputOutputBinding",properties:[{name:"inputDataRef",type:"InputSet",isAttr:!0,isReference:!0},{name:"outputDataRef",type:"OutputSet",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"Assignment",superClass:["BaseElement"],properties:[{name:"from",type:"Expression",xml:{serialize:"xsi:type"}},{name:"to",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"DataStore",superClass:["RootElement","ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"capacity",isAttr:!0,type:"Integer"},{name:"isUnlimited",default:!0,isAttr:!0,type:"Boolean"}]},{name:"DataStoreReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataStoreRef",type:"DataStore",isAttr:!0,isReference:!0}]},{name:"DataObjectReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataObjectRef",type:"DataObject",isAttr:!0,isReference:!0}]},{name:"ConversationLink",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ConversationAssociation",superClass:["BaseElement"],properties:[{name:"innerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0},{name:"outerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0}]},{name:"CallConversation",superClass:["ConversationNode"],properties:[{name:"calledCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"Conversation",superClass:["ConversationNode"]},{name:"SubConversation",superClass:["ConversationNode"],properties:[{name:"conversationNodes",type:"ConversationNode",isMany:!0}]},{name:"ConversationNode",isAbstract:!0,superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"messageFlowRefs",type:"MessageFlow",isMany:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0}]},{name:"GlobalConversation",superClass:["Collaboration"]},{name:"PartnerEntity",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"PartnerRole",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"CorrelationProperty",superClass:["RootElement"],properties:[{name:"correlationPropertyRetrievalExpression",type:"CorrelationPropertyRetrievalExpression",isMany:!0},{name:"name",isAttr:!0,type:"String"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Error",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"errorCode",isAttr:!0,type:"String"}]},{name:"CorrelationKey",superClass:["BaseElement"],properties:[{name:"correlationPropertyRef",type:"CorrelationProperty",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Expression",superClass:["BaseElement"],isAbstract:!1,properties:[{name:"body",type:"String",isBody:!0}]},{name:"FormalExpression",superClass:["Expression"],properties:[{name:"language",isAttr:!0,type:"String"},{name:"evaluatesToTypeRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Message",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"itemRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"ItemDefinition",superClass:["RootElement"],properties:[{name:"itemKind",type:"ItemKind",isAttr:!0},{name:"structureRef",type:"String",isAttr:!0},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"import",type:"Import",isAttr:!0,isReference:!0}]},{name:"FlowElement",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"categoryValueRef",type:"CategoryValue",isMany:!0,isReference:!0}]},{name:"SequenceFlow",superClass:["FlowElement"],properties:[{name:"isImmediate",isAttr:!0,type:"Boolean"},{name:"conditionExpression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"sourceRef",type:"FlowNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"FlowNode",isAttr:!0,isReference:!0}]},{name:"FlowElementsContainer",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"laneSets",type:"LaneSet",isMany:!0},{name:"flowElements",type:"FlowElement",isMany:!0}]},{name:"CallableElement",isAbstract:!0,superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"supportedInterfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"ioBinding",type:"InputOutputBinding",isMany:!0,xml:{serialize:"property"}}]},{name:"FlowNode",isAbstract:!0,superClass:["FlowElement"],properties:[{name:"incoming",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"outgoing",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"lanes",type:"Lane",isVirtual:!0,isMany:!0,isReference:!0}]},{name:"CorrelationPropertyRetrievalExpression",superClass:["BaseElement"],properties:[{name:"messagePath",type:"FormalExpression"},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"CorrelationPropertyBinding",superClass:["BaseElement"],properties:[{name:"dataPath",type:"FormalExpression"},{name:"correlationPropertyRef",type:"CorrelationProperty",isAttr:!0,isReference:!0}]},{name:"Resource",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"resourceParameters",type:"ResourceParameter",isMany:!0}]},{name:"ResourceParameter",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isRequired",isAttr:!0,type:"Boolean"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"CorrelationSubscription",superClass:["BaseElement"],properties:[{name:"correlationKeyRef",type:"CorrelationKey",isAttr:!0,isReference:!0},{name:"correlationPropertyBinding",type:"CorrelationPropertyBinding",isMany:!0}]},{name:"MessageFlow",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"MessageFlowAssociation",superClass:["BaseElement"],properties:[{name:"innerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0},{name:"outerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0}]},{name:"InteractionNode",isAbstract:!0,properties:[{name:"incomingConversationLinks",type:"ConversationLink",isVirtual:!0,isMany:!0,isReference:!0},{name:"outgoingConversationLinks",type:"ConversationLink",isVirtual:!0,isMany:!0,isReference:!0}]},{name:"Participant",superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"interfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"participantMultiplicity",type:"ParticipantMultiplicity"},{name:"endPointRefs",type:"EndPoint",isMany:!0,isReference:!0},{name:"processRef",type:"Process",isAttr:!0,isReference:!0}]},{name:"ParticipantAssociation",superClass:["BaseElement"],properties:[{name:"innerParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"outerParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"ParticipantMultiplicity",properties:[{name:"minimum",default:0,isAttr:!0,type:"Integer"},{name:"maximum",default:1,isAttr:!0,type:"Integer"}],superClass:["BaseElement"]},{name:"Collaboration",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"participants",type:"Participant",isMany:!0},{name:"messageFlows",type:"MessageFlow",isMany:!0},{name:"artifacts",type:"Artifact",isMany:!0},{name:"conversations",type:"ConversationNode",isMany:!0},{name:"conversationAssociations",type:"ConversationAssociation"},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0},{name:"messageFlowAssociations",type:"MessageFlowAssociation",isMany:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"choreographyRef",type:"Choreography",isMany:!0,isReference:!0},{name:"conversationLinks",type:"ConversationLink",isMany:!0}]},{name:"ChoreographyActivity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"loopType",type:"ChoreographyLoopType",default:"None",isAttr:!0}]},{name:"CallChoreography",superClass:["ChoreographyActivity"],properties:[{name:"calledChoreographyRef",type:"Choreography",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"SubChoreography",superClass:["ChoreographyActivity","FlowElementsContainer"],properties:[{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"ChoreographyTask",superClass:["ChoreographyActivity"],properties:[{name:"messageFlowRef",type:"MessageFlow",isMany:!0,isReference:!0}]},{name:"Choreography",superClass:["Collaboration","FlowElementsContainer"]},{name:"GlobalChoreographyTask",superClass:["Choreography"],properties:[{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String"},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Group",superClass:["Artifact"],properties:[{name:"categoryValueRef",type:"CategoryValue",isAttr:!0,isReference:!0}]},{name:"Association",superClass:["Artifact"],properties:[{name:"associationDirection",type:"AssociationDirection",isAttr:!0},{name:"sourceRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"targetRef",type:"BaseElement",isAttr:!0,isReference:!0}]},{name:"Category",superClass:["RootElement"],properties:[{name:"categoryValue",type:"CategoryValue",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Artifact",isAbstract:!0,superClass:["BaseElement"]},{name:"CategoryValue",superClass:["BaseElement"],properties:[{name:"categorizedFlowElements",type:"FlowElement",isVirtual:!0,isMany:!0,isReference:!0},{name:"value",isAttr:!0,type:"String"}]},{name:"Activity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"isForCompensation",default:!1,isAttr:!0,type:"Boolean"},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"boundaryEventRefs",type:"BoundaryEvent",isMany:!0,isReference:!0},{name:"properties",type:"Property",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"startQuantity",default:1,isAttr:!0,type:"Integer"},{name:"resources",type:"ResourceRole",isMany:!0},{name:"completionQuantity",default:1,isAttr:!0,type:"Integer"},{name:"loopCharacteristics",type:"LoopCharacteristics"}]},{name:"ServiceTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"SubProcess",superClass:["Activity","FlowElementsContainer","InteractionNode"],properties:[{name:"triggeredByEvent",default:!1,isAttr:!0,type:"Boolean"},{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"LoopCharacteristics",isAbstract:!0,superClass:["BaseElement"]},{name:"MultiInstanceLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"isSequential",default:!1,isAttr:!0,type:"Boolean"},{name:"behavior",type:"MultiInstanceBehavior",default:"All",isAttr:!0},{name:"loopCardinality",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopDataInputRef",type:"ItemAwareElement",isReference:!0},{name:"loopDataOutputRef",type:"ItemAwareElement",isReference:!0},{name:"inputDataItem",type:"DataInput",xml:{serialize:"property"}},{name:"outputDataItem",type:"DataOutput",xml:{serialize:"property"}},{name:"complexBehaviorDefinition",type:"ComplexBehaviorDefinition",isMany:!0},{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"oneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0},{name:"noneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0}]},{name:"StandardLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"testBefore",default:!1,isAttr:!0,type:"Boolean"},{name:"loopCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopMaximum",type:"Integer",isAttr:!0}]},{name:"CallActivity",superClass:["Activity"],properties:[{name:"calledElement",type:"String",isAttr:!0}]},{name:"Task",superClass:["Activity","InteractionNode"]},{name:"SendTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ReceiveTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ScriptTask",superClass:["Task"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"script",type:"String"}]},{name:"BusinessRuleTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"AdHocSubProcess",superClass:["SubProcess"],properties:[{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"ordering",type:"AdHocOrdering",isAttr:!0},{name:"cancelRemainingInstances",default:!0,isAttr:!0,type:"Boolean"}]},{name:"Transaction",superClass:["SubProcess"],properties:[{name:"protocol",isAttr:!0,type:"String"},{name:"method",isAttr:!0,type:"String"}]},{name:"GlobalScriptTask",superClass:["GlobalTask"],properties:[{name:"scriptLanguage",isAttr:!0,type:"String"},{name:"script",isAttr:!0,type:"String"}]},{name:"GlobalBusinessRuleTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"ComplexBehaviorDefinition",superClass:["BaseElement"],properties:[{name:"condition",type:"FormalExpression"},{name:"event",type:"ImplicitThrowEvent"}]},{name:"ResourceRole",superClass:["BaseElement"],properties:[{name:"resourceRef",type:"Resource",isReference:!0},{name:"resourceParameterBindings",type:"ResourceParameterBinding",isMany:!0},{name:"resourceAssignmentExpression",type:"ResourceAssignmentExpression"},{name:"name",isAttr:!0,type:"String"}]},{name:"ResourceParameterBinding",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"parameterRef",type:"ResourceParameter",isAttr:!0,isReference:!0}],superClass:["BaseElement"]},{name:"ResourceAssignmentExpression",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}}],superClass:["BaseElement"]},{name:"Import",properties:[{name:"importType",isAttr:!0,type:"String"},{name:"location",isAttr:!0,type:"String"},{name:"namespace",isAttr:!0,type:"String"}]},{name:"Definitions",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"targetNamespace",isAttr:!0,type:"String"},{name:"expressionLanguage",default:"http://www.w3.org/1999/XPath",isAttr:!0,type:"String"},{name:"typeLanguage",default:"http://www.w3.org/2001/XMLSchema",isAttr:!0,type:"String"},{name:"imports",type:"Import",isMany:!0},{name:"extensions",type:"Extension",isMany:!0},{name:"rootElements",type:"RootElement",isMany:!0},{name:"diagrams",isMany:!0,type:"bpmndi:BPMNDiagram"},{name:"exporter",isAttr:!0,type:"String"},{name:"relationships",type:"Relationship",isMany:!0},{name:"exporterVersion",isAttr:!0,type:"String"}]}],enumerations:[{name:"ProcessType",literalValues:[{name:"None"},{name:"Public"},{name:"Private"}]},{name:"GatewayDirection",literalValues:[{name:"Unspecified"},{name:"Converging"},{name:"Diverging"},{name:"Mixed"}]},{name:"EventBasedGatewayType",literalValues:[{name:"Parallel"},{name:"Exclusive"}]},{name:"RelationshipDirection",literalValues:[{name:"None"},{name:"Forward"},{name:"Backward"},{name:"Both"}]},{name:"ItemKind",literalValues:[{name:"Physical"},{name:"Information"}]},{name:"ChoreographyLoopType",literalValues:[{name:"None"},{name:"Standard"},{name:"MultiInstanceSequential"},{name:"MultiInstanceParallel"}]},{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"MultiInstanceBehavior",literalValues:[{name:"None"},{name:"One"},{name:"All"},{name:"Complex"}]},{name:"AdHocOrdering",literalValues:[{name:"Parallel"},{name:"Sequential"}]}],prefix:"bpmn",xml:{tagAlias:"lowerCase",typePrefix:"t"}},bpmndi:{name:"BPMNDI",uri:"http://www.omg.org/spec/BPMN/20100524/DI",types:[{name:"BPMNDiagram",properties:[{name:"plane",type:"BPMNPlane",redefines:"di:Diagram#rootElement"},{name:"labelStyle",type:"BPMNLabelStyle",isMany:!0}],superClass:["di:Diagram"]},{name:"BPMNPlane",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"}],superClass:["di:Plane"]},{name:"BPMNShape",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"isHorizontal",isAttr:!0,type:"Boolean"},{name:"isExpanded",isAttr:!0,type:"Boolean"},{name:"isMarkerVisible",isAttr:!0,type:"Boolean"},{name:"label",type:"BPMNLabel"},{name:"isMessageVisible",isAttr:!0,type:"Boolean"},{name:"participantBandKind",type:"ParticipantBandKind",isAttr:!0},{name:"choreographyActivityShape",type:"BPMNShape",isAttr:!0,isReference:!0}],superClass:["di:LabeledShape"]},{name:"BPMNEdge",properties:[{name:"label",type:"BPMNLabel"},{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"sourceElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#source"},{name:"targetElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#target"},{name:"messageVisibleKind",type:"MessageVisibleKind",isAttr:!0,default:"initiating"}],superClass:["di:LabeledEdge"]},{name:"BPMNLabel",properties:[{name:"labelStyle",type:"BPMNLabelStyle",isAttr:!0,isReference:!0,redefines:"di:DiagramElement#style"}],superClass:["di:Label"]},{name:"BPMNLabelStyle",properties:[{name:"font",type:"dc:Font"}],superClass:["di:Style"]}],enumerations:[{name:"ParticipantBandKind",literalValues:[{name:"top_initiating"},{name:"middle_initiating"},{name:"bottom_initiating"},{name:"top_non_initiating"},{name:"middle_non_initiating"},{name:"bottom_non_initiating"}]},{name:"MessageVisibleKind",literalValues:[{name:"initiating"},{name:"non_initiating"}]}],associations:[],prefix:"bpmndi"},dc:{name:"DC",uri:"http://www.omg.org/spec/DD/20100524/DC",types:[{name:"Boolean"},{name:"Integer"},{name:"Real"},{name:"String"},{name:"Font",properties:[{name:"name",type:"String",isAttr:!0},{name:"size",type:"Real",isAttr:!0},{name:"isBold",type:"Boolean",isAttr:!0},{name:"isItalic",type:"Boolean",isAttr:!0},{name:"isUnderline",type:"Boolean",isAttr:!0},{name:"isStrikeThrough",type:"Boolean",isAttr:!0}]},{name:"Point",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0}]},{name:"Bounds",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0},{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]}],prefix:"dc",associations:[]},di:{name:"DI",uri:"http://www.omg.org/spec/DD/20100524/DI",types:[{name:"DiagramElement",isAbstract:!0,properties:[{name:"id",type:"String",isAttr:!0,isId:!0},{name:"extension",type:"Extension"},{name:"owningDiagram",type:"Diagram",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"owningElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"modelElement",isReadOnly:!0,isVirtual:!0,isReference:!0,type:"Element"},{name:"style",type:"Style",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"ownedElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isMany:!0}]},{name:"Node",isAbstract:!0,superClass:["DiagramElement"]},{name:"Edge",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"source",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"target",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"waypoint",isUnique:!1,isMany:!0,type:"dc:Point",xml:{serialize:"xsi:type"}}]},{name:"Diagram",isAbstract:!0,properties:[{name:"id",type:"String",isAttr:!0,isId:!0},{name:"rootElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0},{name:"name",isAttr:!0,type:"String"},{name:"documentation",isAttr:!0,type:"String"},{name:"resolution",isAttr:!0,type:"Real"},{name:"ownedStyle",type:"Style",isReadOnly:!0,isVirtual:!0,isMany:!0}]},{name:"Shape",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Plane",isAbstract:!0,superClass:["Node"],properties:[{name:"planeElement",type:"DiagramElement",subsettedProperty:"DiagramElement-ownedElement",isMany:!0}]},{name:"LabeledEdge",isAbstract:!0,superClass:["Edge"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isVirtual:!0,isMany:!0}]},{name:"LabeledShape",isAbstract:!0,superClass:["Shape"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isVirtual:!0,isMany:!0}]},{name:"Label",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Style",isAbstract:!0,properties:[{name:"id",type:"String",isAttr:!0,isId:!0}]},{name:"Extension",properties:[{name:"values",type:"Element",isMany:!0}]}],associations:[],prefix:"di",xml:{tagAlias:"lowerCase"}},bioc:{name:"bpmn.io colors for BPMN",uri:"http://bpmn.io/schema/bpmn/biocolor/1.0",prefix:"bioc",types:[{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]}],enumerations:[],associations:[]}};var hl=function(t,e){return new ll(ko({},ul,t),e)};function pl(t){return t?"<"+t.$type+(t.id?' id="'+t.id:"")+'" />':"<null>"}var dl=new Ss.a({name:"bpmnElement",enumerable:!0},{name:"di",configurable:!0});function fl(t,e){return t.$instanceOf(e)}function ml(t,e){var n={},i=[];function r(t,e){return function(n){t(n,e)}}function o(t){n[t.id]=t}function a(n,i){try{var r=n.di&&function(n,i){if(n.gfx)throw new Error(e("already rendered {element}",{element:pl(n)}));return t.element(n,i)}(n,i);return o(n),r}catch(t){s(t.message,{element:n,error:t}),console.error(e("failed to import {element}",{element:pl(n)})),console.error(t)}}function s(e,n){t.error(e,n)}function c(t){var n=t.bpmnElement;n?n.di?s(e("multiple DI elements defined for {element}",{element:pl(n)}),{element:n}):(dl.bind(n,"di"),n.di=t):s(e("no bpmnElement referenced in {element}",{element:pl(t)}),{element:t})}function l(t){var e;c(e=t.plane),oo(e.planeElement,u)}function u(t){c(t)}function h(){for(;i.length;)i.shift()()}function p(t,e){C(t,e),b(t.ioSpecification,e),g(t.artifacts,e),o(t)}function d(t,e){a(t,e)}function f(t,e){a(t,e)}function m(t,e){a(t,e)}function v(t,e){a(t,e)}function y(t,e){a(t,e)}function g(t,e){oo(t,(function(t){fl(t,"bpmn:Association")?i.push((function(){y(t,e)})):y(t,e)}))}function b(t,e){t&&(oo(t.dataInputs,r(m,e)),oo(t.dataOutputs,r(v,e)))}function _(t,e){C(t,e),g(t.artifacts,e)}function w(t,e){var n=a(t,e);fl(t,"bpmn:SubProcess")&&_(t,n||e),fl(t,"bpmn:Activity")&&b(t.ioSpecification,e),i.push((function(){oo(t.dataInputAssociations,r(f,e)),oo(t.dataOutputAssociations,r(f,e))}))}function x(t,e){a(t,e)}function E(t,e){i.push((function(){var n=a(t,e);t.childLaneSet&&S(t.childLaneSet,n||e),function(t){oo(t.flowNodeRef,(function(e){var n=e.get("lanes");n&&n.push(t)}))}(t)}))}function S(t,e){oo(t.lanes,r(E,e))}function C(t,n){!function(t,n){oo(t,(function(t){fl(t,"bpmn:SequenceFlow")?i.push((function(){!function(t,e){a(t,e)}(t,n)})):fl(t,"bpmn:BoundaryEvent")?i.unshift((function(){w(t,n)})):fl(t,"bpmn:FlowNode")?w(t,n):fl(t,"bpmn:DataObject")||(fl(t,"bpmn:DataStoreReference")?x(t,n):fl(t,"bpmn:DataObjectReference")?x(t,n):s(e("unrecognized flowElement {element} in context {context}",{element:pl(t),context:n?pl(n.businessObject):"null"}),{element:t,context:n}))}))}(t.flowElements,n),t.laneSets&&function(t,e){oo(t,r(S,e))}(t.laneSets,n)}function k(t,e){var n=a(t,e),i=t.processRef;i&&p(i,n||e)}return{handleDeferred:h,handleDefinitions:function(o,a){var u=o.diagrams;if(a&&-1===u.indexOf(a))throw new Error(e("diagram not part of bpmn:Definitions"));if(!a&&u&&u.length&&(a=u[0]),!a)throw new Error(e("no diagram to display"));l(a);var f=a.plane;if(!f)throw new Error(e("no plane for {element}",{element:pl(a)}));var m=f.bpmnElement;if(!m){if(!(m=function(t){return io(t.rootElements,(function(t){return fl(t,"bpmn:Process")||fl(t,"bpmn:Collaboration")}))}(o)))throw new Error(e("no process or collaboration to display"));s(e("correcting missing bpmnElement on {plane} to {rootElement}",{plane:pl(f),rootElement:pl(m)})),f.bpmnElement=m,c(f)}var v,y=function(e,n){return t.root(e,n)}(m,f);if(fl(m,"bpmn:Process"))p(m,y);else{if(!fl(m,"bpmn:Collaboration"))throw new Error(e("unsupported bpmnElement for {plane}: {rootElement}",{plane:pl(f),rootElement:pl(m)}));oo((v=m).participants,r(k)),g(v.artifacts),i.push((function(){var t;oo(v.messageFlows,r(d,t))})),function(t,e){ro(t,(function(t){return!n[t.id]&&fl(t,"bpmn:Process")&&t.laneSets})).forEach(r(p,e))}(o.rootElements,y)}h()},handleSubProcess:_,registerDi:c}}function vl(t,e){var n=yl(t);return n&&"function"==typeof n.$instanceOf&&n.$instanceOf(e)}function yl(t){return t&&t.businessObject||t}function gl(t){return!vl(t,"bpmn:CallActivity")&&(vl(t,"bpmn:SubProcess")?!!yl(t).di.isExpanded:!vl(t,"bpmn:Participant")||!!yl(t).processRef)}function bl(t){return t&&!!yl(t).triggeredByEvent}function _l(t,e){var n=yl(t),i=!1;return n.eventDefinitions&&oo(n.eventDefinitions,(function(t){vl(t,e)&&(i=!0)})),i}function wl(t){return vl(t,"bpmn:FlowElement")||vl(t,"bpmn:Participant")||vl(t,"bpmn:Lane")||vl(t,"bpmn:SequenceFlow")||vl(t,"bpmn:MessageFlow")||vl(t,"bpmn:DataInput")||vl(t,"bpmn:DataOutput")?"name":vl(t,"bpmn:TextAnnotation")?"text":vl(t,"bpmn:Group")?"categoryValueRef":void 0}function xl(t){var e=t.businessObject,n=wl(e);if(n)return"categoryValueRef"===n?function(t){var e=t.categoryValueRef;return e&&e.value||""}(e):e[n]||""}function El(t,e,n){return lo(t.eventDefinitions,(function(i){return i.$type===e&&function(t,e){return co(e,(function(e,n){return t[n]==e}))}(t,n)}))}function Sl(t){return t.businessObject.di}function Cl(t){return t.businessObject}function kl(t,e){return Sl(t).get("bioc:fill")||e||"white"}function Pl(t,e){return Sl(t).get("bioc:stroke")||e||"black"}var Tl=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t){var e=t.exports=function(t,n){if(n||(n=16),void 0===t&&(t=128),t<=0)return"0";for(var i=Math.log(Math.pow(2,t))/Math.log(n),r=2;i===1/0;r*=2)i=Math.log(Math.pow(2,t/r))/Math.log(n)*r;var o=i-Math.floor(i),a="";for(r=0;r<Math.floor(i);r++){a=Math.floor(Math.random()*n).toString(n)+a}if(o){var s=Math.pow(n,o);a=Math.floor(Math.random()*s).toString(n)+a}var c=parseInt(a,n);return c!==1/0&&c>=Math.pow(2,t)?e(t,n):a};e.rack=function(t,n,i){var r=function(r){var a=0;do{if(a++>10){if(!i)throw new Error("too many ID collisions, use more bits");t+=i}var s=e(t,n)}while(Object.hasOwnProperty.call(o,s));return o[s]=r,s},o=r.hats={};return r.get=function(t){return r.hats[t]},r.set=function(t,e){return r.hats[t]=e,r},r.bits=t||128,r.base=n||16,r}}));function Ol(t){if(!(this instanceof Ol))return new Ol(t);t=t||[128,36,1],this._seed=t.length?Tl.rack(t[0],t[1],t[2]):t}Ol.prototype.next=function(t){return this._seed(t||!0)},Ol.prototype.nextPrefixed=function(t,e){var n;do{n=t+this.next(!0)}while(this.assigned(n));return this.claim(n,e),n},Ol.prototype.claim=function(t,e){this._seed.set(t,e||!0)},Ol.prototype.assigned=function(t){return this._seed.get(t)||!1},Ol.prototype.unclaim=function(t){delete this._seed.hats[t]},Ol.prototype.clear=function(){var t,e=this._seed.hats;for(t in e)this.unclaim(t)};var Al=Ol,Ml=new Al,jl=10,Rl=3,Dl=.95,Nl=.35;function Il(t,e,n,i,r,o,a){Xa.call(this,e,a);var s=t&&t.defaultFillColor,c=t&&t.defaultStrokeColor,l=Ml.next(),u={},h=n.computeStyle;function p(t,e){var n=ko({fill:"black",strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},e.attrs),i=e.ref||{x:0,y:0},o=e.scale||1;"none"===n.strokeDasharray&&(n.strokeDasharray=[1e4,1]);var a=xa("marker");la(e.element,n),oa(a,e.element),la(a,{id:t,viewBox:"0 0 20 20",refX:i.x,refY:i.y,markerWidth:20*o,markerHeight:20*o,orient:"auto"});var s=ta("defs",r._svg);s||(s=xa("defs"),oa(r._svg,s)),oa(s,a),u[t]=a}function d(t){return t.replace(/[()\s,#]+/g,"_")}function f(t,e,n){var i=t+"-"+d(e)+"-"+d(n)+"-"+l;return u[i]||function(t,e,n,i){if("sequenceflow-end"===e){var r=xa("path");la(r,{d:"M 1 5 L 11 10 L 1 15 Z"}),p(t,{element:r,ref:{x:11,y:10},scale:.5,attrs:{fill:i,stroke:i}})}if("messageflow-start"===e){var o=xa("circle");la(o,{cx:6,cy:6,r:3.5}),p(t,{element:o,attrs:{fill:n,stroke:i},ref:{x:6,y:6}})}if("messageflow-end"===e){var a=xa("path");la(a,{d:"m 1 5 l 0 -3 l 7 3 l -7 3 z"}),p(t,{element:a,attrs:{fill:n,stroke:i,strokeLinecap:"butt"},ref:{x:8.5,y:5}})}if("association-start"===e){var s=xa("path");la(s,{d:"M 11 5 L 1 10 L 11 15"}),p(t,{element:s,attrs:{fill:"none",stroke:i,strokeWidth:1.5},ref:{x:1,y:10},scale:.5})}if("association-end"===e){var c=xa("path");la(c,{d:"M 1 5 L 11 10 L 1 15"}),p(t,{element:c,attrs:{fill:"none",stroke:i,strokeWidth:1.5},ref:{x:12,y:10},scale:.5})}if("conditional-flow-marker"===e){var l=xa("path");la(l,{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z"}),p(t,{element:l,attrs:{fill:n,stroke:i},ref:{x:-1,y:10},scale:.5})}if("conditional-default-flow-marker"===e){var u=xa("path");la(u,{d:"M 6 4 L 10 16"}),p(t,{element:u,attrs:{stroke:i},ref:{x:0,y:10},scale:.5})}}(i,t,e,n),"url(#"+i+")"}function m(t,e,n,i,r){Jr(i)&&(r=i,i=0),i=i||0,"none"===(r=h(r,{stroke:"black",strokeWidth:2,fill:"white"})).fill&&delete r.fillOpacity;var o=e/2,a=n/2,s=xa("circle");return la(s,{cx:o,cy:a,r:Math.round((e+n)/4-i)}),la(s,r),oa(t,s),s}function v(t,e,n,i,r,o){Jr(r)&&(o=r,r=0),r=r||0,o=h(o,{stroke:"black",strokeWidth:2,fill:"white"});var a=xa("rect");return la(a,{x:r,y:r,width:e-2*r,height:n-2*r,rx:i,ry:i}),la(a,o),oa(t,a),a}function y(t,e,n){var i=Qa(e,n=h(n,["no-fill"],{stroke:"black",strokeWidth:2,fill:"none"}));return oa(t,i),i}function g(t,e,n){n=h(n,["no-fill"],{strokeWidth:2,stroke:"black"});var i=xa("path");return la(i,{d:e}),la(i,n),oa(t,i),i}function b(t,e,n,i){return g(e,n,ko({"data-marker":t},i))}function _(t){return function(e,n){return P[t](e,n)}}function w(t){return P[t]}function x(t,e){var n=Cl(t),i=function(t){return"bpmn:IntermediateThrowEvent"===t.$type||"bpmn:EndEvent"===t.$type}(n);return n.eventDefinitions&&n.eventDefinitions.length>1?n.parallelMultiple?w("bpmn:ParallelMultipleEventDefinition")(e,t,i):w("bpmn:MultipleEventDefinition")(e,t,i):El(n,"bpmn:MessageEventDefinition")?w("bpmn:MessageEventDefinition")(e,t,i):El(n,"bpmn:TimerEventDefinition")?w("bpmn:TimerEventDefinition")(e,t,i):El(n,"bpmn:ConditionalEventDefinition")?w("bpmn:ConditionalEventDefinition")(e,t):El(n,"bpmn:SignalEventDefinition")?w("bpmn:SignalEventDefinition")(e,t,i):El(n,"bpmn:EscalationEventDefinition")?w("bpmn:EscalationEventDefinition")(e,t,i):El(n,"bpmn:LinkEventDefinition")?w("bpmn:LinkEventDefinition")(e,t,i):El(n,"bpmn:ErrorEventDefinition")?w("bpmn:ErrorEventDefinition")(e,t,i):El(n,"bpmn:CancelEventDefinition")?w("bpmn:CancelEventDefinition")(e,t,i):El(n,"bpmn:CompensateEventDefinition")?w("bpmn:CompensateEventDefinition")(e,t,i):El(n,"bpmn:TerminateEventDefinition")?w("bpmn:TerminateEventDefinition")(e,t,i):null}function E(t,e,n){n=ko({size:{width:100}},n);var i=o.createText(e||"",n);return fa(i).add("djs-label"),oa(t,i),i}function S(t,e,n){return E(t,Cl(e).name,{box:e,align:n,padding:5,style:{fill:Pl(e,c)}})}function C(t,e,n){Gs(E(t,e,{box:{height:30,width:n.height},align:"center-middle",style:{fill:Pl(n,c)}}),0,-(-1*n.height),270)}function k(t){for(var e=t.waypoints,n="m  "+e[0].x+","+e[0].y,i=1;i<e.length;i++)n+="L"+e[i].x+","+e[i].y+" ";return n}var P=this.handlers={"bpmn:Event":function(t,e,n){return"fillOpacity"in n||(n.fillOpacity=Dl),m(t,e.width,e.height,n)},"bpmn:StartEvent":function(t,e){var n={fill:kl(e,s),stroke:Pl(e,c)};Cl(e).isInterrupting||(n={strokeDasharray:"6",strokeLinecap:"round",fill:kl(e,s),stroke:Pl(e,c)});var i=w("bpmn:Event")(t,e,n);return x(e,t),i},"bpmn:MessageEventDefinition":function(t,e,n){return g(t,i.getScaledPath("EVENT_MESSAGE",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:e.width,containerHeight:e.height,position:{mx:.235,my:.315}}),{strokeWidth:1,fill:n?Pl(e,c):kl(e,s),stroke:n?kl(e,s):Pl(e,c)})},"bpmn:TimerEventDefinition":function(t,e){var n=m(t,e.width,e.height,.2*e.height,{strokeWidth:2,fill:kl(e,s),stroke:Pl(e,c)});g(t,i.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:e.width,containerHeight:e.height,position:{mx:.5,my:.5}}),{strokeWidth:2,strokeLinecap:"square",stroke:Pl(e,c)});for(var r=0;r<12;r++){var o=i.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:e.width,containerHeight:e.height,position:{mx:.5,my:.5}}),a=e.width/2;g(t,o,{strokeWidth:1,strokeLinecap:"square",transform:"rotate("+30*r+","+e.height/2+","+a+")",stroke:Pl(e,c)})}return n},"bpmn:EscalationEventDefinition":function(t,e,n){return g(t,i.getScaledPath("EVENT_ESCALATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:e.width,containerHeight:e.height,position:{mx:.5,my:.2}}),{strokeWidth:1,fill:n?Pl(e,c):"none",stroke:Pl(e,c)})},"bpmn:ConditionalEventDefinition":function(t,e){return g(t,i.getScaledPath("EVENT_CONDITIONAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:e.width,containerHeight:e.height,position:{mx:.5,my:.222}}),{strokeWidth:1,stroke:Pl(e,c)})},"bpmn:LinkEventDefinition":function(t,e,n){return g(t,i.getScaledPath("EVENT_LINK",{xScaleFactor:1,yScaleFactor:1,containerWidth:e.width,containerHeight:e.height,position:{mx:.57,my:.263}}),{strokeWidth:1,fill:n?Pl(e,c):"none",stroke:Pl(e,c)})},"bpmn:ErrorEventDefinition":function(t,e,n){return g(t,i.getScaledPath("EVENT_ERROR",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:e.width,containerHeight:e.height,position:{mx:.2,my:.722}}),{strokeWidth:1,fill:n?Pl(e,c):"none",stroke:Pl(e,c)})},"bpmn:CancelEventDefinition":function(t,e,n){var r=g(t,i.getScaledPath("EVENT_CANCEL_45",{xScaleFactor:1,yScaleFactor:1,containerWidth:e.width,containerHeight:e.height,position:{mx:.638,my:-.055}}),{strokeWidth:1,fill:n?Pl(e,c):"none",stroke:Pl(e,c)});return Hs(r,45),r},"bpmn:CompensateEventDefinition":function(t,e,n){return g(t,i.getScaledPath("EVENT_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:e.width,containerHeight:e.height,position:{mx:.22,my:.5}}),{strokeWidth:1,fill:n?Pl(e,c):"none",stroke:Pl(e,c)})},"bpmn:SignalEventDefinition":function(t,e,n){return g(t,i.getScaledPath("EVENT_SIGNAL",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:e.width,containerHeight:e.height,position:{mx:.5,my:.2}}),{strokeWidth:1,fill:n?Pl(e,c):"none",stroke:Pl(e,c)})},"bpmn:MultipleEventDefinition":function(t,e,n){return g(t,i.getScaledPath("EVENT_MULTIPLE",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:e.width,containerHeight:e.height,position:{mx:.222,my:.36}}),{strokeWidth:1,fill:n?Pl(e,c):"none"})},"bpmn:ParallelMultipleEventDefinition":function(t,e){return g(t,i.getScaledPath("EVENT_PARALLEL_MULTIPLE",{xScaleFactor:1.2,yScaleFactor:1.2,containerWidth:e.width,containerHeight:e.height,position:{mx:.458,my:.194}}),{strokeWidth:1,fill:Pl(e,c),stroke:Pl(e,c)})},"bpmn:EndEvent":function(t,e){var n=w("bpmn:Event")(t,e,{strokeWidth:4,fill:kl(e,s),stroke:Pl(e,c)});return x(e,t),n},"bpmn:TerminateEventDefinition":function(t,e){return m(t,e.width,e.height,8,{strokeWidth:4,fill:Pl(e,c),stroke:Pl(e,c)})},"bpmn:IntermediateEvent":function(t,e){var n=w("bpmn:Event")(t,e,{strokeWidth:1,fill:kl(e,s),stroke:Pl(e,c)});return m(t,e.width,e.height,Rl,{strokeWidth:1,fill:kl(e,"none"),stroke:Pl(e,c)}),x(e,t),n},"bpmn:IntermediateCatchEvent":_("bpmn:IntermediateEvent"),"bpmn:IntermediateThrowEvent":_("bpmn:IntermediateEvent"),"bpmn:Activity":function(t,e,n){return"fillOpacity"in(n=n||{})||(n.fillOpacity=Dl),v(t,e.width,e.height,jl,n)},"bpmn:Task":function(t,e){var n={fill:kl(e,s),stroke:Pl(e,c)},i=w("bpmn:Activity")(t,e,n);return S(t,e,"center-middle"),T(t,e),i},"bpmn:ServiceTask":function(t,e){var n=w("bpmn:Task")(t,e);return g(t,i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:12,y:18}}),{strokeWidth:1,fill:kl(e,s),stroke:Pl(e,c)}),g(t,i.getScaledPath("TASK_TYPE_SERVICE_FILL",{abspos:{x:17.2,y:18}}),{strokeWidth:0,fill:kl(e,s)}),g(t,i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:17,y:22}}),{strokeWidth:1,fill:kl(e,s),stroke:Pl(e,c)}),n},"bpmn:UserTask":function(t,e){var n=w("bpmn:Task")(t,e);return g(t,i.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:kl(e,s),stroke:Pl(e,c)}),g(t,i.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:kl(e,s),stroke:Pl(e,c)}),g(t,i.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:Pl(e,c),stroke:Pl(e,c)}),n},"bpmn:ManualTask":function(t,e){var n=w("bpmn:Task")(t,e);return g(t,i.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}}),{strokeWidth:.5,fill:kl(e,s),stroke:Pl(e,c)}),n},"bpmn:SendTask":function(t,e){var n=w("bpmn:Task")(t,e);return g(t,i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:1,yScaleFactor:1,containerWidth:21,containerHeight:14,position:{mx:.285,my:.357}}),{strokeWidth:1,fill:Pl(e,c),stroke:kl(e,s)}),n},"bpmn:ReceiveTask":function(t,e){var n,r=Cl(e),o=w("bpmn:Task")(t,e);return r.instantiate?(m(t,28,28,4.4,{strokeWidth:1}),n=i.getScaledPath("TASK_TYPE_INSTANTIATING_SEND",{abspos:{x:7.77,y:9.52}})):n=i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:21,containerHeight:14,position:{mx:.3,my:.4}}),g(t,n,{strokeWidth:1,fill:kl(e,s),stroke:Pl(e,c)}),o},"bpmn:ScriptTask":function(t,e){var n=w("bpmn:Task")(t,e);return g(t,i.getScaledPath("TASK_TYPE_SCRIPT",{abspos:{x:15,y:20}}),{strokeWidth:1,stroke:Pl(e,c)}),n},"bpmn:BusinessRuleTask":function(t,e){var n=w("bpmn:Task")(t,e);return la(g(t,i.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}})),{strokeWidth:1,fill:kl(e,"#aaaaaa"),stroke:Pl(e,c)}),la(g(t,i.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}})),{strokeWidth:1,stroke:Pl(e,c)}),n},"bpmn:SubProcess":function(t,e,n){n=ko({fill:kl(e,s),stroke:Pl(e,c)},n);var i=w("bpmn:Activity")(t,e,n),r=gl(e);return bl(e)&&la(i,{strokeDasharray:"1,2"}),S(t,e,r?"center-top":"center-middle"),r?T(t,e):T(t,e,["SubProcessMarker"]),i},"bpmn:AdHocSubProcess":function(t,e){return w("bpmn:SubProcess")(t,e)},"bpmn:Transaction":function(t,e){var i=w("bpmn:SubProcess")(t,e),r=n.style(["no-fill","no-events"],{stroke:Pl(e,c)});return v(t,e.width,e.height,jl-2,Rl,r),i},"bpmn:CallActivity":function(t,e){return w("bpmn:SubProcess")(t,e,{strokeWidth:5})},"bpmn:Participant":function(t,e){var n={fillOpacity:Dl,fill:kl(e,s),stroke:Pl(e,c)},i=w("bpmn:Lane")(t,e,n);gl(e)?(y(t,[{x:30,y:0},{x:30,y:e.height}],{stroke:Pl(e,c)}),C(t,Cl(e).name,e)):E(t,Cl(e).name,{box:e,align:"center-middle",style:{fill:Pl(e,c)}});return!!Cl(e).participantMultiplicity&&w("ParticipantMultiplicityMarker")(t,e),i},"bpmn:Lane":function(t,e,n){var i=v(t,e.width,e.height,0,ko({fill:kl(e,s),fillOpacity:Nl,stroke:Pl(e,c)},n)),r=Cl(e);"bpmn:Lane"===r.$type&&C(t,r.name,e);return i},"bpmn:InclusiveGateway":function(t,e){var n=w("bpmn:Gateway")(t,e);return m(t,e.width,e.height,.24*e.height,{strokeWidth:2.5,fill:kl(e,s),stroke:Pl(e,c)}),n},"bpmn:ExclusiveGateway":function(t,e){var n=w("bpmn:Gateway")(t,e),r=i.getScaledPath("GATEWAY_EXCLUSIVE",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:e.width,containerHeight:e.height,position:{mx:.32,my:.3}});return Sl(e).isMarkerVisible&&g(t,r,{strokeWidth:1,fill:Pl(e,c),stroke:Pl(e,c)}),n},"bpmn:ComplexGateway":function(t,e){var n=w("bpmn:Gateway")(t,e);return g(t,i.getScaledPath("GATEWAY_COMPLEX",{xScaleFactor:.5,yScaleFactor:.5,containerWidth:e.width,containerHeight:e.height,position:{mx:.46,my:.26}}),{strokeWidth:1,fill:Pl(e,c),stroke:Pl(e,c)}),n},"bpmn:ParallelGateway":function(t,e){var n=w("bpmn:Gateway")(t,e);return g(t,i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.6,yScaleFactor:.6,containerWidth:e.width,containerHeight:e.height,position:{mx:.46,my:.2}}),{strokeWidth:1,fill:Pl(e,c),stroke:Pl(e,c)}),n},"bpmn:EventBasedGateway":function(t,e){var n=Cl(e),r=w("bpmn:Gateway")(t,e);m(t,e.width,e.height,.2*e.height,{strokeWidth:1,fill:"none",stroke:Pl(e,c)});var o=n.eventGatewayType,a=!!n.instantiate;if("Parallel"===o){var s=i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:e.width,containerHeight:e.height,position:{mx:.474,my:.296}});la(g(t,s),{strokeWidth:1,fill:"none"})}else if("Exclusive"===o){if(!a)la(m(t,e.width,e.height,.26*e.height),{strokeWidth:1,fill:"none",stroke:Pl(e,c)});!function(){var n=i.getScaledPath("GATEWAY_EVENT_BASED",{xScaleFactor:.18,yScaleFactor:.18,containerWidth:e.width,containerHeight:e.height,position:{mx:.36,my:.44}}),r={strokeWidth:2,fill:kl(e,"none"),stroke:Pl(e,c)};g(t,n,r)}()}return r},"bpmn:Gateway":function(t,e){var n={fill:kl(e,s),fillOpacity:Dl,stroke:Pl(e,c)};return function(t,e,n,i){var r=e/2,o=n/2,a=[{x:r,y:0},{x:e,y:o},{x:r,y:n},{x:0,y:o}].map((function(t){return t.x+","+t.y})).join(" ");i=h(i,{stroke:"black",strokeWidth:2,fill:"white"});var s=xa("polygon");return la(s,{points:a}),la(s,i),oa(t,s),s}(t,e.width,e.height,n)},"bpmn:SequenceFlow":function(t,e){var n,i=k(e),r=kl(e,s),o=Pl(e,c),a=g(t,i,{strokeLinejoin:"round",markerEnd:f("sequenceflow-end",r,o),stroke:Pl(e,c)}),l=Cl(e);return e.source&&(n=e.source.businessObject,l.conditionExpression&&n.$instanceOf("bpmn:Activity")&&la(a,{markerStart:f("conditional-flow-marker",r,o)}),n.default&&(n.$instanceOf("bpmn:Gateway")||n.$instanceOf("bpmn:Activity"))&&n.default===l&&la(a,{markerStart:f("conditional-default-flow-marker",r,o)})),a},"bpmn:Association":function(t,e,n){var i=Cl(e),r=kl(e,s),o=Pl(e,c);return n=ko({strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round",stroke:Pl(e,c)},n||{}),"One"!==i.associationDirection&&"Both"!==i.associationDirection||(n.markerEnd=f("association-end",r,o)),"Both"===i.associationDirection&&(n.markerStart=f("association-start",r,o)),y(t,e.waypoints,n)},"bpmn:DataInputAssociation":function(t,e){var n=kl(e,s),i=Pl(e,c);return w("bpmn:Association")(t,e,{markerEnd:f("association-end",n,i)})},"bpmn:DataOutputAssociation":function(t,e){var n=kl(e,s),i=Pl(e,c);return w("bpmn:Association")(t,e,{markerEnd:f("association-end",n,i)})},"bpmn:MessageFlow":function(t,e){var n=Cl(e),r=Sl(e),o=kl(e,s),a=Pl(e,c),l=g(t,k(e),{markerEnd:f("messageflow-end",o,a),markerStart:f("messageflow-start",o,a),strokeDasharray:"10, 12",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5px",stroke:Pl(e,c)});if(n.messageRef){var u=l.getPointAtLength(l.getTotalLength()/2),h=i.getScaledPath("MESSAGE_FLOW_MARKER",{abspos:{x:u.x,y:u.y}}),p={strokeWidth:1};"initiating"===r.messageVisibleKind?(p.fill="white",p.stroke="black"):(p.fill="#888",p.stroke="white"),g(t,h,p)}return l},"bpmn:DataObject":function(t,e){var n=g(t,i.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:e.width,containerHeight:e.height,position:{mx:.474,my:.296}}),{fill:kl(e,s),fillOpacity:Dl,stroke:Pl(e,c)});return function(t){var e=t.dataObjectRef;return t.isCollection||e&&e.isCollection}(Cl(e))&&function(t,e){var n=(e.height-16)/e.height,r=i.getScaledPath("DATA_OBJECT_COLLECTION_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:e.width,containerHeight:e.height,position:{mx:.451,my:n}});g(t,r,{strokeWidth:2})}(t,e),n},"bpmn:DataObjectReference":_("bpmn:DataObject"),"bpmn:DataInput":function(t,e){var n=i.getRawPath("DATA_ARROW"),r=w("bpmn:DataObject")(t,e);return g(t,n,{strokeWidth:1}),r},"bpmn:DataOutput":function(t,e){var n=i.getRawPath("DATA_ARROW"),r=w("bpmn:DataObject")(t,e);return g(t,n,{strokeWidth:1,fill:"black"}),r},"bpmn:DataStoreReference":function(t,e){return g(t,i.getScaledPath("DATA_STORE",{xScaleFactor:1,yScaleFactor:1,containerWidth:e.width,containerHeight:e.height,position:{mx:0,my:.133}}),{strokeWidth:2,fill:kl(e,s),fillOpacity:Dl,stroke:Pl(e,c)})},"bpmn:BoundaryEvent":function(t,e){var n=Cl(e).cancelActivity,i={strokeWidth:1,fill:kl(e,s),stroke:Pl(e,c)};n||(i.strokeDasharray="6",i.strokeLinecap="round");var r=ko({},i,{fillOpacity:1}),o=ko({},i,{fill:"none"}),a=w("bpmn:Event")(t,e,r);return m(t,e.width,e.height,Rl,o),x(e,t),a},"bpmn:Group":function(t,e){return v(t,e.width,e.height,jl,{strokeWidth:1,strokeDasharray:"8,3,1,3",fill:"none",pointerEvents:"none"})},label:function(t,e){return function(t,e){var n={width:90,height:30,x:e.width/2+e.x,y:e.height/2+e.y};return E(t,xl(e),{box:n,fitBox:!0,style:ko({},o.getExternalStyle(),{fill:Pl(e,c)})})}(t,e)},"bpmn:TextAnnotation":function(t,e){var n=v(t,e.width,e.height,0,0,{fill:"none",stroke:"none"});return g(t,i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:e.width,containerHeight:e.height,position:{mx:0,my:0}}),{stroke:Pl(e,c)}),E(t,Cl(e).text||"",{box:e,align:"left-top",padding:5,style:{fill:Pl(e,c)}}),n},ParticipantMultiplicityMarker:function(t,e){b("participant-multiplicity",t,i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:e.width,containerHeight:e.height,position:{mx:e.width/2/e.width,my:(e.height-15)/e.height}}),{strokeWidth:1,fill:kl(e,s),stroke:Pl(e,c)})},SubProcessMarker:function(t,e){Vs(v(t,14,14,0,{strokeWidth:1,fill:kl(e,s),stroke:Pl(e,c)}),e.width/2-7.5,e.height-20),b("sub-process",t,i.getScaledPath("MARKER_SUB_PROCESS",{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:e.width,containerHeight:e.height,position:{mx:(e.width/2-7.5)/e.width,my:(e.height-20)/e.height}}),{fill:kl(e,s),stroke:Pl(e,c)})},ParallelMarker:function(t,e,n){b("parallel",t,i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:e.width,containerHeight:e.height,position:{mx:(e.width/2+n.parallel)/e.width,my:(e.height-20)/e.height}}),{fill:kl(e,s),stroke:Pl(e,c)})},SequentialMarker:function(t,e,n){b("sequential",t,i.getScaledPath("MARKER_SEQUENTIAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:e.width,containerHeight:e.height,position:{mx:(e.width/2+n.seq)/e.width,my:(e.height-19)/e.height}}),{fill:kl(e,s),stroke:Pl(e,c)})},CompensationMarker:function(t,e,n){b("compensation",t,i.getScaledPath("MARKER_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:e.width,containerHeight:e.height,position:{mx:(e.width/2+n.compensation)/e.width,my:(e.height-13)/e.height}}),{strokeWidth:1,fill:kl(e,s),stroke:Pl(e,c)})},LoopMarker:function(t,e,n){b("loop",t,i.getScaledPath("MARKER_LOOP",{xScaleFactor:1,yScaleFactor:1,containerWidth:e.width,containerHeight:e.height,position:{mx:(e.width/2+n.loop)/e.width,my:(e.height-7)/e.height}}),{strokeWidth:1,fill:kl(e,s),stroke:Pl(e,c),strokeLinecap:"round",strokeMiterlimit:.5})},AdhocMarker:function(t,e,n){b("adhoc",t,i.getScaledPath("MARKER_ADHOC",{xScaleFactor:1,yScaleFactor:1,containerWidth:e.width,containerHeight:e.height,position:{mx:(e.width/2+n.adhoc)/e.width,my:(e.height-15)/e.height}}),{strokeWidth:1,fill:Pl(e,c),stroke:Pl(e,c)})}};function T(t,e,n){var i,r=Cl(e),o=n&&-1!==n.indexOf("SubProcessMarker");i=o?{seq:-21,parallel:-22,compensation:-42,loop:-18,adhoc:10}:{seq:-3,parallel:-6,compensation:-27,loop:0,adhoc:10},oo(n,(function(n){w(n)(t,e,i)})),r.isForCompensation&&w("CompensationMarker")(t,e,i),"bpmn:AdHocSubProcess"===r.$type&&w("AdhocMarker")(t,e,i);var a=r.loopCharacteristics,s=a&&a.isSequential;a&&(void 0===s&&w("LoopMarker")(t,e,i),!1===s&&w("ParallelMarker")(t,e,i),!0===s&&w("SequentialMarker")(t,e,i))}this._drawPath=g}Ka()(Il,Xa),Il.$inject=["config.bpmnRenderer","eventBus","styles","pathMap","canvas","textRenderer"],Il.prototype.canRender=function(t){return vl(t,"bpmn:BaseElement")},Il.prototype.drawShape=function(t,e){var n=e.type;return(0,this.handlers[n])(t,e)},Il.prototype.drawConnection=function(t,e){var n=e.type;return(0,this.handlers[n])(t,e)},Il.prototype.getShapePath=function(t){return vl(t,"bpmn:Event")?(n=(e=t).x+e.width/2,i=e.y+e.height/2,r=e.width/2,Za([["M",n,i],["m",0,-r],["a",r,r,0,1,1,0,2*r],["a",r,r,0,1,1,0,-2*r],["z"]])):vl(t,"bpmn:Activity")?function(t,e){var n=t.x,i=t.y,r=t.width,o=t.height;return Za([["M",n+e,i],["l",r-2*e,0],["a",e,e,0,0,1,e,e],["l",0,o-2*e],["a",e,e,0,0,1,-e,e],["l",2*e-r,0],["a",e,e,0,0,1,-e,-e],["l",0,2*e-o],["a",e,e,0,0,1,e,-e],["z"]])}(t,jl):vl(t,"bpmn:Gateway")?function(t){var e=t.width/2,n=t.height/2;return Za([["M",t.x+e,t.y],["l",e,n],["l",-e,n],["l",-e,-n],["z"]])}(t):function(t){var e=t.x,n=t.y,i=t.width;return Za([["M",e,n],["l",i,0],["l",0,t.height],["l",-i,0],["z"]])}(t);var e,n,i,r};var Ll=0,Bl={width:150,height:50};function Fl(t,e){var n;e.textContent=t;try{var i,r=""===t;return e.textContent=r?"dummy":t,i={width:(n=e.getBBox()).width+2*n.x,height:n.height},r&&(i.width=0),i}catch(t){return{width:0,height:0}}}function zl(t,e,n){for(var i,r=t.shift(),o=r;;){if((i=Fl(o,n)).width=o?i.width:0," "===o||""===o||i.width<Math.round(e)||o.length<2)return Gl(t,o,r,i);o=Vl(o,i.width,e)}}function Gl(t,e,n,i){if(e.length<n.length){var r=n.slice(e.length).trim();t.unshift(r)}return{width:i.width,height:i.height,text:e}}function Vl(t,e,n){var i=Math.max(t.length*(n/e),1),r=function(t,e){var n,i=t.split(/(\s|-)/g),r=[],o=0;if(i.length>1)for(;n=i.shift();){if(!(n.length+o<e)){"-"===n&&r.pop();break}r.push(n),o+=n.length}return r.join("")}(t,i);return r||(r=t.slice(0,Math.max(Math.round(i-1),1))),r}function Hl(t){this._config=ko({},{size:Bl,padding:Ll,style:{},align:"center-top"},t||{})}Hl.prototype.createText=function(t,e){return this.layoutText(t,e).element},Hl.prototype.getDimensions=function(t,e){return this.layoutText(t,e).dimensions},Hl.prototype.layoutText=function(t,e){var n=ko({},this._config.size,e.box),i=ko({},this._config.style,e.style),r=function(t){var e=t.split("-");return{horizontal:e[0]||"center",vertical:e[1]||"top"}}(e.align||this._config.align),o=function(t){return Jr(t)?ko({top:0,left:0,right:0,bottom:0},t):{top:t,left:t,right:t,bottom:t}}(void 0!==e.padding?e.padding:this._config.padding),a=e.fitBox||!1,s=function(t){if("fontSize"in t&&"lineHeight"in t)return t.lineHeight*parseInt(t.fontSize,10)}(i),c=t.split(/\r?\n/g),l=[],u=n.width-o.left-o.right,h=xa("text");for(la(h,{x:0,y:0}),la(h,i),oa(function(){var t=document.getElementById("helper-svg");return t||(la(t=xa("svg"),{id:"helper-svg",width:0,height:0,style:"visibility: hidden; position: fixed"}),document.body.appendChild(t)),t}(),h);c.length;)l.push(zl(c,u,h));"middle"===r.vertical&&(o.top=o.bottom=0);var p=so(l,(function(t,e,n){return t+(s||e.height)}),0)+o.top+o.bottom,d=so(l,(function(t,e,n){return e.width>t?e.width:t}),0),f=o.top;"middle"===r.vertical&&(f+=(n.height-p)/2),f-=(s||l[0].height)/4;var m=xa("text");return la(m,i),oo(l,(function(t){var e;switch(f+=s||t.height,r.horizontal){case"left":e=o.left;break;case"right":e=(a?d:u)-o.right-t.width;break;default:e=Math.max(((a?d:u)-t.width)/2+o.left,0)}var n=xa("tspan");la(n,{x:e,y:f}),n.textContent=t.text,oa(m,n)})),va(h),{dimensions:{width:d,height:p},element:m}};var Ul=12,Wl=1.2,$l=30;function ql(t){var e=ko({fontFamily:"Arial, sans-serif",fontSize:Ul,fontWeight:"normal",lineHeight:Wl},t&&t.defaultStyle||{}),n=parseInt(e.fontSize,10)-1,i=ko({},e,{fontSize:n},t&&t.externalStyle||{}),r=new Hl({style:e});this.getExternalLabelBounds=function(t,e){var n=r.getDimensions(e,{box:{width:90,height:30,x:t.width/2+t.x,y:t.height/2+t.y},style:i});return{x:Math.round(t.x+t.width/2-n.width/2),y:Math.round(t.y),width:Math.ceil(n.width),height:Math.ceil(n.height)}},this.getTextAnnotationBounds=function(t,n){var i=r.getDimensions(n,{box:t,style:e,align:"left-top",padding:5});return{x:t.x,y:t.y,width:t.width,height:Math.max($l,Math.round(i.height))}},this.createText=function(t,e){return r.createText(t,e||{})},this.getDefaultStyle=function(){return e},this.getExternalStyle=function(){return i}}ql.$inject=["config.textRenderer"];var Kl=/\{([^}]+)\}/g,Yl=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;var Xl={__init__:["bpmnRenderer"],bpmnRenderer:["type",Il],textRenderer:["type",ql],pathMap:["type",function(){this.pathMap={EVENT_MESSAGE:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:36,width:36,heightElements:[6,14],widthElements:[10.5,21]},EVENT_SIGNAL:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z",height:36,width:36,heightElements:[18],widthElements:[10,20]},EVENT_ESCALATION:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x0},-{e.y1} l -{e.x0},{e.y1} Z",height:36,width:36,heightElements:[20,7],widthElements:[8]},EVENT_CONDITIONAL:{d:"M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z M {e.x2},{e.y3} l {e.x0},0 M {e.x2},{e.y4} l {e.x0},0 M {e.x2},{e.y5} l {e.x0},0 M {e.x2},{e.y6} l {e.x0},0 M {e.x2},{e.y7} l {e.x0},0 M {e.x2},{e.y8} l {e.x0},0 ",height:36,width:36,heightElements:[8.5,14.5,18,11.5,14.5,17.5,20.5,23.5,26.5],widthElements:[10.5,14.5,12.5]},EVENT_LINK:{d:"m {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z",height:36,width:36,heightElements:[4.4375,6.75,7.8125],widthElements:[9.84375,13.5]},EVENT_ERROR:{d:"m {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z",height:36,width:36,heightElements:[.023,8.737,8.151,16.564,10.591,8.714],widthElements:[.085,6.672,6.97,4.273,5.337,6.636]},EVENT_CANCEL_45:{d:"m {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:36,width:36,heightElements:[4.75,8.5],widthElements:[4.75,8.5]},EVENT_COMPENSATION:{d:"m {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x1},-{e.y2} {e.x2},-{e.y3} 0,{e.y1} -{e.x2},-{e.y3} z",height:36,width:36,heightElements:[6.5,13,.4,6.1],widthElements:[9,9.3,8.7]},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my} m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_MULTIPLE:{d:"m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z",height:36,width:36,heightElements:[6.28099,12.56199],widthElements:[3.1405,9.42149,12.56198]},EVENT_PARALLEL_MULTIPLE:{d:"m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} -{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z",height:36,width:36,heightElements:[2.56228,7.68683],widthElements:[2.56228,7.68683]},GATEWAY_EXCLUSIVE:{d:"m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} {e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} {e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z",height:17.5,width:17.5,heightElements:[8.5,6.5312,-6.5312,-8.5],widthElements:[6.5,-6.5,3,-3,5,-5]},GATEWAY_PARALLEL:{d:"m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:30,width:30,heightElements:[5,12.5],widthElements:[5,12.5]},GATEWAY_EVENT_BASED:{d:"m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z",height:11,width:11,heightElements:[-6,6,12,-12],widthElements:[9,-3,-12]},GATEWAY_COMPLEX:{d:"m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} {e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} {e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} -{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z",height:17.125,width:17.125,heightElements:[4.875,3.4375,2.125,3],widthElements:[3.4375,2.125,4.875,3]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},DATA_OBJECT_COLLECTION_PATH:{d:"m {mx}, {my} m  0 15  l 0 -15 m  4 15  l 0 -15 m  4 15  l 0 -15 ",height:61,width:51,heightElements:[12],widthElements:[1,6,12,15]},DATA_ARROW:{d:"m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z",height:61,width:51,heightElements:[],widthElements:[]},DATA_STORE:{d:"m  {mx},{my} l  0,{e.y2} c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 l  0,-{e.y2} c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1} {e.x2},0m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0",height:61,width:61,heightElements:[7,10,45],widthElements:[2,58,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]},MARKER_SUB_PROCESS:{d:"m{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_PARALLEL:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_SEQUENTIAL:{d:"m{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_COMPENSATION:{d:"m {mx},{my} 7,-5 0,10 z m 7.1,-0.3 6.9,-4.7 0,10 -6.9,-4.7 z",height:10,width:21,heightElements:[],widthElements:[]},MARKER_LOOP:{d:"m {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 -6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902",height:13.9,width:13.7,heightElements:[],widthElements:[]},MARKER_ADHOC:{d:"m {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 -3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 -2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z",height:4,width:15,heightElements:[],widthElements:[]},TASK_TYPE_SEND:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:14,width:21,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_SCRIPT:{d:"m {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z m -7,-12 l 5,0 m -4.5,3 l 4.5,0 m -3,3 l 5,0m -4,3 l 5,0",height:15,width:12.6,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_USER_1:{d:"m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5"},TASK_TYPE_USER_2:{d:"m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 "},TASK_TYPE_USER_3:{d:"m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z"},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_INSTANTIATING_SEND:{d:"m {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6"},TASK_TYPE_SERVICE:{d:"m {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 -1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 -0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 -1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 -0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z m 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_SERVICE_FILL:{d:"m {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"},MESSAGE_FLOW_MARKER:{d:"m {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6"}},this.getRawPath=function(t){return this.pathMap[t].d},this.getScaledPath=function(t,e){var n,i,r=this.pathMap[t];e.abspos?(n=e.abspos.x,i=e.abspos.y):(n=e.containerWidth*e.position.mx,i=e.containerHeight*e.position.my);var o,a,s={};if(e.position){for(var c=e.containerHeight/r.height*e.yScaleFactor,l=e.containerWidth/r.width*e.xScaleFactor,u=0;u<r.heightElements.length;u++)s["y"+u]=r.heightElements[u]*c;for(var h=0;h<r.widthElements.length;h++)s["x"+h]=r.widthElements[h]*l}return o=r.d,a={mx:n,my:i,e:s},String(o).replace(Kl,(function(t,e){return function(t,e,n){var i=n;return e.replace(Yl,(function(t,e,n,r,o){e=e||r,i&&(e in i&&(i=i[e]),"function"==typeof i&&o&&(i=i()))})),i=(null==i||i==n?t:i)+""}(t,e,a)}))}}]};var Zl={translate:["value",function(t,e){return e=e||{},t.replace(/{([^}]+)}/g,(function(t,n){return e[n]||"{"+n+"}"}))}]},Jl={width:90,height:20},Ql=15;function tu(t){return vl(t,"bpmn:Event")||vl(t,"bpmn:Gateway")||vl(t,"bpmn:DataStoreReference")||vl(t,"bpmn:DataObjectReference")||vl(t,"bpmn:DataInput")||vl(t,"bpmn:DataOutput")||vl(t,"bpmn:SequenceFlow")||vl(t,"bpmn:MessageFlow")||vl(t,"bpmn:Group")}function eu(t){return ru(t.label)}function nu(t){var e=t.length/2-1,n=t[Math.floor(e)],i=t[Math.ceil(e+.01)],r=function(t){var e=t.length/2-1,n=t[Math.floor(e)],i=t[Math.ceil(e+.01)];return{x:n.x+(i.x-n.x)/2,y:n.y+(i.y-n.y)/2}}(t),o=Math.atan((i.y-n.y)/(i.x-n.x)),a=r.x,s=r.y;return Math.abs(o)<Math.PI/2?s-=Ql:a+=Ql,{x:a,y:s}}function iu(t){return t.waypoints?nu(t.waypoints):vl(t,"bpmn:Group")?{x:t.x+t.width/2,y:t.y+Jl.height/2}:{x:t.x+t.width/2,y:t.y+t.height+Jl.height/2}}function ru(t){return t&&!!t.labelTarget}function ou(t,e){return t&&e?Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)):-1}function au(t,e,n,i){if(void 0===i&&(i=5),!t||!e||!n)return!1;var r=(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x),o=ou(t,e);return Math.abs(r/o)<=i}var su=2;function cu(t,e){var n;return function(t,e){var n;n=Zr(t)?t:[t,e];var i=n.slice().shift();return co(n,(function(t){return Math.abs(i.y-t.y)<=su}))}(n=Zr(t)?t:[t,e])?"h":!!function(t,e){var n;n=Zr(t)?t:[t,e];var i=n.slice().shift();return co(n,(function(t){return Math.abs(i.x-t.x)<=su}))}(n)&&"v"}function lu(t,e,n){return n=n||0,t.x>e.x-n&&t.y>e.y-n&&t.x<e.x+e.width+n&&t.y<e.y+e.height+n}function uu(t,e){return{x:Math.round(t.x+(e.x-t.x)/2),y:Math.round(t.y+(e.y-t.y)/2)}}var hu=n(14),pu=n.n(hu);function du(t){return{x:Math.round(t.x),y:Math.round(t.y),width:Math.round(t.width),height:Math.round(t.height)}}function fu(t){return{x:Math.round(t.x),y:Math.round(t.y)}}function mu(t){return{top:t.y,right:t.x+(t.width||0),bottom:t.y+(t.height||0),left:t.x}}function vu(t){return{x:t.left,y:t.top,width:t.right-t.left,height:t.bottom-t.top}}function yu(t){return fu({x:t.x+(t.width||0)/2,y:t.y+(t.height||0)/2})}function gu(t,e,n){Jr(n=n||0)||(n={x:n,y:n});var i=mu(t),r=mu(e),o=i.bottom+n.y<=r.top,a=i.left-n.x>=r.right,s=i.top-n.y>=r.bottom,c=o?"top":s?"bottom":null,l=i.right+n.x<=r.left?"left":a?"right":null;return l&&c?c+"-"+l:l||c||"intersect"}function bu(t,e,n){var i,r,o=(i=t,r=e,pu()(i,r));return 1===o.length?fu(o[0]):2===o.length&&ou(o[0],o[1])<1?fu(o[0]):o.length>1?fu((o=yo(o,(function(t){var e=Math.floor(100*t.t2)||1;return e=((e=100-e)<10?"0":"")+e,t.segment2+"#"+e})))[n?0:o.length-1]):null}function _u(t){t=t.slice();for(var e,n,i,r=0;t[r];)e=t[r],n=t[r-1],0===ou(e,i=t[r+1])||au(n,i,e)?t.splice(r,1):r++;return t}function wu(t,e){return ko({id:t.id,type:t.$type,businessObject:t},e)}function xu(t,e,n){var i=t.di.waypoint;return!i||i.length<2?[yu(e),yu(n)]:i.map((function(t){return{x:t.x,y:t.y}}))}function Eu(t,e,n,i){return new Error(t("element {element} referenced by {referenced}#{property} not yet drawn",{element:pl(n),referenced:pl(e),property:i}))}function Su(t,e,n,i,r,o){this._eventBus=t,this._canvas=e,this._elementFactory=n,this._elementRegistry=i,this._translate=r,this._textRenderer=o}Su.$inject=["eventBus","canvas","elementFactory","elementRegistry","translate","textRenderer"],Su.prototype.add=function(t,e){var n,i,r,o,a,s,c,l=t.di,u=this._translate;if(vl(l,"bpmndi:BPMNPlane"))n=this._elementFactory.createRoot(wu(t)),this._canvas.setRootElement(n);else if(vl(l,"bpmndi:BPMNShape")){var h=!gl(t);i=e&&(e.hidden||e.collapsed);var p=t.di.bounds;n=this._elementFactory.createShape(wu(t,{collapsed:h,hidden:i,x:Math.round(p.x),y:Math.round(p.y),width:Math.round(p.width),height:Math.round(p.height)})),vl(t,"bpmn:BoundaryEvent")&&this._attachBoundary(t,n),vl(t,"bpmn:Lane")&&(r=0),vl(t,"bpmn:DataStoreReference")&&(o=e,a=yu(p),s=a.x,c=a.y,s>=o.x&&s<=o.x+o.width&&c>=o.y&&c<=o.y+o.height||(e=this._canvas.getRootElement())),this._canvas.addShape(n,e,r)}else{if(!vl(l,"bpmndi:BPMNEdge"))throw new Error(u("unknown di {di} for element {semantic}",{di:pl(l),semantic:pl(t)}));var d=this._getSource(t),f=this._getTarget(t);i=e&&(e.hidden||e.collapsed),n=this._elementFactory.createConnection(wu(t,{hidden:i,source:d,target:f,waypoints:xu(t,d,f)})),vl(t,"bpmn:DataAssociation")&&(e=null),vl(t,"bpmn:SequenceFlow")&&(r=0),this._canvas.addConnection(n,e,r)}return tu(t)&&xl(n)&&this.addLabel(t,n),this._eventBus.fire("bpmnElement.added",{element:n}),n},Su.prototype._attachBoundary=function(t,e){var n=this._translate,i=t.attachedToRef;if(!i)throw new Error(n("missing {semantic}#attachedToRef",{semantic:pl(t)}));var r=this._elementRegistry.get(i.id),o=r&&r.attachers;if(!r)throw Eu(n,t,i,"attachedToRef");e.host=r,o||(r.attachers=o=[]),-1===o.indexOf(e)&&o.push(e)},Su.prototype.addLabel=function(t,e){var n,i,r;return n=function(t,e){var n,i,r,o=t.di.label;return o&&o.bounds?(r=o.bounds,i={width:Math.max(Jl.width,r.width),height:r.height},n={x:r.x+r.width/2,y:r.y+r.height/2}):(n=iu(e),i=Jl),ko({x:n.x-i.width/2,y:n.y-i.height/2},i)}(t,e),(i=xl(e))&&(n=this._textRenderer.getExternalLabelBounds(n,i)),r=this._elementFactory.createLabel(wu(t,{id:t.id+"_label",labelTarget:e,type:"label",hidden:e.hidden||!xl(e),x:Math.round(n.x),y:Math.round(n.y),width:Math.round(n.width),height:Math.round(n.height)})),this._canvas.addShape(r,e.parent)},Su.prototype._getEnd=function(t,e){var n,i,r=t.$type,o=this._translate;if(i=t[e+"Ref"],"source"===e&&"bpmn:DataInputAssociation"===r&&(i=i&&i[0]),("source"===e&&"bpmn:DataOutputAssociation"===r||"target"===e&&"bpmn:DataInputAssociation"===r)&&(i=t.$parent),n=i&&this._getElement(i))return n;throw i?Eu(o,t,i,e+"Ref"):new Error(o("{semantic}#{side} Ref not specified",{semantic:pl(t),side:e}))},Su.prototype._getSource=function(t){return this._getEnd(t,"source")},Su.prototype._getTarget=function(t){return this._getEnd(t,"target")},Su.prototype._getElement=function(t){return this._elementRegistry.get(t.id)};var Cu={__depends__:[Xl,{__depends__:[Zl],bpmnImporter:["type",Su]}]};function ku(t){t&&"function"==typeof t.stopPropagation&&t.stopPropagation()}function Pu(t){return t.originalEvent||t.srcEvent}function Tu(t,e){ku(t),ku(Pu(t))}function Ou(t){return t.pointers&&t.pointers.length&&(t=t.pointers[0]),t.touches&&t.touches.length&&(t=t.touches[0]),t?{x:t.clientX,y:t.clientY}:null}function Au(t){return!(Pu(t)||t).button}function Mu(t){var e=Pu(t)||t;return!!Au(t)&&(/mac/i.test(navigator.platform)?e.metaKey:e.ctrlKey)}function ju(t){return!0}var Ru=500;function Du(t,e,n){var i=this;function r(n,i,r){var o,a;(function(t,e){return!(c[t]||Au)(e)})(n,i)||(r?a=e.getGraphics(r):(o=i.delegateTarget||i.target)&&(a=o,r=e.get(a)),a&&r&&!1===t.fire(n,{element:r,gfx:a,originalEvent:i})&&(i.stopPropagation(),i.preventDefault()))}var o={};function a(t){return o[t]}var s={click:"element.click",contextmenu:"element.contextmenu",dblclick:"element.dblclick",mousedown:"element.mousedown",mousemove:"element.mousemove",mouseover:"element.hover",mouseout:"element.out",mouseup:"element.mouseup"},c={"element.contextmenu":ju};var l="svg, .djs-element";function u(t,e,n,i){var a=o[n]=function(t){r(n,t)};i&&(c[n]=i),a.$delegate=qo.bind(t,l,e,a)}function h(t,e,n){var i=a(n);i&&qo.unbind(t,e,i.$delegate)}t.on("canvas.destroy",(function(t){var e;e=t.svg,oo(s,(function(t,n){h(e,n,t)}))})),t.on("canvas.init",(function(t){var e;e=t.svg,oo(s,(function(t,n){u(e,n,t)}))})),t.on(["shape.added","connection.added"],(function(e){var n=e.element,i=e.gfx;t.fire("interactionEvents.createHit",{element:n,gfx:i})})),t.on(["shape.changed","connection.changed"],Ru,(function(e){var n=e.element,i=e.gfx;t.fire("interactionEvents.updateHit",{element:n,gfx:i})})),t.on("interactionEvents.createHit",Ru,(function(t){var e=t.element,n=t.gfx;i.createDefaultHit(e,n)})),t.on("interactionEvents.updateHit",(function(t){var e=t.element,n=t.gfx;i.updateDefaultHit(e,n)}));var p=m("djs-hit djs-hit-stroke"),d=m("djs-hit djs-hit-click-stroke"),f={all:m("djs-hit djs-hit-all"),"click-stroke":d,stroke:p};function m(t,e){return e=ko({stroke:"white",strokeWidth:15},e||{}),n.cls(t,["no-fill","no-border"],e)}function v(t,e){var n=f[e];if(!n)throw new Error("invalid hit type <"+e+">");return la(t,n),t}function y(t,e){oa(t,e)}this.removeHits=function(t){oo(ea(".djs-hit",t),va)},this.createDefaultHit=function(t,e){var n,i=t.waypoints,r=t.isFrame;return i?this.createWaypointsHit(e,i):(n=r?"stroke":"all",this.createBoxHit(e,n,{width:t.width,height:t.height}))},this.createWaypointsHit=function(t,e){var n=Qa(e);return v(n,"stroke"),y(t,n),n},this.createBoxHit=function(t,e,n){n=ko({x:0,y:0},n);var i=xa("rect");return v(i,e),la(i,n),y(t,i),i},this.updateDefaultHit=function(t,e){var n=ta(".djs-hit",e);if(n)return t.waypoints?function(t,e){la(t,{points:Ja(e)})}(n,t.waypoints):la(n,{width:t.width,height:t.height}),n},this.fire=r,this.triggerMouseEvent=function(t,e,n){var i=s[t];if(!i)throw new Error("unmapped DOM event name <"+t+">");return r(i,e,n)},this.mouseHandler=a,this.registerEvent=u,this.unregisterEvent=h}Du.$inject=["eventBus","elementRegistry","styles"];var Nu={__init__:["interactionEvents"],interactionEvents:["type",Du]},Iu=500;function Lu(t,e,n){this.offset=6;var i=e.cls("djs-outline",["no-fill"]),r=this;function o(t,e){var n=xa("rect");return la(n,ko({x:10,y:10,width:100,height:100},i)),oa(t,n),n}t.on(["shape.added","shape.changed"],Iu,(function(t){var e=t.element,n=t.gfx,i=ta(".djs-outline",n);i||(i=o(n)),r.updateShapeOutline(i,e)})),t.on(["connection.added","connection.changed"],(function(t){var e=t.element,n=t.gfx,i=ta(".djs-outline",n);i||(i=o(n)),r.updateConnectionOutline(i,e)}))}Lu.prototype.updateShapeOutline=function(t,e){la(t,{x:-this.offset,y:-this.offset,width:e.width+2*this.offset,height:e.height+2*this.offset})},Lu.prototype.updateConnectionOutline=function(t,e){var n=os(e);la(t,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+2*this.offset,height:n.height+2*this.offset})},Lu.$inject=["eventBus","styles","elementRegistry"];var Bu={__init__:["outline"],outline:["type",Lu]};function Fu(t){this._eventBus=t,this._selectedElements=[];var e=this;t.on(["shape.remove","connection.remove"],(function(t){var n=t.element;e.deselect(n)})),t.on(["diagram.clear"],(function(t){e.select(null)}))}Fu.$inject=["eventBus"],Fu.prototype.deselect=function(t){var e=this._selectedElements,n=e.indexOf(t);if(-1!==n){var i=e.slice();e.splice(n,1),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:e})}},Fu.prototype.get=function(){return this._selectedElements},Fu.prototype.isSelected=function(t){return-1!==this._selectedElements.indexOf(t)},Fu.prototype.select=function(t,e){var n=this._selectedElements,i=n.slice();Zr(t)||(t=t?[t]:[]),e?oo(t,(function(t){-1===n.indexOf(t)&&n.push(t)})):this._selectedElements=n=t.slice(),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:n})};var zu="hover",Gu="selected";function Vu(t,e,n,i){function r(t,n){e.addMarker(t,n)}function o(t,n){e.removeMarker(t,n)}this._multiSelectionBox=null,t.on("element.hover",(function(t){r(t.element,zu)})),t.on("element.out",(function(t){o(t.element,zu)})),t.on("selection.changed",(function(t){var e=t.oldSelection,n=t.newSelection;oo(e,(function(t){-1===n.indexOf(t)&&o(t,Gu)})),oo(n,(function(t){-1===e.indexOf(t)&&r(t,Gu)}))}))}function Hu(t,e,n,i){t.on("create.end",500,(function(t){var n=t.context,i=n.canExecute,r=n.elements,o=(n.hints||{}).autoSelect;if(i){if(!1===o)return;Zr(o)?e.select(o):e.select(r)}})),t.on("connect.end",500,(function(t){t.context.canExecute&&t.context.target&&e.select(t.context.target)})),t.on("shape.move.end",500,(function(t){var n=t.previousSelection||[],r=i.get(t.context.shape.id);io(n,(function(t){return r.id===t.id}))||e.select(r)})),t.on("element.click",(function(t){var i=t.element;i===n.getRootElement()&&(i=null);var r=e.isSelected(i),o=e.get().length>1,a=Mu(t);if(r&&o)return a?e.deselect(i):e.select(i);r?e.deselect(i):e.select(i,a)}))}Vu.$inject=["eventBus","canvas","selection","styles"],Hu.$inject=["eventBus","selection","canvas","elementRegistry"];var Uu={__init__:["selectionVisuals","selectionBehavior"],__depends__:[Nu,Bu],selection:["type",Fu],selectionVisuals:["type",Vu],selectionBehavior:["type",Hu]};function Wu(t){this._counter=0,this._prefix=(t?t+"-":"")+Math.floor(1e9*Math.random())+"-"}Wu.prototype.next=function(){return this._prefix+ ++this._counter};var $u=new Wu("ov");function qu(t,e,n,i){var r,o;this._eventBus=e,this._canvas=n,this._elementRegistry=i,this._ids=$u,this._overlayDefaults=ko({show:null,scale:!0},t&&t.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=(r=n.getContainer(),o=Ko('<div class="djs-overlay-container" style="position: absolute; width: 0; height: 0;" />'),r.insertBefore(o,r.firstChild),o),this._init()}function Ku(t,e,n){ko(t.style,{left:e+"px",top:n+"px"})}function Yu(t,e){t.style.display=!1===e?"none":""}function Xu(t,e){t.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach((function(n){t.style[n+"transform"]=e}))}qu.$inject=["config.overlays","eventBus","canvas","elementRegistry"],qu.prototype.get=function(t){if(eo(t)&&(t={id:t}),eo(t.element)&&(t.element=this._elementRegistry.get(t.element)),t.element){var e=this._getOverlayContainer(t.element,!0);return e?t.type?ro(e.overlays,go({type:t.type})):e.overlays.slice():[]}return t.type?ro(this._overlays,go({type:t.type})):t.id?this._overlays[t.id]:null},qu.prototype.add=function(t,e,n){if(Jr(e)&&(n=e,e=null),t.id||(t=this._elementRegistry.get(t)),!n.position)throw new Error("must specifiy overlay position");if(!n.html)throw new Error("must specifiy overlay html");if(!t)throw new Error("invalid element specified");var i=this._ids.next();return n=ko({},this._overlayDefaults,n,{id:i,type:e,element:t,html:n.html}),this._addOverlay(n),i},qu.prototype.remove=function(t){var e=this.get(t)||[];Zr(e)||(e=[e]);var n=this;oo(e,(function(t){var e=n._getOverlayContainer(t.element,!0);if(t&&(na(t.html),na(t.htmlContainer),delete t.htmlContainer,delete t.element,delete n._overlays[t.id]),e){var i=e.overlays.indexOf(t);-1!==i&&e.overlays.splice(i,1)}}))},qu.prototype.show=function(){Yu(this._overlayRoot)},qu.prototype.hide=function(){Yu(this._overlayRoot,!1)},qu.prototype.clear=function(){this._overlays={},this._overlayContainers=[],Io(this._overlayRoot)},qu.prototype._updateOverlayContainer=function(t){var e=t.element,n=t.html,i=e.x,r=e.y;if(e.waypoints){var o=os(e);i=o.x,r=o.y}Ku(n,i,r),Oo(t.html,"data-container-id",e.id)},qu.prototype._updateOverlay=function(t){var e,n,i=t.position,r=t.htmlContainer,o=t.element,a=i.left,s=i.top;void 0!==i.right&&(e=o.waypoints?os(o).width:o.width,a=-1*i.right+e);void 0!==i.bottom&&(n=o.waypoints?os(o).height:o.height,s=-1*i.bottom+n);Ku(r,a||0,s||0)},qu.prototype._createOverlayContainer=function(t){var e=Ko('<div class="djs-overlays" style="position: absolute" />');this._overlayRoot.appendChild(e);var n={html:e,element:t,overlays:[]};return this._updateOverlayContainer(n),this._overlayContainers.push(n),n},qu.prototype._updateRoot=function(t){var e=t.scale||1,n="matrix("+[e,0,0,e,-1*t.x*e,-1*t.y*e].join(",")+")";Xu(this._overlayRoot,n)},qu.prototype._getOverlayContainer=function(t,e){var n=io(this._overlayContainers,(function(e){return e.element===t}));return n||e?n:this._createOverlayContainer(t)},qu.prototype._addOverlay=function(t){var e,n,i=t.id,r=t.element,o=t.html;o.get&&o.constructor.prototype.jquery&&(o=o.get(0)),eo(o)&&(o=Ko(o)),n=this._getOverlayContainer(r),(e=Ko('<div class="djs-overlay" data-overlay-id="'+i+'" style="position: absolute">')).appendChild(o),t.type&&Do(e).add("djs-overlay-"+t.type),t.htmlContainer=e,n.overlays.push(t),n.html.appendChild(e),this._overlays[i]=t,this._updateOverlay(t),this._updateOverlayVisibilty(t,this._canvas.viewbox())},qu.prototype._updateOverlayVisibilty=function(t,e){var n=t.show,i=n&&n.minZoom,r=n&&n.maxZoom,o=t.htmlContainer,a=!0;n&&((Xr(i)&&i>e.scale||Xr(r)&&r<e.scale)&&(a=!1),Yu(o,a)),this._updateOverlayScale(t,e)},qu.prototype._updateOverlayScale=function(t,e){var n,i,r,o=t.scale,a=t.htmlContainer,s="";!0!==o&&(!1===o?(n=1,i=1):(n=o.min,i=o.max),Xr(n)&&e.scale<n&&(r=(1/e.scale||1)*n),Xr(i)&&e.scale>i&&(r=(1/e.scale||1)*i)),Xr(r)&&(s="scale("+r+","+r+")"),Xu(a,s)},qu.prototype._updateOverlaysVisibilty=function(t){var e=this;oo(this._overlays,(function(n){e._updateOverlayVisibilty(n,t)}))},qu.prototype._init=function(){var t=this._eventBus,e=this;t.on("canvas.viewbox.changing",(function(t){e.hide()})),t.on("canvas.viewbox.changed",(function(t){var n;n=t.viewbox,e._updateRoot(n),e._updateOverlaysVisibilty(n),e.show()})),t.on(["shape.remove","connection.remove"],(function(t){var n=t.element;oo(e.get({element:n}),(function(t){e.remove(t.id)}));var i=e._getOverlayContainer(n);if(i){na(i.html);var r=e._overlayContainers.indexOf(i);-1!==r&&e._overlayContainers.splice(r,1)}})),t.on("element.changed",500,(function(t){var n=t.element,i=e._getOverlayContainer(n,!0);i&&(oo(i.overlays,(function(t){e._updateOverlay(t)})),e._updateOverlayContainer(i))})),t.on("element.marker.update",(function(t){var n=e._getOverlayContainer(t.element,!0);n&&Do(n.html)[t.add?"add":"remove"](t.marker)})),t.on("diagram.clear",this.clear,this)};var Zu={__init__:["overlays"],overlays:["type",qu]},Ju='<img width="52" height="52" src="'+("data:image/svg+xml,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 960"><path fill="#fff" d="M960 60v839c0 33-27 61-60 61H60c-33 0-60-27-60-60V60C0 27 27 0 60 0h839c34 0 61 27 61 60z"/><path fill="#52b415" d="M217 548a205 205 0 0 0-144 58 202 202 0 0 0-4 286 202 202 0 0 0 285 3 200 200 0 0 0 48-219 203 203 0 0 0-185-128zM752 6a206 206 0 0 0-192 285 206 206 0 0 0 269 111 207 207 0 0 0 111-260A204 204 0 0 0 752 6zM62 0A62 62 0 0 0 0 62v398l60 46a259 259 0 0 1 89-36c5-28 10-57 14-85l99 2 12 85a246 246 0 0 1 88 38l70-52 69 71-52 68c17 30 29 58 35 90l86 14-2 100-86 12a240 240 0 0 1-38 89l43 58h413c37 0 60-27 60-61V407a220 220 0 0 1-44 40l21 85-93 39-45-76a258 258 0 0 1-98 1l-45 76-94-39 22-85a298 298 0 0 1-70-69l-86 22-38-94 76-45a258 258 0 0 1-1-98l-76-45 40-94 85 22a271 271 0 0 1 41-47z"/></svg>'))+'" />';function Qu(t){return t.join(";")}var th,eh='<div class="bjs-powered-by-lightbox" style="'+Qu(["z-index: 1001","position: fixed","top: 0","left: 0","right: 0","bottom: 0"])+'"><div class="backdrop" style="'+Qu(["width: 100%","height: 100%","background: rgba(0,0,0,0.2)"])+'"></div><div class="notice" style="'+Qu(["position: absolute","left: 50%","top: 40%","margin: 0 -130px","width: 260px","padding: 10px","background: white","border: solid 1px #AAA","border-radius: 3px","font-family: Helvetica, Arial, sans-serif","font-size: 14px","line-height: 1.2em"])+'"><a href="http://bpmn.io" target="_blank" style="float: left; margin-right: 10px">'+Ju+'</a>Web-based tooling for BPMN, DMN and CMMN diagrams powered by <a href="http://bpmn.io" target="_blank">bpmn.io</a>.</div></div>';var nh={width:"100%",height:"100%",position:"relative"};function ih(t){return t+(Qr(t)?"px":"")}function rh(t){var e,n;t=ko({},nh,t),this._moddle=this._createModdle(t),this._container=this._createContainer(t),e=this._container,n=Ko('<a href="http://bpmn.io" target="_blank" class="bjs-powered-by" title="Powered by bpmn.io" style="position: absolute; bottom: 15px; right: 15px; z-index: 100">'+Ju+"</a>"),e.appendChild(n),Wo.bind(n,"click",(function(t){th||(th=Ko(eh),qo.bind(th,".backdrop","click",(function(t){document.body.removeChild(th)}))),document.body.appendChild(th),t.preventDefault()})),this._init(this._container,this._moddle,t)}function oh(t){return!t.altKey&&(t.ctrlKey||t.metaKey)}function ah(t,e){return(t=Zr(t)?t:[t]).indexOf(e.key)>-1}function sh(t){return t.shiftKey}Ka()(rh,Ks),rh.prototype.importXML=function(t,e,n){to(e)&&(n=e,e=null),n=n||function(){};var i=this;t=this._emit("import.parse.start",{xml:t})||t,this._moddle.fromXML(t,"bpmn:Definitions",(function(t,r,o){r=i._emit("import.parse.complete",{error:t,definitions:r,context:o})||r;var a=o.warnings;if(t)return t=function(t){var e=/unparsable content <([^>]+)> detected([\s\S]*)$/.exec(t.message);return e&&(t.message="unparsable content <"+e[1]+"> detected; this may indicate an invalid BPMN 2.0 diagram file"+e[2]),t}(t),i._emit("import.done",{error:t,warnings:a}),n(t,a);i.importDefinitions(r,e,(function(t,e){var r=[].concat(a,e||[]);i._emit("import.done",{error:t,warnings:r}),n(t,r)}))}))},rh.prototype.importDefinitions=function(t,e,n){return to(e)&&(n=e,e=null),n=n||function(){},this._setDefinitions(t),this.open(e,n)},rh.prototype.open=function(t,e){to(t)&&(e=t,t=null);var n=this._definitions,i=t;if(e=e||function(){},!n)return e(new Error("no XML imported"));if("string"==typeof t&&!(i=function(t,e){return e&&io(t.diagrams,(function(t){return t.id===e}))||null}(n,t)))return e(new Error("BPMNDiagram <"+t+"> not found"));try{this.clear()}catch(t){return e(t)}return function(t,e,n,i){var r,o,a;to(n)&&(i=n,n=null);var s,c=[];try{r=t.get("bpmnImporter"),o=t.get("eventBus"),a=t.get("translate"),o.fire("import.render.start",{definitions:e}),function(t,e){new ml({root:function(t){return r.add(t)},element:function(t,e){return r.add(t,e)},error:function(t,e){c.push({message:t,context:e})}},a).handleDefinitions(t,e)}(e,n),o.fire("import.render.complete",{error:s,warnings:c})}catch(t){s=t}i(s,c)}(this,n,i,e)},rh.prototype.saveXML=function(t,e){e||(e=t,t={});var n=this,i=this._definitions;if(!i)return e(new Error("no definitions loaded"));i=this._emit("saveXML.start",{definitions:i})||i,this._moddle.toXML(i,t,(function(t,i){try{i=n._emit("saveXML.serialized",{error:t,xml:i})||i,n._emit("saveXML.done",{error:t,xml:i})}catch(t){console.error("error in saveXML life-cycle listener",t)}e(t,i)}))},rh.prototype.saveSVG=function(t,e){var n,i;e||(e=t,t={}),this._emit("saveSVG.start");try{var r=this.get("canvas"),o=r.getDefaultLayer(),a=ta("defs",r._svg),s=ja(o),c=a?"<defs>"+ja(a)+"</defs>":"",l=o.getBBox();n='<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- created with bpmn-js / http://bpmn.io --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+l.width+'" height="'+l.height+'" viewBox="'+l.x+" "+l.y+" "+l.width+" "+l.height+'" version="1.1">'+c+s+"</svg>"}catch(t){i=t}this._emit("saveSVG.done",{error:i,svg:n}),e(i,n)},rh.prototype._setDefinitions=function(t){this._definitions=t},rh.prototype.getModules=function(){return this._modules},rh.prototype.clear=function(){this.getDefinitions()&&(this.get("elementRegistry").forEach((function(t){var e=t.businessObject;e&&e.di&&delete e.di})),Ks.prototype.clear.call(this))},rh.prototype.destroy=function(){Ks.prototype.destroy.call(this),na(this._container)},rh.prototype.on=function(t,e,n,i){return this.get("eventBus").on(t,e,n,i)},rh.prototype.off=function(t,e){this.get("eventBus").off(t,e)},rh.prototype.attachTo=function(t){if(!t)throw new Error("parentNode required");this.detach(),t.get&&t.constructor.prototype.jquery&&(t=t.get(0)),"string"==typeof t&&(t=ta(t)),t.appendChild(this._container),this._emit("attach",{}),this.get("canvas").resized()},rh.prototype.getDefinitions=function(){return this._definitions},rh.prototype.detach=function(){var t=this._container,e=t.parentNode;e&&(this._emit("detach",{}),e.removeChild(t))},rh.prototype._init=function(t,e,n){var i=n.modules||this.getModules(),r=n.additionalModules||[],o=[].concat([{bpmnjs:["value",this],moddle:["value",e]}],i,r),a=ko(To(n,["additionalModules"]),{canvas:ko({},n.canvas,{container:t}),modules:o});Ks.call(this,a),n&&n.container&&this.attachTo(n.container)},rh.prototype._emit=function(t,e){return this.get("eventBus").fire(t,e)},rh.prototype._createContainer=function(t){var e=Ko('<div class="bjs-container"></div>');return ko(e.style,{width:ih(t.width),height:ih(t.height),position:t.position}),e},rh.prototype._createModdle=function(t){var e=ko({},this._moddleExtensions,t.moddleExtensions);return new hl(e)},rh.prototype._modules=[Cu,Zl,Uu,Zu],rh.prototype._moddleExtensions={};function ch(t,e){var n=this;this._config=t||{},this._eventBus=e,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),e.on("diagram.destroy",(function(){n._fire("destroy"),n.unbind()})),e.on("diagram.init",(function(){n._fire("init")})),e.on("attach",(function(){t&&t.bindTo&&n.bind(t.bindTo)})),e.on("detach",(function(){n.unbind()}))}ch.$inject=["config.keyboard","eventBus"],ch.prototype._keydownHandler=function(t){this._keyHandler(t,"keyboard.keydown")},ch.prototype._keyupHandler=function(t){this._keyHandler(t,"keyboard.keyup")},ch.prototype._keyHandler=function(t,e){if(!function(t){return t&&(Qo(t,"input, textarea")||"true"===t.contentEditable)}(t.target)){var n={keyEvent:t};this._eventBus.fire(e||"keyboard.keydown",n)&&t.preventDefault()}},ch.prototype.bind=function(t){this.unbind(),this._node=t,Wo.bind(t,"keydown",this._keydownHandler,!0),Wo.bind(t,"keyup",this._keyupHandler,!0),this._fire("bind")},ch.prototype.getBinding=function(){return this._node},ch.prototype.unbind=function(){var t=this._node;t&&(this._fire("unbind"),Wo.unbind(t,"keydown",this._keydownHandler,!0),Wo.unbind(t,"keyup",this._keyupHandler,!0)),this._node=null},ch.prototype._fire=function(t){this._eventBus.fire("keyboard."+t,{node:this._node})},ch.prototype.addListener=function(t,e,n){to(t)&&(n=e,e=t,t=1e3),this._eventBus.on(n||"keyboard.keydown",t,e)},ch.prototype.removeListener=function(t,e){this._eventBus.off(e||"keyboard.keydown",t)},ch.prototype.hasModifier=function(t){return t.ctrlKey||t.metaKey||t.shiftKey||t.altKey},ch.prototype.isCmd=oh,ch.prototype.isShift=sh,ch.prototype.isKey=ah;var lh=500;function uh(t,e){var n=this;t.on("editorActions.init",lh,(function(t){var i=t.editorActions;n.registerBindings(e,i)}))}uh.$inject=["eventBus","keyboard"],uh.prototype.registerBindings=function(t,e){function n(n,i){e.isRegistered(n)&&t.addListener(i)}n("undo",(function(t){var n=t.keyEvent;if(oh(n)&&!sh(n)&&ah(["z","Z"],n))return e.trigger("undo"),!0})),n("redo",(function(t){var n=t.keyEvent;if(oh(n)&&(ah(["y","Y"],n)||ah(["z","Z"],n)&&sh(n)))return e.trigger("redo"),!0})),n("copy",(function(t){var n=t.keyEvent;if(oh(n)&&ah(["c","C"],n))return e.trigger("copy"),!0})),n("paste",(function(t){var n=t.keyEvent;if(oh(n)&&ah(["v","V"],n))return e.trigger("paste"),!0})),n("stepZoom",(function(t){var n=t.keyEvent;if(ah(["+","Add"],n)&&oh(n))return e.trigger("stepZoom",{value:1}),!0})),n("stepZoom",(function(t){var n=t.keyEvent;if(ah(["-","Subtract"],n)&&oh(n))return e.trigger("stepZoom",{value:-1}),!0})),n("zoom",(function(t){var n=t.keyEvent;if(ah("0",n)&&oh(n))return e.trigger("zoom",{value:1}),!0})),n("removeSelection",(function(t){if(ah(["Delete","Del"],t.keyEvent))return e.trigger("removeSelection"),!0}))};var hh={__init__:["keyboard","keyboardBindings"],keyboard:["type",ch],keyboardBindings:["type",uh]},ph={moveSpeed:50,moveSpeedAccelerated:200};function dh(t,e,n){var i=this;this._config=ko({},ph,t||{}),e.addListener((function(t){var n=t.keyEvent,r=i._config;if(!e.isCmd(n))return;if(e.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],n)){var o,a=e.isShift(n)?r.moveSpeedAccelerated:r.moveSpeed;switch(n.key){case"ArrowLeft":case"Left":o="left";break;case"ArrowUp":case"Up":o="up";break;case"ArrowRight":case"Right":o="right";break;case"ArrowDown":case"Down":o="down"}return i.moveCanvas({speed:a,direction:o}),!0}})),this.moveCanvas=function(t){var e=0,i=0,r=t.speed/Math.min(Math.sqrt(n.viewbox().scale),1);switch(t.direction){case"left":e=r;break;case"up":i=r;break;case"right":e=-r;break;case"down":i=-r}n.scroll({dx:e,dy:i})}}dh.$inject=["config.keyboardMove","keyboard","canvas"];var fh={__depends__:[hh],__init__:["keyboardMove"],keyboardMove:["type",dh]},mh=/^djs-cursor-.*$/;function vh(t){var e=Do(document.body);e.removeMatching(mh),t&&e.add("djs-cursor-"+t)}function yh(){vh(null)}var gh=5e3;function bh(t,e){function n(){return!1}return e=e||"element.click",t.once(e,gh,n),function(){t.off(e,n)}}function _h(t){return{x:t.x+t.width/2,y:t.y+t.height/2}}function wh(t,e){return{x:t.x-e.x,y:t.y-e.y}}var xh=15;function Eh(t,e){var n;function i(i){var r,o=n.start,a=Ou(i),s=wh(a,o);(!n.dragging&&(r=s,Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2))>xh)&&(n.dragging=!0,bh(t),vh("grab")),n.dragging)&&(s=wh(a,n.last||n.start),e.scroll({dx:s.x,dy:s.y}),n.last=a);i.preventDefault()}function r(t){Wo.unbind(document,"mousemove",i),Wo.unbind(document,"mouseup",r),n=null,yh()}t.on("element.mousedown",500,(function(t){return function(t){if(Go(t.target,".djs-draggable"))return;if(t.button||t.ctrlKey||t.shiftKey||t.altKey)return;return n={start:Ou(t)},Wo.bind(document,"mousemove",i),Wo.bind(document,"mouseup",r),!0}(t.originalEvent)}))}Eh.$inject=["eventBus","canvas"];var Sh={__init__:["moveCanvas"],moveCanvas:["type",Eh]};function Ch(t){return Math.log(t)/Math.log(10)}function kh(t,e){var n=Ch(t.min),i=Ch(t.max);return(Math.abs(n)+Math.abs(i))/e}var Ph=Math.sign||function(t){return t>=0?1:-1},Th={min:.2,max:4},Oh=.75;function Ah(t,e,n){t=t||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=So(this._handleWheel,this),this._totalDelta=0,this._scale=t.scale||Oh;var i=this;e.on("canvas.init",(function(e){i._init(!1!==t.enabled)}))}Ah.$inject=["config.zoomScroll","eventBus","canvas"],Ah.prototype.scroll=function(t){this._canvas.scroll(t)},Ah.prototype.reset=function(){this._canvas.zoom("fit-viewport")},Ah.prototype.zoom=function(t,e){var n=kh(Th,20);this._totalDelta+=t,Math.abs(this._totalDelta)>.1&&(this._zoom(t,e,n),this._totalDelta=0)},Ah.prototype._handleWheel=function(t){if(!Go(t.target,".djs-scrollable",!0)){var e=this._container;t.preventDefault();var n,i=t.ctrlKey,r=t.shiftKey,o=-1*this._scale;if(o*=i?0===t.deltaMode?.02:.32:0===t.deltaMode?1:16,i){var a=e.getBoundingClientRect(),s={x:t.clientX-a.left,y:t.clientY-a.top};n=Math.sqrt(Math.pow(t.deltaY,2)+Math.pow(t.deltaX,2))*Ph(t.deltaY)*o,this.zoom(n,s)}else n=r?{dx:o*t.deltaY,dy:0}:{dx:o*t.deltaX,dy:o*t.deltaY},this.scroll(n)}},Ah.prototype.stepZoom=function(t,e){var n=kh(Th,10);this._zoom(t,e,n)},Ah.prototype._zoom=function(t,e,n){var i=this._canvas,r=t>0?1:-1,o=Ch(i.zoom()),a=Math.round(o/n)*n;a+=n*r;var s,c,l=Math.pow(10,a);i.zoom((s=Th,c=l,Math.max(s.min,Math.min(s.max,c))),e)},Ah.prototype.toggle=function(t){var e=this._container,n=this._handleWheel,i=this._enabled;return void 0===t&&(t=!i),i!==t&&Wo[t?"bind":"unbind"](e,"wheel",n,!1),this._enabled=t,t},Ah.prototype._init=function(t){this.toggle(t)};var Mh={__init__:["zoomScroll"],zoomScroll:["type",Ah]};function jh(t){rh.call(this,t)}Ka()(jh,rh),jh.prototype._navigationModules=[fh,Sh,Mh],jh.prototype._modules=[].concat(jh.prototype._modules,jh.prototype._navigationModules);var Rh=n(9),Dh=n.n(Rh),Nh=.2,Ih=4,Lh=["mousedown","mouseup","mouseover","mouseout","click","dblclick"];function Bh(t,e){return e.get(t,!1)}function Fh(t){t.preventDefault(),t.stopPropagation(),"function"==typeof t.stopImmediatePropagation&&t.stopImmediatePropagation()}function zh(t){function e(e){setTimeout((function(){oo(Lh,(function(e){Wo.unbind(t,e,Fh,!0)}))}),500)}Wo.bind(t,"touchstart",(function(e){oo(Lh,(function(e){Wo.bind(t,e,Fh,!0)}))}),!0),Wo.bind(t,"touchend",e,!0),Wo.bind(t,"touchcancel",e,!0);var n=new Dh.a.Manager(t,{inputClass:Dh.a.TouchInput,recognizers:[]}),i=new Dh.a.Tap,r=new Dh.a.Pan({threshold:10}),o=new Dh.a.Press,a=new Dh.a.Pinch,s=new Dh.a.Tap({event:"doubletap",taps:2});return a.requireFailure(r),a.requireFailure(o),n.add([r,o,a,s,i]),n.reset=function(t){var e=this.recognizers,i=this.session;i.stopped||(n.stop(t),setTimeout((function(){var t,n;for(t=0;n=e[t];t++)n.reset(),n.state=8;i.curRecognizer=null}),0))},n.on("hammer.input",(function(t){t.srcEvent.defaultPrevented&&n.reset(!0)})),n}function Gh(t,e,n,i,r){var o,a=Bh("dragging",t),s=Bh("move",t),c=Bh("contextPad",t),l=Bh("palette",t);function u(t){return function(e){r.fire(t,e)}}function h(t){return Go(t,"svg, .djs-element",!0)}function p(t){function n(t){var n=h(t.target),r=n&&i.get(n);if(s&&e.getRootElement()!==r)return s.start(t,r,!0);!function(t){var n=0,i=0;function r(t){var r=t.deltaX-n,o=t.deltaY-i;e.scroll({dx:r,dy:o}),n=t.deltaX,i=t.deltaY}function a(t){o.off("panmove",r),o.off("panend",a),o.off("pancancel",a)}o.on("panmove",r),o.on("panend",a),o.on("pancancel",a)}()}(o=zh(t)).on("doubletap",u("element.dblclick")),o.on("tap",u("element.click")),o.on("panstart",n),o.on("press",n),o.on("pinchstart",(function(t){var n=e.zoom(),i=t.center;function r(t){var r=1-(1-t.scale)/1.5,o=Math.max(Nh,Math.min(Ih,r*n));e.zoom(o,i),Fh(t)}function a(t){o.off("pinchmove",r),o.off("pinchend",a),o.off("pinchcancel",a),o.reset(!0)}o.on("pinchmove",r),o.on("pinchend",a),o.on("pinchcancel",a)}))}a&&n.on("drag.move",(function(t){var e=t.originalEvent;if(e&&!(e instanceof MouseEvent)){var n=Ou(e),r=h(document.elementFromPoint(n.x,n.y)),o=r&&i.get(r);o!==t.hover&&(t.hover&&a.out(t),o&&(a.hover({element:o,gfx:r}),t.hover=o,t.hoverGfx=r))}})),c&&n.on("contextPad.create",(function(t){var e=zh(t.pad.html);e.on("panstart",(function(t){c.trigger("dragstart",t,!0)})),e.on("press",(function(t){c.trigger("dragstart",t,!0)})),e.on("tap",(function(t){c.trigger("click",t)}))})),l&&n.on("palette.create",(function(t){var e=zh(t.container);e.on("panstart",(function(t){l.trigger("dragstart",t,!0)})),e.on("press",(function(t){l.trigger("dragstart",t,!0)})),e.on("tap",(function(t){l.trigger("click",t)}))})),n.on("canvas.init",(function(t){p(t.svg)}))}function Vh(t,e){var n=this;e.on("canvas.init",(function(t){n.addBBoxMarker(t.svg)}))}Gh.$inject=["injector","canvas","eventBus","elementRegistry","interactionEvents","touchFix"],Vh.$inject=["canvas","eventBus"],Vh.prototype.addBBoxMarker=function(t){var e={fill:"none",class:"outer-bound-marker"},n=xa("rect");la(n,{x:-1e4,y:1e4,width:10,height:10}),la(n,e),oa(t,n);var i=xa("rect");la(i,{x:1e4,y:1e4,width:10,height:10}),la(i,e),oa(t,i)};var Hh={__depends__:[{__depends__:[Nu],__init__:["touchInteractionEvents"],touchInteractionEvents:["type",Gh],touchFix:["type",Vh]}]};function Uh(t){return t&&t[t.length-1]}function Wh(t){return t.y}function $h(t){return t.x}var qh={left:$h,center:$h,right:function(t){return t.x+t.width},top:Wh,middle:Wh,bottom:function(t){return t.y+t.height}};function Kh(t){this._modeling=t}Kh.$inject=["modeling"],Kh.prototype._getOrientationDetails=function(t){var e="x",n="width";return-1!==["top","bottom","middle"].indexOf(t)&&(e="y",n="height"),{axis:e,dimension:n}},Kh.prototype._isType=function(t,e){return-1!==e.indexOf(t)},Kh.prototype._alignmentPosition=function(t,e){var n,i,r,o=this._getOrientationDetails(t),a=o.axis,s=o.dimension,c={},l={},u=!1;if(this._isType(t,["left","top"]))c[t]=e[0][a];else if(this._isType(t,["right","bottom"]))r=Uh(e),c[t]=r[a]+r[s];else if(this._isType(t,["center","middle"])){if(oo(e,(function(t){var e=t[a]+Math.round(t[s]/2);l[e]?l[e].elements.push(t):l[e]={elements:[t],center:e}})),n=yo(l,(function(t){return t.elements.length>1&&(u=!0),t.elements.length})),u)return c[t]=Uh(n).center,c;i=e[0],r=Uh(e=yo(e,(function(t){return t[a]+t[s]}))),c[t]=function(t,e){return Math.round((t[a]+e[a]+e[s])/2)}(i,r)}return c},Kh.prototype.trigger=function(t,e){var n=this._modeling,i=yo(ro(t,(function(t){return!(t.waypoints||t.host||t.labelTarget)})),qh[e]),r=this._alignmentPosition(e,i);n.alignElements(i,r)};var Yh={__init__:["alignElements"],alignElements:["type",Kh]};function Xh(t,e){return lo(e,(function(e){return vl(t,e)}))}function Zh(t,e){for("string"==typeof e&&(e=[e]);t=t.parent;)if(Xh(t,e))return t;return null}var Jh=50,Qh=250,tp=10;function ep(t,e){return vl(e,"bpmn:TextAnnotation")?function(t,e){var n=mu(t),i={x:n.right+e.width/2,y:n.top-50-e.height/2};return ip(t,e,i,{y:{margin:-30,rowSize:20}})}(t,e):Xh(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])?function(t,e){var n=mu(t),i={x:n.right-10+e.width/2,y:n.bottom+40+e.width/2};return ip(t,e,i,{x:{margin:30,rowSize:30}})}(t,e):vl(e,"bpmn:FlowNode")?function(t,e){var n=mu(t),i=yu(t),r=function(t,e){var n=mu(t);function i(t){return vl(t,"bpmn:SequenceFlow")}var r=so([].concat(sp(t,i).map((a=5,function(t){return{shape:t,weight:a,distanceTo:function(t){return mu(t).left-n.right}}})),ap(t,i).map(function(t){return function(e){return{shape:e,weight:t,distanceTo:function(t){var e=mu(t);return n.left-e.right}}}}(1))),(function(t,e){return t[e.shape.id+"__weight_"+e.weight]=e,t}),{}),o=so(r,(function(t,e){var n,i,r,o=e.shape,a=e.weight,s=e.distanceTo,c=t.fav;return(n=s(o))<0||n>Qh?t:(i=(r=t[String(n)]=t[String(n)]||{value:n,count:0}).count+=1*a,(!c||c.count<i)&&(t.fav=r),t)}),{});var a;return o.fav?o.fav.value:Jh}(t),o="left",a=80,s=30;vl(t,"bpmn:BoundaryEvent")&&-1!==(o=gu(t,t.host,-25)).indexOf("top")&&(s*=-1);var c={x:n.right+r+e.width/2,y:i.y+(l=o,-1!=l.indexOf("top")?-1*a:-1!=l.indexOf("bottom")?a:0)};var l;return ip(t,e,c,{y:{margin:s,rowSize:a}})}(t,e):function(t,e){var n=mu(t),i=yu(t);return{x:n.right+Jh+e.width/2,y:i.y}}(t,e)}function np(t,e,n){var i={x:e.x-n.width/2,y:e.y-n.height/2,width:n.width,height:n.height};return io(function(t,e){var n=op(t);return t.host&&(n=n.concat(op(t.host))),t.attachers&&(n=n.concat(t.attachers.reduce((function(t,e){return t.concat(op(e))}),[]))),n}(t),(function(t){return t!==n&&"intersect"===gu(t,i,tp)}))}function ip(t,e,n,i){function r(t){var r={x:n.x,y:n.y};return["x","y"].forEach((function(a){var s=i[a];if(s){var c="x"===a?"width":"height",l=s.margin,u=s.rowSize;r[a]=l<0?Math.min(t[a]+l-e[c]/2,n[a]-u+l):Math.max(o[a]+o[c]+l+e[c]/2,n[a]+u+l)}})),r}for(var o;o=np(t,n,e);)n=r(o);return n}function rp(){return!0}function op(t,e){return[].concat(sp(t,e),ap(t,e))}function ap(t,e){return e||(e=rp),t.incoming.filter(e).map((function(t){return t.source}))}function sp(t,e){return e||(e=rp),t.outgoing.filter(e).map((function(t){return t.target}))}function cp(t,e){function n(e,n){return t.fire(e,n)}this.append=function(t,i){n("autoPlace.start",{source:t,shape:i});var r=n("autoPlace",{source:t,shape:i});r||(r=ep(t,i));var o=e.appendShape(t,i,r,t.parent);return n("autoPlace.end",{source:t,shape:o}),o}}function lp(t,e){t.on("autoPlace.end",500,(function(t){e.select(t.shape)}))}cp.$inject=["eventBus","modeling"],lp.$inject=["eventBus","selection"];var up={__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",cp],autoPlaceSelectionBehavior:["type",lp]};function hp(t){this._eventBus=t}hp.$inject=["eventBus"],hp.prototype.on=function(t,e,n,i,r,o){if((to(e)||Qr(e))&&(o=r,r=i,i=n,n=e,e=null),to(n)&&(o=r,r=i,i=n,n=1e3),Jr(r)&&(o=r,r=!1),!to(i))throw new Error("handlerFn must be a function");Zr(t)||(t=[t]);var a=this._eventBus;oo(t,(function(t){var s=["commandStack",t,e].filter((function(t){return t})).join(".");a.on(s,n,r?function(t,e){return function(n){return t.call(e||null,n.context,n.command,n)}}(i,o):i,o)}))};function pp(t,e,n,i){hp.call(this,t),this._elementRegistry=e,this._modeling=n,this._rules=i;var r=this;this.postExecuted(["shape.create"],(function(t){var e=t.context,n=e.hints||{},i=e.shape,o=e.parent||e.newParent;!1!==n.autoResize&&r._expand([i],o)})),this.postExecuted(["elements.move"],(function(t){var e=t.context,n=$r(po(e.closure.topLevel)),i=e.hints,o=!i||i.autoResize;!1!==o&&oo(fo(n,(function(t){return t.parent.id})),(function(t,e){Zr(o)&&(t=t.filter((function(t){return io(o,go({id:t.id}))}))),r._expand(t,e)}))})),this.postExecuted(["shape.toggleCollapse"],(function(t){var e=t.context,n=e.hints,i=e.shape;n&&!1===n.autoResize||i.collapsed||r._expand(i.children||[],i)})),this.postExecuted(["shape.resize"],(function(t){var e=t.context,n=e.hints,i=e.shape,o=i.parent;n&&!1===n.autoResize||o&&r._expand([i],o)}))}function dp(t){t.invoke(pp,this)}function fp(t){hp.call(this,t),this.init()}function mp(t){fp.call(this,t);var e=this;this.addRule("element.autoResize",(function(t){return e.canResize(t.elements,t.target)}))}function vp(t,e){mp.call(this,t),this._modeling=e}oo(["canExecute","preExecute","preExecuted","execute","executed","postExecute","postExecuted","revert","reverted"],(function(t){hp.prototype[t]=function(e,n,i,r,o){(to(e)||Qr(e))&&(o=r,r=i,i=n,n=e,e=null),this.on(e,t,n,i,r,o)}})),pp.$inject=["eventBus","elementRegistry","modeling","rules"],Ka()(pp,hp),pp.prototype._getOptimalBounds=function(t,e){var n=this.getOffset(e),i=this.getPadding(e),r=mu(os(t)),o=mu(e),a={};return r.top-o.top<i.top&&(a.top=r.top-n.top),r.left-o.left<i.left&&(a.left=r.left-n.left),o.right-r.right<i.right&&(a.right=r.right+n.right),o.bottom-r.bottom<i.bottom&&(a.bottom=r.bottom+n.bottom),vu(ko({},o,a))},pp.prototype._expand=function(t,e){if("string"==typeof e&&(e=this._elementRegistry.get(e)),this._rules.allowed("element.autoResize",{elements:t,target:e})){var n=this._getOptimalBounds(t,e);if(function(t,e){return t.x!==e.x||t.y!==e.y||t.width!==e.width||t.height!==e.height}(n,e)){var i=function(t,e){var n="";t=mu(t),e=mu(e),t.top>e.top&&(n=n.concat("n"));t.right<e.right&&(n=n.concat("w"));t.bottom<e.bottom&&(n=n.concat("s"));t.left>e.left&&(n=n.concat("e"));return n}(Po(e,["x","y","width","height"]),n);this.resize(e,n,{autoResize:i});var r=e.parent;r&&this._expand([e],r)}}},pp.prototype.getOffset=function(t){return{top:60,bottom:60,left:100,right:100}},pp.prototype.getPadding=function(t){return{top:2,bottom:2,left:15,right:15}},pp.prototype.resize=function(t,e,n){this._modeling.resizeShape(t,e,null,n)},dp.$inject=["injector"],Ka()(dp,pp),dp.prototype.resize=function(t,e,n){vl(t,"bpmn:Participant")?this._modeling.resizeLane(t,e,null,n):this._modeling.resizeShape(t,e,null,n)},fp.$inject=["eventBus"],Ka()(fp,hp),fp.prototype.addRule=function(t,e,n){var i=this;"string"==typeof t&&(t=[t]),t.forEach((function(t){i.canExecute(t,e,(function(t,e,i){return n(t)}),!0)}))},fp.prototype.init=function(){},mp.$inject=["eventBus"],Ka()(mp,fp),mp.prototype.canResize=function(t,e){return!1},Ka()(vp,mp),vp.$inject=["eventBus","modeling"],vp.prototype.canResize=function(t,e){if(!vl(e,"bpmn:Participant")&&!vl(e,"bpmn:Lane")&&!vl(e,"bpmn:SubProcess"))return!1;var n=!0;return oo(t,(function(t){(vl(t,"bpmn:Lane")||t.labelTarget)&&(n=!1)})),n};var yp={__init__:["bpmnAutoResize","bpmnAutoResizeProvider"],bpmnAutoResize:["type",dp],bpmnAutoResizeProvider:["type",vp]},gp=Math.round,bp="djs-drag-active";function _p(t){t.preventDefault()}function wp(t,e,n,i){var r,o={threshold:5,trapClick:!0};function a(t){var n=e.viewbox(),i=e._container.getBoundingClientRect();return{x:n.x+(t.x-i.left)/n.scale,y:n.y+(t.y-i.top)/n.scale}}function s(e,n){n=n||r;var i=t.createEvent(ko({},n.payload,n.data,{isTouch:n.isTouch}));return!1!==t.fire("drag."+e,i)&&t.fire(n.prefix+"."+e,i)}function c(t,i){var o,c=r.payload,l=r.displacement,u=r.globalStart,h=Ou(t),p=wh(h,u),d=r.localStart,f=a(h),v=wh(f,d);if(!r.active&&(i||(o=p,Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2))>r.threshold))){if(ko(c,{x:gp(d.x+l.x),y:gp(d.y+l.y),dx:0,dy:0},{originalEvent:t}),!1===s("start"))return m();r.active=!0,r.keepSelection||(c.previousSelection=n.get(),n.select(null)),r.cursor&&vh(r.cursor),e.addMarker(e.getRootElement(),bp)}Tu(t),r.active&&(ko(c,{x:gp(f.x+l.x),y:gp(f.y+l.y),dx:gp(v.x),dy:gp(v.y)},{originalEvent:t}),s("move"))}function l(t){var e=!0;r.active&&(t&&(r.payload.originalEvent=t,Tu(t)),e=s("end")),!1===e&&s("rejected"),s("ended",v(!0!==e))}function u(t){27===t.which&&(_p(t),m())}function h(e){var n;r.active&&(n=bh(t),setTimeout(n,400),_p(e)),l(e)}function p(t){c(t)}function d(t){var e=r.payload;e.hoverGfx=t.gfx,e.hover=t.element,s("hover")}function f(t){s("out");var e=r.payload;e.hoverGfx=null,e.hover=null}function m(t){var e;if(r){var n=r.active;n&&s("cancel"),e=v(t),n&&s("canceled",e)}}function v(o){var a,v;s("cleanup"),yh(),v=r.trapClick?h:l,Wo.unbind(document,"mousemove",c),Wo.unbind(document,"dragstart",_p),Wo.unbind(document,"selectstart",_p),Wo.unbind(document,"mousedown",v,!0),Wo.unbind(document,"mouseup",v,!0),Wo.unbind(document,"keyup",u),Wo.unbind(document,"touchstart",p,!0),Wo.unbind(document,"touchcancel",m,!0),Wo.unbind(document,"touchmove",c,!0),Wo.unbind(document,"touchend",l,!0),t.off("element.hover",d),t.off("element.out",f),e.removeMarker(e.getRootElement(),bp);var y=r.payload.previousSelection;return!1!==o&&y&&!n.get().length&&function(t){var e=t.filter((function(t){return i.get(t.id)}));e.length&&n.select(e)}(y),a=r,r=null,a}t.on("diagram.destroy",m),this.init=function(e,n,i,v){r&&m(!1),"string"==typeof n&&(v=i,i=n,n=null);var y,g,b,_,w,x=(v=ko({},o,v||{})).data||{};_=v.trapClick?h:l,e?(y=Pu(e)||e,g=Ou(e),Tu(e),"dragstart"===y.type&&_p(y)):(y=null,g={x:0,y:0}),b=a(g),n||(n=b),w=function(t){return"undefined"!=typeof TouchEvent&&t instanceof TouchEvent}(y),r=ko({prefix:i,data:x,payload:{},globalStart:g,displacement:wh(n,b),localStart:b,isTouch:w},v),v.manual||(w?(Wo.bind(document,"touchstart",p,!0),Wo.bind(document,"touchcancel",m,!0),Wo.bind(document,"touchmove",c,!0),Wo.bind(document,"touchend",l,!0)):(Wo.bind(document,"mousemove",c),Wo.bind(document,"dragstart",_p),Wo.bind(document,"selectstart",_p),Wo.bind(document,"mousedown",_,!0),Wo.bind(document,"mouseup",_,!0)),Wo.bind(document,"keyup",u),t.on("element.hover",d),t.on("element.out",f)),s("init"),v.autoActivate&&c(e,!0)},this.move=c,this.hover=d,this.out=f,this.end=l,this.cancel=m,this.context=function(){return r},this.setOptions=function(t){ko(o,t)}}wp.$inject=["eventBus","canvas","selection","elementRegistry"];var xp=1500;function Ep(t,e,n){var i=this;t.on("drag.start",(function(r){t.once("drag.move",xp,(function(t){!function(t){if(!t.hover){var r=t.originalEvent,o=i._findTargetGfx(r),a=o&&n.get(o);o&&a&&(t.stopPropagation(),e.hover({element:a,gfx:o}),e.move(r))}}(t)}))})),t.on("drag.init",(function(){var n,i;function r(t){n=t.hover,i=t.hoverGfx}function o(){n=null,i=null}function a(){if(n){var t=n,r=i;n=null,i=null,e.out({element:t,gfx:r})}}t.on("drag.hover",r),t.on("element.out",o),t.on("element.hover",xp,a),t.once("drag.cleanup",(function(){t.off("drag.hover",r),t.off("element.out",o),t.off("element.hover",a)}))})),this._findTargetGfx=function(t){var e;if(t instanceof MouseEvent)return e=Ou(t),function(t){return Go(t,"svg, .djs-element",!0)}(document.elementFromPoint(e.x,e.y))}}Ep.$inject=["eventBus","dragging","elementRegistry"];var Sp={__init__:["hoverFix"],__depends__:[Uu],dragging:["type",wp],hoverFix:["type",Ep]};function Cp(t,e,n){this._canvas=n,this._opts=ko({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},t);var i=this;e.on("drag.move",(function(t){var e=i._toBorderPoint(t);i.startScroll(e)})),e.on(["drag.cleanup"],(function(){i.stopScroll()}))}function kp(t,e,n){return e<t&&t<n}Cp.$inject=["config.autoScroll","eventBus","canvas"],Cp.prototype.startScroll=function(t){var e=this._canvas,n=this._opts,i=this,r=e.getContainer().getBoundingClientRect(),o=[t.x,t.y,r.width-t.x,r.height-t.y];this.stopScroll();for(var a=0,s=0,c=0;c<4;c++)kp(o[c],n.scrollThresholdOut[c],n.scrollThresholdIn[c])&&(0===c?a=n.scrollStep:1==c?s=n.scrollStep:2==c?a=-n.scrollStep:3==c&&(s=-n.scrollStep));0===a&&0===s||(e.scroll({dx:a,dy:s}),this._scrolling=setTimeout((function(){i.startScroll(t)}),n.scrollRepeatTimeout))},Cp.prototype.stopScroll=function(){clearTimeout(this._scrolling)},Cp.prototype.setOptions=function(t){this._opts=ko({},this._opts,t)},Cp.prototype._toBorderPoint=function(t){var e=this._canvas._container.getBoundingClientRect(),n=Ou(t.originalEvent);return{x:n.x-e.left,y:n.y-e.top}};var Pp={__depends__:[Sp],__init__:["autoScroll"],autoScroll:["type",Cp]};function Tp(t){this._commandStack=t.get("commandStack",!1)}Tp.$inject=["injector"],Tp.prototype.allowed=function(t,e){var n=!0,i=this._commandStack;return i&&(n=i.canExecute(t,e)),void 0===n||n};var Op={__init__:["rules"],rules:["type",Tp]},Ap=Math.round,Mp=Math.max;var jp=10;function Rp(t,e){return function(t,e){var n,i;for(n=0;i=t[n];n++)if(ou(i,e)<=jp)return{point:t[n],bendpoint:!0,index:n};return null}(t,e)||function(t,e){var n,i,r,o,a=pu()((r=jp,[["M",(i=e).x,i.y],["m",0,-r],["a",r,r,0,1,1,0,2*r],["a",r,r,0,1,1,0,-2*r],["z"]]),(n=[],t.forEach((function(t,e){n.push([0===e?"M":"L",t.x,t.y])})),n)),s=a[0],c=a[a.length-1];return s?s!==c?s.segment2!==c.segment2?{point:t[o=Mp(s.segment2,c.segment2)-1],bendpoint:!0,index:o}:{point:{x:Ap(s.x+c.x)/2,y:Ap(s.y+c.y)/2},index:s.segment2}:{point:{x:Ap(s.x),y:Ap(s.y)},index:s.segment2}:null}(t,e)}var Dp="djs-bendpoint",Np="djs-segment-dragger";function Ip(t,e,n){return Rp(e,function(t,e){var n,i=Ou(e),r=t._container.getBoundingClientRect();n={x:r.left,y:r.top};var o=t.viewbox();return{x:o.x+(i.x-n.x)/o.scale,y:o.y+(i.y-n.y)/o.scale}}(t,n))}function Lp(t,e){var n=xa("g");fa(n).add(Dp),oa(t,n);var i=xa("circle");la(i,{cx:0,cy:0,r:4}),fa(i).add("djs-visual"),oa(n,i);var r=xa("circle");return la(r,{cx:0,cy:0,r:10}),fa(r).add("djs-hit"),oa(n,r),e&&fa(n).add(e),n}function Bp(t,e,n,i){var r=xa("g");oa(t,r);var o=function(t,e,n){var i=e.x-t.x,r=e.y-t.y;return zp("h"===n?i:r)}(e,n,i),a=xa("rect");la(a,{x:-7,y:-1.5,width:14,height:3}),fa(a).add("djs-visual"),oa(r,a);var s=xa("rect");return la(s,{x:-o/2,y:-4.5,width:o,height:9}),fa(s).add("djs-hit"),oa(r,s),Hs(r,"v"===i?90:0),r}function Fp(t,e,n){var i=xa("g"),r=uu(e,n),o=cu(e,n);return oa(t,i),Bp(i,e,n,o),fa(i).add(Np),fa(i).add("h"===o?"horizontal":"vertical"),Vs(i,r.x,r.y),i}function zp(t){return Math.abs(Math.round(2*t/3))}var Gp=n(12),Vp=n.n(Gp),Hp={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Up(t){return(t=""+t)&&t.replace(/[&<>"']/g,(function(t){return Hp[t]}))}function Wp(t,e,n,i,r){function o(t,n){var o=n.waypoints,a=Ip(e,o,t);if(a)return!function(t,e,n){var i,r,o,a,s,c,l=t.index,u=t.point;return!(l<=0||t.bendpoint)&&(o=uu(i=e[l-1],r=e[l]),a=cu(i,r),s=Math.abs(u.x-o.x),c=Math.abs(u.y-o.y),a&&s<=n&&c<=n)}(a,o,function(t,e){var n,i,r=t.waypoints;return e.index<=0||e.bendpoint?null:(i=cu((n={start:r[e.index-1],end:r[e.index]}).start,n.end))?zp("h"===i?n.end.x-n.start.x:n.end.y-n.start.y)/2:null}(n,a))?i.start(t,n,a.index,!a.bendpoint):r.start(t,n,a.index),!0}function a(t,e,i){Wo.bind(t,e,(function(t){n.triggerMouseEvent(e,t,i),t.stopPropagation()}))}function s(t,n){var i=e.getLayer("overlays"),r=ta('.djs-bendpoints[data-element-id="'+Vp()(t.id)+'"]',i);return!r&&n&&(la(r=xa("g"),{"data-element-id":t.id}),fa(r).add("djs-bendpoints"),oa(i,r),a(r,"mousedown",t),a(r,"click",t),a(r,"dblclick",t)),r}function c(t,e){return ta('.djs-segment-dragger[data-segment-idx="'+t+'"]',e)}function l(t,e){e.waypoints.forEach((function(e,n){var i=Lp(t);oa(t,i),Vs(i,e.x,e.y)})),Lp(t,"floating")}function u(t,e){for(var n,i,r,o=e.waypoints,s=1;s<o.length;s++)cu(n=o[s-1],i=o[s])&&(la(r=Fp(t,n,i),{"data-segment-idx":s}),a(r,"mousemove",e))}function h(t){var e=s(t);return e||(l(e=s(t,!0),t),u(e,t)),e}function p(t){var e=s(t);e&&(!function(t){oo(ea("."+Np,t),(function(t){va(t)}))}(e),function(t){oo(ea("."+Dp,t),(function(t){va(t)}))}(e),u(e,t),l(e,t))}function d(t,e,n){var i,r,o=c(e.index,t),a=n[e.index-1],s=n[e.index],l=e.point,u=uu(a,s),h=cu(a,s);o&&(i=function(t){return ta(".djs-visual",t)}(o),r={x:l.x-u.x,y:l.y-u.y},"v"===h&&(r={x:r.y,y:r.x}),Vs(i,r.x,r.y))}t.on("connection.changed",(function(t){p(t.element)})),t.on("connection.remove",(function(t){var e=s(t.element);e&&va(e)})),t.on("element.marker.update",(function(t){var e,n=t.element;n.waypoints&&(e=h(n),t.add?fa(e).add(t.marker):fa(e).remove(t.marker))})),t.on("element.mousemove",(function(t){var n,i,r=t.element,o=r.waypoints;if(o){if(n=s(r,!0),!(i=Ip(e,o,t.originalEvent)))return;!function(t,e){var n=ta(".floating",t),i=e.point;n&&Vs(n,i.x,i.y)}(n,i),i.bendpoint||d(n,i,o)}})),t.on("element.mousedown",(function(t){var e=t.originalEvent,n=t.element,i=n.waypoints;if(i)return o(e,n)})),t.on("selection.changed",(function(t){var e=t.newSelection[0];e&&e.waypoints&&h(e)})),t.on("element.hover",(function(t){var e=t.element;e.waypoints&&(h(e),n.registerEvent(t.gfx,"mousemove","element.mousemove"))})),t.on("element.out",(function(t){n.unregisterEvent(t.gfx,"mousemove","element.mousemove")})),t.on("element.updateId",(function(t){var e=t.element,n=t.newId;if(e.waypoints){var i=s(e);i&&la(i,{"data-element-id":n})}})),this.addHandles=h,this.updateHandles=p,this.getBendpointsContainer=s,this.getSegmentDragger=c}Wp.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];var $p="connection.updateWaypoints",qp="connection.reconnectStart",Kp="connection.reconnectEnd",Yp=Math.round;function Xp(t,e,n,i,r,o){var a=t.get("connectionDocking",!1);this.start=function(t,e,o,a){var s,c=e.waypoints,l=n.getGraphics(e);!1!==((s={connection:e,bendpointIndex:o,insert:a,type:a||0!==o?a||o!==c.length-1?$p:Kp:qp}).allowed=r.allowed(s.type,s))&&i.init(t,"bendpoint.move",{data:{connection:e,connectionGfx:l,context:s}})},e.on("bendpoint.move.hover",(function(t){var e=t.context;(e.hover=t.hover,t.hover)&&((e.allowed=r.allowed(e.type,e))&&(e.target=e.hover))})),e.on(["bendpoint.move.out","bendpoint.move.cleanup"],(function(t){var e=t.context;e.target=null,e.allowed=!1})),e.on("bendpoint.move.end",(function(t){var e,n,i=t.context,r=i.connection,s=r.waypoints,c=s.slice(),l=i.bendpointIndex,u=i.allowed,h=i.insert;if(e={x:Yp(t.x),y:Yp(t.y)},u&&i.type===qp)o.reconnectStart(i.connection,i.target,e);else if(u&&i.type===Kp)o.reconnectEnd(i.connection,i.target,e);else{if(!1===u||i.type!==$p)return!1;h?c.splice(l,0,e):c[l]=e,n={bendpointMove:{insert:h,bendpointIndex:l}},a&&(r.waypoints=c,r.waypoints=a.getCroppedWaypoints(r),c=r.waypoints,r.waypoints=s),o.updateWaypoints(i.connection,_u(c),n)}}))}Xp.$inject=["injector","eventBus","canvas","dragging","rules","modeling"];var Zp="connect-ok",Jp="connect-not-ok",Qp="connect-hover",td="djs-updating",ed="djs-element-hidden",nd="connection.reconnectStart",id="connection.reconnectEnd",rd=1100;function od(t,e,n){var i=t.get("connectionPreview",!1),r=t.get("connectionDocking",!1);e.on("bendpoint.move.start",(function(t){var e=t.context,i=e.connection,r=i.waypoints,o=r.slice(),a=e.insert,s=e.bendpointIndex;e.originalWaypoints=r,a&&o.splice(s,0,{x:t.x,y:t.y}),i.waypoints=o,e.draggerGfx=Lp(n.getLayer("overlays")),fa(e.draggerGfx).add("djs-dragging"),n.addMarker(i,td),n.addMarker(i,ed)})),e.on("bendpoint.move.hover",(function(t){var e=t.context,i=e.allowed,r=e.hover,o=e.type;if(r){if(n.addMarker(r,Qp),o!==nd&&o!==id)return;i?(n.removeMarker(r,Jp),n.addMarker(r,Zp)):!1===i&&(n.removeMarker(r,Zp),n.addMarker(r,Jp))}})),e.on(["bendpoint.move.out","bendpoint.move.cleanup"],rd,(function(t){var e=t.context.hover;e&&(n.removeMarker(e,Qp),n.removeMarker(e,t.context.target?Zp:Jp))})),e.on("bendpoint.move.move",(function(t){var e,n=t.context,o=n.type,a=t.connection,s=a.waypoints,c=s.slice(),l={x:t.x,y:t.y};i&&(e={source:a.source,target:a.target},o===nd?(e.source=n.target,e.connectionStart=l):o===id?(e.target=n.target,e.connectionEnd=l):(e.noCropping=!0,e.noLayout=!0,c[n.bendpointIndex]=l),r&&(a.waypoints=c,a.waypoints=r.getCroppedWaypoints(a),c=a.waypoints,a.waypoints=s),e.waypoints=_u(c),i.drawPreview(n,n.allowed,e)),Vs(n.draggerGfx,t.x,t.y)})),e.on(["bendpoint.move.end","bendpoint.move.cancel"],rd,(function(t){var e=t.context,r=e.hover,o=e.connection;o.waypoints=e.originalWaypoints,va(e.draggerGfx),n.removeMarker(o,td),n.removeMarker(o,ed),r&&(n.removeMarker(r,Zp),n.removeMarker(r,e.target?Zp:Jp)),i&&i.cleanUp(e)}))}od.$inject=["injector","eventBus","canvas"];var ad="connect-hover",sd="djs-updating";function cd(t,e,n){return ld(t,e,t[e]+n)}function ld(t,e,n){return{x:"x"===e?n:t.x,y:"y"===e?n:t.y}}function ud(t){return"x"===t?"y":"x"}function hd(t,e,n){var i,r;return t.original?t.original:(i=yu(e),ld(t,r=ud(n),i[r]))}function pd(t,e,n,i,r,o){var a=t.get("connectionDocking",!1);function s(t,e){if(!a)return e;var n,i=t.waypoints;return t.waypoints=e,n=a.getCroppedWaypoints(t),t.waypoints=i,n}function c(t){r.update("connection",t.connection,t.connectionGfx)}function l(t,e,n){var i=t.newWaypoints,r=function(t,e,n,i){var r=Math.max(e[i],n[i]),o=Math.min(e[i],n[i]);return ld(e,i,Math.min(Math.max(o+20,t[i]),r-20))}(n,i[t.segmentStartIndex+e],i[t.segmentEndIndex+e],ud(t.axis));Vs(t.draggerGfx,r.x,r.y)}this.start=function(t,e,r){var o,a,s,c,l=n.getGraphics(e),u=r-1,h=r,p=e.waypoints,d=p[u],f=p[h],m=Ip(n,p,t);(a=cu(d,f))&&(s="v"===a?"x":"y",0===u&&(d=hd(d,e.source,s)),h===p.length-1&&(f=hd(f,e.target,s)),o={connection:e,segmentStartIndex:u,segmentEndIndex:h,segmentStart:d,segmentEnd:f,axis:s,dragPosition:c=m?m.point:{x:(d.x+f.x)/2,y:(d.y+f.y)/2}},i.init(t,c,"connectionSegment.move",{cursor:"x"===s?"resize-ew":"resize-ns",data:{connection:e,connectionGfx:l,context:o}}))},e.on("connectionSegment.move.start",(function(t){var e=t.context,i=t.connection,r=n.getLayer("overlays");e.originalWaypoints=i.waypoints.slice(),e.draggerGfx=Fp(r,e.segmentStart,e.segmentEnd),fa(e.draggerGfx).add("djs-dragging"),n.addMarker(i,sd)})),e.on("connectionSegment.move.move",(function(t){var e,n,i=t.context,r=i.connection,o=i.segmentStartIndex,a=i.segmentEndIndex,u=i.segmentStart,h=i.segmentEnd,p=i.axis,d=i.originalWaypoints.slice(),f=cd(u,p,t["d"+p]),m=cd(h,p,t["d"+p]),v=d.length,y=0;d[o]=f,d[a]=m,o<2&&(e=gu(r.source,f),1===o?"intersect"===e&&(d.shift(),d[0]=f,y--):"intersect"!==e&&(d.unshift(u),y++)),a>v-3&&(n=gu(r.target,m),a===v-2?"intersect"===n&&(d.pop(),d[d.length-1]=m):"intersect"!==n&&d.push(h)),i.newWaypoints=r.waypoints=s(r,d),l(i,y,t),i.newSegmentStartIndex=o+y,c(t)})),e.on("connectionSegment.move.hover",(function(t){t.context.hover=t.hover,n.addMarker(t.hover,ad)})),e.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],(function(t){var e=t.context.hover;e&&n.removeMarker(e,ad)})),e.on("connectionSegment.move.cleanup",(function(t){var e=t.context,i=e.connection;e.draggerGfx&&va(e.draggerGfx),n.removeMarker(i,sd)})),e.on(["connectionSegment.move.cancel","connectionSegment.move.end"],(function(t){var e=t.context;e.connection.waypoints=e.originalWaypoints,c(t)})),e.on("connectionSegment.move.end",(function(t){var e=t.context,n=e.connection,i=e.newWaypoints,r=e.newSegmentStartIndex,a=function(t,e){var n=0;return{waypoints:t.filter((function(i,r){return!au(t[r-1],t[r+1],i)||(n=r<=e?n-1:n,!1)})),segmentOffset:n}}(i=i.map((function(t){return{original:t.original,x:Math.round(t.x),y:Math.round(t.y)}})),r),c=s(n,a.waypoints),l=a.segmentOffset,u={segmentMove:{segmentStartIndex:e.segmentStartIndex,newSegmentStartIndex:r+l}};o.updateWaypoints(n,c,u)}))}pd.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"];var dd=Math.abs,fd=Math.round;function md(t){return{x:t.x,y:t.y}}function vd(t){return{x:t.x+t.width,y:t.y+t.height}}function yd(t,e){return!t||isNaN(t.x)||isNaN(t.y)?e:{x:fd(t.x+t.width/2),y:fd(t.y+t.height/2)}}function gd(t,e){var n=t.snapped;return!!n&&("string"==typeof e?n[e]:n.x&&n.y)}function bd(t,e,n){if("string"!=typeof e)throw new Error("axis must be in [x, y]");if("number"!=typeof n&&!1!==n)throw new Error("value must be Number or false");var i,r=t[e],o=t.snapped=t.snapped||{};return!1===n?o[e]=!1:(o[e]=!0,i=n-r,t[e]+=i,t["d"+e]+=i),r}function _d(t){return t.children||[]}var wd=Math.abs,xd=Math.round,Ed=10;function Sd(t){function e(t,e){if(Zr(t)){for(var n=t.length;n--;)if(wd(t[n]-e)<=Ed)return t[n]}else{var i=e%(t=+t);if(i<Ed)return e-i;if(i>t-Ed)return e-i+t}return e}function n(t){if(t.width)return{x:xd(t.width/2+t.x),y:xd(t.height/2+t.y)}}t.on("connectionSegment.move.move",1500,(function(t){var i,r,o=function(t){var e=t.snapPoints,i=t.connection,r=i.waypoints,o=t.segmentStart,a=t.segmentStartIndex,s=t.segmentEnd,c=t.segmentEndIndex,l=t.axis;if(e)return e;var u=[r[a-1],o,s,r[c+1]];return a<2&&u.unshift(n(i.source)),c>r.length-3&&u.unshift(n(i.target)),t.snapPoints=e={horizontal:[],vertical:[]},oo(u,(function(t){t&&(t=t.original||t,"y"===l&&e.horizontal.push(t.y),"x"===l&&e.vertical.push(t.x))})),e}(t.context),a=t.x,s=t.y;if(o){var c=a-(i=e(o.vertical,a)),l=s-(r=e(o.horizontal,s));ko(t,{dx:t.dx-c,dy:t.dy-l,x:i,y:r}),(c||-1!==o.vertical.indexOf(a))&&bd(t,"x",i),(l||-1!==o.horizontal.indexOf(s))&&bd(t,"y",r)}})),t.on(["bendpoint.move.move","bendpoint.move.end"],1500,(function(t){var i,r,o=t.context,a=function(t){var e=t.snapPoints,n=t.connection.waypoints,i=t.bendpointIndex;if(e)return e;var r=[n[i-1],n[i+1]];return t.snapPoints=e={horizontal:[],vertical:[]},oo(r,(function(t){t&&(t=t.original||t,e.horizontal.push(t.y),e.vertical.push(t.x))})),e}(o),s=o.target,c=s&&n(s),l=t.x,u=t.y;if(a){var h=l-(i=e(c?a.vertical.concat([c.x]):a.vertical,l)),p=u-(r=e(c?a.horizontal.concat([c.y]):a.horizontal,u));ko(t,{dx:t.dx-h,dy:t.dy-p,x:t.x-h,y:t.y-p}),(h||-1!==a.vertical.indexOf(l))&&bd(t,"x",i),(p||-1!==a.horizontal.indexOf(u))&&bd(t,"y",r)}}))}Sd.$inject=["eventBus"];var Cd={__depends__:[Sp,Op],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",Wp],bendpointMove:["type",Xp],bendpointMovePreview:["type",od],connectionSegmentMove:["type",pd],bendpointSnapping:["type",Sd]};function kd(t,e,n,i){function r(t,e){return i.allowed("connection.create",{source:t,target:e})}t.on("connect.hover",(function(t){var e=t.context,n=e.source,i=t.hover;null!==(e.canExecute=r(n,i))&&(e.target=i)})),t.on(["connect.out","connect.cleanup"],(function(t){var e=t.context;e.target=null,e.canExecute=!1})),t.on("connect.end",(function(t){var e=t.context,i=e.source,o=e.sourcePosition,a=e.target,s={x:t.x,y:t.y},c=e.canExecute||r(i,a);if(!c)return!1;var l=null,u={connectionStart:o,connectionEnd:s};"object"==typeof c&&(l=c),n.connect(i,a,l,u)})),this.start=function(t,n,i,r){"object"!=typeof i&&(r=i,i=yu(n)),e.init(t,"connect",{autoActivate:r,data:{shape:n,context:{source:n,sourcePosition:i}}})}}kd.$inject=["eventBus","dragging","modeling","rules"];var Pd=1100,Td=900,Od="connect-ok",Ad="connect-not-ok";function Md(t,e,n){var i=t.get("connectionPreview",!1);i&&e.on("connect.move",(function(t){var e=t.context,n=e.source,r=e.target,o=e.canExecute,a={x:t.x,y:t.y};i.drawPreview(e,o,{source:n,target:r,connectionEnd:a})})),e.on("connect.hover",Td,(function(t){var e=t.context,i=t.hover,r=e.canExecute;null!==r&&n.addMarker(i,r?Od:Ad)})),e.on(["connect.out","connect.cleanup"],Pd,(function(t){var e=t.context;e.target&&n.removeMarker(e.target,e.canExecute?Od:Ad)})),i&&e.on("connect.cleanup",(function(t){i.cleanUp(t.context)}))}Md.$inject=["injector","eventBus","canvas"];var jd={__depends__:[Uu,Op,Sp],__init__:["connectPreview"],connect:["type",kd],connectPreview:["type",Md]};function Rd(t,e,n,i){this._canvas=e,this._graphicsFactory=n,this._elementFactory=i,this._connectionDocking=t.get("connectionDocking",!1),this._layouter=t.get("layouter",!1)}Rd.$inject=["injector","canvas","graphicsFactory","elementFactory"],Rd.prototype.drawPreview=function(t,e,n){n=n||{};var i,r,o,a=t.connectionPreviewGfx,s=t.getConnection,c=n.source,l=n.target,u=n.waypoints,h=n.connectionStart,p=n.connectionEnd,d=n.noLayout,f=n.noCropping,m=n.noNoop,v=this;a||(a=t.connectionPreviewGfx=this.createConnectionPreviewGfx()),ya(a),s||(s=t.getConnection=(r=function(t,e,n){return v.getConnection(t,e,n)},o={},function(t){var e=JSON.stringify(t),n=o[e];return n||(n=o[e]=r.apply(null,arguments)),n})),e&&(i=s(e,c,l)),i?(i.waypoints=u||[],this._layouter&&!d&&(i.waypoints=this._layouter.layoutConnection(i,{source:c,target:l,connectionStart:h,connectionEnd:p})),i.waypoints&&i.waypoints.length||(i.waypoints=[c?yu(c):h,l?yu(l):p]),this._connectionDocking&&(c||l)&&!f&&(i.waypoints=this._connectionDocking.getCroppedWaypoints(i,c,l)),this._graphicsFactory.drawConnection(a,i)):!m&&this.drawNoopPreview(a,n)},Rd.prototype.drawNoopPreview=function(t,e){var n=e.source,i=e.target,r=e.connectionStart||yu(n),o=e.connectionEnd||yu(i),a=this.cropWaypoints(r,o,n,i);oa(t,this.createNoopConnection(a[0],a[1]))},Rd.prototype.cropWaypoints=function(t,e,n,i){var r=this._graphicsFactory,o=n&&r.getShapePath(n),a=i&&r.getShapePath(i),s=r.getConnectionPath({waypoints:[t,e]});return[t=n&&bu(o,s,!0)||t,e=i&&bu(a,s,!1)||e]},Rd.prototype.cleanUp=function(t){t&&t.connectionPreviewGfx&&va(t.connectionPreviewGfx)},Rd.prototype.getConnection=function(t){var e=function(t){return Jr(t)?t:{}}(t);return this._elementFactory.createConnection(e)},Rd.prototype.createConnectionPreviewGfx=function(){var t=xa("g");return la(t,{pointerEvents:"none"}),fa(t).add("djs-connection-preview"),oa(this._canvas.getDefaultLayer(),t),t},Rd.prototype.createNoopConnection=function(t,e){var n=xa("polyline");return la(n,{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"}),la(n,{points:[t.x,t.y,e.x,e.y]}),n};var Dd={__init__:["connectionPreview"],connectionPreview:["type",Rd]},Nd=Math.min,Id=Math.max;function Ld(t){t.preventDefault()}function Bd(t){t.stopPropagation()}function Fd(t){this.container=t.container,this.parent=Ko('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=ta("[contenteditable]",this.parent),this.keyHandler=t.keyHandler||function(){},this.resizeHandler=t.resizeHandler||function(){},this.autoResize=So(this.autoResize,this),this.handlePaste=So(this.handlePaste,this)}function zd(t,e){this._eventBus=t,this._providers=[],this._textbox=new Fd({container:e.getContainer(),keyHandler:So(this._handleKey,this),resizeHandler:So(this._handleResize,this)})}Fd.prototype.create=function(t,e,n,i){var r=this.parent,o=this.content,a=this.container;i=this.options=i||{};var s=Po(e=this.style=e||{},["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);ko(r.style,{width:t.width+"px",height:t.height+"px",maxWidth:t.maxWidth+"px",maxHeight:t.maxHeight+"px",minWidth:t.minWidth+"px",minHeight:t.minHeight+"px",left:t.x+"px",top:t.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},s);var c=Po(e,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return ko(o.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},c),i.centerVertically&&ko(o.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},c),o.innerText=n,Wo.bind(o,"keydown",this.keyHandler),Wo.bind(o,"mousedown",Bd),Wo.bind(o,"paste",this.handlePaste),i.autoResize&&Wo.bind(o,"input",this.autoResize),i.resizable&&this.resizable(e),a.appendChild(r),this.setSelection(o.lastChild,o.lastChild&&o.lastChild.length),r},Fd.prototype.handlePaste=function(t){var e,n=this.options,i=this.style;if(t.preventDefault(),e=t.clipboardData?t.clipboardData.getData("text/plain"):window.clipboardData.getData("Text"),this.insertText(e),n.autoResize){var r=this.autoResize(i);r&&this.resizeHandler(r)}},Fd.prototype.insertText=function(t){document.execCommand("insertText",!1,t)||this._insertTextIE(t)},Fd.prototype._insertTextIE=function(t){var e,n,i,r=this.getSelection(),o=r.startContainer,a=r.endContainer,s=r.startOffset,c=r.endOffset,l=r.commonAncestorContainer,u=(e=l.childNodes,[].slice.call(e));if(l.nodeType===Node.TEXT_NODE){var h=o.textContent;o.textContent=h.substring(0,s)+t+h.substring(c),n=o,i=s+t.length}else if(o===this.content&&a===this.content){var p=document.createTextNode(t);this.content.insertBefore(p,u[s]),n=p,i=p.textContent.length}else{var d=u.indexOf(o),f=u.indexOf(a);u.forEach((function(e,n){n===d?e.textContent=o.textContent.substring(0,s)+t+a.textContent.substring(c):n>d&&n<=f&&na(e)})),n=o,i=s+t.length}n&&void 0!==i&&setTimeout((function(){self.setSelection(n,i)}))},Fd.prototype.autoResize=function(){var t=this.parent,e=this.content,n=parseInt(this.style.fontSize)||12;if(e.scrollHeight>t.offsetHeight||e.scrollHeight<t.offsetHeight-n){var i=t.getBoundingClientRect(),r=e.scrollHeight;t.style.height=r+"px",this.resizeHandler({width:i.width,height:i.height,dx:0,dy:r-i.height})}},Fd.prototype.resizable=function(){var t=this,e=this.parent,n=this.resizeHandle,i=parseInt(this.style.minWidth)||0,r=parseInt(this.style.minHeight)||0,o=parseInt(this.style.maxWidth)||1/0,a=parseInt(this.style.maxHeight)||1/0;if(!n){var s,c,l,u;n=this.resizeHandle=Ko('<div class="djs-direct-editing-resize-handle"></div>');var h=function(n){Ld(n),Bd(n);var h=Nd(Id(l+n.clientX-s,i),o),p=Nd(Id(u+n.clientY-c,r),a);e.style.width=h+"px",e.style.height=p+"px",t.resizeHandler({width:l,height:u,dx:n.clientX-s,dy:n.clientY-c})},p=function(t){Ld(t),Bd(t),Wo.unbind(document,"mousemove",h,!1),Wo.unbind(document,"mouseup",p,!1)};Wo.bind(n,"mousedown",(function(t){Ld(t),Bd(t),s=t.clientX,c=t.clientY;var n=e.getBoundingClientRect();l=n.width,u=n.height,Wo.bind(document,"mousemove",h),Wo.bind(document,"mouseup",p)}))}ko(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),e.appendChild(n)},Fd.prototype.destroy=function(){var t=this.parent,e=this.content,n=this.resizeHandle;e.innerText="",t.removeAttribute("style"),e.removeAttribute("style"),Wo.unbind(e,"keydown",this.keyHandler),Wo.unbind(e,"mousedown",Bd),Wo.unbind(e,"input",this.autoResize),Wo.unbind(e,"paste",this.handlePaste),n&&(n.removeAttribute("style"),na(n)),na(t)},Fd.prototype.getValue=function(){return this.content.innerText.trim()},Fd.prototype.getSelection=function(){return window.getSelection().getRangeAt(0)},Fd.prototype.setSelection=function(t,e){var n=document.createRange();null===t?n.selectNodeContents(this.content):(n.setStart(t,e),n.setEnd(t,e));var i=window.getSelection();i.removeAllRanges(),i.addRange(n)},zd.$inject=["eventBus","canvas"],zd.prototype.registerProvider=function(t){this._providers.push(t)},zd.prototype.isActive=function(){return!!this._active},zd.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())},zd.prototype._fire=function(t,e){this._eventBus.fire("directEditing."+t,e||{active:this._active})},zd.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0},zd.prototype.complete=function(){var t=this._active;if(t){var e,n=t.context.bounds,i=this.$textbox.getBoundingClientRect(),r=this.getValue();r===t.context.text&&i.height===n.height&&i.width===n.width||(e=this._textbox.container.getBoundingClientRect(),t.provider.update(t.element,r,t.context.text,{x:i.left-e.left,y:i.top-e.top,width:i.width,height:i.height})),this._fire("complete"),this.close()}},zd.prototype.getValue=function(){return this._textbox.getValue()},zd.prototype._handleKey=function(t){t.stopPropagation();var e=t.keyCode||t.charCode;return 27===e?(t.preventDefault(),this.cancel()):13!==e||t.shiftKey?void 0:(t.preventDefault(),this.complete())},zd.prototype._handleResize=function(t){this._fire("resize",t)},zd.prototype.activate=function(t){var e;this.isActive()&&this.cancel();var n=io(this._providers,(function(n){return(e=n.activate(t))?n:null}));return e&&(this.$textbox=this._textbox.create(e.bounds,e.style,e.text,e.options),this._active={element:t,context:e,provider:n},e.options&&e.options.resizable&&(this.resizable=!0),this._fire("activate")),!!e};var Gd={__depends__:[Nu],__init__:["directEditing"],directEditing:["type",zd]};function Vd(t,e,n){this._providers=[],this._eventBus=e,this._overlays=n;var i=Xr(t&&t.scale)?t.scale:{min:1,max:1.5};this._overlaysConfig={position:{right:-9,top:-6},scale:i},this._current=null,this._init()}Vd.$inject=["config.contextPad","eventBus","overlays"],Vd.prototype._init=function(){var t=this._eventBus,e=this;t.on("selection.changed",(function(t){var n=t.newSelection;1===n.length?e.open(n[0]):e.close()})),t.on("elements.delete",(function(t){oo(t.elements,(function(t){e.isOpen(t)&&e.close()}))})),t.on("element.changed",(function(t){var n=t.element,i=e._current;i&&i.element===n&&e.open(n,!0)}))},Vd.prototype.registerProvider=function(t){this._providers.push(t)},Vd.prototype.getEntries=function(t){var e={};return oo(this._providers,(function(n){oo(n.getContextPadEntries(t),(function(t,n){e[n]=t}))})),e},Vd.prototype.trigger=function(t,e,n){var i,r,o=this._current.element,a=this._current.entries,s=e.delegateTarget||e.target;if(!s)return e.preventDefault();if(i=a[Oo(s,"data-action")].action,r=e.originalEvent||e,to(i)){if("click"===t)return i(r,o,n)}else if(i[t])return i[t](r,o,n);e.preventDefault()},Vd.prototype.open=function(t,e){!e&&this.isOpen(t)||(this.close(),this._updateAndOpen(t))},Vd.prototype._updateAndOpen=function(t){var e=this.getEntries(t),n=this.getPad(t),i=n.html;oo(e,(function(t,e){var n,r=t.group||"default",o=Ko(t.html||'<div class="entry" draggable="true"></div>');Oo(o,"data-action",e),(n=ta("[data-group="+r+"]",i))||(n=Ko('<div class="group" data-group="'+r+'"></div>'),i.appendChild(n)),n.appendChild(o),t.className&&function(t,e){var n=Do(t);(Zr(e)?e:e.split(/\s+/g)).forEach((function(t){n.add(t)}))}(o,t.className),t.title&&Oo(o,"title",t.title),t.imageUrl&&o.appendChild(Ko('<img src="'+t.imageUrl+'">'))})),Do(i).add("open"),this._current={element:t,pad:n,entries:e},this._eventBus.fire("contextPad.open",{current:this._current})},Vd.prototype.getPad=function(t){if(this.isOpen())return this._current.pad;var e=this,n=this._overlays,i=Ko('<div class="djs-context-pad"></div>'),r=ko({html:i},this._overlaysConfig);qo.bind(i,".entry","click",(function(t){e.trigger("click",t)})),qo.bind(i,".entry","dragstart",(function(t){e.trigger("dragstart",t)})),Wo.bind(i,"mousedown",(function(t){t.stopPropagation()})),this._overlayId=n.add(t,"context-pad",r);var o=n.get(this._overlayId);return this._eventBus.fire("contextPad.create",{element:t,pad:o}),o},Vd.prototype.close=function(){this.isOpen()&&(this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)},Vd.prototype.isOpen=function(t){return!(!this._current||t&&this._current.element!==t)};var Hd={__depends__:[Nu,Zu],contextPad:["type",Vd]},Ud=["marker-start","marker-mid","marker-end"],Wd=["circle","ellipse","line","path","polygon","polyline","rect"];function $d(t,e,n,i){this._elementRegistry=t,this._canvas=n,this._styles=i,this._clonedMarkers={};var r=this;e.on("drag.cleanup",(function(){oo(r._clonedMarkers,(function(t){va(t)})),r._clonedMarkers={}}))}$d.$inject=["elementRegistry","eventBus","canvas","styles"],$d.prototype.getGfx=function(t){return this._elementRegistry.getGraphics(t)},$d.prototype.addDragger=function(t,e,n){var i=ga(n=n||this.getGfx(t)),r=n.getBoundingClientRect();return this._cloneMarkers(zs(i)),la(i,this._styles.cls("djs-dragger",[],{x:r.top,y:r.left})),oa(e,i),i},$d.prototype.addFrame=function(t,e){var n=xa("rect",{class:"djs-resize-overlay",width:t.width,height:t.height,x:t.x,y:t.y});return oa(e,n),n},$d.prototype._cloneMarkers=function(t){var e,n=this;if(t.childNodes)for(var i=0;i<t.childNodes.length;i++)n._cloneMarkers(t.childNodes[i]);(e=t,-1!==Wd.indexOf(e.nodeName))&&Ud.forEach((function(e){if(la(t,e)){var i=function(t,e,n){return ta("marker#"+(i=la(t,e),i.match(/url\(['"]?#([^'"]*)['"]?\)/)[1]),n||document);var i}(t,e,n._canvas.getContainer());n._cloneMarker(t,i,e)}}))},$d.prototype._cloneMarker=function(t,e,n){var i=e.id,r=this._clonedMarkers[i];if(!r){var o=i+"-clone";(r=ga(e)).id=o,fa(r).add("djs-dragger").add("djs-dragger-marker"),this._clonedMarkers[i]=r;var a=ta("defs",this._canvas._svg);a||(a=xa("defs"),oa(this._canvas._svg,a)),oa(a,r)}la(t,n,"url(#"+this._clonedMarkers[i].id+")")};var qd={__init__:["previewSupport"],previewSupport:["type",$d]},Kd="drop-ok",Yd="drop-not-ok",Xd="attach-ok",Zd="new-parent",Jd="create",Qd=2e3;function tf(t,e,n,i,r){function o(e,n){[Xd,Kd,Yd,Zd].forEach((function(i){i===n?t.addMarker(e,i):t.removeMarker(e,i)}))}function a(){var t=e.context();t&&t.prefix===Jd&&e.cancel()}n.on(["create.move","create.hover"],(function(t){var e=t.context,n=e.elements,i=t.hover,a=e.source;if(!i)return e.canExecute=!1,void(e.target=null);ef(t);var s={x:t.x,y:t.y},c=e.canExecute=i&&function(t,e,n,i){if(!e)return!1;var o=io(t=ro(t,(function(e){var n=e.labelTarget;return!(e.parent||function(t){return!!t.labelTarget}(e)&&-1!==t.indexOf(n))})),(function(t){return!nf(t)})),a=!1,s=!1,c=!1;return rf(t)&&(a=r.allowed("shape.attach",{position:n,shape:o,target:e})),a||(c=rf(t)?r.allowed("shape.create",{position:n,shape:o,source:i,target:e}):r.allowed("elements.create",{elements:t,position:n,target:e})),c||a?(o&&i&&(s=r.allowed("connection.create",{source:i,target:o,hints:{targetParent:e,targetAttach:a}})),{attach:a,connect:s}):(null===c||null===a)&&null}(n,i,s,a);i&&null!==c&&(e.target=i,c&&c.attach?o(i,Xd):o(i,c?Zd:Yd))})),n.on(["create.end","create.out","create.cleanup"],(function(t){var e=t.hover;e&&o(e,null)})),n.on("create.end",(function(t){var e=t.context,n=e.source,r=e.shape,o=e.elements,a=e.target,s=e.hints,c=e.canExecute,l=c&&c.attach,u=c&&c.connect;if(!1===c||!a)return!1;ef(t);var h={x:t.x,y:t.y};r=u?i.appendShape(n,r,h,a,{attach:l,connection:!0===u?{}:u}):io(o=i.createElements(o,h,a,ko({},s,{attach:l})),(function(t){return!nf(t)})),ko(e,{elements:o,shape:r}),ko(t,{elements:o,shape:r})})),n.on("create.init",(function(){n.on("elements.changed",a),n.once(["create.cancel","create.end"],Qd,(function(){n.off("elements.changed",a)}))})),this.start=function(t,n,i){Zr(n)||(n=[n]);var r=io(n,(function(t){return!nf(t)}));if(r){i=ko({elements:n,hints:{},shape:r},i||{}),oo(n,(function(t){Qr(t.x)||(t.x=0),Qr(t.y)||(t.y=0)}));var o=os(n);oo(n,(function(t){nf(t)&&(t.waypoints=uo(t.waypoints,(function(t){return{x:t.x-o.x-o.width/2,y:t.y-o.y-o.height/2}}))),ko(t,{x:t.x-o.x-o.width/2,y:t.y-o.y-o.height/2})})),e.init(t,Jd,{cursor:"grabbing",autoActivate:!0,data:{shape:r,elements:n,context:i}})}}}function ef(t){var e=t.context.createConstraints;e&&(e.left&&(t.x=Math.max(t.x,e.left)),e.right&&(t.x=Math.min(t.x,e.right)),e.top&&(t.y=Math.max(t.y,e.top)),e.bottom&&(t.y=Math.min(t.y,e.bottom)))}function nf(t){return!!t.waypoints}function rf(t){return t&&1===t.length&&!nf(t[0])}tf.$inject=["canvas","dragging","eventBus","modeling","rules"];var of=750;function af(t,e,n,i,r){e.on("create.move",of,(function(e){var o=e.hover,a=e.context,s=a.elements,c=a.dragGroup;c||(c=a.dragGroup=function(t){var e=xa("g");la(e,r.cls("djs-drag-group",["no-events"]));var o=xa("g");return t.forEach((function(t){var r;t.waypoints?(r=n._createContainer("connection",o),n.drawConnection(zs(r),t)):(r=n._createContainer("shape",o),n.drawShape(zs(r),t),Vs(r,t.x,t.y)),i.addDragger(t,e,r)})),e}(s)),o?(c.parentNode||oa(t.getDefaultLayer(),c),Vs(c,e.x,e.y)):va(c)})),e.on("create.cleanup",(function(t){var e=t.context.dragGroup;e&&va(e)}))}af.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];var sf={__depends__:[Sp,qd,Op,Uu],__init__:["create","createPreview"],create:["type",tf],createPreview:["type",af]};function cf(t,e,n){var i=Xr(t&&t.scale)?t.scale:{min:1,max:1.5};this._config={scale:i},this._eventBus=e,this._canvas=n,this._providers={},this._current={}}cf.$inject=["config.popupMenu","eventBus","canvas"],cf.prototype.registerProvider=function(t,e){this._providers[t]=e},cf.prototype.isEmpty=function(t,e){if(!t)throw new Error("element parameter is missing");if(!e)throw new Error("providerId parameter is missing");var n=this._providers[e],i=n.getEntries(t),r=n.getHeaderEntries&&n.getHeaderEntries(t),o=i.length>0,a=r&&r.length>0;return!o&&!a},cf.prototype.open=function(t,e,n){var i=this._providers[e];if(!t)throw new Error("Element is missing");if(!i)throw new Error("Provider is not registered: "+e);if(!n)throw new Error("the position argument is missing");this.isOpen()&&this.close(),this._emit("open");var r=this._current={provider:i,className:e,element:t,position:n};i.getHeaderEntries&&(r.headerEntries=i.getHeaderEntries(t)),r.entries=i.getEntries(t),r.container=this._createContainer();var o=r.headerEntries||[],a=r.entries||[];o.length&&r.container.appendChild(this._createEntries(r.headerEntries,"djs-popup-header")),a.length&&r.container.appendChild(this._createEntries(r.entries,"djs-popup-body"));var s=this._canvas.getContainer();this._attachContainer(r.container,s,n.cursor)},cf.prototype.close=function(){this.isOpen()&&(this._emit("close"),this._unbindHandlers(),na(this._current.container),this._current.container=null)},cf.prototype.isOpen=function(){return!!this._current.container},cf.prototype.trigger=function(t){t.preventDefault();var e=Oo(t.delegateTarget||t.target,"data-id"),n=this._getEntry(e);if(n.action)return n.action.call(null,t,n)},cf.prototype._getEntry=function(t){var e=go({id:t}),n=io(this._current.entries,e)||io(this._current.headerEntries,e);if(!n)throw new Error("entry not found");return n},cf.prototype._emit=function(t){this._eventBus.fire("popupMenu."+t)},cf.prototype._createContainer=function(){var t=Ko('<div class="djs-popup">'),e=this._current.position,n=this._current.className;return ko(t.style,{position:"absolute",left:e.x+"px",top:e.y+"px",visibility:"hidden"}),Do(t).add(n),t},cf.prototype._attachContainer=function(t,e,n){var i=this;qo.bind(t,".entry","click",(function(t){i.trigger(t)})),this._updateScale(t),e.appendChild(t),n&&this._assureIsInbounds(t,n),this._bindHandlers()},cf.prototype._updateScale=function(t){var e,n,i,r,o=this._canvas.zoom(),a=this._config.scale,s=o;!0!==a&&(!1===a?(e=1,n=1):(e=a.min,n=a.max),Xr(e)&&o<e&&(s=e),Xr(n)&&o>n&&(s=n)),r="scale("+s+")",(i=t).style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach((function(t){i.style[t+"transform"]=r}))},cf.prototype._assureIsInbounds=function(t,e){var n,i,r=this._canvas._container.getBoundingClientRect(),o=t.offsetLeft,a=t.offsetTop,s=t.scrollWidth,c=t.scrollHeight,l={},u=e.x-r.left,h=e.y-r.top;o+s>r.width&&(l.x=!0),a+c>r.height&&(l.y=!0),l.x&&l.y?(n=u-s+"px",i=h-c+"px"):l.x?(n=u-s+"px",i=h+"px"):l.y&&h<c?(n=u+"px",i="10px"):l.y&&(n=u+"px",i=h-c+"px"),ko(t.style,{left:n,top:i},{visibility:"visible","z-index":1e3})},cf.prototype._createEntries=function(t,e){var n=Ko("<div>"),i=this;return Do(n).add(e),oo(t,(function(t){var e=i._createEntry(t,n);n.appendChild(e)})),n},cf.prototype._createEntry=function(t){if(!t.id)throw new Error("every entry must have the id property set");var e=Ko("<div>"),n=Do(e);if(n.add("entry"),t.className&&t.className.split(" ").forEach((function(t){n.add(t)})),Oo(e,"data-id",t.id),t.label){var i=Ko("<span>");i.textContent=t.label,e.appendChild(i)}return t.imageUrl&&e.appendChild(Ko('<img src="'+t.imageUrl+'" />')),!0===t.active&&n.add("active"),!0===t.disabled&&n.add("disabled"),t.title&&(e.title=t.title),e},cf.prototype._bindHandlers=function(){var t=this._eventBus,e=this;function n(){e.close()}t.once("contextPad.close",n),t.once("canvas.viewbox.changing",n),t.once("commandStack.changed",n)},cf.prototype._unbindHandlers=function(){var t=this._eventBus,e=this;function n(){e.close()}t.off("contextPad.close",n),t.off("canvas.viewbox.changed",n),t.off("commandStack.changed",n)};var lf={__init__:["popupMenu"],popupMenu:["type",cf]};function uf(){}uf.prototype.get=function(){return this._data},uf.prototype.set=function(t){this._data=t},uf.prototype.clear=function(){var t=this._data;return delete this._data,t},uf.prototype.isEmpty=function(){return!this._data};var hf={clipboard:["type",uf]};function pf(t){var e=this;function n(t){e._lastMoveEvent=t}this._lastMoveEvent=null,t.on("canvas.init",(function(t){(e._svg=t.svg).addEventListener("mousemove",n)})),t.on("canvas.destroy",(function(){e._lastMouseEvent=null,e._svg.removeEventListener("mousemove",n)}))}pf.$inject=["eventBus"],pf.prototype.getLastMoveEvent=function(){return this._lastMoveEvent||function(t,e){var n=document.createEvent("MouseEvent"),i=t,r=e,o=t,a=e;n.initMouseEvent&&n.initMouseEvent("mousemove",!0,!0,window,0,i,r,o,a,!1,!1,!1,!1,0,null);return n}(0,0)};var df={__init__:["mouse"],mouse:["type",pf]};function ff(t,e,n,i,r,o,a,s){this._canvas=t,this._create=e,this._clipboard=n,this._elementFactory=i,this._eventBus=r,this._modeling=o,this._mouse=a,this._rules=s,r.on("copyPaste.copyElement",(function(t){var e=t.descriptor,n=t.element,i=t.elements;e.priority=1,e.id=n.id,io(i,(function(t){return t===n.parent}))&&(e.parent=n.parent.id),function(t){return!!t.host}(n)&&(e.priority=2,e.host=n.host.id),mf(n)&&(e.priority=3,e.source=n.source.id,e.target=n.target.id,e.waypoints=function(t){return uo(t.waypoints,(function(t){return(t=yf(t)).original&&(t.original=yf(t.original)),t}))}(n)),vf(n)&&(e.priority=4,e.labelTarget=n.labelTarget.id),oo(["x","y","width","height"],(function(t){Qr(n[t])&&(e[t]=n[t])}))})),r.on("copyPaste.pasteElements",(function(t){ko(t.hints,{createElementsBehavior:!1})}))}function mf(t){return!!t.waypoints}function vf(t){return!!t.labelTarget}function yf(t){return ko({},t)}function gf(t,e){var n=e.indexOf(t);return-1===n?e:e.splice(n,1)}ff.$inject=["canvas","create","clipboard","elementFactory","eventBus","modeling","mouse","rules"],ff.prototype.copy=function(t){var e,n;return Zr(t)||(t=t?[t]:[]),n=!1===(e=this._eventBus.fire("copyPaste.canCopyElements",{elements:t}))?{}:this.createTree(Zr(e)?e:t),this._clipboard.set(n),this._eventBus.fire("copyPaste.elementsCopied",{elements:t,tree:n}),n},ff.prototype.paste=function(t){var e=this._clipboard.get();if(!this._clipboard.isEmpty()){var n=t&&t.hints||{};this._eventBus.fire("copyPaste.pasteElements",{hints:n});var i=this._createElements(e);if(t&&t.element&&t.point)return this._paste(i,t.element,t.point,n);this._create.start(this._mouse.getLastMoveEvent(),i,{hints:n||{}})}},ff.prototype._paste=function(t,e,n,i){oo(t,(function(t){Qr(t.x)||(t.x=0),Qr(t.y)||(t.y=0)}));var r=os(t);return oo(t,(function(t){mf(t)&&(t.waypoints=uo(t.waypoints,(function(t){return{x:t.x-r.x-r.width/2,y:t.y-r.y-r.height/2}}))),ko(t,{x:t.x-r.x-r.width/2,y:t.y-r.y-r.height/2})})),this._modeling.createElements(t,n,e,ko({},i))},ff.prototype._createElements=function(t){var e=this,n=this._eventBus,i={},r=[];return oo(t,(function(t,o){o=parseInt(o,10),oo(t=yo(t,"priority"),(function(t){var o,a=ko({},To(t,["priority"]));return i[t.parent]?a.parent=i[t.parent]:delete a.parent,n.fire("copyPaste.pasteElement",{cache:i,descriptor:a}),mf(a)?(a.source=i[t.source],a.target=i[t.target],o=i[t.id]=e.createConnection(a),void r.push(o)):vf(a)?(a.labelTarget=i[a.labelTarget],o=i[t.id]=e.createLabel(a),void r.push(o)):(a.host&&(a.host=i[a.host]),o=i[t.id]=e.createShape(a),void r.push(o))}))})),r},ff.prototype.createConnection=function(t){return this._elementFactory.createConnection(To(t,["id"]))},ff.prototype.createLabel=function(t){return this._elementFactory.createLabel(To(t,["id"]))},ff.prototype.createShape=function(t){return this._elementFactory.createShape(To(t,["id"]))},ff.prototype.hasRelations=function(t,e){var n,i;return!(mf(t)&&(n=io(e,go({id:t.source.id})),i=io(e,go({id:t.target.id})),!n||!i))&&!(vf(t)&&!io(e,go({id:t.labelTarget.id})))},ff.prototype.createTree=function(t){var e=this._rules,n=this,i={},r=[];function o(t,e){var n=io(r,(function(e){return t===e.element}));n?n.depth<e&&(r=function(t,e){var n=e.indexOf(t);-1!==n&&e.splice(n,1);return e}(n,r)).push({element:n.element,depth:e}):r.push({element:t,depth:e})}return ns(ts(t),(function(t,e,n){if(!vf(t))return oo(t.labels,(function(t){o(t,n)})),oo([t.attachers,t.incoming,t.outgoing],(function(t){t&&t.length&&oo(t,(function(t){oo(t.labels,(function(t){o(t,n)})),o(t,n)}))})),o(t,n),t.children})),t=uo(r,(function(t){return t.element})),r=yo(r=uo(r,(function(e){return e.descriptor={},n._eventBus.fire("copyPaste.copyElement",{descriptor:e.descriptor,element:e.element,elements:t}),e})),(function(t){return t.descriptor.priority})),t=uo(r,(function(t){return t.element})),oo(r,(function(r){var o=r.depth;n.hasRelations(r.element,t)?!function(t,n){return e.allowed("element.copy",{element:t,elements:n})}(r.element,t)?gf(r.element,t):(i[o]||(i[o]=[]),i[o].push(r.descriptor)):gf(r.element,t)})),i};var bf={__depends__:[hf,sf,df,Op],__init__:["copyPaste"],copyPaste:["type",ff]};function _f(t,e,n){Zr(n)||(n=[n]),oo(n,(function(n){Yr(t[n])||(e[n]=t[n])}))}var wf=750;function xf(t,e,n){var i;e.on("copyPaste.copyElement",wf,(function(t){var e=t.descriptor,n=t.element,i=e.oldBusinessObject=yl(n);if(e.type=n.type,_f(i,e,"name"),e.di={},_f(i.di,e.di,["fill","stroke"]),_f(i.di,e,"isExpanded"),Ef(e))return e;i.default&&(e.default=i.default.id)})),e.on("moddleCopy.canCopyProperty",(function(e){var i,r=e.parent,o=e.property;if("processRef"===e.propertyName&&vl(r,"bpmn:Participant")&&vl(o,"bpmn:Process"))return i=t.create("bpmn:Process"),n.copyElement(o,i)})),e.on("copyPaste.pasteElements",(function(){i={}})),e.on("copyPaste.pasteElement",(function(e){var r,o,a,s=e.cache,c=e.descriptor,l=c.oldBusinessObject;Ef(c)?c.businessObject=yl(s[c.labelTarget]):(r=t.create(l.$type),c.businessObject=n.copyElement(l,r),function(t,e){var n=yl(t);t.default&&(i[t.default]={element:n,property:"default"}),t.host&&(yl(t).attachedToRef=yl(e[t.host])),i=To(i,so(i,(function(e,i,r){var o=i.element,a=i.property;return r===t.id&&(o[a]=n,e.push(t.id)),e}),[]))}(c,s),_f(c,r,["isExpanded","name"]),o=c,Zr(a="oldBusinessObject")||(a=[a]),oo(a,(function(t){o[t]&&delete o[t]})))}))}function Ef(t){return!!t.labelTarget}xf.$inject=["bpmnFactory","eventBus","moddleCopy"];var Sf=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing"];function Cf(t,e,n){this._bpmnFactory=e,this._eventBus=t,this._moddle=n,t.on("moddleCopy.canCopyProperties",(function(t){var e=t.propertyNames;if(e&&e.length)return yo(e,(function(t){return"extensionElements"===t}))})),t.on("moddleCopy.canCopyProperty",(function(t){var e=t.parent,n=Jr(e)&&e.$descriptor,i=t.propertyName;return(!i||-1===Sf.indexOf(i))&&(!(i&&n&&!io(n.properties,go({name:i})))&&void 0)})),t.on("moddleCopy.canSetCopiedProperty",(function(t){var e,n,i=t.property;if(n="bpmn:ExtensionElements",(e=i)&&"function"==typeof e.$instanceOf&&e.$instanceOf(n)&&(!i.values||!i.values.length))return!1}))}function kf(t,e){return so(t.properties,(function(t,n){return e&&n.default?t:t.concat(n.name)}),[])}Cf.$inject=["eventBus","bpmnFactory","moddle"],Cf.prototype.copyElement=function(t,e,n){var i=this;n&&!Zr(n)&&(n=[n]),n=n||kf(t.$descriptor);var r=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:n,sourceElement:t,targetElement:e});return!1===r?e:(Zr(r)&&(n=r),oo(n,(function(n){var r;no(t,n)&&(r=t.get(n));var o=i.copyProperty(r,e,n);!1!==i._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:parent,property:o,propertyName:n})&&Xr(o)&&e.set(n,o)})),e)},Cf.prototype.copyProperty=function(t,e,n){var i=this,r=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:e,property:t,propertyName:n});if(!1!==r){if(r)return Jr(r)&&r.$type&&!r.$parent&&(r.$parent=e),r;var o=this._moddle.getPropertyDescriptor(e,n);if(!o.isId&&!o.isReference){if(Zr(t))return so(t,(function(t,o){return(r=i.copyProperty(o,e,n))?(r.$parent=e,t.concat(r)):t}),[]);if(Jr(t)&&t.$type){if(this._moddle.getElementDescriptor(t).isGeneric)return;return(r=i._bpmnFactory.create(t.$type)).$parent=e,r=i.copyElement(t,r)}return t}}};var Pf={__depends__:[bf],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",xf],moddleCopy:["type",Cf]},Tf=Math.round;function Of(t){this._modeling=t}Of.$inject=["modeling"],Of.prototype.replaceElement=function(t,e,n){var i=this._modeling,r=null;return t.waypoints||(e.x=Tf(t.x+(e.width||t.width)/2),e.y=Tf(t.y+(e.height||t.height)/2),r=i.replaceShape(t,e,n)),r};var Af={__init__:["replace"],replace:["type",Of]};var Mf=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function jf(t,e,n,i,r,o){this.replaceElement=function(a,s,c){c=c||{};var l=s.type,u=a.businessObject;if(Rf(u)&&"bpmn:SubProcess"===l&&function(t,e){var n=t&&no(t,"collapsed")?t.collapsed:!gl(t);return n!==(e&&(no(e,"collapsed")||no(e,"isExpanded"))?no(e,"collapsed")?e.collapsed:!e.isExpanded:n)&&(t.collapsed=n,!0)}(a,s))return i.toggleCollapse(a),a;var h,p=t.create(l),d={type:l,businessObject:p},f=kf(u.$descriptor),m=kf(p.$descriptor,!0),v=(h=m,f.filter((function(t){return-1!==h.indexOf(t)})));ko(p,Po(s,Mf));var y=ro(v,(function(t){return"eventDefinitions"===t?Df(a,s.eventDefinitionType):"loopCharacteristics"===t?!bl(p):!p.hasOwnProperty(t)&&(("processRef"!==t||!1!==s.isExpanded)&&"triggeredByEvent"!==t)}));return p=n.copyElement(u,p,y),s.eventDefinitionType&&(Df(p,s.eventDefinitionType)||(d.eventDefinitionType=s.eventDefinitionType)),vl(u,"bpmn:Activity")&&(Rf(u)?d.isExpanded=gl(u):s&&no(s,"isExpanded")&&(d.isExpanded=s.isExpanded),gl(u)&&!vl(u,"bpmn:Task")&&d.isExpanded&&(d.width=a.width,d.height=a.height)),Rf(u)&&!Rf(p)&&(c.moveChildren=!1),vl(u,"bpmn:Participant")&&(!0===s.isExpanded?p.processRef=t.create("bpmn:Process"):c.moveChildren=!1,d.width=a.width,d.height=e._getDefaultSize(p).height),p.name=u.name,Xh(u,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&Xh(p,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(p.default=u.default),s.host&&!vl(u,"bpmn:BoundaryEvent")&&vl(p,"bpmn:BoundaryEvent")&&(d.host=s.host),d.di={},function(t,e,n){Zr(n)||(n=[n]),oo(n,(function(n){Yr(t[n])||(e[n]=t[n])}))}(u.di,d.di,["fill","stroke"]),d=r.replaceElement(a,d,c),!1!==c.select&&o.select(d),d}}function Rf(t){return vl(t,"bpmn:SubProcess")}function Df(t,e){var n=yl(t);return e&&n.get("eventDefinitions").some((function(t){return vl(t,e)}))}jf.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","selection"];var Nf={__depends__:[Pf,Af,Uu],bpmnReplace:["type",jf]};function If(t){return function(e){var n=e.target,i=yl(t),r=i.eventDefinitions&&i.eventDefinitions[0],o=i.$type===n.type,a=(r&&r.$type)===n.eventDefinitionType,s=i.triggeredByEvent===n.triggeredByEvent,c=void 0===n.isExpanded||n.isExpanded===gl(i);return!(o&&a&&s&&c)}}var Lf=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],Bf=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Intermediate Catch Event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message Intermediate Throw Event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Intermediate Catch Event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Intermediate Throw Event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Intermediate Catch Event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link Intermediate Catch Event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition"}},{label:"Link Intermediate Throw Event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition"}},{label:"Compensation Intermediate Throw Event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal Intermediate Catch Event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal Intermediate Throw Event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],Ff=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message End Event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation End Event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error End Event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel End Event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation End Event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal End Event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate End Event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],zf=[{label:"Exclusive Gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel Gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive Gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex Gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event based Gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],Gf=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],Vf=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],Hf=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}}],Uf=[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"Send Task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive Task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"User Task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Manual Task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business Rule Task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Service Task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Script Task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call Activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub Process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}}],Wf=[{label:"Message Boundary Event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Boundary Event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Boundary Event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Boundary Event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Error Boundary Event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel Boundary Event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Signal Boundary Event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Compensation Boundary Event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],$f=[{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Error Start Event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Escalation Start Event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Compensation Start Event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],qf=[{label:"Sequence Flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default Flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional Flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],Kf=[{label:"Expanded Pool",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:"Collapsed Pool",actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}];function Yf(t,e,n,i,r,o){this._popupMenu=t,this._modeling=e,this._moddle=n,this._bpmnReplace=i,this._rules=r,this._translate=o,this.register()}Yf.$inject=["popupMenu","modeling","moddle","bpmnReplace","rules","translate"],Yf.prototype.register=function(){this._popupMenu.registerProvider("bpmn-replace",this)},Yf.prototype.getEntries=function(t){var e,n=t.businessObject;if(!this._rules.allowed("shape.replace",{element:t}))return[];var i=If(t);return vl(n,"bpmn:StartEvent")&&!bl(n.$parent)?(e=ro(Lf,i),this._createEntries(t,e)):vl(n,"bpmn:Participant")?(e=ro(Kf,(function(t){return gl(n)!==t.target.isExpanded})),this._createEntries(t,e)):vl(n,"bpmn:StartEvent")&&bl(n.$parent)?(e=ro($f,(function(e){var n=!1!==e.target.isInterrupting,r=yl(t).isInterrupting===n;return i(e)||!i(e)&&!r})),this._createEntries(t,e)):vl(n,"bpmn:EndEvent")?(e=ro(Ff,(function(t){return!("bpmn:CancelEventDefinition"==t.target.eventDefinitionType&&!vl(n.$parent,"bpmn:Transaction"))&&i(t)})),this._createEntries(t,e)):vl(n,"bpmn:BoundaryEvent")?(e=ro(Wf,(function(t){var e=t.target;if("bpmn:CancelEventDefinition"==e.eventDefinition&&!vl(n.attachedToRef,"bpmn:Transaction"))return!1;var r=!1!==e.cancelActivity,o=n.cancelActivity==r;return i(t)||!i(t)&&!o})),this._createEntries(t,e)):vl(n,"bpmn:IntermediateCatchEvent")||vl(n,"bpmn:IntermediateThrowEvent")?(e=ro(Bf,i),this._createEntries(t,e)):vl(n,"bpmn:Gateway")?(e=ro(zf,i),this._createEntries(t,e)):vl(n,"bpmn:Transaction")?(e=ro(Vf,i),this._createEntries(t,e)):bl(n)&&gl(n)?(e=ro(Hf,i),this._createEntries(t,e)):vl(n,"bpmn:SubProcess")&&gl(n)?(e=ro(Gf,i),this._createEntries(t,e)):vl(n,"bpmn:AdHocSubProcess")&&!gl(n)?(e=ro(Uf,(function(e){var n=e.target,i="bpmn:SubProcess"===n.type,r=!0===n.isExpanded;return If(t)&&(!i||r)})),this._createEntries(t,e)):vl(n,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(t,qf):vl(n,"bpmn:FlowNode")?(e=ro(Uf,i),vl(n,"bpmn:SubProcess")&&!gl(n)&&(e=ro(e,(function(t){return"Sub Process (collapsed)"!==t.label}))),this._createEntries(t,e)):[]},Yf.prototype.getHeaderEntries=function(t){var e=[];return vl(t,"bpmn:Activity")&&!bl(t)&&(e=e.concat(this._getLoopEntries(t))),!vl(t,"bpmn:SubProcess")||vl(t,"bpmn:Transaction")||bl(t)||e.push(this._getAdHocEntry(t)),e},Yf.prototype._createEntries=function(t,e){var n=[],i=this;return oo(e,(function(e){var r=i._createMenuEntry(e,t);n.push(r)})),n},Yf.prototype._createSequenceFlowEntries=function(t,e){var n=yl(t),i=[],r=this._modeling,o=this._moddle,a=this;return oo(e,(function(e){switch(e.actionName){case"replace-with-default-flow":n.sourceRef.default!==n&&(vl(n.sourceRef,"bpmn:ExclusiveGateway")||vl(n.sourceRef,"bpmn:InclusiveGateway")||vl(n.sourceRef,"bpmn:ComplexGateway")||vl(n.sourceRef,"bpmn:Activity"))&&i.push(a._createMenuEntry(e,t,(function(){r.updateProperties(t.source,{default:n})})));break;case"replace-with-conditional-flow":!n.conditionExpression&&vl(n.sourceRef,"bpmn:Activity")&&i.push(a._createMenuEntry(e,t,(function(){var e=o.create("bpmn:FormalExpression",{body:""});r.updateProperties(t,{conditionExpression:e})})));break;default:if(vl(n.sourceRef,"bpmn:Activity")&&n.conditionExpression)return i.push(a._createMenuEntry(e,t,(function(){r.updateProperties(t,{conditionExpression:void 0})})));if((vl(n.sourceRef,"bpmn:ExclusiveGateway")||vl(n.sourceRef,"bpmn:InclusiveGateway")||vl(n.sourceRef,"bpmn:ComplexGateway")||vl(n.sourceRef,"bpmn:Activity"))&&n.sourceRef.default===n)return i.push(a._createMenuEntry(e,t,(function(){r.updateProperties(t.source,{default:void 0})})))}})),i},Yf.prototype._createMenuEntry=function(t,e,n){var i=this._translate,r=this._bpmnReplace.replaceElement;return n=n||function(){return r(e,t.target)},{label:i(t.label),className:t.className,id:t.actionName,action:n}},Yf.prototype._getLoopEntries=function(t){var e=this,n=this._translate;function i(n,i){var r;i.active?r=void 0:(r=e._moddle.create(i.options.loopCharacteristics),i.options.isSequential&&(r.isSequential=i.options.isSequential)),e._modeling.updateProperties(t,{loopCharacteristics:r})}var r,o,a,s=yl(t).loopCharacteristics;return s&&(r=s.isSequential,o=void 0===s.isSequential,a=void 0!==s.isSequential&&!s.isSequential),[{id:"toggle-parallel-mi",className:"bpmn-icon-parallel-mi-marker",title:n("Parallel Multi Instance"),active:a,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},{id:"toggle-sequential-mi",className:"bpmn-icon-sequential-mi-marker",title:n("Sequential Multi Instance"),active:r,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},{id:"toggle-loop",className:"bpmn-icon-loop-marker",title:n("Loop"),active:o,action:i,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}]},Yf.prototype._getAdHocEntry=function(t){var e=this._translate,n=vl(yl(t),"bpmn:AdHocSubProcess"),i=this._bpmnReplace.replaceElement;return{id:"toggle-adhoc",className:"bpmn-icon-ad-hoc-marker",title:e("Ad-hoc"),active:n,action:function(e,r){return i(t,n?{type:"bpmn:SubProcess"}:{type:"bpmn:AdHocSubProcess"})}}};var Xf={__depends__:[lf,Nf],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",Yf]},Zf=Math.max,Jf=Math.min,Qf=20;function tm(t,e){return{top:t.top-e.top,right:t.right-e.right,bottom:t.bottom-e.bottom,left:t.left-e.left}}function em(t,e,n){var i=e[t],r=n.min&&n.min[t],o=n.max&&n.max[t];return Qr(r)&&(i=(/top|left/.test(t)?Jf:Zf)(i,r)),Qr(o)&&(i=(/top|left/.test(t)?Zf:Jf)(i,o)),i}function nm(t,e){return void 0!==t?t:Qf}function im(t){return!t.waypoints&&"label"!==t.type}function rm(t,e){var n;if((n=void 0===t.length?ro(t.children,im):t).length)return function(t,e){var n,i,r,o;return"object"==typeof e?(n=nm(e.left),i=nm(e.right),r=nm(e.top),o=nm(e.bottom)):n=i=r=o=nm(e),{x:t.x-n,y:t.y-r,width:t.width+n+i,height:t.height+r+o}}(os(n),e)}var om=Math.abs;var am=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"];function sm(t,e){return e=e||[],t.children.filter((function(t){vl(t,"bpmn:Lane")&&(sm(t,e),e.push(t))})),e}function cm(t){return t.children.filter((function(t){return vl(t,"bpmn:Lane")}))}function lm(t){return Zh(t,am)||t}function um(t,e){var n=lm(t),i=sm(n,vl(n,"bpmn:Process")?[]:[n]),r=mu(t),o=mu(e),a=function(t,e){return tm(mu(e),mu(t))}(t,e),s=[];return i.forEach((function(e){if(e!==t){var n,i,c=0,l=a.right,u=0,h=a.left,p=mu(e);a.top&&(om(p.bottom-r.top)<10&&(u=o.top-p.bottom),om(p.top-r.top)<5&&(c=o.top-p.top)),a.bottom&&(om(p.top-r.bottom)<10&&(c=o.bottom-p.top),om(p.bottom-r.bottom)<5&&(u=o.bottom-p.bottom)),(c||l||u||h)&&s.push({shape:e,newBounds:(n=e,i={top:c,right:l,bottom:u,left:h},{x:n.x+(i.left||0),y:n.y+(i.top||0),width:n.width-(i.left||0)+(i.right||0),height:n.height-(i.top||0)+(i.bottom||0)})})}})),s}function hm(t,e,n,i,r,o,a,s,c,l,u,h){t=t||{},i.registerProvider(this),this._contextPad=i,this._modeling=r,this._elementFactory=o,this._connect=a,this._create=s,this._popupMenu=c,this._canvas=l,this._rules=u,this._translate=h,!1!==t.autoPlace&&(this._autoPlace=e.get("autoPlace",!1)),n.on("create.end",250,(function(t){var e=t.context.shape;if(Mu(t)){var n=i.getEntries(e);n.replace&&n.replace.action.click(t,e)}}))}function pm(t,e,n){var i=t.$instanceOf(e),r=!1;return oo(t.eventDefinitions||[],(function(t){t.$type===n&&(r=!0)})),i&&r}hm.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate"],hm.prototype.getContextPadEntries=function(t){var e=this._contextPad,n=this._modeling,i=this._elementFactory,r=this._connect,o=this._create,a=this._popupMenu,s=this._canvas,c=this._rules,l=this._autoPlace,u=this._translate,h={};if("label"===t.type)return h;var p=t.businessObject;function d(t,e){r.start(t,e)}function f(t,e,n,r){function a(e,n){var a=i.createShape(ko({type:t},r));o.start(e,a,{source:n})}return"string"!=typeof n&&(r=n,n=u("Append {type}",{type:t.replace(/^bpmn:/,"")})),{group:"model",className:e,title:n,action:{dragstart:a,click:l?function(e,n){var o=i.createShape(ko({type:t},r));l.append(n,o)}:a}}}function m(t){return function(i,r){n.splitLane(r,t),e.open(r,!0)}}if(Xh(p,["bpmn:Lane","bpmn:Participant"])&&gl(p)){var v=cm(t);ko(h,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:u("Add Lane above"),action:{click:function(t,e){n.addLane(e,"top")}}}}),v.length<2&&(t.height>=120&&ko(h,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:u("Divide into two Lanes"),action:{click:m(2)}}}),t.height>=180&&ko(h,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:u("Divide into three Lanes"),action:{click:m(3)}}})),ko(h,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:u("Add Lane below"),action:{click:function(t,e){n.addLane(e,"bottom")}}}})}vl(p,"bpmn:FlowNode")&&(vl(p,"bpmn:EventBasedGateway")?ko(h,{"append.receive-task":f("bpmn:ReceiveTask","bpmn-icon-receive-task"),"append.message-intermediate-event":f("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",u("Append MessageIntermediateCatchEvent"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":f("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",u("Append TimerIntermediateCatchEvent"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":f("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",u("Append ConditionIntermediateCatchEvent"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":f("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",u("Append SignalIntermediateCatchEvent"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):pm(p,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?ko(h,{"append.compensation-activity":f("bpmn:Task","bpmn-icon-task",u("Append compensation activity"),{isForCompensation:!0})}):vl(p,"bpmn:EndEvent")||p.isForCompensation||pm(p,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")||bl(p)||ko(h,{"append.end-event":f("bpmn:EndEvent","bpmn-icon-end-event-none",u("Append EndEvent")),"append.gateway":f("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",u("Append Gateway")),"append.append-task":f("bpmn:Task","bpmn-icon-task",u("Append Task")),"append.intermediate-event":f("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",u("Append Intermediate/Boundary Event"))})),a.isEmpty(t,"bpmn-replace")||ko(h,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:u("Change type"),action:{click:function(t,n){var i=ko(function(t){var n=s.getContainer(),i=e.getPad(t).html,r=n.getBoundingClientRect(),o=i.getBoundingClientRect(),a=o.top-r.top;return{x:o.left-r.left,y:a+o.height+5}}(n),{cursor:{x:t.x,y:t.y}});a.open(n,"bpmn-replace",i)}}}}),Xh(p,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&ko(h,{"append.text-annotation":f("bpmn:TextAnnotation","bpmn-icon-text-annotation"),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:u("Connect using "+(p.isForCompensation?"":"Sequence/MessageFlow or ")+"Association"),action:{click:d,dragstart:d}}}),Xh(p,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&ko(h,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:u("Connect using DataInputAssociation"),action:{click:d,dragstart:d}}});var y=c.allowed("elements.delete",{elements:[t]});return Zr(y)&&(y=y[0]===t),y&&ko(h,{delete:{group:"edit",className:"bpmn-icon-trash",title:u("Remove"),action:{click:function(e){n.removeElements([t])}}}}),h};var dm={__depends__:[Gd,Hd,Uu,jd,sf,Xf],__init__:["contextPadProvider"],contextPadProvider:["type",hm]},fm={horizontal:["x","width"],vertical:["y","height"]};function mm(t){this._modeling=t,this._filters=[],this.registerFilter((function(t,e,n){var i,r=0,o=0;return oo(t,(function(t){t.waypoints||t.labelTarget||(r+=t[n],o+=1)})),i=Math.round(r/o),ro(t,(function(t){return t[n]<i+50}))}))}mm.$inject=["modeling"],mm.prototype.registerFilter=function(t){if("function"!=typeof t)throw new Error("the filter has to be a function");this._filters.push(t)},mm.prototype.trigger=function(t,e){var n,i,r=this._modeling;if(!(t.length<3||(this._setOrientation(e),i=this._filterElements(t),(n=this._createGroups(i)).length<=2)))return r.distributeElements(n,this._axis,this._dimension),n},mm.prototype._filterElements=function(t){var e=this._filters,n=this._axis,i=this._dimension,r=[].concat(t);return e.length?(oo(e,(function(t){r=t(r,n,i)})),r):t},mm.prototype._createGroups=function(t){var e=[],n=this,i=this._axis,r=this._dimension;if(!i)throw new Error('must have a defined "axis" and "dimension"');return oo(yo(t,i),(function(t,o){var a,s=n._findRange(t,i,r),c=e[e.length-1];c&&n._hasIntersection(c.range,s)?e[e.length-1].elements.push(t):(a={range:s,elements:[t]},e.push(a))})),e},mm.prototype._setOrientation=function(t){var e=fm[t];this._axis=e[0],this._dimension=e[1]},mm.prototype._hasIntersection=function(t,e){return Math.max(t.min,t.max)>=Math.min(e.min,e.max)&&Math.min(t.min,t.max)<=Math.max(e.min,e.max)},mm.prototype._findRange=function(t){var e=t[this._axis];return{min:e+5,max:e+t[this._dimension]-5}};var vm={__init__:["distributeElements"],distributeElements:["type",mm]};function ym(t){t.registerFilter((function(t){return ro(t,(function(t){var e=Xh(t,["bpmn:Association","bpmn:BoundaryEvent","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:Lane","bpmn:MessageFlow","bpmn:Participant","bpmn:SequenceFlow","bpmn:TextAnnotation"]);return!(t.labelTarget||e)}))}))}ym.$inject=["distributeElements"];var gm={__depends__:[vm],__init__:["bpmnDistributeElements"],bpmnDistributeElements:["type",ym]};function bm(t,e){this._actions={};var n=this;t.on("diagram.init",(function(){n._registerDefaultActions(e),t.fire("editorActions.init",{editorActions:n})}))}function _m(t,e){return new Error(t+" "+e)}bm.$inject=["eventBus","injector"],bm.prototype._registerDefaultActions=function(t){var e=t.get("commandStack",!1),n=t.get("modeling",!1),i=t.get("selection",!1),r=t.get("zoomScroll",!1),o=t.get("copyPaste",!1),a=t.get("canvas",!1),s=t.get("rules",!1),c=t.get("keyboardMove",!1),l=t.get("keyboardMoveSelection",!1);e&&(this.register("undo",(function(){e.undo()})),this.register("redo",(function(){e.redo()}))),o&&i&&this.register("copy",(function(){var t=i.get();o.copy(t)})),o&&this.register("paste",(function(){o.paste()})),r&&this.register("stepZoom",(function(t){r.stepZoom(t.value)})),a&&this.register("zoom",(function(t){a.zoom(t.value)})),n&&i&&s&&this.register("removeSelection",(function(){var t=i.get();if(t.length){var e,r=s.allowed("elements.delete",{elements:t});!1!==r&&(e=Zr(r)?r:t).length&&n.removeElements(e.slice())}})),c&&this.register("moveCanvas",(function(t){c.moveCanvas(t)})),l&&this.register("moveSelection",(function(t){l.moveSelection(t.direction,t.accelerated)}))},bm.prototype.trigger=function(t,e){if(!this._actions[t])throw _m(t,"is not a registered action");return this._actions[t](e)},bm.prototype.register=function(t,e){var n=this;if("string"==typeof t)return this._registerAction(t,e);oo(t,(function(t,e){n._registerAction(e,t)}))},bm.prototype._registerAction=function(t,e){if(this.isRegistered(t))throw _m(t,"is already registered");this._actions[t]=e},bm.prototype.unregister=function(t){if(!this.isRegistered(t))throw _m(t,"is not a registered action");this._actions[t]=void 0},bm.prototype.getActions=function(){return Object.keys(this._actions)},bm.prototype.isRegistered=function(t){return!!this._actions[t]};var wm={__init__:["editorActions"],editorActions:["type",bm]};function xm(t){t.invoke(bm,this)}Ka()(xm,bm),xm.$inject=["injector"],xm.prototype._registerDefaultActions=function(t){bm.prototype._registerDefaultActions.call(this,t);var e=t.get("canvas",!1),n=t.get("elementRegistry",!1),i=t.get("selection",!1),r=t.get("spaceTool",!1),o=t.get("lassoTool",!1),a=t.get("handTool",!1),s=t.get("globalConnect",!1),c=t.get("distributeElements",!1),l=t.get("alignElements",!1),u=t.get("directEditing",!1),h=t.get("searchPad",!1),p=t.get("modeling",!1);e&&n&&i&&this._registerAction("selectElements",(function(){var t=e.getRootElement(),r=n.filter((function(e){return e!==t}));return i.select(r),r})),r&&this._registerAction("spaceTool",(function(){r.toggle()})),o&&this._registerAction("lassoTool",(function(){o.toggle()})),a&&this._registerAction("handTool",(function(){a.toggle()})),s&&this._registerAction("globalConnectTool",(function(){s.toggle()})),i&&c&&this._registerAction("distributeElements",(function(t){var e=i.get(),n=t.type;e.length&&c.trigger(e,n)})),i&&l&&this._registerAction("alignElements",(function(t){var e=i.get(),n=[],r=t.type;e.length&&(n=ro(e,(function(t){return!vl(t,"bpmn:Lane")})),l.trigger(n,r))})),i&&p&&this._registerAction("setColor",(function(t){var e=i.get();e.length&&p.setColor(e,t)})),i&&u&&this._registerAction("directEditing",(function(){var t=i.get();t.length&&u.activate(t[0])})),h&&this._registerAction("find",(function(){h.toggle()})),e&&p&&this._registerAction("moveToOrigin",(function(){var t,i,r=e.getRootElement();t=os(i=vl(r,"bpmn:Collaboration")?n.filter((function(t){return vl(t.parent,"bpmn:Collaboration")})):n.filter((function(t){return t!==r&&!vl(t.parent,"bpmn:SubProcess")}))),p.moveElements(i,{x:-t.x,y:-t.y},r)}))};var Em={__depends__:[wm],editorActions:["type",xm]};function Sm(t){t.on(["create.init","shape.move.init"],(function(t){var e=t.context;Xh(t.shape,["bpmn:Participant","bpmn:SubProcess","bpmn:TextAnnotation"])&&(e.gridSnappingContext||(e.gridSnappingContext={}),e.gridSnappingContext.snapLocation="top-left")}))}Sm.$inject=["eventBus"];function Cm(t,e,n){return n||(n="round"),Math[n](t/e)*e}var km=1200,Pm=800;function Tm(t,e,n){var i=!n||!1!==n.active;this._eventBus=e;var r=this;e.on("diagram.init",Pm,(function(){r.setActive(i)})),e.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],km,(function(e){var n=e.originalEvent;if(!(!r.active||n&&oh(n))){var i=e.context,o=i.gridSnappingContext;o||(o=i.gridSnappingContext={}),["x","y"].forEach((function(n){var i={},o=function(t,e,n){var i=t.context,r=t.shape,o=i.gridSnappingContext,a=o.snapLocation,s=o.snapOffset;if(s&&Qr(s[e]))return s[e];s||(s=o.snapOffset={});Qr(s[e])||(s[e]=0);if(!r)return s[e];n.get(r.id)||(Om(e)?s[e]+=r[e]+r.width/2:s[e]+=r[e]+r.height/2);if(!a)return s[e];"x"===e?/left/.test(a)?s[e]-=r.width/2:/right/.test(a)&&(s[e]+=r.width/2):/top/.test(a)?s[e]-=r.height/2:/bottom/.test(a)&&(s[e]+=r.height/2);return s[e]}(e,n,t);o&&(i.offset=o);var a=function(t,e){var n=t.context,i=n.createConstraints,r=n.resizeConstraints||{},o=n.gridSnappingContext,a=o.snapConstraints;if(a&&a[e])return a[e];a||(a=o.snapConstraints={});a[e]||(a[e]={});var s=n.direction;i&&(Om(e)?(a.x.min=i.left,a.x.max=i.right):(a.y.min=i.top,a.y.max=i.bottom));var c=r.min,l=r.max;c&&(Om(e)?Mm(s)?a.x.max=c.left:a.x.min=c.right:Am(s)?a.y.max=c.top:a.y.min=c.bottom);l&&(Om(e)?Mm(s)?a.x.min=l.left:a.x.max=l.right:Am(s)?a.y.min=l.top:a.y.max=l.bottom);return a[e]}(e,n);a&&ko(i,a),gd(e,n)||r.snapEvent(e,n,i)}))}}))}function Om(t){return"x"===t}function Am(t){return"n"===t.charAt(0)}function Mm(t){return"w"===t.charAt(1)}function jm(t,e){hp.call(this,t),this._gridSnapping=e;var n=this;this.preExecute("shape.resize",(function(t){var e=t.context,i=(e.hints||{}).autoResize;if(i){var r=e.shape,o=e.newBounds;eo(i)?e.newBounds=n.snapComplex(o,i):e.newBounds=n.snapSimple(r,o)}}))}Tm.prototype.snapEvent=function(t,e,n){bd(t,e,this.snapValue(t[e],n))},Tm.prototype.getGridSpacing=function(){return 10},Tm.prototype.snapValue=function(t,e){var n,i,r=0;return e&&e.offset&&(r=e.offset),t=Cm(t+=r,10),e&&e.min&&Qr(n=e.min)&&(n=Cm(n+r,10,"ceil"),t=Math.max(t,n)),e&&e.max&&Qr(i=e.max)&&(i=Cm(i+r,10,"floor"),t=Math.min(t,i)),t-=r},Tm.prototype.isActive=function(){return this.active},Tm.prototype.setActive=function(t){this.active=t,this._eventBus.fire("gridSnapping.toggle",{active:t})},Tm.prototype.toggleActive=function(){this.setActive(!this.active)},Tm.$inject=["elementRegistry","eventBus","config.gridSnapping"],jm.$inject=["eventBus","gridSnapping","modeling"],Ka()(jm,hp),jm.prototype.snapSimple=function(t,e){var n=this._gridSnapping;return e.width=n.snapValue(e.width,{min:e.width}),e.height=n.snapValue(e.height,{min:e.height}),e.x=t.x+t.width/2-e.width/2,e.y=t.y+t.height/2-e.height/2,e},jm.prototype.snapComplex=function(t,e){return/w|e/.test(e)&&(t=this.snapHorizontally(t,e)),/n|s/.test(e)&&(t=this.snapVertically(t,e)),t},jm.prototype.snapHorizontally=function(t,e){var n=this._gridSnapping,i=/w/.test(e),r=/e/.test(e),o={};return o.width=n.snapValue(t.width,{min:t.width}),r&&(i?(o.x=n.snapValue(t.x,{max:t.x}),o.width+=n.snapValue(t.x-o.x,{min:t.x-o.x})):t.x=t.x+t.width-o.width),ko(t,o),t},jm.prototype.snapVertically=function(t,e){var n=this._gridSnapping,i=/n/.test(e),r=/s/.test(e),o={};return o.height=n.snapValue(t.height,{min:t.height}),i&&(r?(o.y=n.snapValue(t.y,{max:t.y}),o.height+=n.snapValue(t.y-o.y,{min:t.y-o.y})):t.y=t.y+t.height-o.height),ko(t,o),t};var Rm=2e3;function Dm(t,e){t.on(["spaceTool.move","spaceTool.end"],Rm,(function(t){var n=t.context;n.initialized&&("x"===n.axis?t.dx=e.snapValue(t.dx):t.dy=e.snapValue(t.dy))}))}Dm.$inject=["eventBus","gridSnapping"];var Nm={__depends__:[{__init__:["gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior"],gridSnappingResizeBehavior:["type",jm],gridSnappingSpaceToolBehavior:["type",Dm]}],__init__:["gridSnapping"],gridSnapping:["type",Tm]};function Im(t,e){t.on("autoPlace",(function(t){var n=t.source,i=yu(n),r=t.shape,o=ep(n,r);return["x","y"].forEach((function(t){var n={};o[t]!==i[t]&&(o[t]>i[t]?n.min=o[t]:n.max=o[t],vl(r,"bpmn:TextAnnotation")&&(!function(t){return"x"===t}(t)?n.offset=-r.height/2:n.offset=-r.width/2),o[t]=e.snapValue(o[t],n))})),o}))}Im.$inject=["eventBus","gridSnapping"];var Lm=1750;function Bm(t,e,n){e.on(["create.start","shape.move.start"],Lm,(function(e){var i=e.context,r=i.shape,o=t.getRootElement();vl(r,"bpmn:Participant")&&vl(o,"bpmn:Process")&&o.children.length&&(i.createConstraints&&(r.width=n.snapValue(r.width,{min:r.width}),r.height=n.snapValue(r.height,{min:r.height})))}))}Bm.$inject=["canvas","eventBus","gridSnapping"];var Fm=3e3;function zm(t,e,n){hp.call(this,t),this._gridSnapping=e;var i=this;this.postExecuted(["connection.create","connection.layout"],Fm,(function(t){var e=t.context,r=e.connection,o=e.hints||{},a=r.waypoints;o.connectionStart||o.connectionEnd||function(t){return t.length>3}(a)&&n.updateWaypoints(r,i.snapMiddleSegments(a))}))}function Gm(t,e,n){var i=cu(e,n),r={};return function(t){return"h"===t}(i)&&(r.y=t.snapValue(e.y)),function(t){return"v"===t}(i)&&(r.x=t.snapValue(e.x)),("x"in r||"y"in r)&&(e=ko({},e,r),n=ko({},n,r)),[e,n]}zm.$inject=["eventBus","gridSnapping","modeling"],Ka()(zm,hp),zm.prototype.snapMiddleSegments=function(t){var e,n=this._gridSnapping;t=t.slice();for(var i=1;i<t.length-2;i++)e=Gm(n,t[i],t[i+1]),t[i]=e[0],t[i+1]=e[1];return t};var Vm={__depends__:[Nm,{__init__:["gridSnappingAutoPlaceBehavior","gridSnappingCreateParticipantBehavior","gridSnappingLayoutConnectionBehavior"],gridSnappingAutoPlaceBehavior:["type",Im],gridSnappingCreateParticipantBehavior:["type",Bm],gridSnappingLayoutConnectionBehavior:["type",zm]}],__init__:["bpmnGridSnapping"],bpmnGridSnapping:["type",Sm]};function Hm(t,e){this._interactionEvents=e;var n=this;t.on(["interactionEvents.createHit","interactionEvents.updateHit"],(function(t){var e=t.element,i=t.gfx;return vl(e,"bpmn:Lane")?n.createParticipantHit(e,i):vl(e,"bpmn:Participant")?gl(e)?n.createParticipantHit(e,i):n.createDefaultHit(e,i):vl(e,"bpmn:SubProcess")?gl(e)?n.createSubProcessHit(e,i):n.createDefaultHit(e,i):void 0}))}Hm.$inject=["eventBus","interactionEvents"],Hm.prototype.createDefaultHit=function(t,e){return this._interactionEvents.removeHits(e),this._interactionEvents.createDefaultHit(t,e),!0},Hm.prototype.createParticipantHit=function(t,e){return this._interactionEvents.removeHits(e),this._interactionEvents.createBoxHit(e,"click-stroke",{width:t.width,height:t.height}),this._interactionEvents.createBoxHit(e,"all",{width:30,height:t.height}),!0},Hm.prototype.createSubProcessHit=function(t,e){return this._interactionEvents.removeHits(e),this._interactionEvents.createBoxHit(e,"click-stroke",{width:t.width,height:t.height}),this._interactionEvents.createBoxHit(e,"all",{width:t.width,height:30}),!0};var Um={__init__:["bpmnInteractionEvents"],bpmnInteractionEvents:["type",Hm]};function Wm(t){t.invoke(uh,this)}Ka()(Wm,uh),Wm.$inject=["injector"],Wm.prototype.registerBindings=function(t,e){function n(n,i){e.isRegistered(n)&&t.addListener(i)}uh.prototype.registerBindings.call(this,t,e),n("selectElements",(function(n){var i=n.keyEvent;if(t.isKey(["a","A"],i)&&t.isCmd(i))return e.trigger("selectElements"),!0})),n("find",(function(n){var i=n.keyEvent;if(t.isKey(["f","F"],i)&&t.isCmd(i))return e.trigger("find"),!0})),n("spaceTool",(function(n){var i=n.keyEvent;if(!t.hasModifier(i))return t.isKey(["s","S"],i)?(e.trigger("spaceTool"),!0):void 0})),n("lassoTool",(function(n){var i=n.keyEvent;if(!t.hasModifier(i))return t.isKey(["l","L"],i)?(e.trigger("lassoTool"),!0):void 0})),n("handTool",(function(n){var i=n.keyEvent;if(!t.hasModifier(i))return t.isKey(["h","H"],i)?(e.trigger("handTool"),!0):void 0})),n("globalConnectTool",(function(n){var i=n.keyEvent;if(!t.hasModifier(i))return t.isKey(["c","C"],i)?(e.trigger("globalConnectTool"),!0):void 0})),n("directEditing",(function(n){var i=n.keyEvent;if(!t.hasModifier(i))return t.isKey(["e","E"],i)?(e.trigger("directEditing"),!0):void 0}))};var $m={__depends__:[hh],__init__:["keyboardBindings"],keyboardBindings:["type",Wm]},qm={moveSpeed:1,moveSpeedAccelerated:10},Km=1500,Ym={ArrowLeft:"left",Left:"left",ArrowUp:"up",Up:"up",ArrowRight:"right",Right:"right",ArrowDown:"down",Down:"down"},Xm={left:function(t){return{x:-t,y:0}},up:function(t){return{x:0,y:-t}},right:function(t){return{x:t,y:0}},down:function(t){return{x:0,y:t}}};function Zm(t,e,n,i,r){var o=this;this._config=ko({},qm,t||{}),e.addListener(Km,(function(t){var n=t.keyEvent,i=Ym[n.key];if(i&&!e.isCmd(n)){var r=e.isShift(n);return o.moveSelection(i,r),!0}})),this.moveSelection=function(t,e){var o=r.get();if(o.length){var a=this._config[e?"moveSpeedAccelerated":"moveSpeed"],s=Xm[t](a);i.allowed("elements.move",{shapes:o})&&n.moveElements(o,s)}}}Zm.$inject=["config.keyboardMoveSelection","keyboard","modeling","rules","selection"];var Jm={__depends__:[hh,Uu],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",Zm]};function Qm(t,e,n,i){t.on("element.changed",(function(i){var r=i.element;(r.parent||r===e.getRootElement())&&(i.gfx=n.getGraphics(r)),i.gfx&&t.fire(as(r)+".changed",i)})),t.on("elements.changed",(function(e){var n=e.elements;n.forEach((function(e){t.fire("element.changed",{element:e})})),i.updateContainments(n)})),t.on("shape.changed",(function(t){i.update("shape",t.element,t.gfx)})),t.on("connection.changed",(function(t){i.update("connection",t.element,t.gfx)}))}Qm.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];var tv={__init__:["changeSupport"],changeSupport:["type",Qm]};function ev(t,e,n,i){this._dragging=i,this._rules=e;var r=this;function o(t,e){var n,i=t.shape,o=t.direction,a=t.resizeConstraints;t.delta=e,n=function(t,e,n){var i=n.x,r=n.y;switch(e){case"nw":return{x:t.x+i,y:t.y+r,width:t.width-i,height:t.height-r};case"sw":return{x:t.x+i,y:t.y,width:t.width-i,height:t.height+r};case"ne":return{x:t.x,y:t.y+r,width:t.width+i,height:t.height-r};case"se":return{x:t.x,y:t.y,width:t.width+i,height:t.height+r};default:throw new Error("unrecognized direction: "+e)}}(i,o,e),t.newBounds=function(t,e){if(!e)return t;var n=mu(t);return vu({top:em("top",n,e),right:em("right",n,e),bottom:em("bottom",n,e),left:em("left",n,e)})}(n,a),t.canExecute=r.canResize(t)}t.on("resize.start",(function(t){var e,n,i;e=t.context,n=e.resizeConstraints,i=e.minBounds,void 0===n&&(void 0===i&&(i=r.computeMinResizeBox(e)),e.resizeConstraints={min:mu(i)})})),t.on("resize.move",(function(t){var e={x:t.dx,y:t.dy};o(t.context,e)})),t.on("resize.end",(function(t){!function(t){var e=t.shape,i=t.canExecute,r=t.newBounds;if(i){if(!function(t,e){return t.x!==e.x||t.y!==e.y||t.width!==e.width||t.height!==e.height}(e,r=du(r)))return;n.resizeShape(e,r)}}(t.context)}))}ev.prototype.canResize=function(t){var e=this._rules,n=Po(t,["newBounds","shape","delta","direction"]);return e.allowed("shape.resize",n)},ev.prototype.activate=function(t,e,n){var i,r,o=this._dragging;if("string"==typeof n&&(n={direction:n}),!(r=(i=ko({shape:e},n)).direction))throw new Error("must provide a direction (nw|se|ne|sw)");var a={x:/w/.test(r)?e.x:e.x+e.width,y:/n/.test(r)?e.y:e.y+e.height};o.init(t,a,"resize",{autoActivate:!0,cursor:"resize-"+(/nw|se/.test(r)?"nwse":"nesw"),data:{shape:e,context:i}})},ev.prototype.computeMinResizeBox=function(t){var e=t.shape;return function(t,e,n,i){var r=mu(e),o={top:/n/.test(t)?r.bottom-n.height:r.top,left:/w/.test(t)?r.right-n.width:r.left,bottom:/s/.test(t)?r.top+n.height:r.bottom,right:/e/.test(t)?r.left+n.width:r.right},a=i?mu(i):o;return vu({top:Jf(o.top,a.top),left:Jf(o.left,a.left),bottom:Zf(o.bottom,a.bottom),right:Zf(o.right,a.right)})}(t.direction,e,t.minDimensions||{width:10,height:10},rm(e,t.childrenBoxPadding))},ev.$inject=["eventBus","rules","modeling","dragging"];var nv="djs-resizing",iv="resize-not-ok",rv=500;function ov(t,e,n){t.on("resize.move",rv,(function(t){var i,r,o,a;i=t.context,r=i.shape,o=i.newBounds,(a=i.frame)||(a=i.frame=n.addFrame(r,e.getDefaultLayer()),e.addMarker(r,nv)),o.width>5&&la(a,{x:o.x,width:o.width}),o.height>5&&la(a,{y:o.y,height:o.height}),i.canExecute?fa(a).remove(iv):fa(a).add(iv)})),t.on("resize.cleanup",(function(t){var n,i;n=t.context,i=n.shape,n.frame&&va(n.frame),e.removeMarker(i,nv)}))}ov.$inject=["eventBus","canvas","previewSupport"];function av(t,e,n,i){this._resize=i,this._canvas=e;var r=this;t.on("selection.changed",(function(t){var e=t.newSelection;r.removeResizers(),1===e.length&&oo(e,So(r.addResizer,r))})),t.on("shape.changed",(function(t){var e=t.element;n.isSelected(e)&&(r.removeResizers(),r.addResizer(e))}))}av.prototype.makeDraggable=function(t,e,n){var i=this._resize;function r(e){Au(e)&&i.activate(e,t,n)}Wo.bind(e,"mousedown",r),Wo.bind(e,"touchstart",r)},av.prototype._createResizer=function(t,e,n,i,r){var o=this._getResizersParent(),a=xa("g");fa(a).add("djs-resizer"),fa(a).add("djs-resizer-"+t.id),fa(a).add("djs-resizer-"+r),oa(o,a);var s=xa("rect");la(s,{x:-7,y:-7,width:5,height:5}),fa(s).add("djs-resizer-visual"),oa(a,s);var c=xa("rect");return la(c,{x:-7,y:-7,width:20,height:20}),fa(c).add("djs-resizer-hit"),oa(a,c),Gs(a,e,n,i),a},av.prototype.createResizer=function(t,e){var n,i=mu(t);n="nw"===e?this._createResizer(t,i.left,i.top,0,e):"ne"===e?this._createResizer(t,i.right,i.top,90,e):"se"===e?this._createResizer(t,i.right,i.bottom,180,e):this._createResizer(t,i.left,i.bottom,270,e),this.makeDraggable(t,n,e)},av.prototype.addResizer=function(t){this._resize.canResize({shape:t})&&(this.createResizer(t,"nw"),this.createResizer(t,"ne"),this.createResizer(t,"se"),this.createResizer(t,"sw"))},av.prototype.removeResizers=function(){ya(this._getResizersParent())},av.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")},av.$inject=["eventBus","canvas","selection","resize"];var sv={__depends__:[Op,Sp,qd],__init__:["resize","resizePreview","resizeHandles"],resize:["type",ev],resizePreview:["type",ov],resizeHandles:["type",av]};function cv(t,e){var n=e.create("bpmn:CategoryValue"),i=e.create("bpmn:Category",{categoryValue:[n]});return ds(t.get("rootElements"),i),yl(i).$parent=t,yl(n).$parent=i,n}function lv(t,e,n,i,r,o,a){function s(t,e){(e||Xh(t,["bpmn:Task","bpmn:TextAnnotation","bpmn:Group"])||uv(t))&&i.activate(t)}this._bpmnFactory=e,this._canvas=n,this._modeling=r,this._textRenderer=a,i.registerProvider(this),t.on("element.dblclick",(function(t){s(t.element,!0)})),t.on(["autoPlace.start","canvas.viewbox.changing","drag.init","element.mousedown","popupMenu.open"],(function(t){i.isActive()&&i.complete()})),t.on(["commandStack.changed"],(function(t){i.isActive()&&i.cancel()})),t.on("directEditing.activate",(function(t){o.removeResizers()})),t.on("create.end",500,(function(t){var e=t.context,n=e.shape,i=t.context.canExecute;t.isTouch||i&&(e.hints&&!1===e.hints.createElementsBehavior||s(n))})),t.on("autoPlace.end",500,(function(t){s(t.shape)}))}function uv(t){return vl(t,"bpmn:SubProcess")&&!gl(t)}lv.$inject=["eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer"],lv.prototype.activate=function(t){var e=xl(t);if(void 0!==e){var n={text:e};ko(n,this.getEditingBBox(t));var i={};return(Xh(t,["bpmn:Task","bpmn:Participant","bpmn:Lane","bpmn:CallActivity"])||uv(t))&&ko(i,{centerVertically:!0}),tu(t)&&ko(i,{autoResize:!0}),vl(t,"bpmn:TextAnnotation")&&ko(i,{resizable:!0,autoResize:!0}),ko(n,{options:i}),n}},lv.prototype.getEditingBBox=function(t){var e=this._canvas,n=t.label||t,i=e.getAbsoluteBBox(n),r=i.x+i.width/2,o=i.y+i.height/2,a={x:i.x,y:i.y},s=e.zoom(),c=this._textRenderer.getDefaultStyle(),l=this._textRenderer.getExternalStyle(),u=l.fontSize*s,h=l.lineHeight,p=c.fontSize*s,d=c.lineHeight,f={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};(vl(t,"bpmn:Lane")||function(t){return vl(t,"bpmn:Participant")&&gl(t)}(t))&&(ko(a,{width:i.height,height:30*s,x:i.x-i.height/2+15*s,y:o-30*s/2}),ko(f,{fontSize:p+"px",lineHeight:d,paddingTop:7*s+"px",paddingBottom:7*s+"px",paddingLeft:5*s+"px",paddingRight:5*s+"px",transform:"rotate(-90deg)"})),(Xh(t,["bpmn:Task","bpmn:CallActivity"])||function(t){return vl(t,"bpmn:Participant")&&!gl(t)}(t)||uv(t))&&(ko(a,{width:i.width,height:i.height}),ko(f,{fontSize:p+"px",lineHeight:d,paddingTop:7*s+"px",paddingBottom:7*s+"px",paddingLeft:5*s+"px",paddingRight:5*s+"px"})),function(t){return vl(t,"bpmn:SubProcess")&&gl(t)}(t)&&(ko(a,{width:i.width,x:i.x}),ko(f,{fontSize:p+"px",lineHeight:d,paddingTop:7*s+"px",paddingBottom:7*s+"px",paddingLeft:5*s+"px",paddingRight:5*s+"px"}));var m=90*s,v=7*s,y=4*s;if(n.labelTarget&&(ko(a,{width:m,height:i.height+v+y,x:r-m/2,y:i.y-v}),ko(f,{fontSize:u+"px",lineHeight:h,paddingTop:v+"px",paddingBottom:y+"px"})),tu(n)&&!eu(n)&&!ru(n)){var g=iu(t),b=e.getAbsoluteBBox({x:g.x,y:g.y,width:0,height:0}),_=u+v+y;ko(a,{width:m,height:_,x:b.x-m/2,y:b.y-_/2}),ko(f,{fontSize:u+"px",lineHeight:h,paddingTop:v+"px",paddingBottom:y+"px"})}return vl(t,"bpmn:TextAnnotation")&&(ko(a,{width:i.width,height:i.height,minWidth:30*s,minHeight:10*s}),ko(f,{textAlign:"left",paddingTop:5*s+"px",paddingBottom:7*s+"px",paddingLeft:7*s+"px",paddingRight:5*s+"px",fontSize:p+"px",lineHeight:d})),{bounds:a,style:f}},lv.prototype.update=function(t,e,n,i){var r,o,a;if((vl(t,"bpmn:TextAnnotation")&&(o=this._canvas.getAbsoluteBBox(t),r={x:t.x,y:t.y,width:t.width/o.width*i.width,height:t.height/o.height*i.height}),vl(t,"bpmn:Group"))&&!yl(t).categoryValueRef){var s=cv(yl(this._canvas.getRootElement()).$parent,this._bpmnFactory);yl(t).categoryValueRef=s}(a=e)&&a.trim()||(e=null),this._modeling.updateLabel(t,e,r)};var hv="djs-element-hidden",pv="djs-label-hidden";function dv(t,e,n,i){var r,o,a,s=this,c=e.getDefaultLayer();t.on("directEditing.activate",(function(t){var n=t.active;if(vl(r=n.element.label||n.element,"bpmn:TextAnnotation")){o=e.getAbsoluteBBox(r),a=xa("g");var l=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:r.width,containerHeight:r.height,position:{mx:0,my:0}}),u=s.path=xa("path");la(u,{d:l,strokeWidth:2,stroke:fv(r)}),oa(a,u),oa(c,a),Vs(a,r.x,r.y)}vl(r,"bpmn:TextAnnotation")||r.labelTarget?e.addMarker(r,hv):(vl(r,"bpmn:Task")||vl(r,"bpmn:CallActivity")||vl(r,"bpmn:SubProcess")||vl(r,"bpmn:Participant"))&&e.addMarker(r,pv)})),t.on("directEditing.resize",(function(t){if(vl(r,"bpmn:TextAnnotation")){var e=t.height,n=t.dy,a=Math.max(r.height/o.height*(e+n),0),c=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:r.width,containerHeight:a,position:{mx:0,my:0}});la(s.path,{d:c})}})),t.on(["directEditing.complete","directEditing.cancel"],(function(t){var n=t.active;n&&(e.removeMarker(n.element.label||n.element,hv),e.removeMarker(r,pv)),r=void 0,o=void 0,a&&(va(a),a=void 0)}))}function fv(t,e){return yl(t).di.get("stroke")||e||"black"}dv.$inject=["eventBus","canvas","elementRegistry","pathMap"];var mv={__depends__:[tv,sv,Gd],__init__:["labelEditingProvider","labelEditingPreview"],labelEditingProvider:["type",lv],labelEditingPreview:["type",dv]},vv=["top","bottom","left","right"],yv=10;function gv(t,e){function n(t){if(eu(t)){var n=function(t){var e=yu(t.label),n=bv(yu(t),e);if(i=n,-1===vv.indexOf(i))return;var i;var r=function(t){var e=yu(t);return[].concat(t.incoming.map((function(t){return t.waypoints[t.waypoints.length-2]})),t.outgoing.map((function(t){return t.waypoints[1]}))).map((function(t){return bv(e,t)}))}(t);if(t.host){var o=function(t){var e,n=t.host,i=gu(yu(t),n);e=i.indexOf("-")>=0?i.split("-"):[i];return vv.filter((function(t){return-1===e.indexOf(t)}))}(t);r=r.concat(o)}var a=vv.filter((function(t){return-1===r.indexOf(t)}));if(-1!==a.indexOf(n))return;return a[0]}(t);n&&function(t,n){var i=yu(t),r=t.label,o=yu(r);if(!r.parent)return;var a,s=mu(t);switch(n){case"top":a={x:i.x,y:s.top-yv-r.height/2};break;case"left":a={x:s.left-yv-r.width/2,y:i.y};break;case"bottom":a={x:i.x,y:s.bottom+yv+r.height/2};break;case"right":a={x:s.right+yv+r.width/2,y:i.y}}var c=wh(a,o);e.moveShape(r,c)}(t,n)}}hp.call(this,t),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],(function(t){var e=t.context.connection,i=e.source,r=e.target;n(i),n(r)})),this.postExecuted(["label.create"],(function(t){n(t.context.shape.labelTarget)})),this.postExecuted(["elements.create"],(function(t){t.context.elements.forEach((function(t){n(t)}))}))}function bv(t,e){return gu(e,t,5)}function _v(t,e,n){hp.call(this,t),this.preExecute("shape.append",(function(t){var e=t.source,n=t.shape;t.position||(vl(n,"bpmn:TextAnnotation")?t.position={x:e.x+e.width/2+75,y:e.y-50-n.height/2}:t.position={x:e.x+e.width+80+n.width/2,y:e.y+e.height/2})}),!0)}Ka()(gv,hp),gv.$inject=["eventBus","modeling"],Ka()(_v,hp),_v.$inject=["eventBus","elementFactory","bpmnRules"];var wv=500;function xv(t,e){e.invoke(hp,this),this._bpmnReplace=t;var n=this;this.postExecuted("elements.create",wv,(function(t){var e=t.elements;1===(e=e.filter((function(t){return Ev(t,t.host)}))).length&&e.map((function(t){return e.indexOf(t)})).forEach((function(i){var r=e[i];t.elements[i]=n.replaceShape(e[i],r)}))}),!0),this.preExecute("elements.move",wv,(function(t){var e=t.shapes,i=t.newHost;if(1===e.length){var r=e[0];Ev(r,i)&&(t.shapes=[n.replaceShape(r,i)])}}),!0)}function Ev(t,e){return!ru(t)&&Xh(t,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!e}function Sv(t,e){function n(t){return ro(t.attachers,(function(t){return vl(t,"bpmn:BoundaryEvent")}))}hp.call(this,t),this.postExecute("connection.create",(function(t){var i=t.context.source,r=t.context.target,o=n(r);vl(i,"bpmn:EventBasedGateway")&&vl(r,"bpmn:ReceiveTask")&&o.length>0&&e.removeElements(o)})),this.postExecute("connection.reconnectStart",(function(t){var i=t.context.oldSource,r=t.context.newSource;vl(i,"bpmn:Gateway")&&vl(r,"bpmn:EventBasedGateway")&&oo(r.outgoing,(function(t){var i=t.target,r=n(i);vl(i,"bpmn:ReceiveTask")&&r.length>0&&e.removeElements(r)}))}))}function Cv(t){t.invoke(hp,this),this.preExecute("shape.create",1500,(function(t){var e=t.context,n=e.parent;vl(n,"bpmn:Lane")&&(e.parent=Zh(n,"bpmn:Participant"))}))}xv.$inject=["bpmnReplace","injector"],Ka()(xv,hp),xv.prototype.replaceShape=function(t,e){var n,i=(n=yl(t).eventDefinitions)&&n[0],r={type:"bpmn:BoundaryEvent",host:e};return i&&(r.eventDefinitionType=i.$type),this._bpmnReplace.replaceElement(t,r,{layoutConnection:!1})},Sv.$inject=["eventBus","modeling"],Ka()(Sv,hp),Cv.$inject=["injector"],Ka()(Cv,hp);var kv=1500,Pv=2e3;function Tv(t,e,n){e.on(["create.hover","create.move","create.end","shape.move.hover","shape.move.move","shape.move.end"],kv,(function(e){var i=e.context.shape||e.shape,r=e.hover;vl(r,"bpmn:Lane")&&!Xh(i,["bpmn:Lane","bpmn:Participant"])&&(e.hover=lm(r),e.hoverGfx=t.getGraphics(e.hover));var o=n.getRootElement();r!==o&&(i.labelTarget||vl(i,"bpmn:Group"))&&(e.hover=o,e.hoverGfx=t.getGraphics(e.hover))})),e.on(["connect.hover","global-connect.hover"],kv,(function(e){var n=e.hover;vl(n,"bpmn:Lane")&&(e.hover=lm(n)||n,e.hoverGfx=t.getGraphics(e.hover))})),e.on(["bendpoint.move.hover"],kv,(function(e){var n=e.context.type,i=e.hover;vl(i,"bpmn:Lane")&&/reconnect/.test(n)&&(e.hover=lm(i)||i,e.hoverGfx=t.getGraphics(e.hover))})),e.on(["connect.start"],kv,(function(t){var e=t.context,n=e.source;vl(n,"bpmn:Lane")&&(e.source=lm(n)||n)})),e.on("shape.move.start",Pv,(function(t){var e=t.shape;vl(e,"bpmn:Lane")&&(t.shape=lm(e)||e)}))}function Ov(t,e,n){hp.call(this,t),this.preExecute("shape.create",(function(t){var n=t.context.shape;if(vl(n,"bpmn:DataObjectReference")&&"label"!==n.type){var i=e.create("bpmn:DataObject");n.businessObject.dataObjectRef=i}}))}Tv.$inject=["elementRegistry","eventBus","canvas"],Ov.$inject=["eventBus","bpmnFactory","moddle"],Ka()(Ov,hp);var Av=20,Mv=20,jv=30,Rv=2e3;function Dv(t,e,n){function i(e){var i,r=e.parent,o=t.getRootElement();vl(o,"bpmn:Collaboration")?i=o:(i=n.makeCollaboration(),e.process=r),e.parent=i}hp.call(this,e),e.on(["create.start","shape.move.start"],Rv,(function(e){var n=e.context,i=n.shape,r=t.getRootElement();if(vl(i,"bpmn:Participant")&&vl(r,"bpmn:Process")&&r.children.length){var o=r.children.filter((function(t){return!vl(t,"bpmn:Group")&&!ru(t)&&!function(t){return!!t.waypoints}(t)}));if(o.length){var a=os(o);ko(i,function(t,e){e={width:e.width+2*Av+jv,height:e.height+2*Mv};var n=Math.max(t.width,e.width),i=Math.max(t.height,e.height);return{x:-n/2,y:-i/2,width:n,height:i}}(i,a)),n.createConstraints=function(t,e){return{bottom:(e=mu(e)).top+t.height/2-Mv,left:e.right-t.width/2+Av,top:e.bottom-t.height/2+Mv,right:e.left+t.width/2-Av-jv}}(i,a)}}})),e.on("create.start",Rv,(function(n){var i=n.context.shape,r=t.getRootElement(),o=t.getGraphics(r);function a(t){t.element=r,t.gfx=o}vl(i,"bpmn:Participant")&&vl(r,"bpmn:Process")&&(e.on("element.hover",Rv,a),e.once("create.cleanup",(function(){e.off("element.hover",a)})))})),this.preExecute("shape.create",(function(t){var e=t.parent;vl(t.shape,"bpmn:Participant")&&vl(e,"bpmn:Process")&&i(t)}),!0),this.execute("shape.create",(function(t){var e=t.process,n=t.shape;e&&(t.oldProcessRef=n.businessObject.processRef,n.businessObject.processRef=e.businessObject)}),!0),this.revert("shape.create",(function(t){var e=t.process,n=t.shape;e&&(n.businessObject.processRef=t.oldProcessRef)}),!0),this.postExecute("shape.create",(function(t){var e=t.process,i=t.shape;if(e){var r=e.children.slice();n.moveElements(r,{x:0,y:0},i)}}),!0),this.preExecute("elements.create",Rv,(function(t){var e,n=t.elements,r=t.parent;Nv(n)&&vl(r,"bpmn:Process")&&(i(t),e=Nv(n),t.oldProcessRef=e.businessObject.processRef,e.businessObject.processRef=r.businessObject)}),!0),this.revert("elements.create",(function(t){var e=t.elements;t.process&&(Nv(e).businessObject.processRef=t.oldProcessRef)}),!0),this.postExecute("elements.create",(function(t){var e,i=t.elements,r=t.process;if(r){e=Nv(i);var o=r.children.slice();n.moveElements(o,{x:0,y:0},e)}}),!0)}function Nv(t){return io(t,(function(t){return vl(t,"bpmn:Participant")}))}Dv.$inject=["canvas","eventBus","modeling"],Ka()(Dv,hp);var Iv="__targetRef_placeholder";function Lv(t,e){function n(t,n){var i=t.get("properties"),r=io(i,(function(t){return t.name===Iv}));return!r&&n&&ds(i,r=e.create("bpmn:Property",{name:Iv})),r}function i(t,e){var i=n(t);i&&(function(t,e,n){return io(t.get("dataInputAssociations"),(function(t){return t!==n&&t.targetRef===e}))}(t,i,e)||ps(t.get("properties"),i))}function r(t){var e,r=t.context,o=r.connection,a=o.businessObject,s=o.target,c=s&&s.businessObject,l=r.newTarget,u=l&&l.businessObject,h=r.oldTarget||r.target,p=h&&h.businessObject,d=o.businessObject;p&&p!==c&&i(p,a),u&&u!==c&&i(u,a),c?(e=n(c,!0),d.targetRef=e):d.targetRef=null}hp.call(this,t),this.executed(["connection.create","connection.delete","connection.move","connection.reconnectEnd"],Bv(r)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnectEnd"],Bv(r))}function Bv(t){return function(e){if(vl(e.context.connection,"bpmn:DataInputAssociation"))return t(e)}}function Fv(t){this._bpmnUpdater=t}function zv(t,e,n,i){function r(t){return t.children.filter((function(t){return vl(t,"bpmn:DataStoreReference")&&!t.labelTarget}))}function o(t,i){var r=t.businessObject||t;if(i=i||n.filter((function(t){return vl(t,"bpmn:Participant")}))[0]){var o=i.businessObject||i;e.execute("dataStore.updateContainment",{dataStoreBo:r,newSemanticParent:o.processRef||o,newDiParent:o.di})}}hp.call(this,i),e.registerHandler("dataStore.updateContainment",Fv),this.preExecute("shape.create",(function(t){var e=t.context,n=e.shape;vl(n,"bpmn:DataStoreReference")&&"label"!==n.type&&(e.hints||(e.hints={}),e.hints.autoResize=!1)})),this.preExecute("elements.move",(function(t){var e=t.context,n=e.shapes;n.filter((function(t){return vl(t,"bpmn:DataStoreReference")})).length&&(e.hints||(e.hints={}),e.hints.autoResize=n.filter((function(t){return!vl(t,"bpmn:DataStoreReference")})))})),this.postExecute("shape.create",(function(t){var e=t.context.shape,n=e.parent;vl(e,"bpmn:DataStoreReference")&&"label"!==e.type&&vl(n,"bpmn:Collaboration")&&o(e)})),this.postExecute("shape.move",(function(t){var e=t.context,n=e.shape,i=e.oldParent,r=n.parent;vl(i,"bpmn:Collaboration")||vl(n,"bpmn:DataStoreReference")&&"label"!==n.type&&vl(r,"bpmn:Collaboration")&&o(n,vl(i,"bpmn:Participant")?i:function(t,e){for(;t.parent;){if(vl(t.parent,e))return t.parent;t=t.parent}}(i,"bpmn:Participant"))})),this.postExecute("shape.delete",(function(e){var n=e.context.shape,i=t.getRootElement();Xh(n,["bpmn:Participant","bpmn:SubProcess"])&&vl(i,"bpmn:Collaboration")&&r(i).filter((function(t){return function(t,e){var n=t.businessObject||t,i=e.businessObject||e;for(;n.$parent;){if(n.$parent===i.processRef||i)return!0;n=n.$parent}return!1}(t,n)})).forEach((function(t){o(t)}))})),this.postExecute("canvas.updateRoot",(function(t){var e=t.context,n=e.oldRoot,i=e.newRoot;r(n).forEach((function(t){vl(i,"bpmn:Process")&&o(t,i)}))}))}Lv.$inject=["eventBus","bpmnFactory"],Ka()(Lv,hp),Fv.$inject=["bpmnUpdater"],Fv.prototype.execute=function(t){var e=t.dataStoreBo,n=t.newSemanticParent,i=t.newDiParent;t.oldSemanticParent=e.$parent,t.oldDiParent=e.di.$parent,this._bpmnUpdater.updateSemanticParent(e,n),this._bpmnUpdater.updateDiParent(e.di,i)},Fv.prototype.revert=function(t){var e=t.dataStoreBo,n=t.oldSemanticParent,i=t.oldDiParent;this._bpmnUpdater.updateSemanticParent(e,n),this._bpmnUpdater.updateDiParent(e.di,i)},zv.$inject=["canvas","commandStack","elementRegistry","eventBus"],Ka()(zv,hp);var Gv=500;function Vv(t,e,n){hp.call(this,t),this.postExecuted("shape.delete",Gv,(function(t){var e=t.context,i=e.hints,r=e.shape,o=e.oldParent;vl(r,"bpmn:Lane")&&(i&&i.nested||function(t,e){var i,r,o,a=cm(e),s=[],c=[];ns(a,(function(e){return e.y>t.y?c.push(e):s.push(e),e.children})),a.length&&(i=c.length&&s.length?t.height/2:t.height,s.length&&(r=n.calculateAdjustments(s,"y",i,t.y-10),n.makeSpace(r.movingShapes,r.resizingShapes,{x:0,y:i},"s")),c.length&&(o=n.calculateAdjustments(c,"y",-i,t.y+t.height+10),n.makeSpace(o.movingShapes,o.resizingShapes,{x:0,y:-i},"n")))}(r,o))}))}Vv.$inject=["eventBus","modeling","spaceTool"],Ka()(Vv,hp);var Hv=500;function Uv(t,e){e.invoke(hp,this),this._bpmnReplace=t;var n=this;this.postExecuted("elements.create",Hv,(function(t){var e=t.elements;e.filter((function(t){return Wv(t,t.host)})).map((function(t){return e.indexOf(t)})).forEach((function(i){t.elements[i]=n.replaceShape(e[i])}))}),!0),this.preExecute("elements.move",Hv,(function(t){var e=t.shapes,i=t.newHost;e.forEach((function(t,r){var o,a=t.host;Wv(t,(o=a,-1!==e.indexOf(o)?a:i))&&(e[r]=n.replaceShape(t))}))}),!0)}function Wv(t,e){return!ru(t)&&vl(t,"bpmn:BoundaryEvent")&&!e}function $v(t,e,n){function i(t,i,r){var o,a,s,c,l,u,h,p,d=i.waypoints,f=t.outgoing.slice(),m=t.incoming.slice(),v=Rp(d,p=Qr(r.width)?yu(r):r);if(v){if(o=d.slice(0,v.index),a=d.slice(v.index+(v.bendpoint?1:0)),!o.length||!a.length)return;s=v.bendpoint?d[v.index]:p,qv(t,o[o.length-1])||o.push(Kv(s)),qv(t,a[0])||a.unshift(Kv(s))}c=i.source,l=i.target,e.canConnect(c,t,i)&&(n.reconnectEnd(i,t,o||p),u=i),e.canConnect(t,l,i)&&(u?h=n.connect(t,l,{type:i.type,waypoints:a}):(n.reconnectStart(i,t,a||p),h=i));var y=[].concat(u&&ro(m,(function(t){return t.source===u.source}))||[],h&&ro(f,(function(t){return t.source===h.source}))||[]);y.length&&n.removeElements(y)}hp.call(this,t),this.preExecute("elements.move",(function(t){var n=t.newParent,i=t.shapes,r=t.delta,o=i[0];if(o&&n){n&&n.waypoints&&(t.newParent=n=n.parent);var a=yu(o),s={x:a.x+r.x,y:a.y+r.y},c=io(n.children,(function(t){return e.canInsert(i,t)&&Rp(t.waypoints,s)}));c&&(t.targetFlow=c,t.position=s)}}),!0),this.postExecuted("elements.move",(function(t){var e=t.shapes,n=t.targetFlow,r=t.position;n&&i(e[0],n,r)}),!0),this.preExecute("shape.create",(function(t){var n=t.parent,i=t.shape;e.canInsert(i,n)&&(t.targetFlow=n,t.parent=n.parent)}),!0),this.postExecuted("shape.create",(function(t){var e=t.shape,n=t.targetFlow,r=t.position;n&&i(e,n,r)}),!0)}function qv(t,e){var n=e.x,i=e.y;return n>=t.x&&n<=t.x+t.width&&i>=t.y&&i<=t.y+t.height}function Kv(t){return ko({},t)}function Yv(t,e){hp.call(this,t),this.preExecuted("connection.create",(function(t){var n=t.context,i=n.source,r=n.target,o=r.incoming.slice();n.hints&&!1===n.hints.createElementsBehavior||vl(i,"bpmn:EventBasedGateway")&&r.incoming.length&&o.filter(Xv).forEach((function(t){e.removeConnection(t)}))})),this.preExecuted("shape.replace",(function(t){var n=t.context.newShape;vl(n,"bpmn:EventBasedGateway")&&n.outgoing.filter(Xv).map((function(t){return t.target})).reduce((function(t,e){var n=e.incoming.filter(Xv);return t.concat(n)}),[]).forEach((function(t){t.source!==n&&e.removeConnection(t)}))}))}function Xv(t){return vl(t,"bpmn:SequenceFlow")}Uv.$inject=["bpmnReplace","injector"],Ka()(Uv,hp),Uv.prototype.replaceShape=function(t){var e,n,i=(n=yl(t).eventDefinitions)&&n[0];return e=i?{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:i.$type}:{type:"bpmn:IntermediateThrowEvent"},this._bpmnReplace.replaceElement(t,e,{layoutConnection:!1})},Ka()($v,hp),$v.$inject=["eventBus","bpmnRules","modeling"],Yv.$inject=["eventBus","modeling"],Ka()(Yv,hp);var Zv=2e3;function Jv(t,e,n,i,r,o){function a(){return yl(e.getRootElement()).$parent}function s(t){var e=yl(t).categoryValueRef;if(e){var n=e.$parent;e&&(ps(n.categoryValue,e),n&&!n.categoryValue.length&&function(t){ps(a().get("rootElements"),t)}(n))}}r.invoke(hp,this),this.executed("shape.delete",(function(t){var e,i=t.context.shape;if(vl(i,"bpmn:Group")){var r=yl(i).categoryValueRef,o=n.filter((function(t){return vl(t,"bpmn:Group")}));e=r,o.some((function(t){var n=yl(t);return n.categoryValueRef&&n.categoryValueRef===e}))||s(i)}})),this.reverted("shape.delete",(function(t){var e=t.context.shape;if(vl(e,"bpmn:Group")){var n=yl(e).categoryValueRef,i=a(),r=n?n.$parent:null;ds(r.get("categoryValue"),n),ds(i.get("rootElements"),r)}})),this.execute("shape.create",(function(e){var n=yl(e.context.shape);if(vl(n,"bpmn:Group")&&!n.categoryValueRef){var i=cv(a(),t);n.categoryValueRef=i}})),this.revert("shape.create",(function(t){var e=t.context.shape;vl(e,"bpmn:Group")&&(s(e),delete yl(e).categoryValueRef)})),i.on("moddleCopy.canCopyProperty",Zv,(function(e){var n,i=e.property;if(vl(i,"bpmn:CategoryValue"))return n=cv(a(),t),o.copyElement(i,n)}))}function Qv(t,e,n,i){var r,o,a,s;return 0==(r=(i.y-n.y)*(e.x-t.x)-(i.x-n.x)*(e.y-t.y))?null:(o=t.y-n.y,a=t.x-n.x,s=((i.x-n.x)*o-(i.y-n.y)*a)/r,{x:Math.round(t.x+s*(e.x-t.x)),y:Math.round(t.y+s*(e.y-t.y))})}function ty(t){function e(t,e,n){var i,r={x:n.x,y:n.y-50},o={x:n.x-50,y:n.y},a=Qv(t,e,n,r),s=Qv(t,e,n,o);i=a&&s?ey(a,n)>ey(s,n)?s:a:a||s,t.original=i}t.on("bpmnElement.added",(function(t){var n,i,r=t.element;r.waypoints&&(e((i=(n=r).waypoints)[0],i[1],yu(n.source)),e(i[i.length-1],i[i.length-2],yu(n.target)))}))}function ey(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function ny(t){hp.call(this,t);var e=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],(function(t){var n=yl(t.context.shape);Xh(n,e)&&!n.di.get("isHorizontal")&&n.di.set("isHorizontal",!0)}))}function iy(t){return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))}function ry(t){return Math.atan((t[1].y-t[0].y)/(t[1].x-t[0].x))}function oy(t,e){var n=e[0],i=e[1],r={x:i.x-n.x,y:i.y-n.y},o=function(t,e,n){var i=[{n:t[0]-n[0],lambda:e[0]},{n:t[1]-n[1],lambda:e[1]}];return-(i[0].n*e[0]+i[1].n*e[1])/(i[0].lambda*e[0]+i[1].lambda*e[1])}([n.x,n.y],[r.x,r.y],[t.x,t.y]);return{x:n.x+o*r.x,y:n.y+o*r.y}}function ay(t,e){var n=oy(t,e);return iy({x:n.x-t.x,y:n.y-t.y})}function sy(t,e){return iy({x:t.x-e.x,y:t.y-e.y})}Jv.$inject=["bpmnFactory","canvas","elementRegistry","eventBus","injector","moddleCopy"],Ka()(Jv,hp),ty.$inject=["eventBus"],ny.$inject=["eventBus"],Ka()(ny,hp);var cy=Math.sqrt,ly=Math.min,uy=Math.max,hy=Math.abs;function py(t){return Math.pow(t,2)}function dy(t,e){return cy(py(t.x-e.x)+py(t.y-e.y))}function fy(t,e,n,i){var r=e.x-t.x,o=e.y-t.y,a=n.x-t.x,s=n.y-t.y,c=r*r+o*o,l=(r*a+o*s)/c,u=l*l-(a*a+s*s-i*i)/c;if(u<0&&u>-1e-6&&(u=0),u<0)return[];var h=cy(u),p=-l+h,d=-l-h,f={x:t.x-r*p,y:t.y-o*p};return 0===u?[f]:[f,{x:t.x-r*d,y:t.y-o*d}].filter((function(n){return function(t,e,n){return my(t.x,e.x,n.x)&&my(t.y,e.y,n.y)}(n,t,e)}))}function my(t,e,n){return t>=ly(e,n)-vy&&t<=uy(e,n)+vy}var vy=.1;function yy(t,e){return hy(t.x-e.x)<=vy&&hy(t.y-e.y)<=vy}function gy(t,e,n,i){var r=0,o=0,a=function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}}(t),s=function(t,e){var n,i,r,o,a,s,c,l,u,h,p,d,f=0;for(f=0;f<e.length-1;f++){if(yy(n=e[f],i=e[f+1])?s=[n]:(r=dy(t,n),o=dy(t,i),s=fy(n,i,t,ly(r,o))),s.length<1)throw new Error("expected between [1, 2] circle -> line intersections");1===s.length&&(c={type:"bendpoint",position:s[0],segmentIndex:f,bendpointIndex:yy(n,s[0])?f:f+1}),2===s.length&&(p=s[0],d=s[1],c={type:"segment",position:a={x:(p.x+d.x)/2,y:(p.y+d.y)/2},segmentIndex:f,relativeLocation:dy(n,a)/dy(n,i)}),l=dy(c.position,t),(!h||u>l)&&(h=c,u=l)}return h}(a,n),c=s.segmentIndex,l=function(t,e,n,i){var r=n.segmentIndex,o=e.length-t.length;if(i.segmentMove){var a=i.segmentMove.segmentStartIndex,s=i.segmentMove.newSegmentStartIndex;return r===a?s:r>=s?r+o<s?s:r+o:r}if(i.bendpointMove){var c,l=i.bendpointMove.insert,u=i.bendpointMove.bendpointIndex;if(0===o)return r;if(r>=u&&(c=l?r+1:r-1),r<u)if(c=r,l&&"bendpoint"!==n.type&&u-1===r)by(e,u)<n.relativeLocation&&c++;return c}return 0===o?r:i.connectionStart?0===r?0:null:i.connectionEnd&&r===t.length-2?e.length-2:null}(n,e,s,i);if(null===l)return{x:r,y:o};if(l<0||l>e.length-2)return{x:r,y:o};var u,h,p,d,f,m,v=_y(n,c),y=_y(e,l),g=s.position,b=(d=g,f=sy((p=v)[0],p[1]),m=sy(p[0],d),0===f?0:m/f),_=(u=y,h=ry(v),ry(u)-h);if("bendpoint"===s.type){var w=e.length-n.length,x=s.bendpointIndex,E=n[x];if(-1!==e.indexOf(E))return{x:r,y:o};if(0===w){var S=e[x];return{x:S.x-s.position.x,y:S.y-s.position.y}}w<0&&0!==x&&x<n.length-1&&(b=by(n,x))}var C,k,P=(y[1].x-y[0].x)*b+y[0].x,T=(y[1].y-y[0].y)*b+y[0].y,O=(C={x:a.x-g.x,y:a.y-g.y},(k=_)?{x:Math.cos(k)*C.x-Math.sin(k)*C.y,y:Math.sin(k)*C.x+Math.cos(k)*C.y}:C);return fu({x:r=P+O.x-a.x,y:o=T+O.y-a.y})}function by(t,e){var n=sy(t[e-1],t[e]);return n/(n+sy(t[e],t[e+1]))}function _y(t,e){return[t[e],t[e+1]]}function wy(t,e,n){var i=_h(e),r=_h(n),o=wh(t,i),a=o.x*(n.width/e.width),s=o.y*(n.height/e.height);return fu({x:r.x+a,y:r.y+s})}function xy(t,e,n){var i=_h(t),r=_h(e),o=_h(n),a=wh(t,i),s=wh(i,r),c=s.x*(n.width/e.width),l=s.y*(n.height/e.height),u=o.x+c,h=o.y+l;return fu({x:u+a.x-t.x,y:h+a.y-t.y})}var Ey={width:90,height:20},Sy="name",Cy="text";function ky(t,e,n,i){hp.call(this,t),this.postExecute("element.updateProperties",(function(t){var n=t.context,r=n.element,o=n.properties;if(Sy in o&&e.updateLabel(r,o[Sy]),Cy in o&&vl(r,"bpmn:TextAnnotation")){var a=i.getTextAnnotationBounds({x:r.x,y:r.y,width:r.width,height:r.height},o[Cy]||"");e.updateLabel(r,o.text,a)}})),this.postExecute(["shape.create","connection.create"],(function(t){var n=t.context;if(!1!==(n.hints||{}).createElementsBehavior){var r=n.shape||n.connection,o=r.businessObject;if(tu(r)&&xl(r)){var a=iu(r),s=i.getExternalLabelBounds(Ey,xl(r));e.createLabel(r,a,{id:o.id+"_label",businessObject:o,width:s.width,height:s.height})}}})),this.postExecute("shape.delete",(function(t){var n=t.context,i=n.labelTarget,r=n.hints||{};i&&!1!==r.unsetLabel&&e.updateLabel(i,null,null,{removeShape:!1})})),this.postExecute(["label.create"],(function(t){var e,i=t.context.shape;i.labelTarget&&vl(i.labelTarget||i,"bpmn:BaseElement")&&((e=i.businessObject.di).label||(e.label=n.create("bpmndi:BPMNLabel",{bounds:n.create("dc:Bounds")})),ko(e.label.bounds,{x:i.x,y:i.y,width:i.width,height:i.height}))})),this.postExecute(["connection.layout","connection.updateWaypoints"],(function(t){var n,i=t.context.connection.label;i&&(n=function(t){var e=t.context,n=e.connection,i=n.label,r=ko({},e.hints),o=e.newWaypoints||n.waypoints,a=e.oldWaypoints;return void 0===r.startChanged&&(r.startChanged=!!r.connectionStart),void 0===r.endChanged&&(r.endChanged=!!r.connectionEnd),gy(i,o,a,r)}(t),e.moveShape(i,n))})),this.postExecute(["shape.replace"],(function(t){var e=t.context,n=e.newShape,i=e.oldShape,r=yl(n);r&&tu(r)&&i.label&&n.label&&(n.label.x=i.label.x,n.label.y=i.label.y)})),this.postExecute("shape.resize",(function(t){var n,i=t.context,r=i.shape,o=i.newBounds,a=i.oldBounds;if(eu(r)){var s=r.label,c=function(t,e,n){return fu(wh(wy(t,e,n),t))}(function(t,e){if(!e.length)return;var n=function(t,e){return yo(e.map((function(e){return{line:e,distance:ay(t,e)}})),"distance")[0].line}(t,e);return oy(t,n)}(yu(s),[[{x:(n=a).x,y:n.y},{x:n.x+(n.width||0),y:n.y}],[{x:n.x+(n.width||0),y:n.y},{x:n.x+(n.width||0),y:n.y+(n.height||0)}],[{x:n.x,y:n.y+(n.height||0)},{x:n.x+(n.width||0),y:n.y+(n.height||0)}],[{x:n.x,y:n.y},{x:n.x,y:n.y+(n.height||0)}]]),a,o);e.moveShape(s,c)}}))}Ka()(ky,hp),ky.$inject=["eventBus","modeling","bpmnFactory","textRenderer"];var Py="flow elements must be children of pools/participants",Ty="participants cannot be pasted onto a non-empty process diagram";function Oy(t,e,n){function i(t,n,i){e.add({position:{x:t.x+5,y:t.y+5},type:"error",timeout:i||2e3,html:"<div>"+n+"</div>"})}t.on(["shape.move.rejected","create.rejected"],(function(t){var e=t.context,r=e.shape;vl(e.target,"bpmn:Collaboration")&&vl(r,"bpmn:FlowNode")&&i(t,n(Py))})),t.on(["elements.paste.rejected"],(function(t){var e=t.context,r=e.position,o=e.target;vl(o,"bpmn:Collaboration")&&i(r,n(Py)),vl(o,"bpmn:Process")&&i(r,n(Ty),3e3)}))}function Ay(t,e,n,i){hp.call(this,t);var r=i.get("dragging",!1);function o(t){var i,r,o=t.source,a=t.target;t.parent&&(vl(t,"bpmn:SequenceFlow")&&(n.canConnectSequenceFlow(o,a)||(r=!0),n.canConnectMessageFlow(o,a)&&(i="bpmn:MessageFlow")),vl(t,"bpmn:MessageFlow")&&(n.canConnectMessageFlow(o,a)||(r=!0),n.canConnectSequenceFlow(o,a)&&(i="bpmn:SequenceFlow")),vl(t,"bpmn:Association")&&!n.canConnectAssociation(o,a)&&(r=!0),r&&e.removeConnection(t),i&&e.connect(o,a,{type:i,waypoints:t.waypoints.slice()}))}this.postExecuted("elements.move",(function(t){oo(t.closure.allConnections,o)}),!0),this.preExecute(["connection.reconnectStart","connection.reconnectEnd"],(function(t){var i,o,a=t.context,s=a.connection,c=a.newSource||s.source,l=a.newTarget||s.target;(i=n.canConnect(c,l))&&i.type!==s.type&&(o=e.connect(c,l,{type:i.type,waypoints:s.waypoints.slice()}),e.removeConnection(s),a.connection=o,r&&function(t,e){var n,i=r.context(),o=i&&i.payload.previousSelection;if(!o||!o.length)return;if(-1===(n=o.indexOf(t)))return;o.splice(n,1,e)}(s,o))})),this.postExecuted("element.updateProperties",(function(t){var n,i=t.context,r=i.properties,o=i.element,a=o.businessObject;r.default&&(n=io(o.outgoing,go({id:o.businessObject.default.id})))&&e.updateProperties(n,{conditionExpression:void 0}),r.conditionExpression&&a.sourceRef.default===a&&e.updateProperties(o.source,{default:void 0})}))}function My(t,e){hp.call(this,t),this.preExecute("shape.delete",(function(t){var e=t.shape,n=e.parent;vl(e,"bpmn:Participant")&&(t.collaborationRoot=n)}),!0),this.postExecute("shape.delete",(function(t){var n=t.collaborationRoot;n&&!n.businessObject.participants.length&&e.makeProcess()}),!0)}function jy(t,e,n,i,r,o){i.invoke(hp,this),this._bpmnReplace=t,this._elementRegistry=n,this._selection=o,this.postExecuted(["elements.move"],500,(function(t){var n=t.context,i=n.newParent,r=n.newHost,o=[];oo(n.closure.topLevel,(function(t){o=bl(t)?o.concat(t.children):o.concat(t)})),1===o.length&&r&&(i=r);var a=e.canReplace(o,i);a&&this.replaceElements(o,a.replacements,r)}),this),this.postExecute(["shape.replace"],1500,(function(t){var n,i=t.context,r=i.oldShape,o=i.newShape,a=r.attachers;a&&a.length&&(n=e.canReplace(a,o),this.replaceElements(a,n.replacements))}),this),this.postExecuted(["shape.replace"],1500,(function(t){var e=t.context,n=e.oldShape,i=e.newShape;r.unclaimId(n.businessObject.id,n.businessObject),r.updateProperties(i,{id:n.id})}))}Oy.$inject=["eventBus","tooltips","translate"],Ka()(Ay,hp),Ay.$inject=["eventBus","modeling","bpmnRules","injector"],My.$inject=["eventBus","modeling"],Ka()(My,hp),Ka()(jy,hp),jy.prototype.replaceElements=function(t,e){var n=this._elementRegistry,i=this._bpmnReplace,r=this._selection;oo(e,(function(e){var r={type:e.newElementType},o=n.get(e.oldElementId),a=t.indexOf(o);t[a]=i.replaceElement(o,r,{select:!1})})),e&&r.select(t)},jy.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"];var Ry=Math.abs,Dy=Math.min,Ny=Math.max;function Iy(t,e,n,i){var r=t[e];t[e]=void 0===r?n:i(n,r)}function Ly(t,e,n){return Iy(t,e,n,Dy)}function By(t,e,n){return Iy(t,e,n,Ny)}var Fy=60,zy=300,Gy=20,Vy=50,Hy=20,Uy=20;var Wy=1500,$y={width:300,height:150},qy={width:140,height:120},Ky={width:50,height:30};function Yy(t){t.on("resize.start",Wy,(function(t){var e=t.context,n=e.shape,i=e.direction,r=e.balanced;(vl(n,"bpmn:Lane")||vl(n,"bpmn:Participant"))&&(e.resizeConstraints=function(t,e,n){var i=lm(t),r=!0,o=!0,a=sm(i,[i]),s=mu(t),c={},l={};return/e/.test(e)?l.right=s.left+zy:/w/.test(e)&&(l.left=s.right-zy),a.forEach((function(t){var i=mu(t);/n/.test(e)&&(i.top<s.top-10&&(r=!1),n&&Ry(s.top-i.bottom)<10&&By(c,"top",i.top+Fy),Ry(s.top-i.top)<5&&Ly(l,"top",i.bottom-Fy)),/s/.test(e)&&(i.bottom>s.bottom+10&&(o=!1),n&&Ry(s.bottom-i.top)<10&&Ly(c,"bottom",i.bottom-Fy),Ry(s.bottom-i.bottom)<5&&By(l,"bottom",i.top+Fy))})),i.children.filter((function(t){return!t.hidden&&!t.waypoints&&(vl(t,"bpmn:FlowElement")||vl(t,"bpmn:Artifact"))})).forEach((function(t){var n=mu(t);r&&/n/.test(e)&&Ly(l,"top",n.top-Hy),/e/.test(e)&&By(l,"right",n.right+Gy),o&&/s/.test(e)&&By(l,"bottom",n.bottom+Uy),/w/.test(e)&&Ly(l,"left",n.left-Vy)})),{min:l,max:c}}(n,i,r)),vl(n,"bpmn:Participant")&&(e.minDimensions=$y),vl(n,"bpmn:SubProcess")&&gl(n)&&(e.minDimensions=qy),vl(n,"bpmn:TextAnnotation")&&(e.minDimensions=Ky)}))}Yy.$inject=["eventBus"];var Xy=1001;function Zy(t,e){t.on("resize.start",Xy+500,(function(t){var e=t.context,n=e.shape;(vl(n,"bpmn:Lane")||vl(n,"bpmn:Participant"))&&(e.balanced=!Mu(t))})),t.on("resize.end",Xy,(function(t){var n=t.context,i=n.shape,r=n.canExecute,o=n.newBounds;if(vl(i,"bpmn:Lane")||vl(i,"bpmn:Participant"))return r&&(o=du(o),e.resizeLane(i,o,n.balanced)),!1}))}function Jy(t,e,n){hp.call(this,t),this.preExecute("shape.delete",(function(t){var i=t.context.shape;if(1===i.incoming.length&&1===i.outgoing.length){var r,o,a,s=i.incoming[0],c=i.outgoing[0];if(vl(s,"bpmn:SequenceFlow")&&vl(c,"bpmn:SequenceFlow"))if(e.canConnect(s.source,c.target,s)){var l=(r=s.waypoints,o=c.waypoints,(a=Qv(Qy(r[r.length-2]),Qy(r[r.length-1]),Qy(o[1]),Qy(o[0])))?[].concat(r.slice(0,r.length-1),[a],o.slice(1)):[Qy(r[0]),Qy(o[o.length-1])]);n.reconnectEnd(s,c.target,l)}}}))}function Qy(t){return t.original||t}function tg(t,e){t.invoke(hp,this),this.postExecuted("shape.replace",(function(t){var n=t.context.oldShape,i=t.context.newShape;if(vl(i,"bpmn:SubProcess")&&vl(n,"bpmn:Task")&&gl(i)){var r,o={x:(r=i).x+r.width/6,y:r.y+r.height/2};e.createShape({type:"bpmn:StartEvent"},o,i)}}))}Zy.$inject=["eventBus","modeling"],Ka()(Jy,hp),Jy.$inject=["eventBus","bpmnRules","modeling"],tg.$inject=["injector","modeling"],Ka()(tg,hp);var eg=500;function ng(t,e,n,i){hp.call(this,t),this.executed(["shape.toggleCollapse"],eg,(function(t){var e,n=t.context.shape;vl(n,"bpmn:SubProcess")&&(n.collapsed?yl(n).di.isExpanded=!1:((e=n.children).length&&e.forEach((function(t){"label"!==t.type||t.businessObject.name||(t.hidden=!0)})),yl(n).di.isExpanded=!0))})),this.reverted(["shape.toggleCollapse"],eg,(function(t){var e=t.context.shape;e.collapsed?yl(e).di.isExpanded=!1:yl(e).di.isExpanded=!0})),this.postExecuted(["shape.toggleCollapse"],eg,(function(t){var i,r=t.context.shape,o=e._getDefaultSize(r);i=r.collapsed?function(t,e){return{x:t.x+(t.width-e.width)/2,y:t.y+(t.height-e.height)/2,width:e.width,height:e.height}}(r,o):function(t,e){var n,i,r=t.children,o=e;return(n=rm((i=r,i.filter((function(t){return!t.hidden}))).concat([t])))?(o.width=Math.max(n.width,o.width),o.height=Math.max(n.height,o.height),o.x=n.x+(n.width-o.width)/2,o.y=n.y+(n.height-o.height)/2):(o.x=t.x+(t.width-o.width)/2,o.y=t.y+(t.height-o.height)/2),o}(r,o),n.resizeShape(r,i,null,{autoResize:!r.collapsed&&"nwse"})}))}function ig(t,e){hp.call(this,t),this.preExecute("elements.delete",(function(t){oo(t.context.elements,(function(t){e.unclaimId(t.businessObject.id,t.businessObject)}))}))}Ka()(ng,hp),ng.$inject=["eventBus","elementFactory","modeling"],Ka()(ig,hp),ig.$inject=["eventBus","modeling"];var rg=500,og=5e3;function ag(t,e,n){var i;function r(){if(!i)throw new Error(n("out of bounds release"));return i}hp.call(this,t);var o=["spaceTool","lane.add","lane.resize","lane.split","elements.move","elements.delete","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(o,og,(function(t){(i=i||new sg).enter()})),this.postExecuted(o,rg,(function(t){!function(){if(!i)throw new Error(n("out of bounds release"));var t=i.leave();t&&(e.updateLaneRefs(i.flowNodes,i.lanes),i=null)}()})),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],(function(t){var e=t.context.shape,n=r();e.labelTarget||(vl(e,"bpmn:Lane")&&n.addLane(e),vl(e,"bpmn:FlowNode")&&n.addFlowNode(e))}))}function sg(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(t){this.lanes.push(t)},this.addFlowNode=function(t){this.flowNodes.push(t)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}function cg(t,e){hp.call(this,t),this.preExecute("connection.delete",(function(t){var n=t.context.connection,i=n.source;(function(t,e){if(!vl(t,"bpmn:SequenceFlow"))return!1;var n=yl(e),i=yl(t);return n.get("default")===i})(n,i)&&e.updateProperties(i,{default:null})}))}ag.$inject=["eventBus","modeling","translate"],Ka()(ag,hp),Ka()(cg,hp),cg.$inject=["eventBus","modeling"];var lg={__init__:["adaptiveLabelPositioningBehavior","appendBehavior","attachEventBehavior","boundaryEventBehavior","createBehavior","fixHoverBehavior","createDataObjectBehavior","createParticipantBehavior","dataStoreBehavior","dataInputAssociationBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","modelingFeedback","removeElementBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","toggleElementCollapseBehaviour","subProcessStartEventBehavior","unclaimIdBehavior","unsetDefaultFlowBehavior","updateFlowNodeRefsBehavior"],adaptiveLabelPositioningBehavior:["type",gv],appendBehavior:["type",_v],attachEventBehavior:["type",xv],boundaryEventBehavior:["type",Sv],createBehavior:["type",Cv],fixHoverBehavior:["type",Tv],createDataObjectBehavior:["type",Ov],createParticipantBehavior:["type",Dv],dataInputAssociationBehavior:["type",Lv],dataStoreBehavior:["type",zv],deleteLaneBehavior:["type",Vv],detachEventBehavior:["type",Uv],dropOnFlowBehavior:["type",$v],eventBasedGatewayBehavior:["type",Yv],groupBehavior:["type",Jv],importDockingFix:["type",ty],isHorizontalFix:["type",ny],labelBehavior:["type",ky],modelingFeedback:["type",Oy],replaceConnectionBehavior:["type",Ay],removeParticipantBehavior:["type",My],replaceElementBehaviour:["type",jy],resizeBehavior:["type",Yy],resizeLaneBehavior:["type",Zy],removeElementBehavior:["type",Jy],toggleElementCollapseBehaviour:["type",ng],subProcessStartEventBehavior:["type",tg],unclaimIdBehavior:["type",ig],updateFlowNodeRefsBehavior:["type",ag],unsetDefaultFlowBehavior:["type",cg]};function ug(t,e){var n=gu(t,e,-15);return"intersect"!==n?n:null}function hg(t){fp.call(this,t)}function pg(t){return!t||ru(t)}function dg(t){do{if(vl(t,"bpmn:Process"))return yl(t);if(vl(t,"bpmn:Participant"))return yl(t).processRef||yl(t)}while(t=t.parent)}function fg(t){return vl(t,"bpmn:TextAnnotation")}function mg(t){return vl(t,"bpmn:Group")&&!t.labelTarget}function vg(t){return vl(t,"bpmn:BoundaryEvent")&&bg(t,"bpmn:CompensateEventDefinition")}function yg(t){return yl(t).isForCompensation}function gg(t){for(var e=t;e=e.parent;){if(vl(e,"bpmn:FlowElementsContainer"))return yl(e);if(vl(e,"bpmn:Participant"))return yl(e).processRef}return null}function bg(t,e){return!!io(yl(t).eventDefinitions||[],(function(t){return vl(t,e)}))}function _g(t,e){return(yl(t).eventDefinitions||[]).every((function(t){return vl(t,e)}))}function wg(t){return vl(t,"bpmn:ReceiveTask")||vl(t,"bpmn:IntermediateCatchEvent")&&(bg(t,"bpmn:MessageEventDefinition")||bg(t,"bpmn:TimerEventDefinition")||bg(t,"bpmn:ConditionalEventDefinition")||bg(t,"bpmn:SignalEventDefinition"))}function xg(t){return t.waypoints}function Eg(t,e){return-1!==function(t){for(var e=[];t;)(t=t.parent)&&e.push(t);return e}(e).indexOf(t)}function Sg(t,e,n){if(pg(t)||pg(e))return null;if(!vl(n,"bpmn:DataAssociation")){if(Ig(t,e))return{type:"bpmn:MessageFlow"};if(Lg(t,e))return{type:"bpmn:SequenceFlow"}}var i=Bg(t,e);return i||(vg(t)&&yg(e)?{type:"bpmn:Association",associationDirection:"One"}:!!Ng(t,e)&&{type:"bpmn:Association"})}function Cg(t,e,n){return!(!ru(t)&&!mg(t))||!(vl(e,"bpmn:Participant")&&!gl(e))&&(vl(t,"bpmn:Participant")?vl(e,"bpmn:Process")||vl(e,"bpmn:Collaboration"):Xh(t,["bpmn:DataInput","bpmn:DataOutput"])&&t.parent?e===t.parent:vl(t,"bpmn:Lane")?vl(e,"bpmn:Participant")||vl(e,"bpmn:Lane"):!(vl(t,"bpmn:BoundaryEvent")&&(i=t,!yl(i).cancelActivity||!Tg(i)&&!Og(i)))&&(vl(t,"bpmn:FlowElement")&&!vl(t,"bpmn:DataStoreReference")?vl(e,"bpmn:FlowElementsContainer")?gl(e):Xh(e,["bpmn:Participant","bpmn:Lane"]):Xh(t,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?Xh(e,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process","bpmn:SubProcess"]):!!vl(t,"bpmn:MessageFlow")&&(vl(e,"bpmn:Collaboration")||t.source.parent==e||t.target.parent==e)));var i}function kg(t){return vl(t,"bpmn:Lane")}function Pg(t){return!!function(t){return!ru(t)&&vl(t,"bpmn:BoundaryEvent")}(t)||(!(!vl(t,"bpmn:IntermediateThrowEvent")||!Tg(t))||vl(t,"bpmn:IntermediateCatchEvent")&&Og(t))}function Tg(t){var e=yl(t);return e&&!(e.eventDefinitions&&e.eventDefinitions.length)}function Og(t){return function(t,e){return e.some((function(e){return bg(t,e)}))}(t,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function Ag(t,e,n,i){if(Array.isArray(t)||(t=[t]),1!==t.length)return!1;var r=t[0];return!ru(r)&&(!!Pg(r)&&(!bl(e)&&(!(!vl(e,"bpmn:Activity")||yg(e))&&(!(i&&!ug(i,e))&&(!function(t){return vl(t,"bpmn:ReceiveTask")&&io(t.incoming,(function(t){return vl(t.source,"bpmn:EventBasedGateway")}))}(e)&&"attach")))))}function Mg(t,e,n){if(!e)return!1;var i={replacements:[]};return oo(t,(function(t){bl(e)||vl(t,"bpmn:StartEvent")&&"label"!==t.type&&Cg(t,e)&&(function(t){return t&&!1!==yl(t).isInterrupting}(t)||i.replacements.push({oldElementId:t.id,newElementType:"bpmn:StartEvent"}),(function(t){return _l(t,"bpmn:ErrorEventDefinition")}(t)||function(t){return _l(t,"bpmn:EscalationEventDefinition")}(t)||function(t){return _l(t,"bpmn:CompensateEventDefinition")}(t))&&i.replacements.push({oldElementId:t.id,newElementType:"bpmn:StartEvent"})),vl(e,"bpmn:Transaction")||bg(t,"bpmn:CancelEventDefinition")&&"label"!==t.type&&(vl(t,"bpmn:EndEvent")&&Cg(t,e)&&i.replacements.push({oldElementId:t.id,newElementType:"bpmn:EndEvent"}),vl(t,"bpmn:BoundaryEvent")&&Ag(t,e,0,n)&&i.replacements.push({oldElementId:t.id,newElementType:"bpmn:BoundaryEvent"}))})),!!i.replacements.length&&i}function jg(t,e){return!lo(t,kg)&&(!e||t.every((function(t){return Cg(t,e)})))}function Rg(t,e,n,i){return!!e&&(!(!ru(t)&&!mg(t))||n!==e&&((!n||!Eg(n,e))&&(Cg(t,e)||Fg(t,e,i))))}function Dg(t,e){return vl(t,"bpmn:SubProcess")?gl(t)&&(!e||e.width>=100&&e.height>=80):vl(t,"bpmn:Lane")?!e||e.width>=130&&e.height>=60:vl(t,"bpmn:Participant")?!e||e.width>=250&&e.height>=50:!!fg(t)||!!mg(t)}function Ng(t,e){return!xg(t)&&!xg(e)&&(!(!vg(t)||!yg(e))||!Eg(e,t)&&!Eg(t,e)&&function(t,e){var n=fg(t),i=fg(e);return(n||i)&&n!==i}(t,e))}function Ig(t,e){return!(Vg(t)&&!Vg(e))&&(vl(i=t,"bpmn:InteractionNode")&&(!vl(i,"bpmn:Event")||vl(i,"bpmn:ThrowEvent")&&_g(i,"bpmn:MessageEventDefinition"))&&function(t){return vl(t,"bpmn:InteractionNode")&&!yg(t)&&(!vl(t,"bpmn:Event")||vl(t,"bpmn:CatchEvent")&&_g(t,"bpmn:MessageEventDefinition"))}(e)&&(n=e,!(dg(t)===dg(n))));var n,i}function Lg(t,e){return!(wg(e)&&e.incoming.length>0&&(n=e.incoming,(n=n||[]).some(Gg))&&!vl(t,"bpmn:EventBasedGateway"))&&(vl(r=t,"bpmn:FlowNode")&&!vl(r,"bpmn:EndEvent")&&!bl(r)&&!(vl(r,"bpmn:IntermediateThrowEvent")&&bg(r,"bpmn:LinkEventDefinition"))&&!vg(r)&&!yg(r)&&function(t){return vl(t,"bpmn:FlowNode")&&!vl(t,"bpmn:StartEvent")&&!vl(t,"bpmn:BoundaryEvent")&&!bl(t)&&!(vl(t,"bpmn:IntermediateCatchEvent")&&bg(t,"bpmn:LinkEventDefinition"))&&!yg(t)}(e)&&(i=e,gg(t)===gg(i))&&!(vl(t,"bpmn:EventBasedGateway")&&!wg(e)));var n,i,r}function Bg(t,e){return Xh(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&Xh(e,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:!(!Xh(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])||!Xh(t,["bpmn:Activity","bpmn:CatchEvent"]))&&{type:"bpmn:DataOutputAssociation"}}function Fg(t,e,n){if(!e)return!1;if(Array.isArray(t)){if(1!==t.length)return!1;t=t[0]}return e.source!==t&&e.target!==t&&(Xh(e,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!ru(e)&&vl(t,"bpmn:FlowNode")&&!vl(t,"bpmn:BoundaryEvent")&&Cg(t,e.parent))}function zg(t,e){return!!ru(e)||!(vl(e,"bpmn:Lane")&&!function(t,e){return t&&e&&-1!==t.indexOf(e)}(t,e.parent))}function Gg(t){if(t&&t.source)return vl(t.source,"bpmn:EventBasedGateway")}function Vg(t){return Zh(t,"bpmn:Process")||Zh(t,"bpmn:Collaboration")}Ka()(hg,fp),hg.$inject=["eventBus"],hg.prototype.init=function(){this.addRule("connection.start",(function(t){return function(t){if(pg(t))return null;return Xh(t,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])}(t.source)})),this.addRule("connection.create",(function(t){var e=t.source,n=t.target,i=t.hints||{},r=i.targetParent;if(i.targetAttach)return!1;r&&(n.parent=r);try{return Sg(e,n)}finally{r&&(n.parent=null)}})),this.addRule("connection.reconnectStart",(function(t){var e=t.connection;return Sg(t.hover||t.source,e.target,e)})),this.addRule("connection.reconnectEnd",(function(t){var e=t.connection;return Sg(e.source,t.hover||t.target,e)})),this.addRule("connection.updateWaypoints",(function(t){return{type:t.connection.type}})),this.addRule("shape.resize",(function(t){return Dg(t.shape,t.newBounds)})),this.addRule("elements.create",(function(t){var e=t.elements,n=t.position,i=t.target;return co(e,(function(t){return xg(t)?Sg(t.source,t.target,t):t.host?Ag(t,t.host,null,n):Rg(t,i,null,n)}))})),this.addRule("elements.move",(function(t){var e=t.target,n=t.shapes,i=t.position;return Ag(n,e,null,i)||Mg(n,e,i)||jg(n,e)||Fg(n,e,i)})),this.addRule("shape.create",(function(t){return Rg(t.shape,t.target,t.source,t.position)})),this.addRule("shape.attach",(function(t){return Ag(t.shape,t.target,null,t.position)})),this.addRule("element.copy",(function(t){var e=t.element;return zg(t.elements,e)}))},hg.prototype.canConnectMessageFlow=Ig,hg.prototype.canConnectSequenceFlow=Lg,hg.prototype.canConnectDataAssociation=Bg,hg.prototype.canConnectAssociation=Ng,hg.prototype.canMove=jg,hg.prototype.canAttach=Ag,hg.prototype.canReplace=Mg,hg.prototype.canDrop=Cg,hg.prototype.canInsert=Fg,hg.prototype.canCreate=Rg,hg.prototype.canConnect=Sg,hg.prototype.canResize=Dg,hg.prototype.canCopy=zg;var Hg={__depends__:[Op],__init__:["bpmnRules"],bpmnRules:["type",hg]};function Ug(t){hp.call(this,t);var e=this;this.preExecute(["shape.create","connection.create"],(function(t){var n=t.context,i=n.shape||n.connection,r=n.parent,o=e.getOrdering(i,r);o&&(void 0!==o.parent&&(n.parent=o.parent),n.parentIndex=o.index)})),this.preExecute(["shape.move","connection.move"],(function(t){var n=t.context,i=n.shape||n.connection,r=n.newParent||i.parent,o=e.getOrdering(i,r);o&&(void 0!==o.parent&&(n.newParent=o.parent),n.newParentIndex=o.index)}))}function Wg(t,e,n){Ug.call(this,t);var i=[{type:"bpmn:SubProcess",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:3,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:Process"]}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:Process"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function r(t){var e=t.order;return e||(t.order=e=function(t){if(t.labelTarget)return{level:10};var e=io(i,(function(e){return Xh(t,[e.type])}));return e&&e.order||{level:1}}(t)),e}this.getOrdering=function(t,i){if(t.labelTarget)return{parent:e.getRootElement(),index:-1};var o=r(t);o.containers&&(i=function(t,e,i){for(var r=e;r&&!Xh(r,i);)r=r.parent;if(!r)throw new Error(n("no parent for {element} in {parent}",{element:t.id,parent:e.id}));return r}(t,i,o.containers));var a=i.children.indexOf(t),s=function(t,e){e=_o(e);var n=Zr(t)?-1:void 0;return oo(t,(function(t,i){if(e(t,i))return n=i,!1})),n}(i.children,(function(e){return!(!t.labelTarget&&e.labelTarget)&&o.level<r(e).level}));return-1!==s&&-1!==a&&a<s&&(s-=1),{index:s,parent:i}}}Ug.prototype.getOrdering=function(t,e){return null},Ka()(Ug,hp),Wg.$inject=["eventBus","canvas","translate"],Ka()(Wg,Ug);var $g={__depends__:[Zl],__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",Wg]};function qg(t,e){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[]},this._injector=e,this._eventBus=t,this._uid=1,t.on(["diagram.destroy","diagram.clear"],(function(){this.clear(!1)}),this)}qg.$inject=["eventBus","injector"],qg.prototype.execute=function(t,e){if(!t)throw new Error("command required");var n={command:t,context:e};this._pushAction(n),this._internalExecute(n),this._popAction(n)},qg.prototype.canExecute=function(t,e){var n={command:t,context:e},i=this._getHandler(t),r=this._fire(t,"canExecute",n);if(void 0===r){if(!i)return!1;i.canExecute&&(r=i.canExecute(e))}return r},qg.prototype.clear=function(t){this._stack.length=0,this._stackIdx=-1,!1!==t&&this._fire("changed")},qg.prototype.undo=function(){var t,e=this._getUndoAction();if(e){for(this._pushAction(e);e&&(this._internalUndo(e),(t=this._getUndoAction())&&t.id===e.id);)e=t;this._popAction()}},qg.prototype.redo=function(){var t,e=this._getRedoAction();if(e){for(this._pushAction(e);e&&(this._internalExecute(e,!0),(t=this._getRedoAction())&&t.id===e.id);)e=t;this._popAction()}},qg.prototype.register=function(t,e){this._setHandler(t,e)},qg.prototype.registerHandler=function(t,e){if(!t||!e)throw new Error("command and handlerCls must be defined");var n=this._injector.instantiate(e);this.register(t,n)},qg.prototype.canUndo=function(){return!!this._getUndoAction()},qg.prototype.canRedo=function(){return!!this._getRedoAction()},qg.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]},qg.prototype._getUndoAction=function(){return this._stack[this._stackIdx]},qg.prototype._internalUndo=function(t){var e=this,n=t.command,i=t.context,r=this._getHandler(n);this._atomicDo((function(){e._fire(n,"revert",t),r.revert&&e._markDirty(r.revert(i)),e._revertedAction(t),e._fire(n,"reverted",t)}))},qg.prototype._fire=function(t,e,n){arguments.length<3&&(n=e,e=null);var i,r,o,a=e?[t+"."+e,e]:[t];for(n=this._eventBus.createEvent(n),i=0;(r=a[i])&&(o=this._eventBus.fire("commandStack."+r,n),!n.cancelBubble);i++);return o},qg.prototype._createId=function(){return this._uid++},qg.prototype._atomicDo=function(t){var e=this._currentExecution;e.atomic=!0;try{t()}finally{e.atomic=!1}},qg.prototype._internalExecute=function(t,e){var n=this,i=t.command,r=t.context,o=this._getHandler(i);if(!o)throw new Error("no command handler registered for <"+i+">");this._pushAction(t),e||(this._fire(i,"preExecute",t),o.preExecute&&o.preExecute(r),this._fire(i,"preExecuted",t)),this._atomicDo((function(){n._fire(i,"execute",t),o.execute&&n._markDirty(o.execute(r)),n._executedAction(t,e),n._fire(i,"executed",t)})),e||(this._fire(i,"postExecute",t),o.postExecute&&o.postExecute(r),this._fire(i,"postExecuted",t)),this._popAction(t)},qg.prototype._pushAction=function(t){var e=this._currentExecution,n=e.actions,i=n[0];if(e.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+t.command+")");t.id||(t.id=i&&i.id||this._createId()),n.push(t)},qg.prototype._popAction=function(){var t=this._currentExecution,e=t.actions,n=t.dirty;e.pop(),e.length||(this._eventBus.fire("elements.changed",{elements:mo("id",n.reverse())}),n.length=0,this._fire("changed"))},qg.prototype._markDirty=function(t){var e=this._currentExecution;t&&(t=Zr(t)?t:[t],e.dirty=e.dirty.concat(t))},qg.prototype._executedAction=function(t,e){var n=++this._stackIdx;e||this._stack.splice(n,this._stack.length,t)},qg.prototype._revertedAction=function(t){this._stackIdx--},qg.prototype._getHandler=function(t){return this._handlerMap[t]},qg.prototype._setHandler=function(t,e){if(!t||!e)throw new Error("command and handler required");if(this._handlerMap[t])throw new Error("overriding handler for command <"+t+">");this._handlerMap[t]=e};var Kg={commandStack:["type",qg]},Yg=new Wu("tt");function Xg(t,e){t.style.display=!1===e?"none":""}var Zg=".djs-tooltip";function Jg(t,e){var n,i;this._eventBus=t,this._canvas=e,this._ids=Yg,this._tooltipDefaults={show:{minZoom:.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=(n=e.getContainer(),i=Ko('<div class="djs-tooltip-container" style="position: absolute; width: 0; height: 0;" />'),n.insertBefore(i,n.firstChild),i);var r=this;qo.bind(this._tooltipRoot,Zg,"mousedown",(function(t){t.stopPropagation()})),qo.bind(this._tooltipRoot,Zg,"mouseover",(function(t){r.trigger("mouseover",t)})),qo.bind(this._tooltipRoot,Zg,"mouseout",(function(t){r.trigger("mouseout",t)})),this._init()}Jg.$inject=["eventBus","canvas"],Jg.prototype.add=function(t){if(!t.position)throw new Error("must specifiy tooltip position");if(!t.html)throw new Error("must specifiy tooltip html");var e=this._ids.next();return t=ko({},this._tooltipDefaults,t,{id:e}),this._addTooltip(t),t.timeout&&this.setTimeout(t),e},Jg.prototype.trigger=function(t,e){var n=e.delegateTarget||e.target,i=this.get(Oo(n,"data-tooltip-id"));i&&("mouseover"===t&&i.timeout&&this.clearTimeout(i),"mouseout"===t&&i.timeout&&(i.timeout=1e3,this.setTimeout(i)))},Jg.prototype.get=function(t){return"string"!=typeof t&&(t=t.id),this._tooltips[t]},Jg.prototype.clearTimeout=function(t){if(t=this.get(t)){var e=t.removeTimer;e&&(clearTimeout(e),t.removeTimer=null)}},Jg.prototype.setTimeout=function(t){if(t=this.get(t)){this.clearTimeout(t);var e=this;t.removeTimer=setTimeout((function(){e.remove(t)}),t.timeout)}},Jg.prototype.remove=function(t){var e=this.get(t);e&&(na(e.html),na(e.htmlContainer),delete e.htmlContainer,delete this._tooltips[e.id])},Jg.prototype.show=function(){Xg(this._tooltipRoot)},Jg.prototype.hide=function(){Xg(this._tooltipRoot,!1)},Jg.prototype._updateRoot=function(t){var e=t.scale||1,n=t.scale||1,i="matrix("+e+",0,0,"+n+","+-1*t.x*e+","+-1*t.y*n+")";this._tooltipRoot.style.transform=i,this._tooltipRoot.style["-ms-transform"]=i},Jg.prototype._addTooltip=function(t){var e,n=t.id,i=t.html,r=this._tooltipRoot;i.get&&i.constructor.prototype.jquery&&(i=i.get(0)),eo(i)&&(i=Ko(i)),(e=Ko('<div data-tooltip-id="'+n+'" class="djs-tooltip" style="position: absolute">')).appendChild(i),t.type&&Do(e).add("djs-tooltip-"+t.type),t.className&&Do(e).add(t.className),t.htmlContainer=e,r.appendChild(e),this._tooltips[n]=t,this._updateTooltip(t)},Jg.prototype._updateTooltip=function(t){var e,n,i,r=t.position,o=t.htmlContainer;e=o,n=r.x,i=r.y,ko(e.style,{left:n+"px",top:i+"px"})},Jg.prototype._updateTooltipVisibilty=function(t){oo(this._tooltips,(function(e){var n=e.show,i=e.htmlContainer,r=!0;n&&((n.minZoom>t.scale||n.maxZoom<t.scale)&&(r=!1),Xg(i,r))}))},Jg.prototype._init=function(){var t=this;this._eventBus.on("canvas.viewbox.changing",(function(e){t.hide()})),this._eventBus.on("canvas.viewbox.changed",(function(e){var n;n=e.viewbox,t._updateRoot(n),t._updateTooltipVisibilty(n),t.show()}))};var Qg={__init__:["tooltips"],tooltips:["type",Jg]};function tb(t,e){if("function"!=typeof e)throw new Error("removeFn iterator must be a function");if(t){for(var n;n=t[0];)e(n);return t}}var eb=250,nb=1400;function ib(t,e,n){hp.call(this,e);var i=t.get("movePreview",!1);e.on("shape.move.start",nb,(function(t){var e=t.context,n=e.shapes,i=e.validatedShapes;e.shapes=rb(n),e.validatedShapes=rb(i)})),i&&e.on("shape.move.start",eb,(function(t){var e=t.context,n=e.shapes,r=[];oo(n,(function(t){oo(t.labels,(function(n){n.hidden||-1!==e.shapes.indexOf(n)||r.push(n),t.labelTarget&&r.push(t)}))})),oo(r,(function(t){i.makeDraggable(e,t,!0)}))})),this.preExecuted("elements.move",nb,(function(t){var e=t.context.closure,n=e.enclosedElements,i=[];oo(n,(function(t){oo(t.labels,(function(t){n[t.id]||i.push(t)}))})),e.addAll(i)})),this.preExecute(["connection.delete","shape.delete"],(function(t){var e=t.context;tb((e.connection||e.shape).labels,(function(t){n.removeShape(t,{nested:!0})}))})),this.execute("shape.delete",(function(t){var e=t.context,n=e.shape,i=n.labelTarget;i&&(e.labelTargetIndex=fs(i.labels,n),e.labelTarget=i,n.labelTarget=null)})),this.revert("shape.delete",(function(t){var e=t.context,n=e.shape,i=e.labelTarget,r=e.labelTargetIndex;i&&(ds(i.labels,n,r),n.labelTarget=i)}))}function rb(t){return ro(t,(function(e){return-1===t.indexOf(e.labelTarget)}))}Ka()(ib,hp),ib.$inject=["injector","eventBus","modeling"];var ob={__init__:["labelSupport"],labelSupport:["type",ib]},ab=251,sb=1401,cb="attach-ok";function lb(t,e,n,i,r){hp.call(this,e);var o=t.get("movePreview",!1);e.on("shape.move.start",sb,(function(t){var e,n,i=t.context,r=i.shapes,o=i.validatedShapes;i.shapes=(n=ub(e=r),vo("id",e,n)),i.validatedShapes=function(t){var e=fo(t,"id");return ro(t,(function(t){for(;t;){if(t.host&&e[t.host.id])return!1;t=t.parent}return!0}))}(o)})),o&&e.on("shape.move.start",ab,(function(t){var e=t.context;oo(ub(e.shapes),(function(t){o.makeDraggable(e,t,!0),oo(t.labels,(function(t){o.makeDraggable(e,t,!0)}))}))})),o&&e.on("shape.move.start",(function(t){var i=t.context.shapes;if(1===i.length){var r=i[0].host;r&&(n.addMarker(r,cb),e.once(["shape.move.out","shape.move.cleanup"],(function(){n.removeMarker(r,cb)})))}})),this.preExecuted("elements.move",sb,(function(t){var e=t.context,n=e.closure;oo(ub(e.shapes),(function(t){n.add(t,n.topLevel[t.host.id])}))})),this.postExecuted("elements.move",(function(t){var e=t.context,n=e.shapes,i=e.newHost;i&&1!==n.length||oo(i?n:ro(n,(function(t){var e,i=t.host;return function(t){return!!t.host}(t)&&(e=i,!(-1!==n.indexOf(e)))})),(function(t){r.updateAttachment(t,i)}))})),this.postExecuted("elements.move",(function(t){oo(t.context.shapes,(function(t){oo(t.attachers,(function(t){oo(t.outgoing.slice(),(function(t){i.allowed("connection.reconnectStart",{connection:t,source:t.source,target:t.target})||r.removeConnection(t)})),oo(t.incoming.slice(),(function(t){i.allowed("connection.reconnectEnd",{connection:t,source:t.source,target:t.target})||r.removeConnection(t)}))}))}))})),this.postExecute("shape.create",(function(t){var e=t.context,n=e.shape,i=e.host;i&&r.updateAttachment(n,i)})),this.postExecute("shape.replace",(function(t){var e=t.context,n=e.oldShape,o=e.newShape;tb(n.attachers,(function(t){"attach"===i.allowed("elements.move",{target:o,shapes:[t]})?r.updateAttachment(t,o):r.removeShape(t)})),o.attachers.length&&oo(o.attachers,(function(t){var e=xy(t,n,o);r.moveShape(t,e,t.parent)}))})),this.postExecute("shape.resize",(function(t){var e=t.context,n=e.shape,i=e.oldBounds,o=e.newBounds;oo(n.attachers,(function(t){var e=xy(t,i,o);r.moveShape(t,e,t.parent),oo(t.labels,(function(t){r.moveShape(t,e,t.parent)}))}))})),this.preExecute("shape.delete",(function(t){var e=t.context.shape;tb(e.attachers,(function(t){r.removeShape(t)})),e.host&&r.updateAttachment(e,null)})),e.on("spaceTool.move",(function(t){var e=t.context,n=e.initialized,i=e.attachSupportInitialized;if(n&&!i){var r=e.movingShapes;oo(ro(r,(function(t){var e=t.host;return e&&-1===r.indexOf(e)})),(function(t){ps(r,t),oo(t.labels,(function(e){ps(r,t.label)}))})),e.attachSupportInitialized=!0}}))}function ub(t){return $r(uo(t,(function(t){return t.attachers||[]})))}Ka()(lb,hp),lb.$inject=["injector","eventBus","canvas","rules","modeling"];var hb={__depends__:[Op],__init__:["attachSupport"],attachSupport:["type",lb]};function pb(t,e){this._eventBus=t,this._dragging=e,this._tools=[],this._active=null}pb.$inject=["eventBus","dragging"],pb.prototype.registerTool=function(t,e){var n=this._tools;if(!e)throw new Error('A tool has to be registered with it\'s "events"');n.push(t),this.bindEvents(t,e)},pb.prototype.isActive=function(t){return t&&this._active===t},pb.prototype.length=function(t){return this._tools.length},pb.prototype.setActive=function(t){var e=this._eventBus;this._active!==t&&(this._active=t,e.fire("tool-manager.update",{tool:t}))},pb.prototype.bindEvents=function(t,e){var n=this._eventBus,i=this._dragging,r=[];n.on(e.tool+".init",(function(e){if(!e.context.reactivate&&this.isActive(t))return this.setActive(null),void i.cancel();this.setActive(t)}),this),oo(e,(function(t){r.push(t+".ended"),r.push(t+".canceled")})),n.on(r,250,(function(t){var e=t.originalEvent;this._active&&(e&&Go(e.target,'.group[data-group="tools"]')||this.setActive(null))}),this)};var db={__depends__:[Sp],__init__:["toolManager"],toolManager:["type",pb]};function fb(t,e){if("x"===t){if(e>0)return"e";if(e<0)return"w"}if("y"===t){if(e>0)return"s";if(e<0)return"n"}return null}var mb=Math.abs,vb=Math.round,yb=1500,gb={x:"width",y:"height"},bb={x:"y",y:"x"};function _b(t,e,n,i,r,o){this._canvas=n,this._dragging=e,this._modeling=i,this._rules=r,this._toolManager=o;var a=this;o.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),t.on("spaceTool.selection.end",(function(e){var n=e.originalEvent.target;(e.hover||n instanceof SVGElement)&&t.once("spaceTool.selection.ended",(function(){a.activateMakeSpace(e.originalEvent)}))})),t.on("spaceTool.move",yb,(function(t){var e=t.context;e.initialized||(e.initialized=a.initializeMakeSpace(t,e))})),t.on("spaceTool.end",(function(e){var n=e.context,i=n.axis,r=n.direction,o=n.movingShapes,s=n.resizingShapes;if(n.initialized){var c={x:vb(e.dx),y:vb(e.dy)};c[bb[i]]=0;var l=!0;oo(s,(function(t){("w"===r&&e.x>t.x+t.width||"e"===r&&e.x<t.x||"n"===r&&e.y>t.y+t.height||"s"===r&&e.y<t.y)&&(l=!1)})),l&&a.makeSpace(o,s,c,r),t.once("spaceTool.ended",(function(t){a.activateSelection(t.originalEvent,!0,!0)}))}}))}_b.$inject=["eventBus","dragging","canvas","modeling","rules","toolManager"],_b.prototype.activateSelection=function(t,e,n){this._dragging.init(t,"spaceTool.selection",{trapClick:!1,cursor:"crosshair",autoActivate:e,data:{context:{reactivate:n}}})},_b.prototype.activateMakeSpace=function(t){this._dragging.init(t,"spaceTool",{autoActivate:!0,cursor:"crosshair",data:{context:{}}})},_b.prototype.makeSpace=function(t,e,n,i){return this._modeling.createSpace(t,e,n,i)},_b.prototype.initializeMakeSpace=function(t,e){var n=mb(t.dx)>mb(t.dy)?"x":"y",i=t["d"+n],r=t[n]-i;if(mb(i)<5)return!1;i<0&&(i*=-1),Mu(t)&&(i*=-1);var o=rs(this._canvas.getRootElement(),!0);return ko(e,this.calculateAdjustments(o,n,i,r),{axis:n,direction:fb(n,i)}),vh("resize-"+("x"===n?"ew":"ns")),!0},_b.prototype.calculateAdjustments=function(t,e,n,i){var r=[],o=[],a=this._rules;return t.forEach((function(t){var s=t[e],c=s+t[gb[e]];if(t.parent&&!t.waypoints)return n>0&&s>i?r.push(t):n<0&&c<i?r.push(t):s<i&&c>i&&a.allowed("shape.resize",{shape:t})?o.push(t):void 0})),{movingShapes:r,resizingShapes:o}},_b.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateSelection()},_b.prototype.isActive=function(){var t=this._dragging.context();return t&&/^spaceTool/.test(t.prefix)};var wb="djs-dragging",xb="djs-resizing",Eb=250,Sb=Math.max;function Cb(t,e,n,i,r){function o(t,e){oo(t,(function(t){r.addDragger(t,e),n.addMarker(t,wb)}))}t.on("spaceTool.selection.start",(function(t){var e=n.getLayer("space"),r=t.context,o="M 0,-10000 L 0,10000",a="M -10000,0 L 10000,0",s=xa("g");la(s,i.cls("djs-crosshair-group",["no-events"])),oa(e,s);var c=xa("path");la(c,"d",o),fa(c).add("djs-crosshair"),oa(s,c);var l=xa("path");la(l,"d",a),fa(l).add("djs-crosshair"),oa(s,l),r.crosshairGroup=s})),t.on("spaceTool.selection.move",(function(t){Vs(t.context.crosshairGroup,t.x,t.y)})),t.on("spaceTool.selection.cleanup",(function(t){var e=t.context.crosshairGroup;e&&va(e)})),t.on("spaceTool.move",Eb,(function(t){var a=t.context,s=a.line,c=a.axis,l=a.movingShapes,u=a.resizingShapes;if(a.initialized){if(!a.dragGroup){var h=n.getLayer("space");la(s=xa("path"),"d","M0,0 L0,0"),fa(s).add("djs-crosshair"),oa(h,s),a.line=s;var p=xa("g");la(p,i.cls("djs-drag-group",["no-events"])),oa(n.getDefaultLayer(),p),o(l,p),o(a.movingConnections=e.filter((function(t){var e=!1;oo(l,(function(n){oo(n.outgoing,(function(n){t===n&&(e=!0)}))}));var n=!1;oo(l,(function(e){oo(e.incoming,(function(e){t===e&&(n=!0)}))}));var i=!1;oo(u,(function(e){oo(e.outgoing,(function(e){t===e&&(i=!0)}))}));var r=!1;return oo(u,(function(e){oo(e.incoming,(function(e){t===e&&(r=!0)}))})),function(t){return t.waypoints}(t)&&(e||i)&&(n||r)})),p),a.dragGroup=p}if(!a.frameGroup){var d=xa("g");la(d,i.cls("djs-frame-group",["no-events"])),oa(n.getDefaultLayer(),d);var f=[];oo(u,(function(t){var e=r.addFrame(t,d),i=e.getBBox();f.push({element:e,initialBounds:i}),n.addMarker(t,xb)})),a.frameGroup=d,a.frames=f}la(s,{path:{x:"M"+t.x+", -10000 L"+t.x+", 10000",y:"M -10000, "+t.y+" L 10000, "+t.y}[c],display:""});var m={x:t.dx,y:t.dy};m[{x:"y",y:"x"}[a.axis]]=0,Vs(a.dragGroup,m.x,m.y),oo(a.frames,(function(t){var e,n,i=t.element,r=t.initialBounds;"e"===a.direction?la(i,{width:Sb(r.width+m.x,5)}):la(i,{width:e=Sb(r.width-m.x,5),x:r.x+r.width-e}),"s"===a.direction?la(i,{height:Sb(r.height+m.y,5)}):la(i,{height:n=Sb(r.height-m.y,5),y:r.y+r.height-n})}))}})),t.on("spaceTool.cleanup",(function(t){var e=t.context,i=e.movingShapes,r=e.movingConnections,o=e.resizingShapes,a=e.line,s=e.dragGroup,c=e.frameGroup;oo(i,(function(t){n.removeMarker(t,wb)})),oo(r,(function(t){n.removeMarker(t,wb)})),s&&(va(a),va(s)),oo(o,(function(t){n.removeMarker(t,xb)})),c&&va(c)}))}Cb.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];var kb={__init__:["spaceToolPreview"],__depends__:[Sp,Op,db,qd],spaceTool:["type",_b],spaceToolPreview:["type",Cb]};function Pb(t){this._model=t}function Tb(t,e,n,i){hp.call(this,t),this._bpmnFactory=e,this._translate=i;var r=this;function o(t){oo(t.context.oldRoot.children,(function(t){vl(t,"bpmn:BaseElement")&&r.updateParent(t)}))}function a(t){var e=t.context.shape;vl(e,"bpmn:BaseElement")&&r.updateBounds(e)}function s(t){r.updateConnection(t.context)}function c(t){r.updateConnectionWaypoints(t.context.connection)}function l(t){r.updateAttachment(t.context)}this.executed(["connection.layout","connection.create"],(function(t){var e,i=t.context;i.cropped||((e=i.connection).waypoints=n.getCroppedWaypoints(e),i.cropped=!0)})),this.reverted(["connection.layout"],(function(t){delete t.context.cropped})),this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Ob((function(t){var e=t.context;r.updateParent(e.shape||e.connection,e.oldParent)}))),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Ob((function(t){var e=t.context,n=e.shape||e.connection,i=e.parent||e.newParent;r.updateParent(n,i)}))),this.executed(["canvas.updateRoot"],o),this.reverted(["canvas.updateRoot"],o),this.executed(["shape.move","shape.create","shape.resize"],Ob((function(t){"label"!==t.context.shape.type&&a(t)}))),this.reverted(["shape.move","shape.create","shape.resize"],Ob((function(t){"label"!==t.context.shape.type&&a(t)}))),t.on("shape.changed",(function(t){"label"===t.element.type&&a({context:{shape:t.element}})})),this.executed(["connection.create","connection.move","connection.delete","connection.reconnectEnd","connection.reconnectStart"],Ob(s)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnectEnd","connection.reconnectStart"],Ob(s)),this.executed(["connection.layout","connection.move","connection.updateWaypoints"],Ob(c)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],Ob(c)),this.executed(["connection.reconnectEnd","connection.reconnectStart"],Ob((function(t){var e=t.context,n=e.connection,i=yl(n),r=yl(e.oldSource),o=yl(e.oldTarget),a=yl(n.source),s=yl(n.target);r!==a&&o!==s&&(r&&r.default===i&&(e.default=r.default,r.default=void 0),i.sourceRef&&i.sourceRef.default&&!Xh(s,["bpmn:Activity","bpmn:EndEvent","bpmn:Gateway","bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&(e.default=i.sourceRef.default,i.sourceRef.default=void 0),r&&i.conditionExpression&&!vl(a,"bpmn:Activity")&&!vl(a,"bpmn:Gateway")&&(e.conditionExpression=i.conditionExpression,i.conditionExpression=void 0),o&&i.conditionExpression&&!Xh(s,["bpmn:Activity","bpmn:EndEvent","bpmn:Gateway","bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&(e.conditionExpression=i.conditionExpression,i.conditionExpression=void 0))}))),this.reverted(["connection.reconnectEnd","connection.reconnectStart"],Ob((function(t){var e=t.context,n=e.connection,i=yl(n),r=yl(n.source);e.default&&(vl(r,"bpmn:ExclusiveGateway")||vl(r,"bpmn:InclusiveGateway")||vl(r,"bpmn:Activity"))&&(r.default=e.default),e.conditionExpression&&vl(r,"bpmn:Activity")&&(i.conditionExpression=e.conditionExpression)}))),this.executed(["element.updateAttachment"],Ob(l)),this.reverted(["element.updateAttachment"],Ob(l))}function Ob(t){return function(e){var n=e.context;vl(n.shape||n.connection,"bpmn:BaseElement")&&t(e)}}function Ab(t,e,n){Is.call(this),this._bpmnFactory=t,this._moddle=e,this._translate=n}function Mb(t,e,n){t[n]=e[n],delete e[n]}function jb(t,e){this._modeling=t,this._canvas=e}function Rb(t){this._modeling=t}function Db(t,e){this._canvas=t,this._layouter=e}Pb.$inject=["moddle"],Pb.prototype._needsId=function(t){return Xh(t,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])},Pb.prototype._ensureId=function(t){var e=(t.$type||"").replace(/^[^:]*:/g,"")+"_";!t.id&&this._needsId(t)&&(t.id=this._model.ids.nextPrefixed(e,t))},Pb.prototype.create=function(t,e){var n=this._model.create(t,e||{});return this._ensureId(n),n},Pb.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})},Pb.prototype.createDiShape=function(t,e,n){return this.create("bpmndi:BPMNShape",ko({bpmnElement:t,bounds:this.createDiBounds(e)},n))},Pb.prototype.createDiBounds=function(t){return this.create("dc:Bounds",t)},Pb.prototype.createDiWaypoints=function(t){var e=this;return uo(t,(function(t){return e.createDiWaypoint(t)}))},Pb.prototype.createDiWaypoint=function(t){return this.create("dc:Point",Po(t,["x","y"]))},Pb.prototype.createDiEdge=function(t,e,n){return this.create("bpmndi:BPMNEdge",ko({bpmnElement:t},n))},Pb.prototype.createDiPlane=function(t){return this.create("bpmndi:BPMNPlane",{bpmnElement:t})},Ka()(Tb,hp),Tb.$inject=["eventBus","bpmnFactory","connectionDocking","translate"],Tb.prototype.updateAttachment=function(t){var e=t.shape,n=e.businessObject,i=e.host;n.attachedToRef=i&&i.businessObject},Tb.prototype.updateParent=function(t,e){if(!(t instanceof Rs||vl(t,"bpmn:DataStoreReference")&&t.parent&&vl(t.parent,"bpmn:Collaboration"))){var n=t.parent,i=t.businessObject,r=n&&n.businessObject,o=r&&r.di;vl(t,"bpmn:FlowNode")&&this.updateFlowNodeRefs(i,r,e&&e.businessObject),vl(t,"bpmn:DataOutputAssociation")&&(r=t.source?t.source.businessObject:null),vl(t,"bpmn:DataInputAssociation")&&(r=t.target?t.target.businessObject:null),this.updateSemanticParent(i,r),vl(t,"bpmn:DataObjectReference")&&i.dataObjectRef&&this.updateSemanticParent(i.dataObjectRef,r),this.updateDiParent(i.di,o)}},Tb.prototype.updateBounds=function(t){var e=t.businessObject.di,n=t instanceof Rs?this._getLabel(e):e,i=n.bounds;i||(i=this._bpmnFactory.createDiBounds(),n.set("bounds",i)),ko(i,{x:t.x,y:t.y,width:t.width,height:t.height})},Tb.prototype.updateFlowNodeRefs=function(t,e,n){n!==e&&(vl(n,"bpmn:Lane")&&ps(n.get("flowNodeRef"),t),vl(e,"bpmn:Lane")&&ds(e.get("flowNodeRef"),t))},Tb.prototype.updateDiConnection=function(t,e,n){t.sourceElement&&t.sourceElement.bpmnElement!==e&&(t.sourceElement=e&&e.di),t.targetElement&&t.targetElement.bpmnElement!==n&&(t.targetElement=n&&n.di)},Tb.prototype.updateDiParent=function(t,e){if(e&&!vl(e,"bpmndi:BPMNPlane")&&(e=e.$parent),t.$parent!==e){var n=(e||t.$parent).get("planeElement");e?(n.push(t),t.$parent=e):(ps(n,t),t.$parent=null)}},Tb.prototype.getLaneSet=function(t){var e,n;return vl(t,"bpmn:Lane")?((e=t.childLaneSet)||(e=this._bpmnFactory.create("bpmn:LaneSet"),t.childLaneSet=e,e.$parent=t),e):(vl(t,"bpmn:Participant")&&(t=t.processRef),(e=(n=t.get("laneSets"))[0])||((e=this._bpmnFactory.create("bpmn:LaneSet")).$parent=t,n.push(e)),e)},Tb.prototype.updateSemanticParent=function(t,e,n){var i,r=this._translate;if(t.$parent!==e&&!((vl(t,"bpmn:DataInput")||vl(t,"bpmn:DataOutput"))&&(vl(e,"bpmn:Participant")&&"processRef"in e&&(e=e.processRef),"ioSpecification"in e&&e.ioSpecification===t.$parent))){if(vl(t,"bpmn:Lane"))e&&(e=this.getLaneSet(e)),i="lanes";else if(vl(t,"bpmn:FlowElement")){if(e)if(vl(e,"bpmn:Participant"))e=e.processRef;else if(vl(e,"bpmn:Lane"))do{e=e.$parent.$parent}while(vl(e,"bpmn:Lane"));i="flowElements"}else if(vl(t,"bpmn:Artifact")){for(;e&&!vl(e,"bpmn:Process")&&!vl(e,"bpmn:SubProcess")&&!vl(e,"bpmn:Collaboration");){if(vl(e,"bpmn:Participant")){e=e.processRef;break}e=e.$parent}i="artifacts"}else if(vl(t,"bpmn:MessageFlow"))i="messageFlows";else if(vl(t,"bpmn:Participant")){i="participants";var o,a=t.processRef;a&&(o=function(t){for(;t&&!vl(t,"bpmn:Definitions");)t=t.$parent;return t}(t.$parent||e),t.$parent&&(ps(o.get("rootElements"),a),a.$parent=null),e&&(ds(o.get("rootElements"),a),a.$parent=o))}else vl(t,"bpmn:DataOutputAssociation")?i="dataOutputAssociations":vl(t,"bpmn:DataInputAssociation")&&(i="dataInputAssociations");if(!i)throw new Error(r("no parent for {element} in {parent}",{element:t.id,parent:e.id}));var s;if(t.$parent&&ps(s=t.$parent.get(i),t),e?((s=e.get(i)).push(t),t.$parent=e):t.$parent=null,n){var c=n.get(i);ps(s,t),e&&(c||(c=[],e.set(i,c)),c.push(t))}}},Tb.prototype.updateConnectionWaypoints=function(t){t.businessObject.di.set("waypoint",this._bpmnFactory.createDiWaypoints(t.waypoints))},Tb.prototype.updateConnection=function(t){var e,n=t.connection,i=yl(n),r=yl(n.source),o=yl(n.target);if(vl(i,"bpmn:DataAssociation"))vl(i,"bpmn:DataInputAssociation")?(i.get("sourceRef")[0]=r,e=t.parent||t.newParent||o,this.updateSemanticParent(i,o,e)):vl(i,"bpmn:DataOutputAssociation")&&(e=t.parent||t.newParent||r,this.updateSemanticParent(i,r,e),i.targetRef=o);else{var a=vl(i,"bpmn:SequenceFlow");i.sourceRef!==r&&(a&&(ps(i.sourceRef&&i.sourceRef.get("outgoing"),i),r&&r.get("outgoing")&&r.get("outgoing").push(i)),i.sourceRef=r),i.targetRef!==o&&(a&&(ps(i.targetRef&&i.targetRef.get("incoming"),i),o&&o.get("incoming")&&o.get("incoming").push(i)),i.targetRef=o)}this.updateConnectionWaypoints(n),this.updateDiConnection(i.di,r,o)},Tb.prototype._getLabel=function(t){return t.label||(t.label=this._bpmnFactory.createDiLabel()),t.label},Ka()(Ab,Is),Ab.$inject=["bpmnFactory","moddle","translate"],Ab.prototype.baseCreate=Is.prototype.create,Ab.prototype.create=function(t,e){return"label"===t?this.baseCreate(t,ko({type:"label"},Jl,e)):this.createBpmnElement(t,e)},Ab.prototype.createBpmnElement=function(t,e){var n,i,r,o=this._translate,a=(e=e||{}).businessObject;if(!a){if(!e.type)throw new Error(o("no shape type specified"));a=this._bpmnFactory.create(e.type)}return a.di||(a.di="root"===t?this._bpmnFactory.createDiPlane(a,[],{id:a.id+"_di"}):"connection"===t?this._bpmnFactory.createDiEdge(a,[],{id:a.id+"_di"}):this._bpmnFactory.createDiShape(a,{},{id:a.id+"_di"})),vl(a,"bpmn:Group")&&(e=ko({isFrame:!0},e)),e.di&&(ko(a.di,e.di),delete e.di),function(t,e,n){oo(n,(function(n){void 0!==e[n]&&Mb(t,e,n)}))}(a,e,["processRef","isInterrupting","associationDirection","isForCompensation"]),e.isExpanded&&Mb(a.di,e,"isExpanded"),vl(a,"bpmn:ExclusiveGateway")&&(a.di.isMarkerVisible=!0),e.eventDefinitionType&&(i=a.get("eventDefinitions")||[],r=this._moddle.create(e.eventDefinitionType),"bpmn:ConditionalEventDefinition"===e.eventDefinitionType&&(r.condition=this._moddle.create("bpmn:FormalExpression")),i.push(r),r.$parent=a,a.eventDefinitions=i,delete e.eventDefinitionType),n=this._getDefaultSize(a),e=ko({businessObject:a,id:a.id},n,e),this.baseCreate(t,e)},Ab.prototype._getDefaultSize=function(t){return vl(t,"bpmn:SubProcess")?gl(t)?{width:350,height:200}:{width:100,height:80}:vl(t,"bpmn:Task")?{width:100,height:80}:vl(t,"bpmn:Gateway")?{width:50,height:50}:vl(t,"bpmn:Event")?{width:36,height:36}:vl(t,"bpmn:Participant")?gl(t)?{width:600,height:250}:{width:400,height:60}:vl(t,"bpmn:Lane")?{width:400,height:100}:vl(t,"bpmn:DataObjectReference")?{width:36,height:50}:vl(t,"bpmn:DataStoreReference")?{width:50,height:50}:vl(t,"bpmn:TextAnnotation")?{width:100,height:30}:vl(t,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}},Ab.prototype.createParticipantShape=function(t){return Jr(t)||(t={isExpanded:t}),!1!==(t=ko({type:"bpmn:Participant"},t||{})).isExpanded&&(t.processRef=this._bpmnFactory.create("bpmn:Process")),this.createShape(t)},jb.$inject=["modeling","canvas"],jb.prototype.preExecute=function(t){var e=this._modeling,n=t.elements,i=t.alignment;oo(n,(function(t){var n={x:0,y:0};i.left?n.x=i.left-t.x:i.right?n.x=i.right-t.width-t.x:i.center?n.x=i.center-Math.round(t.width/2)-t.x:i.top?n.y=i.top-t.y:i.bottom?n.y=i.bottom-t.height-t.y:i.middle&&(n.y=i.middle-Math.round(t.height/2)-t.y),e.moveElements([t],n,t.parent)}))},jb.prototype.postExecute=function(t){},Rb.$inject=["modeling"],Rb.prototype.preExecute=function(t){var e=t.source;if(!e)throw new Error("source required");var n=t.target||e.parent,i=t.shape;i=t.shape=this._modeling.createShape(i,t.position,n,{attach:t.attach}),t.shape=i},Rb.prototype.postExecute=function(t){var e,n,i=t.connectionParent||t.shape.parent;e=t.source,n=t.shape,lo(e.outgoing,(function(t){return t.target===n}))||this._modeling.connect(t.source,t.shape,t.connection,i)},Db.$inject=["canvas","layouter"],Db.prototype.execute=function(t){var e=t.connection,n=t.source,i=t.target,r=t.parent,o=t.parentIndex,a=t.hints;if(!n||!i)throw new Error("source and target required");if(!r)throw new Error("parent required");return e.source=n,e.target=i,e.waypoints||(e.waypoints=this._layouter.layoutConnection(e,a)),this._canvas.addConnection(e,r,o),e},Db.prototype.revert=function(t){var e=t.connection;this._canvas.removeConnection(e),e.source=null,e.target=null};var Nb=Math.round;function Ib(t){this._modeling=t}function Lb(t){return!!t.waypoints}Ib.$inject=["modeling"],Ib.prototype.preExecute=function(t){var e=t.elements,n=t.parent,i=t.parentIndex,r=t.position,o=t.hints,a=this._modeling;oo(e,(function(t){Qr(t.x)||(t.x=0),Qr(t.y)||(t.y=0)}));var s=os(e);oo(e,(function(t){Lb(t)&&(t.waypoints=uo(t.waypoints,(function(t){return{x:Nb(t.x-s.x-s.width/2+r.x),y:Nb(t.y-s.y-s.height/2+r.y)}}))),ko(t,{x:Nb(t.x-s.x-s.width/2+r.x),y:Nb(t.y-s.y-s.height/2+r.y)})}));var c=ts(e),l={};oo(e,(function(t){if(Lb(t))l[t.id]=Qr(i)?a.createConnection(l[t.source.id],l[t.target.id],i,t,t.parent||n,o):a.createConnection(l[t.source.id],l[t.target.id],t,t.parent||n,o);else{var e=ko({},o);-1===c.indexOf(t)&&(e.autoResize=!1),l[t.id]=Qr(i)?a.createShape(t,Po(t,["x","y","width","height"]),t.parent||n,i,e):a.createShape(t,Po(t,["x","y","width","height"]),t.parent||n,e)}})),t.elements=po(l)};var Bb=Math.round;function Fb(t){this._canvas=t}function zb(t){Fb.call(this,t)}Fb.$inject=["canvas"],Fb.prototype.execute=function(t){var e=t.shape,n=t.position,i=t.parent,r=t.parentIndex;if(!i)throw new Error("parent required");if(!n)throw new Error("position required");return void 0!==n.width?ko(e,n):ko(e,{x:n.x-Bb(e.width/2),y:n.y-Bb(e.height/2)}),this._canvas.addShape(e,i,r),e},Fb.prototype.revert=function(t){this._canvas.removeShape(t.shape)},Ka()(zb,Fb),zb.$inject=["canvas"];var Gb=Fb.prototype.execute;zb.prototype.execute=function(t){var e=t.shape;return function(t){["width","height"].forEach((function(e){void 0===t[e]&&(t[e]=0)}))}(e),e.labelTarget=t.labelTarget,Gb.call(this,t)};var Vb=Fb.prototype.revert;function Hb(t,e){this._canvas=t,this._modeling=e}function Ub(t,e){this._modeling=t,this._elementRegistry=e}function Wb(t,e){this._canvas=t,this._modeling=e}function $b(t){this._modeling=t}zb.prototype.revert=function(t){return t.shape.labelTarget=null,Vb.call(this,t)},Hb.$inject=["canvas","modeling"],Hb.prototype.execute=function(t){var e=t.connection,n=e.parent;return t.parent=n,t.parentIndex=fs(n.children,e),t.source=e.source,t.target=e.target,this._canvas.removeConnection(e),e.source=null,e.target=null,e},Hb.prototype.revert=function(t){var e=t.connection,n=t.parent,i=t.parentIndex;return e.source=t.source,e.target=t.target,ds(n.children,e,i),this._canvas.addConnection(e,n),e},Ub.$inject=["modeling","elementRegistry"],Ub.prototype.postExecute=function(t){var e=this._modeling,n=this._elementRegistry;oo(t.elements,(function(t){n.get(t.id)&&(t.waypoints?e.removeConnection(t):e.removeShape(t))}))},Wb.$inject=["canvas","modeling"],Wb.prototype.preExecute=function(t){var e=this._modeling,n=t.shape;tb(n.incoming,(function(t){e.removeConnection(t,{nested:!0})})),tb(n.outgoing,(function(t){e.removeConnection(t,{nested:!0})})),tb(n.children,(function(t){t.waypoints?e.removeConnection(t,{nested:!0}):e.removeShape(t,{nested:!0})}))},Wb.prototype.execute=function(t){var e=this._canvas,n=t.shape,i=n.parent;return t.oldParent=i,t.oldParentIndex=fs(i.children,n),e.removeShape(n),n},Wb.prototype.revert=function(t){var e=this._canvas,n=t.shape,i=t.oldParent,r=t.oldParentIndex;return ds(i.children,n,r),e.addShape(n,i),n},$b.$inject=["modeling"];var qb={x:"y",y:"x"};function Kb(t,e){this._layouter=t,this._canvas=e}function Yb(){}function Xb(t,e,n){var i=e_(t)[0];return wy(i.original||i,n,e)}function Zb(t,e,n){var i=e_(t),r=i[i.length-1];return wy(r.original||r,n,e)}function Jb(t,e,n){return Xb(t,e,t_(e,n))}function Qb(t,e,n){return Zb(t,e,t_(e,n))}function t_(t,e){return{x:t.x-e.x,y:t.y-e.y,width:t.width,height:t.height}}function e_(t){var e=t.waypoints;if(!e.length)throw new Error("connection#"+t.id+": no waypoints");return e}function n_(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}function i_(t){this._modeling=t}function r_(t){this._helper=new i_(t)}function o_(t){this._modeling=t,this._helper=new i_(t)}function a_(t){this._modeling=t}function s_(t,e){this._modeling=t,this._rules=e}function c_(t){this._modeling=t}function l_(t){this._modeling=t}function u_(t){this._modeling=t}function h_(t){this._modeling=t}function p_(t,e){return ps(t&&t.attachers,e)}function d_(t,e,n){if(t){var i=t.attachers;i||(t.attachers=i=[]),ds(i,e,n)}}function f_(){}function m_(t,e,n){this._eventBus=t,this._elementFactory=e,this._commandStack=n;var i=this;t.on("diagram.init",(function(){i.registerHandlers(n)}))}$b.prototype.preExecute=function(t){var e=this._modeling,n=t.groups,i=t.axis,r=t.dimension;function o(t,e){t.range.min=Math.min(e[i],t.range.min),t.range.max=Math.max(e[i]+e[r],t.range.max)}function a(t){return t[i]+t[r]/2}function s(t){return t.length-1}function c(t){return t.max-t.min}var l,u,h=n[0],p=s(n),d=n[p],f=0;oo(n,(function(t,l){var u,h,d;t.elements.length<2?l&&l!==n.length-1&&(o(t,t.elements[0]),f+=c(t.range)):(h=(u=yo(t.elements,i))[0],l===p&&(h=u[s(u)]),d=a(h),t.range=null,oo(u,(function(n){!function(t,n){var r={y:0};r[i]=t-a(n),r[i]&&(r[qb[i]]=0,e.moveElements([n],r,n.parent))}(d,n),null!==t.range?o(t,n):t.range={min:n[i],max:n[i]+n[r]}})),l&&l!==n.length-1&&(f+=c(t.range)))})),u=Math.abs(d.range.min-h.range.max),(l=Math.round((u-f)/(n.length-1)))<n.length-1||oo(n,(function(t,o){var a,s={};t!==h&&t!==d&&(a=n[o-1],t.range.max=0,oo(t.elements,(function(n,o){s[qb[i]]=0,s[i]=a.range.max-n[i]+l,t.range.min!==n[i]&&(s[i]+=n[i]-t.range.min),s[i]&&e.moveElements([n],s,n.parent),t.range.max=Math.max(n[i]+n[r],o?t.range.max:0)})))}))},$b.prototype.postExecute=function(t){},Kb.$inject=["layouter","canvas"],Kb.prototype.execute=function(t){var e=t.connection;return ko(t,{oldWaypoints:e.waypoints}),e.waypoints=this._layouter.layoutConnection(e,t.hints),e},Kb.prototype.revert=function(t){var e=t.connection;return e.waypoints=t.oldWaypoints,e},Yb.prototype.execute=function(t){var e=t.connection,n=t.delta,i=t.newParent||e.parent,r=t.newParentIndex,o=e.parent;return t.oldParent=o,t.oldParentIndex=ps(o.children,e),ds(i.children,e,r),e.parent=i,oo(e.waypoints,(function(t){t.x+=n.x,t.y+=n.y,t.original&&(t.original.x+=n.x,t.original.y+=n.y)})),e},Yb.prototype.revert=function(t){var e=t.connection,n=e.parent,i=t.oldParent,r=t.oldParentIndex,o=t.delta;return ps(n.children,e),ds(i.children,e,r),e.parent=i,oo(e.waypoints,(function(t){t.x-=o.x,t.y-=o.y,t.original&&(t.original.x-=o.x,t.original.y-=o.y)})),e},n_.prototype.add=function(t,e){return this.addAll([t],e)},n_.prototype.addAll=function(t,e){return ko(this,function(t,e,n){Yr(e)&&(e=!0),Jr(e)&&(n=e,e=!0);var i=cs((n=n||{}).allShapes),r=cs(n.allConnections),o=cs(n.enclosedElements),a=cs(n.enclosedConnections),s=cs(n.topLevel,e&&fo(t,(function(t){return t.id})));function c(t){s[t.source.id]&&s[t.target.id]&&(s[t.id]=[t]),i[t.source.id]&&i[t.target.id]&&(a[t.id]=o[t.id]=t),r[t.id]=t}return ns(t,(function(t){if(o[t.id]=t,!t.waypoints)return i[t.id]=t,oo(t.incoming,c),oo(t.outgoing,c),t.children;a[t.id]=r[t.id]=t})),{allShapes:i,allConnections:r,topLevel:s,enclosedConnections:a,enclosedElements:o}}(t,!!e,this)),this},i_.prototype.moveRecursive=function(t,e,n){return t?this.moveClosure(this.getClosure(t),e,n):[]},i_.prototype.moveClosure=function(t,e,n,i,r){var o=this._modeling,a=t.allShapes,s=t.allConnections,c=t.enclosedConnections,l=t.topLevel,u=!1;r&&r.parent===n&&(u=!0),oo(a,(function(t){o.moveShape(t,e,l[t.id]&&!u&&n,{recurse:!1,layout:!1})})),oo(s,(function(t){var i=!!a[t.source.id],r=!!a[t.target.id];c[t.id]&&i&&r?o.moveConnection(t,e,l[t.id]&&!u&&n):o.layoutConnection(t,{connectionStart:i&&Jb(t,t.source,e),connectionEnd:r&&Qb(t,t.target,e)})}))},i_.prototype.getClosure=function(t){return(new n_).addAll(t,!0)},r_.$inject=["modeling"],r_.prototype.preExecute=function(t){t.closure=this._helper.getClosure(t.shapes)},r_.prototype.postExecute=function(t){var e,n=t.hints;n&&n.primaryShape&&(e=n.primaryShape,n.oldParent=e.parent),this._helper.moveClosure(t.closure,t.delta,t.newParent,t.newHost,e)},o_.$inject=["modeling"],o_.prototype.execute=function(t){var e=t.shape,n=t.delta,i=t.newParent||e.parent,r=t.newParentIndex,o=e.parent;return t.oldBounds=Po(e,["x","y","width","height"]),t.oldParent=o,t.oldParentIndex=ps(o.children,e),ds(i.children,e,r),ko(e,{parent:i,x:e.x+n.x,y:e.y+n.y}),e},o_.prototype.postExecute=function(t){var e=t.shape,n=t.delta,i=t.hints,r=this._modeling;!1!==i.layout&&(oo(e.incoming,(function(t){r.layoutConnection(t,{connectionEnd:Qb(t,e,n)})})),oo(e.outgoing,(function(t){r.layoutConnection(t,{connectionStart:Jb(t,e,n)})}))),!1!==i.recurse&&this.moveChildren(t)},o_.prototype.revert=function(t){var e=t.shape,n=t.oldParent,i=t.oldParentIndex,r=t.delta;return ds(n.children,e,i),ko(e,{parent:n,x:e.x-r.x,y:e.y-r.y}),e},o_.prototype.moveChildren=function(t){var e=t.delta,n=t.shape;this._helper.moveRecursive(n.children,e,null)},o_.prototype.getNewParent=function(t){return t.newParent||t.shape.parent},a_.$inject=["modeling"],a_.prototype.execute=function(t){var e=t.newSource,n=t.newTarget,i=t.connection,r=t.dockingOrPoints;if(!e&&!n)throw new Error("newSource or newTarget are required");if(e&&n)throw new Error("must specify either newSource or newTarget");return Zr(r)&&(t.oldWaypoints=i.waypoints,i.waypoints=r),e&&(t.oldSource=i.source,i.source=e),n&&(t.oldTarget=i.target,i.target=n),i},a_.prototype.postExecute=function(t){var e,n,i=t.connection,r=t.dockingOrPoints,o=t.newSource,a=o?"connectionStart":"connectionEnd",s={};!1!==t.hints.layoutConnection&&(e=Zr(r)?o?r[0]:r[r.length-1]:r,s[a]=(n=e).original||n,this._modeling.layoutConnection(i,s))},a_.prototype.revert=function(t){var e=t.oldSource,n=t.oldTarget,i=t.oldWaypoints,r=t.connection;return e&&(r.source=e),n&&(r.target=n),i&&(r.waypoints=i),r},s_.$inject=["modeling","rules"],s_.prototype.preExecute=function(t){var e,n=this,i=this._modeling,r=this._rules,o=t.oldShape,a=t.newData,s=t.hints;function c(t,e,n,i){return r.allowed(t,{source:e,target:n,connection:i})}var l,u={x:a.x,y:a.y};e=t.newShape=t.newShape||n.createShape(a,u,o.parent,s),o.host&&i.updateAttachment(e,o.host),!1!==s.moveChildren&&(l=o.children.slice(),i.moveElements(l,{x:0,y:0},e));var h=o.incoming.slice(),p=o.outgoing.slice();oo(h,(function(t){var i=t.waypoints,r=i[i.length-1];c("connection.reconnectEnd",t.source,e,t)&&n.reconnectEnd(t,e,r,{layoutConnection:s.layoutConnection})})),oo(p,(function(t){var i=t.waypoints[0],r=t.target;c("connection.reconnectStart",e,r,t)&&n.reconnectStart(t,e,i,{layoutConnection:s.layoutConnection})}))},s_.prototype.postExecute=function(t){var e=this._modeling,n=t.oldShape,i=t.newShape;!1!==t.hints.layoutConnection&&(oo(i.incoming,(function(t){e.layoutConnection(t,{endChanged:!0})})),oo(i.outgoing,(function(t){e.layoutConnection(t,{startChanged:!0})}))),e.removeShape(n)},s_.prototype.execute=function(t){},s_.prototype.revert=function(t){},s_.prototype.createShape=function(t,e,n,i){return this._modeling.createShape(t,e,n,i)},s_.prototype.reconnectStart=function(t,e,n,i){this._modeling.reconnectStart(t,e,n,i)},s_.prototype.reconnectEnd=function(t,e,n,i){this._modeling.reconnectEnd(t,e,n,i)},c_.$inject=["modeling"],c_.prototype.execute=function(t){var e=t.shape,n=t.newBounds,i=t.minBounds;if(void 0===n.x||void 0===n.y||void 0===n.width||void 0===n.height)throw new Error("newBounds must have {x, y, width, height} properties");if(i&&(n.width<i.width||n.height<i.height))throw new Error("width and height cannot be less than minimum height and width");if(!i&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return t.oldBounds={width:e.width,height:e.height,x:e.x,y:e.y},ko(e,{width:n.width,height:n.height,x:n.x,y:n.y}),e},c_.prototype.postExecute=function(t){var e=t.shape,n=t.oldBounds,i=this._modeling;oo(e.incoming,(function(t){i.layoutConnection(t,{connectionEnd:Zb(t,e,n)})})),oo(e.outgoing,(function(t){i.layoutConnection(t,{connectionStart:Xb(t,e,n)})}))},c_.prototype.revert=function(t){var e=t.shape,n=t.oldBounds;return ko(e,{width:n.width,height:n.height,x:n.x,y:n.y}),e},l_.$inject=["modeling"],l_.prototype.preExecute=function(t){var e=this._modeling,n=t.resizingShapes,i=t.delta,r=t.direction;oo(n,(function(t){var n=function(t,e,n){var i=n.x,r=n.y;switch(e){case"n":return{x:t.x,y:t.y+r,width:t.width,height:t.height-r};case"s":return{x:t.x,y:t.y,width:t.width,height:t.height+r};case"w":return{x:t.x+i,y:t.y,width:t.width-i,height:t.height};case"e":return{x:t.x,y:t.y,width:t.width+i,height:t.height};default:throw new Error("unrecognized direction: "+e)}}(t,r,i);e.resizeShape(t,n)}))},l_.prototype.postExecute=function(t){var e=this._modeling,n=t.movingShapes,i=t.delta;e.moveElements(n,i,void 0,{autoResize:!1,attach:!1})},l_.prototype.execute=function(t){},l_.prototype.revert=function(t){},u_.$inject=["modeling"],u_.prototype.execute=function(t){var e=t.shape,n=e.children;t.oldChildrenVisibility=function t(e){var n={};oo(e,(function(e){n[e.id]=e.hidden,e.children&&(n=ko({},n,t(e.children)))}));return n}(n),e.collapsed=!e.collapsed;var i=function t(e,n){var i=[];oo(e,(function(e){e.hidden=n,i=i.concat(e),e.children&&(i=i.concat(t(e.children,e.collapsed||n)))}));return i}(n,e.collapsed);return[e].concat(i)},u_.prototype.revert=function(t){var e=t.shape,n=t.oldChildrenVisibility,i=function t(e,n){var i=[];oo(e,(function(e){e.hidden=n[e.id],i=i.concat(e),e.children&&(i=i.concat(t(e.children,n)))}));return i}(e.children,n);return e.collapsed=!e.collapsed,[e].concat(i)},h_.$inject=["modeling"],h_.prototype.execute=function(t){var e=t.shape,n=t.newHost,i=e.host;return t.oldHost=i,t.attacherIdx=p_(i,e),d_(n,e),e.host=n,e},h_.prototype.revert=function(t){var e=t.shape,n=t.newHost,i=t.oldHost,r=t.attacherIdx;return e.host=i,p_(n,e),d_(i,e,r),e},f_.prototype.execute=function(t){var e=t.connection,n=t.newWaypoints;return t.oldWaypoints=e.waypoints,e.waypoints=n,e},f_.prototype.revert=function(t){var e=t.connection,n=t.oldWaypoints;return e.waypoints=n,e},m_.$inject=["eventBus","elementFactory","commandStack"],m_.prototype.getHandlers=function(){return{"shape.append":Rb,"shape.create":Fb,"shape.delete":Wb,"shape.move":o_,"shape.resize":c_,"shape.replace":s_,"shape.toggleCollapse":u_,spaceTool:l_,"label.create":zb,"connection.create":Db,"connection.delete":Hb,"connection.move":Yb,"connection.layout":Kb,"connection.updateWaypoints":f_,"connection.reconnectStart":a_,"connection.reconnectEnd":a_,"elements.create":Ib,"elements.move":r_,"elements.delete":Ub,"elements.distribute":$b,"elements.align":jb,"element.updateAttachment":h_}},m_.prototype.registerHandlers=function(t){oo(this.getHandlers(),(function(e,n){t.registerHandler(n,e)}))},m_.prototype.moveShape=function(t,e,n,i,r){"object"==typeof i&&(r=i,i=null);var o={shape:t,delta:e,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("shape.move",o)},m_.prototype.updateAttachment=function(t,e){var n={shape:t,newHost:e};this._commandStack.execute("element.updateAttachment",n)},m_.prototype.moveElements=function(t,e,n,i){var r,o=(i=i||{}).attach,a=n;!0===o?(r=n,a=n.parent):!1===o&&(r=null);var s={shapes:t,delta:e,newParent:a,newHost:r,hints:i};this._commandStack.execute("elements.move",s)},m_.prototype.moveConnection=function(t,e,n,i,r){"object"==typeof i&&(r=i,i=void 0);var o={connection:t,delta:e,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("connection.move",o)},m_.prototype.layoutConnection=function(t,e){var n={connection:t,hints:e||{}};this._commandStack.execute("connection.layout",n)},m_.prototype.createConnection=function(t,e,n,i,r,o){"object"==typeof n&&(o=r,r=i,i=n,n=void 0);var a={source:t,target:e,parent:r,parentIndex:n,connection:i=this._create("connection",i),hints:o};return this._commandStack.execute("connection.create",a),a.connection},m_.prototype.createShape=function(t,e,n,i,r){"number"!=typeof i&&(r=i,i=void 0);var o,a,s=(r=r||{}).attach;t=this._create("shape",t),s?(o=n.parent,a=n):o=n;var c={position:e,shape:t,parent:o,parentIndex:i,host:a,hints:r};return this._commandStack.execute("shape.create",c),c.shape},m_.prototype.createElements=function(t,e,n,i,r){Zr(t)||(t=[t]),"number"!=typeof i&&(r=i,i=void 0);var o={position:e,elements:t,parent:n,parentIndex:i,hints:r=r||{}};return this._commandStack.execute("elements.create",o),o.elements},m_.prototype.createLabel=function(t,e,n,i){n=this._create("label",n);var r={labelTarget:t,position:e,parent:i||t.parent,shape:n};return this._commandStack.execute("label.create",r),r.shape},m_.prototype.appendShape=function(t,e,n,i,r){r=r||{};var o={source:t,position:n,target:i,shape:e=this._create("shape",e),connection:r.connection,connectionParent:r.connectionParent,attach:r.attach};return this._commandStack.execute("shape.append",o),o.shape},m_.prototype.removeElements=function(t){var e={elements:t};this._commandStack.execute("elements.delete",e)},m_.prototype.distributeElements=function(t,e,n){var i={groups:t,axis:e,dimension:n};this._commandStack.execute("elements.distribute",i)},m_.prototype.removeShape=function(t,e){var n={shape:t,hints:e||{}};this._commandStack.execute("shape.delete",n)},m_.prototype.removeConnection=function(t,e){var n={connection:t,hints:e||{}};this._commandStack.execute("connection.delete",n)},m_.prototype.replaceShape=function(t,e,n){var i={oldShape:t,newData:e,hints:n||{}};return this._commandStack.execute("shape.replace",i),i.newShape},m_.prototype.alignElements=function(t,e){var n={elements:t,alignment:e};this._commandStack.execute("elements.align",n)},m_.prototype.resizeShape=function(t,e,n,i){var r={shape:t,newBounds:e,minBounds:n,hints:i};this._commandStack.execute("shape.resize",r)},m_.prototype.createSpace=function(t,e,n,i){var r={movingShapes:t,resizingShapes:e,delta:n,direction:i};this._commandStack.execute("spaceTool",r)},m_.prototype.updateWaypoints=function(t,e,n){var i={connection:t,newWaypoints:e,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",i)},m_.prototype.reconnectStart=function(t,e,n,i){var r={connection:t,newSource:e,dockingOrPoints:n,hints:i||{}};this._commandStack.execute("connection.reconnectStart",r)},m_.prototype.reconnectEnd=function(t,e,n,i){var r={connection:t,newTarget:e,dockingOrPoints:n,hints:i||{}};this._commandStack.execute("connection.reconnectEnd",r)},m_.prototype.connect=function(t,e,n,i){return this.createConnection(t,e,n||{},t.parent,i)},m_.prototype._create=function(t,e){return e instanceof As?e:this._elementFactory.create(t,e)},m_.prototype.toggleCollapse=function(t,e){var n={shape:t,hints:e||{}};this._commandStack.execute("shape.toggleCollapse",n)};var v_="id",y_="di",g_={width:0,height:0};function b_(t,e,n,i,r){this._elementRegistry=t,this._moddle=e,this._translate=n,this._modeling=i,this._textRenderer=r}function __(t,e){return v_ in t&&t[v_]!==e[v_]}function w_(t,e){oo(e,(function(e,n){n!==y_?t.set(n,e):t.di&&function(t,e){oo(e,(function(e,n){t.set(n,e)}))}(t.di,e)}))}b_.$inject=["elementRegistry","moddle","translate","modeling","textRenderer"],b_.prototype.execute=function(t){var e=t.element,n=[e],i=this._translate;if(!e)throw new Error(i("element required"));var r=this._elementRegistry,o=this._moddle.ids,a=e.businessObject,s=function(t){var e=ko({},t);return x_.forEach((function(n){n in t&&(e[n]=yl(e[n]))})),e}(t.properties),c=t.oldProperties||function(t,e){return so(ho(e),(function(n,i){return n[i]=i!==y_?t.get(i):function(t,e){return so(e,(function(e,n){return e[n]=t.get(n),e}),{})}(t.di,ho(e.di)),n}),{})}(a,s);return __(s,a)&&(o.unclaim(a[v_]),r.updateId(e,s[v_]),o.claim(s[v_],a)),"default"in s&&(s.default&&n.push(r.get(s.default.id)),a.default&&n.push(r.get(a.default.id))),w_(a,s),t.oldProperties=c,t.changed=n,n},b_.prototype.postExecute=function(t){var e=t.element.label,n=e&&yl(e).name;if(n){var i=this._textRenderer.getExternalLabelBounds(e,n);this._modeling.resizeShape(e,i,g_)}},b_.prototype.revert=function(t){var e=t.element,n=t.properties,i=t.oldProperties,r=e.businessObject,o=this._elementRegistry,a=this._moddle.ids;return w_(r,i),__(n,r)&&(a.unclaim(n[v_]),o.updateId(e,i[v_]),a.claim(i[v_],r)),t.changed};var x_=["default"];function E_(t,e){this._canvas=t,this._modeling=e}function S_(t,e){this._modeling=t,this._spaceTool=e}function C_(t,e){this._modeling=t,this._translate=e}function k_(t,e){this._modeling=t,this._spaceTool=e}E_.$inject=["canvas","modeling"],E_.prototype.execute=function(t){var e=this._canvas,n=t.newRoot,i=n.businessObject,r=e.getRootElement(),o=r.businessObject,a=o.$parent,s=o.di;e.setRootElement(n,!0),ds(a.rootElements,i),i.$parent=a,ps(a.rootElements,o),o.$parent=null,o.di=null,s.bpmnElement=i,i.di=s,t.oldRoot=r},E_.prototype.revert=function(t){var e=this._canvas,n=t.newRoot.businessObject,i=t.oldRoot,r=i.businessObject,o=n.$parent,a=n.di;e.setRootElement(i,!0),ps(o.rootElements,n),n.$parent=null,ds(o.rootElements,r),r.$parent=o,n.di=null,a.bpmnElement=r,r.di=a},S_.$inject=["modeling","spaceTool"],S_.prototype.preExecute=function(t){var e=this._spaceTool,n=this._modeling,i=t.shape,r=t.location,o=lm(i),a=o===i,s=a?i:i.parent;cm(s).length||n.createShape({type:"bpmn:Lane"},{x:i.x+30,y:i.y,width:i.width-30,height:i.height},s);var c=[];ns(o,(function(t){return c.push(t),t===i?[]:ro(t.children,(function(t){return t!==i}))}));var l="top"===r?-120:120,u="top"===r?i.y:i.y+i.height,h=u+("top"===r?10:-10),p="top"===r?"n":"s",d=e.calculateAdjustments(c,"y",l,h);e.makeSpace(d.movingShapes,d.resizingShapes,{x:0,y:l},p),t.newLane=n.createShape({type:"bpmn:Lane"},{x:i.x+(a?30:0),y:u-("top"===r?120:0),width:i.width-(a?30:0),height:120},s)},C_.$inject=["modeling","translate"],C_.prototype.preExecute=function(t){var e=this._modeling,n=this._translate,i=t.shape,r=t.count,o=cm(i),a=o.length;if(a>r)throw new Error(n("more than {count} child lanes",{count:r}));var s,c,l,u,h,p=Math.round(i.height/r);for(h=0;h<r;h++)s=i.y+h*p,c=h===r-1?i.height-p*h:p,l={x:i.x+30,y:s,width:i.width-30,height:c},h<a?e.resizeShape(o[h],l):(u={type:"bpmn:Lane"},e.createShape(u,l,i))},k_.$inject=["modeling","spaceTool"],k_.prototype.preExecute=function(t){var e=t.shape,n=t.newBounds;!1!==t.balanced?this.resizeBalanced(e,n):this.resizeSpace(e,n)},k_.prototype.resizeBalanced=function(t,e){var n=this._modeling,i=um(t,e);n.resizeShape(t,e),i.forEach((function(t){n.resizeShape(t.shape,t.newBounds)}))},k_.prototype.resizeSpace=function(t,e){var n,i,r,o,a,s=this._spaceTool,c=mu(t),l=tm(mu(e),c),u=lm(t),h=[],p=[];ns(u,(function(t){return h.push(t),(vl(t,"bpmn:Lane")||vl(t,"bpmn:Participant"))&&p.push(t),t.children})),(l.bottom||l.top)&&(n=l.bottom||l.top,i=t.y+(l.bottom?t.height:0)+(l.bottom?-10:10),r=l.bottom?"s":"n",o=l.top>0||l.bottom<0?-n:n,a=s.calculateAdjustments(h,"y",o,i),s.makeSpace(a.movingShapes,a.resizingShapes,{x:0,y:n},r)),(l.left||l.right)&&(n=l.right||l.left,i=t.x+(l.right?t.width:0)+(l.right?-10:100),r=l.right?"e":"w",o=l.left>0||l.right<0?-n:n,a=s.calculateAdjustments(p,"x",o,i),s.makeSpace(a.movingShapes,a.resizingShapes,{x:n,y:0},r))};function P_(t){this._elementRegistry=t}function T_(t){this._moddle=t}P_.$inject=["elementRegistry"],P_.prototype.computeUpdates=function(t,e){var n=[],i=[],r={},o=[];function a(t){-1===n.indexOf(t)&&(o.push(t),n.push(t))}function s(t){return t.parent?function(t){var e=lm(t);return r[e.id]||(r[e.id]=sm(e)),r[e.id]}(t).filter((function(e){return n=t,i=mu(e),r=n.x+n.width/2,o=n.y+n.height/2,r>i.left&&r<i.right&&o>i.top&&o<i.bottom;var n,i,r,o})).map((function(t){return t.businessObject})):[]}return e.forEach((function(t){var e=lm(t);e&&-1===n.indexOf(e)&&(e.children.filter((function(t){return vl(t,"bpmn:FlowNode")})).forEach(a),n.push(e))})),t.forEach(a),o.forEach((function(t){var e=t.businessObject,n=e.get("lanes").slice(),r=s(t);i.push({flowNode:e,remove:n,add:r})})),e.forEach((function(t){var e=t.businessObject;t.parent||e.get("flowNodeRef").forEach((function(t){i.push({flowNode:t,remove:[e],add:[]})}))})),i},P_.prototype.execute=function(t){var e=t.updates;e||(e=t.updates=this.computeUpdates(t.flowNodeShapes,t.laneShapes)),e.forEach((function(t){var e=t.flowNode,n=e.get("lanes");t.remove.forEach((function(t){ps(n,t),ps(t.get("flowNodeRef"),e)})),t.add.forEach((function(t){ds(n,t),ds(t.get("flowNodeRef"),e)}))}))},P_.prototype.revert=function(t){t.updates.forEach((function(t){var e=t.flowNode,n=e.get("lanes");t.add.forEach((function(t){ps(n,t),ps(t.get("flowNodeRef"),e)})),t.remove.forEach((function(t){ds(n,t),ds(t.get("flowNodeRef"),e)}))}))},T_.$inject=["moddle"],T_.prototype.execute=function(t){var e=this._moddle.ids,n=t.id,i=t.element;t.claiming?e.claim(n,i):e.unclaim(n)},T_.prototype.revert=function(t){var e=this._moddle.ids,n=t.id,i=t.element;t.claiming?e.unclaim(n):e.claim(n,i)};var O_={fill:void 0,stroke:void 0};function A_(t){this._commandStack=t}A_.$inject=["commandStack"],A_.prototype.postExecute=function(t){var e=t.elements,n=t.colors||O_,i=this,r={};"fill"in n&&ko(r,{fill:n.fill}),"stroke"in n&&ko(r,{stroke:n.stroke}),oo(e,(function(t){i._commandStack.execute("element.updateProperties",{element:t,properties:{di:r}})}))};var M_={width:0,height:0};function j_(t,e){function n(t,e){var n=t.label||t,i=t.labelTarget||t;return function(t,e,n){var i=t.businessObject,r=wl(i);r&&("categoryValueRef"===r?i.categoryValueRef.value=e:i[r]=e)}(n,e),[n,i]}this.preExecute=function(e){var n=e.element,i=n.businessObject,r=e.newLabel;if(!ru(n)&&tu(n)&&!eu(n)&&!R_(r)){var o=iu(n);o={x:o.x,y:o.y+7},t.createLabel(n,o,{id:i.id+"_label",businessObject:i})}},this.execute=function(t){return t.oldLabel=xl(t.element),n(t.element,t.newLabel)},this.revert=function(t){return n(t.element,t.oldLabel)},this.postExecute=function(n){var i=n.element,r=i.label||i,o=n.newLabel,a=n.newBounds,s=n.hints||{};if(ru(r)&&R_(o))!1!==s.removeShape&&t.removeShape(r,{unsetLabel:!1});else if(tu(i)||vl(i,"bpmn:TextAnnotation")){var c=xl(r);c&&(void 0===a&&(a=e.getExternalLabelBounds(r,c)),a&&t.resizeShape(r,a,M_))}}}function R_(t){return!t||!t.trim()}function D_(t,e,n,i){m_.call(this,t,e,n),this._bpmnRules=i}function N_(){}j_.$inject=["modeling","textRenderer"],Ka()(D_,m_),D_.$inject=["eventBus","elementFactory","commandStack","bpmnRules"],D_.prototype.getHandlers=function(){var t=m_.prototype.getHandlers.call(this);return t["element.updateProperties"]=b_,t["canvas.updateRoot"]=E_,t["lane.add"]=S_,t["lane.resize"]=k_,t["lane.split"]=C_,t["lane.updateRefs"]=P_,t["id.updateClaim"]=T_,t["element.setColor"]=A_,t["element.updateLabel"]=j_,t},D_.prototype.updateLabel=function(t,e,n,i){this._commandStack.execute("element.updateLabel",{element:t,newLabel:e,newBounds:n,hints:i||{}})},D_.prototype.connect=function(t,e,n,i){var r=this._bpmnRules;if(n||(n=r.canConnect(t,e)),n)return this.createConnection(t,e,n,t.parent,i)},D_.prototype.updateProperties=function(t,e){this._commandStack.execute("element.updateProperties",{element:t,properties:e})},D_.prototype.resizeLane=function(t,e,n){this._commandStack.execute("lane.resize",{shape:t,newBounds:e,balanced:n})},D_.prototype.addLane=function(t,e){var n={shape:t,location:e};return this._commandStack.execute("lane.add",n),n.newLane},D_.prototype.splitLane=function(t,e){this._commandStack.execute("lane.split",{shape:t,count:e})},D_.prototype.makeCollaboration=function(){var t=this._create("root",{type:"bpmn:Collaboration"}),e={newRoot:t};return this._commandStack.execute("canvas.updateRoot",e),t},D_.prototype.updateLaneRefs=function(t,e){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:t,laneShapes:e})},D_.prototype.makeProcess=function(){var t={newRoot:this._create("root",{type:"bpmn:Process"})};this._commandStack.execute("canvas.updateRoot",t)},D_.prototype.claimId=function(t,e){this._commandStack.execute("id.updateClaim",{id:t,element:e,claiming:!0})},D_.prototype.unclaimId=function(t,e){this._commandStack.execute("id.updateClaim",{id:t,element:e})},D_.prototype.setColor=function(t,e){t.length||(t=[t]),this._commandStack.execute("element.setColor",{elements:t,colors:e})},N_.prototype.layoutConnection=function(t,e){return[(e=e||{}).connectionStart||yu(e.source||t.source),e.connectionEnd||yu(e.target||t.target)]};var I_=20,L_=5,B_=Math.round,F_=20,z_={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function G_(t,e,n){var i,r,o,a=gu(e,t,L_),s=n.split(":")[0],c=B_((e.x-t.x)/2+t.x),l=B_((e.y-t.y)/2+t.y),u=(o=a,{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[s].test(o)),h=/h|r|l/.test(s),p=!1;return u?(i=h?{x:c,y:t.y}:{x:t.x,y:l},r=h?"h:h":"v:v"):(r=h?"h:v":"v:h",function(t,e){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[e].test(t)}(a,s)?h?(p=l===t.y,i={x:t.x+I_*(/l/.test(s)?-1:1),y:p?l+I_:l}):i={x:(p=c===t.x)?c+I_:c,y:t.y+I_*(/t/.test(s)?-1:1)}:i={x:c,y:l}),{waypoints:H_(t,i,r).concat(i),directions:r,turnNextDirections:p}}function V_(t){return t.split(":").reverse().join(":")}function H_(t,e,n){if(!function(t){return t&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(t)}(n=n||"h:h"))throw new Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(K_(n)){var i=function(t,e,n){return G_(t,e,n)}(t,e,n),r=function(t,e,n){var i=G_(e,t,V_(n));return{waypoints:i.waypoints.slice().reverse(),directions:V_(i.directions),turnNextDirections:i.turnNextDirections}}(t,e,n),o=function(t,e){var n=t.directions.split(":")[1],i=e.directions.split(":")[0];t.turnNextDirections&&(n="h"==n?"v":"h"),e.turnNextDirections&&(i="h"==i?"v":"h");var r=n+":"+i;return{waypoints:H_(t.waypoints[t.waypoints.length-1],e.waypoints[0],r),directions:r}}(i,r);return[].concat(i.waypoints,o.waypoints,r.waypoints)}return function(t,e,n){var i=B_((e.x-t.x)/2+t.x),r=B_((e.y-t.y)/2+t.y);if("h:v"===n)return[{x:e.x,y:t.y}];if("v:h"===n)return[{x:t.x,y:e.y}];if("h:h"===n)return[{x:i,y:t.y},{x:i,y:e.y}];if("v:v"===n)return[{x:t.x,y:r},{x:e.x,y:r}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}(t,e,n)}function U_(t,e,n,i,r){var o=ao(r&&r.preferredLayouts||[],"straight")[0]||"h:h",a=gu(t,e,z_[o]||0),s=function(t,e){if(K_(e))return e;switch(t){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return e}}(a,o);n=n||yu(t),i=i||yu(e);var c=s.split(":");return function(t,e,n){var i=H_(t,e,n);return i.unshift(t),i.push(e),X_(i)}(Y_(n,t,c[0],function(t){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[t]}(a)),Y_(i,e,c[1],a),s)}function W_(t,e,n,i,r,o){var a;return Zr(n)&&(r=n,o=i,n=yu(t),i=yu(e)),r=r||[],(a=-1!==(o=ko({preferredLayouts:[]},o)).preferredLayouts.indexOf("straight")&&function(t,e,n,i,r){var o,a,s={};if(a=gu(t,e),!/^(top|bottom|left|right)$/.test(a))return null;/top|bottom/.test(a)&&(o="x");/left|right/.test(a)&&(o="y");return"target"===r.preserveDocking?$_(o,i,t)?(s[o]=i[o],[{x:void 0!==s.x?s.x:n.x,y:void 0!==s.y?s.y:n.y,original:{x:void 0!==s.x?s.x:n.x,y:void 0!==s.y?s.y:n.y}},{x:i.x,y:i.y}]):null:$_(o,n,e)?(s[o]=n[o],[{x:n.x,y:n.y},{x:void 0!==s.x?s.x:i.x,y:void 0!==s.y?s.y:i.y,original:{x:void 0!==s.x?s.x:i.x,y:void 0!==s.y?s.y:i.y}}]):null}(t,e,n,i,o))?a:(a=o.connectionEnd&&function(t,e,n,i){var r=i.slice().reverse();return(r=q_(t,e,n,r))?r.reverse():null}(e,t,i,r))?a:(a=o.connectionStart&&q_(t,e,n,r))||(!o.connectionStart&&!o.connectionEnd&&r&&r.length?r:U_(t,e,n,i,o))}function $_(t,e,n){return function(t,e,n){return t>=e&&t<=n}(e[t],n[t],n[t]+n[{x:"width",y:"height"}[t]])}function q_(t,e,n,i){if(function(t){return t.length<3||!(t.length>4)&&!!io(t,(function(e,n){var i=t[n-1];return i&&ou(e,i)<3}))}(i))return null;var r,o=i[0],a=i.slice();return a[0]=n,a[1]=function(t,e,n){switch(cu(e,t)){case"v":return{x:n.x,y:t.y};case"h":return{x:t.x,y:n.y}}return{x:t.x,y:t.y}}(a[1],o,n),(r=function(t,e,n){var i;for(i=t.length-2;0!==i;i--)if(lu(t[i],e,F_)||lu(t[i],n,F_))return t.slice(i);return t}(a,t,e))!==a&&(a=q_(t,e,n,r)),a&&cu(a)?null:a}function K_(t){return t&&/t|r|b|l/.test(t)}function Y_(t,e,n,i){if("h"===n&&(n=/left/.test(i)?"l":"r"),"v"===n&&(n=/top/.test(i)?"t":"b"),"t"===n)return{original:t,x:t.x,y:e.y};if("r"===n)return{original:t,x:e.x+e.width,y:t.y};if("b"===n)return{original:t,x:t.x,y:e.y+e.height};if("l"===n)return{original:t,x:e.x,y:t.y};throw new Error("unexpected dockingDirection: <"+n+">")}function X_(t){return t.reduce((function(e,n,i){return au(e[e.length-1],t[i+1],n,0)||e.push(n),e}),[])}var Z_=40;function J_(){}function Q_(t,e){return vl(e,"bpmn:Participant")?"source":vl(t,"bpmn:Participant")?"target":nw(e)?"source":nw(t)?"target":vl(e,"bpmn:Event")?"target":vl(t,"bpmn:Event")?"source":null}function tw(t,e){return t?t.original||t:yu(e)}function ew(t,e){return vl(e,"bpmn:Activity")&&vl(t,"bpmn:BoundaryEvent")&&e.businessObject.isForCompensation}function nw(t){return vl(t,"bpmn:SubProcess")&&gl(t)}function iw(t,e){return t===e}Ka()(J_,N_),J_.prototype.layoutConnection=function(t,e){var n,i,r=(e=e||{}).source||t.source,o=e.target||t.target,a=t.waypoints,s=e.connectionStart,c=e.connectionEnd;return s||(s=tw(a&&a[0],r)),c||(c=tw(a&&a[a.length-1],o)),(vl(t,"bpmn:Association")||vl(t,"bpmn:DataAssociation"))&&a&&!ew(r,o)?[].concat([s],a.slice(1,-1),[c]):(vl(t,"bpmn:MessageFlow")?n=function(t,e){return{preferredLayouts:["straight","v:v"],preserveDocking:Q_(t,e)}}(r,o):(vl(t,"bpmn:SequenceFlow")||ew(r,o))&&(n=r===o?{preferredLayouts:lw(r,t)}:vl(r,"bpmn:BoundaryEvent")?{preferredLayouts:uw(r,o,c)}:vl(r,"bpmn:Gateway")?{preferredLayouts:["v:h"]}:vl(o,"bpmn:Gateway")?{preferredLayouts:["h:v"]}:{preferredLayouts:["h:h"]}),n&&(i=X_(W_(r,o,s,c,a,n=ko(n,e)))),i||[s,c])};var rw={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},ow={top:"t",right:"r",bottom:"b",left:"l"};function aw(t){var e=/right|left/.exec(t);return e&&e[0]}function sw(t){var e=/top|bottom/.exec(t);return e&&e[0]}function cw(t){return"right"===t||"left"===t}function lw(t,e){var n=e.waypoints,i=n&&n.length&&gu(n[0],t);return"top"===i?["t:r"]:"right"===i?["r:b"]:"left"===i?["l:t"]:["b:l"]}function uw(t,e,n){var i,r,o=yu(t),a=yu(e),s=(r=(i=t).host,gu(yu(i),r,-10)),c=iw(t.host,e),l=-1!==["top","right","bottom","left"].indexOf(s),u=gu(a,o,{x:t.width/2+e.width/2,y:t.height/2+e.height/2});return c?function(t,e,n,i,r){var o,a=ow[e?t:sw(t)];o=e?cw(t)?hw("y",n,i,r)?"h":"b":hw("x",n,i,r)?"v":"l":"v";return[a+":"+o]}(s,l,t,e,n):[function(t,e,n){if(n)return ow[t];if(iw(sw(t),sw(e))||(i=aw(t),r=aw(e),rw[i]===r))return ow[sw(t)];var i,r;return ow[aw(t)]}(s,u,l)+":"+function(t,e,n){if(n)return cw(t)?(i=e,r=aw(t),o=rw[r],-1!==i.indexOf(o)||iw(t,e)?"h":"v"):function(t,e){var n=sw(t),i=rw[n];return-1!==e.indexOf(i)}(t,e)||iw(t,e)?"v":"h";var i,r,o;return cw(e)||iw(sw(t),sw(e))&&aw(e)?"h":"v"}(s,u,l)]}function hw(t,e,n,i){var r=Z_;return!(pw(t,i,n,r)||pw(t,i,{x:n.x+n.width,y:n.y+n.height},r)||pw(t,i,yu(e),r))}function pw(t,e,n,i){return Math.abs(e[t]-n[t])<i}function dw(t){return ko({original:t.point.original||t.point},t.actual)}function fw(t,e){this._elementRegistry=t,this._graphicsFactory=e}fw.$inject=["elementRegistry","graphicsFactory"],fw.prototype.getCroppedWaypoints=function(t,e,n){e=e||t.source,n=n||t.target;var i=this.getDockingPoint(t,e,!0),r=this.getDockingPoint(t,n),o=t.waypoints.slice(i.idx+1,r.idx);return o.unshift(dw(i)),o.push(dw(r)),o},fw.prototype.getDockingPoint=function(t,e,n){var i,r,o=t.waypoints;return{point:r=o[i=n?0:o.length-1],actual:this._getIntersection(e,t,n)||r,idx:i}},fw.prototype._getIntersection=function(t,e,n){return bu(this._getShapePath(t),this._getConnectionPath(e),n)},fw.prototype._getConnectionPath=function(t){return this._graphicsFactory.getConnectionPath(t)},fw.prototype._getShapePath=function(t){return this._graphicsFactory.getShapePath(t)},fw.prototype._getGfx=function(t){return this._elementRegistry.getGraphics(t)};var mw={__init__:["modeling","bpmnUpdater"],__depends__:[lg,Hg,$g,Nf,Kg,Qg,ob,hb,Uu,tv,kb],bpmnFactory:["type",Pb],bpmnUpdater:["type",Tb],elementFactory:["type",Ab],modeling:["type",D_],layouter:["type",J_],connectionDocking:["type",fw]},vw=500,yw=1250,gw=1500,bw=Math.round;function _w(t,e,n,i,r){function o(t,e,n,i){return r.allowed("elements.move",{shapes:t,delta:e,position:n,target:i})}function a(t,n,i,r){if(Jr(i)&&(r=i,i=!1),!n.waypoints&&n.parent){var o=function(t){return{x:t.x+bw(t.width/2),y:t.y+bw(t.height/2)}}(n);return e.init(t,o,"shape.move",{cursor:"grabbing",autoActivate:i,data:{shape:n,context:r||{}}}),!0}}t.on("shape.move.start",gw,(function(t){var e,n,r=t.context,o=t.shape,a=i.get().slice();-1===a.indexOf(o)&&(a=[o]),n=fo(e=a,"id"),ko(r,{shapes:a=ro(e,(function(t){for(;t=t.parent;)if(n[t.id])return!1;return!0})),validatedShapes:a,shape:o})})),t.on("shape.move.start",yw,(function(t){var e=t.context,n=e.validatedShapes;if(!(e.canExecute=o(n)))return!1})),t.on("shape.move.move",vw,(function(t){var e,n=t.context,i=n.validatedShapes,r=t.hover,a={x:t.dx,y:t.dy};e=o(i,a,{x:t.x,y:t.y},r),n.delta=a,n.canExecute=e,n.target=null!==e?r:null})),t.on("shape.move.end",(function(t){var e=t.context,i=e.delta,r=e.canExecute,o="attach"===r,a=e.shapes;if(!1===r)return!1;i.x=bw(i.x),i.y=bw(i.y),0===i.x&&0===i.y||n.moveElements(a,i,e.target,{primaryShape:e.shape,attach:o})})),t.on("element.mousedown",(function(t){var e=Pu(t);if(!e)throw new Error("must supply DOM mousedown event");return a(e,t.element)})),this.start=a}_w.$inject=["eventBus","dragging","modeling","selection","rules"];var ww=499,xw="djs-dragging",Ew="drop-ok",Sw="drop-not-ok",Cw="new-parent",kw="attach-ok";function Pw(t,e,n,i){function r(t){return function(t){return ro(t,(function(e){return!function(t){return t.waypoints}(e)||io(t,go({id:e.source.id}))&&io(t,go({id:e.target.id}))}))}(o(t))}function o(t){var e=rs(t,!0),n=uo(e,(function(t){return(t.incoming||[]).concat(t.outgoing||[])}));return $r(e.concat(n))}function a(t,n){[kw,Ew,Sw,Cw].forEach((function(i){i===n?e.addMarker(t,i):e.removeMarker(t,i)}))}t.on("shape.move.start",ww,(function(t){var a=t.context,s=a.shapes,c=a.allDraggedElements,l=r(s);if(!a.dragGroup){var u=xa("g");la(u,n.cls("djs-drag-group",["no-events"])),oa(e.getDefaultLayer(),u),a.dragGroup=u}l.forEach((function(t){i.addDragger(t,a.dragGroup)})),oo(c=c?$r([c,o(s)]):o(s),(function(t){e.addMarker(t,xw)})),a.allDraggedElements=c,a.differentParents=1!==ho(fo(s,(function(t){return t.parent&&t.parent.id}))).length})),t.on("shape.move.move",ww,(function(t){var e=t.context,n=e.dragGroup,i=e.target,r=e.shape.parent,o=e.canExecute;i&&("attach"===o?a(i,kw):e.canExecute&&i&&i.id!==r.id?a(i,Cw):a(i,e.canExecute?Ew:Sw)),Vs(n,t.dx,t.dy)})),t.on(["shape.move.out","shape.move.cleanup"],(function(t){var e=t.context.target;e&&a(e,null)})),t.on("shape.move.cleanup",(function(t){var n=t.context,i=n.allDraggedElements,r=n.dragGroup;oo(i,(function(t){e.removeMarker(t,xw)})),r&&va(r)})),this.makeDraggable=function(t,n,r){i.addDragger(n,t.dragGroup),r&&e.addMarker(n,xw),t.allDraggedElements?t.allDraggedElements.push(n):t.allDraggedElements=[n]}}Pw.$inject=["eventBus","canvas","styles","previewSupport"];var Tw={__depends__:[Nu,Uu,Bu,Op,Sp,qd],__init__:["move","movePreview"],move:["type",_w],movePreview:["type",Pw]};function Ow(t,e){this._eventBus=t,this._canvas=e,this._providers=[];var n=this;t.on("tool-manager.update",(function(t){var e=t.tool;n.updateToolHighlight(e)})),t.on("i18n.changed",(function(){n._update()})),t.on("diagram.init",(function(){n._diagramInitialized=!0,n._providers.length&&(n._init(),n._update())}))}Ow.$inject=["eventBus","canvas"],Ow.prototype.registerProvider=function(t){this._providers.push(t),this._diagramInitialized&&(this._container||this._init(),this._update())},Ow.prototype.getEntries=function(){var t={};return oo(this._providers,(function(e){oo(e.getPaletteEntries(),(function(e,n){t[n]=e}))})),t},Ow.prototype._init=function(){var t=this,e=this._eventBus,n=this._getParentContainer(),i=this._container=Ko(Ow.HTML_MARKUP);n.appendChild(i),qo.bind(i,".djs-palette-toggle, .entry","click",(function(e){var n=e.delegateTarget;if(Qo(n,".djs-palette-toggle"))return t.toggle();t.trigger("click",e)})),Wo.bind(i,"mousedown",(function(t){t.stopPropagation()})),qo.bind(i,".entry","dragstart",(function(e){t.trigger("dragstart",e)})),e.on("canvas.resized",this._layoutChanged,this),e.fire("palette.create",{container:i})},Ow.prototype._toggleState=function(t){t=t||{};var e,n=this._getParentContainer(),i=this._container,r=this._eventBus,o=Do(i);e="twoColumn"in t?t.twoColumn:this._needsCollapse(n.clientHeight,this._entries||{}),o.toggle("two-column",e),"open"in t&&o.toggle("open",t.open),r.fire("palette.changed",{twoColumn:e,open:this.isOpen()})},Ow.prototype._update=function(){var t=ta(".djs-palette-entries",this._container),e=this._entries=this.getEntries();Io(t),oo(e,(function(e,n){var i=e.group||"default",r=ta("[data-group="+i+"]",t);r||(r=Ko('<div class="group" data-group="'+i+'"></div>'),t.appendChild(r));var o,a,s,c=e.html||(e.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),l=Ko(c);r.appendChild(l),e.separator||(Oo(l,"data-action",n),e.title&&Oo(l,"title",e.title),e.className&&(o=l,a=e.className,s=Do(o),(Zr(a)?a:a.split(/\s+/g)).forEach((function(t){s.add(t)}))),e.imageUrl&&l.appendChild(Ko('<img src="'+e.imageUrl+'">')))})),this.open()},Ow.prototype.trigger=function(t,e,n){var i,r,o,a=this._entries,s=e.delegateTarget||e.target;if(!s)return e.preventDefault();(i=a[Oo(s,"data-action")])&&(r=i.action,o=e.originalEvent||e,to(r)?"click"===t&&r(o,n):r[t]&&r[t](o,n),e.preventDefault())},Ow.prototype._layoutChanged=function(){this._toggleState({})},Ow.prototype._needsCollapse=function(t,e){return t<46*Object.keys(e).length+50},Ow.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})},Ow.prototype.open=function(){this._toggleState({open:!0})},Ow.prototype.toggle=function(t){this.isOpen()?this.close():this.open()},Ow.prototype.isActiveTool=function(t){return t&&this._activeTool===t},Ow.prototype.updateToolHighlight=function(t){var e;this._toolsContainer||(e=ta(".djs-palette-entries",this._container),this._toolsContainer=ta("[data-group=tools]",e)),oo(this._toolsContainer.children,(function(e){var n=e.getAttribute("data-action");if(n){var i=Do(e);n=n.replace("-tool",""),i.contains("entry")&&n===t?i.add("highlighted-entry"):i.remove("highlighted-entry")}}))},Ow.prototype.isOpen=function(){return Do(this._container).has("open")},Ow.prototype._getParentContainer=function(){return this._canvas.getContainer()},Ow.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';var Aw={__init__:["palette"],palette:["type",Ow]};function Mw(t,e,n,i,r,o){this._selection=r,this._dragging=n;var a=this,s=function(t){var n,i=e.getDefaultLayer();la(n=t.frame=xa("rect"),{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),oa(i,n)},c=function(t){var e=t.frame,n=t.bbox;la(e,{x:n.x,y:n.y,width:n.width,height:n.height})},l=function(t){t.frame&&va(t.frame)};o.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),t.on("lasso.selection.end",(function(e){var n=e.originalEvent.target;(e.hover||n instanceof SVGElement)&&t.once("lasso.selection.ended",(function(){a.activateLasso(e.originalEvent,!0)}))})),t.on("lasso.end",(function(t){var e=jw(t),n=i.filter((function(t){return t}));a.select(n,e)})),t.on("lasso.start",(function(t){var e=t.context;e.bbox=jw(t),s(e)})),t.on("lasso.move",(function(t){var e=t.context;e.bbox=jw(t),c(e)})),t.on("lasso.cleanup",(function(t){var e=t.context;l(e)})),t.on("element.mousedown",1500,(function(t){if(function(t){var e=Pu(t)||t;return Au(t)&&e.shiftKey}(t))return a.activateLasso(t.originalEvent),!0}))}function jw(t){var e={x:t.x-t.dx,y:t.y-t.dy},n={x:t.x,y:t.y};return e.x<=n.x&&e.y<n.y||e.x<n.x&&e.y<=n.y?{x:e.x,y:e.y,width:n.x-e.x,height:n.y-e.y}:e.x>=n.x&&e.y<n.y||e.x>n.x&&e.y<=n.y?{x:n.x,y:e.y,width:e.x-n.x,height:n.y-e.y}:e.x<=n.x&&e.y>n.y||e.x<n.x&&e.y>=n.y?{x:e.x,y:n.y,width:n.x-e.x,height:e.y-n.y}:e.x>=n.x&&e.y>n.y||e.x>n.x&&e.y>=n.y?{x:n.x,y:n.y,width:e.x-n.x,height:e.y-n.y}:{x:n.x,y:n.y,width:0,height:0}}Mw.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager"],Mw.prototype.activateLasso=function(t,e){this._dragging.init(t,"lasso",{autoActivate:e,cursor:"crosshair",data:{context:{}}})},Mw.prototype.activateSelection=function(t){this._dragging.init(t,"lasso.selection",{trapClick:!1,cursor:"crosshair",data:{context:{}}})},Mw.prototype.select=function(t,e){var n=function(t,e){var n={};return oo(t,(function(t){var i=t;i.waypoints&&(i=os(i)),!Qr(e.y)&&i.x>e.x&&(n[t.id]=t),!Qr(e.x)&&i.y>e.y&&(n[t.id]=t),i.x>e.x&&i.y>e.y&&(Qr(e.width)&&Qr(e.height)&&i.width+i.x<e.width+e.x&&i.height+i.y<e.height+e.y?n[t.id]=t:Qr(e.width)&&Qr(e.height)||(n[t.id]=t))})),n}(t,e);this._selection.select(po(n))},Mw.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateSelection()},Mw.prototype.isActive=function(){var t=this._dragging.context();return t&&/^lasso/.test(t.prefix)};var Rw={__depends__:[db],__init__:["lassoTool"],lassoTool:["type",Mw]},Dw=1500;function Nw(t,e,n,i,r){this._dragging=n;var o=this,a=i.get("keyboard",!1);r.registerTool("hand",{tool:"hand",dragging:"hand.move"}),t.on("element.mousedown",Dw,(function(t){if(Mu(t))return this.activateMove(t.originalEvent),!1}),this),a&&a.addListener(Dw,(function(t){function e(t){o.activateMove(t),window.removeEventListener("mousemove",e)}Iw(t.keyEvent)&&(o.isActive()||(window.addEventListener("mousemove",e),a.addListener(Dw,(function t(i){Iw(i.keyEvent)&&(window.removeEventListener("mousemove",e),a.removeListener(t,"keyboard.keyup"),n.cancel())}),"keyboard.keyup")))}),"keyboard.keydown"),t.on("hand.end",(function(e){var n=e.originalEvent.target;if(!(e.hover||n instanceof SVGElement))return!1;t.once("hand.ended",(function(){this.activateMove(e.originalEvent,{reactivate:!0})}),this)}),this),t.on("hand.move.move",(function(t){var n=e.viewbox().scale;e.scroll({dx:t.dx*n,dy:t.dy*n})})),t.on("hand.move.end",(function(e){var n=e.context.reactivate;return!Mu(e)&&n&&t.once("hand.move.ended",(function(t){this.activateHand(t.originalEvent,!0,!0)}),this),!1}),this)}function Iw(t){return ah(" ",t)}Nw.$inject=["eventBus","canvas","dragging","injector","toolManager"],Nw.prototype.activateMove=function(t,e,n){"object"==typeof e&&(n=e,e=!1),this._dragging.init(t,"hand.move",{autoActivate:e,cursor:"grab",data:{context:n||{}}})},Nw.prototype.activateHand=function(t,e,n){this._dragging.init(t,"hand",{trapClick:!1,autoActivate:e,cursor:"grab",data:{context:{reactivate:n}}})},Nw.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateHand()},Nw.prototype.isActive=function(){var t=this._dragging.context();return!!t&&/^(hand|hand\.move)$/.test(t.prefix)};var Lw={__depends__:[db],__init__:["handTool"],handTool:["type",Nw]},Bw="connect-ok",Fw="connect-not-ok";function zw(t,e,n,i,r,o){var a=this;this._dragging=e,this._rules=o,r.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),t.on("global-connect.hover",(function(t){var e=t.context,n=t.hover,r=e.canStartConnect=a.canStartConnect(n);null!==r&&(e.startTarget=n,i.addMarker(n,r?Bw:Fw))})),t.on(["global-connect.out","global-connect.cleanup"],(function(t){var e=t.context.startTarget,n=t.context.canStartConnect;e&&i.removeMarker(e,n?Bw:Fw)})),t.on(["global-connect.ended"],(function(e){var i=e.context.startTarget,r={x:e.x,y:e.y};if(a.canStartConnect(i))return t.once("element.out",(function(){t.once(["connect.ended","connect.canceled"],(function(){t.fire("global-connect.drag.ended")})),n.start(null,i,r)})),!1}))}zw.$inject=["eventBus","dragging","connect","canvas","toolManager","rules"],zw.prototype.start=function(t){this._dragging.init(t,"global-connect",{trapClick:!1,data:{context:{}}})},zw.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.start()},zw.prototype.isActive=function(){var t=this._dragging.context();return t&&/^global-connect/.test(t.prefix)},zw.prototype.canStartConnect=function(t){return this._rules.allowed("connection.start",{source:t})};var Gw={__depends__:[jd,Op,Sp,db],globalConnect:["type",zw]};function Vw(t,e,n,i,r,o,a,s){this._palette=t,this._create=e,this._elementFactory=n,this._spaceTool=i,this._lassoTool=r,this._handTool=o,this._globalConnect=a,this._translate=s,t.registerProvider(this)}Vw.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"],Vw.prototype.getPaletteEntries=function(t){var e={},n=this._create,i=this._elementFactory,r=this._spaceTool,o=this._lassoTool,a=this._handTool,s=this._globalConnect,c=this._translate;function l(t,e,r,o,a){function s(e){var r=i.createShape(ko({type:t},a));a&&(r.businessObject.di.isExpanded=a.isExpanded),n.start(e,r)}var l=t.replace(/^bpmn:/,"");return{group:e,className:r,title:o||c("Create {type}",{type:l}),action:{dragstart:s,click:s}}}function u(t){var e=i.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),r=i.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:e});n.start(t,[e,r],{hints:{autoSelect:[r]}})}function h(t){n.start(t,i.createParticipantShape())}return ko(e,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:c("Activate the hand tool"),action:{click:function(t){a.activateHand(t)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:c("Activate the lasso tool"),action:{click:function(t){o.activateSelection(t)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:c("Activate the create/remove space tool"),action:{click:function(t){r.activateSelection(t)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:c("Activate the global connect tool"),action:{click:function(t){s.toggle(t)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":l("bpmn:StartEvent","event","bpmn-icon-start-event-none",c("Create StartEvent")),"create.intermediate-event":l("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",c("Create Intermediate/Boundary Event")),"create.end-event":l("bpmn:EndEvent","event","bpmn-icon-end-event-none",c("Create EndEvent")),"create.exclusive-gateway":l("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",c("Create Gateway")),"create.task":l("bpmn:Task","activity","bpmn-icon-task",c("Create Task")),"create.data-object":l("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",c("Create DataObjectReference")),"create.data-store":l("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",c("Create DataStoreReference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:c("Create expanded SubProcess"),action:{dragstart:u,click:u}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:c("Create Pool/Participant"),action:{dragstart:h,click:h}},"create.group":l("bpmn:Group","artifact","bpmn-icon-group",c("Create Group"))}),e};var Hw={__depends__:[Aw,sf,kb,Rw,Lw,Gw,Zl],__init__:["paletteProvider"],paletteProvider:["type",Vw]},Uw=250;function Ww(t,e,n,i,r){hp.call(this,t),t.on("shape.move.move",Uw,(function(t){var o=t.context,a=o.canExecute;o.visualReplacements||(o.visualReplacements={}),a&&a.replacements?function(t){oo(t.canExecute.replacements,(function(o){var a=o.oldElementId,s={type:o.newElementType};if(!t.visualReplacements[a]){var c=e.get(a);ko(s,{x:c.x,y:c.y});var l=n.createShape(s);i.addShape(l,c.parent);var u=ta('[data-element-id="'+Vp()(c.id)+'"]',t.dragGroup);u&&la(u,{display:"none"});var h=r.addDragger(l,t.dragGroup);t.visualReplacements[a]=h,i.removeShape(l)}}))}(o):function(t){var e=t.visualReplacements;oo(e,(function(n,i){var r=ta('[data-element-id="'+Vp()(i)+'"]',t.dragGroup);r&&la(r,{display:"inline"}),n.remove(),e[i]&&delete e[i]}))}(o)}))}Ww.$inject=["eventBus","elementRegistry","elementFactory","canvas","previewSupport"],Ka()(Ww,hp);var $w={__depends__:[qd],__init__:["bpmnReplacePreview"],bpmnReplacePreview:["type",Ww]},qw=1250,Kw=40,Yw=20,Xw=20,Zw=10,Jw=["x","y"],Qw=Math.abs;function tx(t,e){t.on(["connect.hover","connect.move","connect.end"],qw,(function(t){var n=t.context,i=n.source,r=n.target;if(!t.originalEvent||!oh(t.originalEvent)){n.initialSourcePosition||(n.initialSourcePosition=n.sourcePosition);var o,a=e.allowed("connection.create",{source:i,target:r});r&&a&&function(t,e,n){Jw.forEach((function(i){var r,o=ix(i,e);t[i]<e[i]+n?r=e[i]+n:t[i]>e[i]+o-n&&(r=e[i]+o-n),r&&bd(t,i,r)}))}(t,r,function(t){return vl(t,"bpmn:Task")?Zw:Yw}(r)),r&&(o=a,lo(["bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:SequenceFlow"],(function(t){return nx(o,t)})))?(n.sourcePosition=yd(i),Xh(r,["bpmn:Event","bpmn:Gateway"])&&ex(t,yd(r)),Xh(r,["bpmn:Task","bpmn:SubProcess"])&&function(t,e){var n=yd(e);Jw.forEach((function(i){(function(t,e,n){return t[n]>e[n]+Xw&&t[n]<e[n]+ix(n,e)-Xw})(t,e,i)&&bd(t,i,n[i])}))}(t,r),vl(i,"bpmn:BoundaryEvent")&&r===i.host&&function(t,e,n){var i=yd(e),r=gu(i,n,-10),o=[];/top|bottom/.test(r)&&o.push("x");/left|right/.test(r)&&o.push("y");o.forEach((function(e){var n,r=t[e];Qw(r-i[e])<Kw&&(n=r>i[e]?i[e]+Kw:i[e]-Kw,bd(t,e,n))}))}(t,i,r)):nx(a,"bpmn:MessageFlow")?(vl(i,"bpmn:Event")&&(n.sourcePosition=yd(i)),vl(r,"bpmn:Event")&&ex(t,yd(r))):n.sourcePosition=n.initialSourcePosition}}))}function ex(t,e){bd(t,"x",e.x),bd(t,"y",e.y)}function nx(t,e){return t&&t.type===e}function ix(t,e){return"x"===t?e.width:e.height}function rx(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}function ox(t){this._snapValues={}}tx.$inject=["eventBus","rules"],rx.prototype.getSnapOrigin=function(t){return this._snapOrigins[t]},rx.prototype.setSnapOrigin=function(t,e){this._snapOrigins[t]=e,-1===this._snapLocations.indexOf(t)&&this._snapLocations.push(t)},rx.prototype.addDefaultSnap=function(t,e){var n=this._defaultSnaps[t];n||(n=this._defaultSnaps[t]=[]),n.push(e)},rx.prototype.getSnapLocations=function(){return this._snapLocations},rx.prototype.setSnapLocations=function(t){this._snapLocations=t},rx.prototype.pointsForTarget=function(t){var e=t.id||t,n=this._targets[e];return n||(n=this._targets[e]=new ox).initDefaults(this._defaultSnaps),n},ox.prototype.add=function(t,e){var n=this._snapValues[t];n||(n=this._snapValues[t]={x:[],y:[]}),-1===n.x.indexOf(e.x)&&n.x.push(e.x),-1===n.y.indexOf(e.y)&&n.y.push(e.y)},ox.prototype.snap=function(t,e,n,i){var r=this._snapValues[e];return r&&function(t,e,n){var i,r;for(n=void 0===n?10:n,i=0;i<e.length;i++)if(r=e[i],dd(r-t)<=n)return r}(t[n],r[n],i)},ox.prototype.initDefaults=function(t){var e=this;oo(t||{},(function(t,n){oo(t,(function(t){e.add(n,t)}))}))};var ax=1250;function sx(t,e,n){var i=this;this._elementRegistry=t,e.on(["create.start","shape.move.start"],(function(t){i.initSnap(t)})),e.on(["create.move","create.end","shape.move.move","shape.move.end"],ax,(function(t){var e=t.context,r=e.shape,o=e.snapContext,a=e.target;if((!t.originalEvent||!oh(t.originalEvent))&&!gd(t)&&a){var s=o.pointsForTarget(a);s.initialized||((s=i.addSnapTargetPoints(s,r,a)).initialized=!0),n.snap(t,s)}})),e.on(["create.cleanup","shape.move.cleanup"],(function(){n.hide()}))}function cx(t){return!!t.labelTarget}sx.$inject=["elementRegistry","eventBus","snapping"],sx.prototype.initSnap=function(t){var e,n=this._elementRegistry,i=t.context,r=i.shape,o=i.snapContext;o||(o=i.snapContext=new rx);var a=(e=n.get(r.id)?yd(r,t):{x:t.x+yd(r).x,y:t.y+yd(r).y}).x-r.width/2,s=e.y-r.height/2,c=e.x+r.width/2,l=e.y+r.height/2;return o.setSnapOrigin("mid",{x:e.x-t.x,y:e.y-t.y}),cx(r)?o:(o.setSnapOrigin("top-left",{x:a-t.x,y:s-t.y}),o.setSnapOrigin("bottom-right",{x:c-t.x,y:l-t.y}),o)},sx.prototype.addSnapTargetPoints=function(t,e,n){return oo(this.getSnapTargets(e,n),(function(n){if(cx(n))cx(e)&&t.add("mid",yd(n));else if(n.waypoints){if(n.waypoints.length<3)return;oo(n.waypoints.slice(1,-1),(function(e){t.add("mid",e)}))}else{t.add("mid",yd(n))}})),Qr(e.x)&&Qr(e.y)?(this._elementRegistry.get(e.id)&&t.add("mid",yd(e)),t):t},sx.prototype.getSnapTargets=function(t,e){return _d(e).filter((function(t){return!t.hidden}))};var lx=1500;function ux(t,e){e.invoke(sx,this),t.on(["create.move","create.end"],lx,hx),t.on(["create.move","create.end","shape.move.move","shape.move.end"],lx,(function(t){var e=t.context,n=e.canExecute,i=e.target;n&&("attach"===n||n.attach)&&!gd(t)&&function(t,e){var n,i=mu(e),r=ug(t,e),o=t.context.shape;n=o.parent?{x:0,y:0}:yu(o);/top/.test(r)?bd(t,"y",i.top-n.y):/bottom/.test(r)&&bd(t,"y",i.bottom-n.y);/left/.test(r)?bd(t,"x",i.left-n.x):/right/.test(r)&&bd(t,"x",i.right-n.x)}(t,i)}))}function hx(t){var e=t.context.createConstraints;if(e){var n=e.top,i=e.right,r=e.bottom,o=e.left;(o&&o>=t.x||i&&i<=t.x)&&bd(t,"x",t.x),(n&&n>=t.y||r&&r<=t.y)&&bd(t,"y",t.y)}}function px(t,e){return-1!==t.indexOf(e)}Ka()(ux,sx),ux.$inject=["eventBus","injector"],ux.prototype.initSnap=function(t){var e=sx.prototype.initSnap.call(this,t),n=t.shape;return oo(n.outgoing,(function(n){var i=n.waypoints[0];i=i.original||i,e.setSnapOrigin(n.id+"-docking",{x:i.x-t.x,y:i.y-t.y})})),oo(n.incoming,(function(n){var i=n.waypoints[n.waypoints.length-1];i=i.original||i,e.setSnapOrigin(n.id+"-docking",{x:i.x-t.x,y:i.y-t.y})})),vl(n,"bpmn:Participant")&&e.setSnapLocations(["top-left","bottom-right","mid"]),e},ux.prototype.addSnapTargetPoints=function(t,e,n){sx.prototype.addSnapTargetPoints.call(this,t,e,n);var i=this.getSnapTargets(e,n);return oo(i,(function(n){var i;(function(t){if(vl(t,"bpmn:SubProcess")&&gl(t))return!0;return vl(t,"bpmn:Participant")}(n)||(i="bpmn:TextAnnotation",[e,n].every((function(t){return vl(t,i)}))))&&(t.add("top-left",md(n)),t.add("bottom-right",vd(n)))})),oo(e.incoming,(function(e){px(i,e.source)||t.add("mid",yu(e.source));var n=e.waypoints[0];t.add(e.id+"-docking",n.original||n)})),oo(e.outgoing,(function(e){px(i,e.target)||t.add("mid",yu(e.target));var n=e.waypoints[e.waypoints.length-1];t.add(e.id+"-docking",n.original||n)})),vl(n,"bpmn:SequenceFlow")&&(t=this.addSnapTargetPoints(t,e,n.parent)),t},ux.prototype.getSnapTargets=function(t,e){return sx.prototype.getSnapTargets.call(this,t,e).filter((function(t){return!vl(t,"bpmn:Lane")}))};var dx=1250;function fx(t,e){var n=this;t.on(["resize.start"],(function(t){n.initSnap(t)})),t.on(["resize.move","resize.end"],dx,(function(t){var i=t.context,r=i.shape,o=r.parent,a=i.direction,s=i.snapContext;if(!(t.originalEvent&&oh(t.originalEvent)||gd(t))){var c=s.pointsForTarget(o);c.initialized||((c=n.addSnapTargetPoints(c,r,o,a)).initialized=!0),e.snap(t,c)}})),t.on(["resize.cleanup"],(function(){e.hide()}))}function mx(t,e){return"nw"===e?md(t):"ne"===e?{x:(n=t).x+n.width,y:n.y}:"sw"===e?function(t){return{x:t.x,y:t.y+t.height}}(t):vd(t);var n}fx.prototype.initSnap=function(t){var e=t.context,n=e.shape,i=e.direction,r=e.snapContext;r||(r=e.snapContext=new rx);var o=mx(n,i);return r.setSnapOrigin("corner",{x:o.x-t.x,y:o.y-t.y}),r},fx.prototype.addSnapTargetPoints=function(t,e,n,i){return oo(this.getSnapTargets(e,n),(function(e){t.add("corner",vd(e)),t.add("corner",md(e))})),t.add("corner",mx(e,i)),t},fx.$inject=["eventBus","snapping"],fx.prototype.getSnapTargets=function(t,e){return _d(e).filter((function(e){return!(n=e,i=t,n.host===i||function(t){return!!t.waypoints}(e)||function(t){return!!t.hidden}(e)||function(t){return!!t.labelTarget}(e));var n,i}))};var vx=1e3;function yx(t){this._canvas=t,this._asyncHide=Eo(So(this.hide,this),vx)}yx.$inject=["canvas"],yx.prototype.snap=function(t,e){var n=t.context.snapContext,i=n.getSnapLocations(),r={x:gd(t,"x"),y:gd(t,"y")};oo(i,(function(i){var o=n.getSnapOrigin(i),a={x:t.x+o.x,y:t.y+o.y};if(oo(["x","y"],(function(t){var n;r[t]||void 0!==(n=e.snap(a,i,t,7))&&(r[t]={value:n,originValue:n-o[t]})})),r.x&&r.y)return!1})),this.showSnapLine("vertical",r.x&&r.x.value),this.showSnapLine("horizontal",r.y&&r.y.value),oo(["x","y"],(function(e){var n=r[e];Jr(n)&&bd(t,e,n.originValue)}))},yx.prototype._createLine=function(t){var e=this._canvas.getLayer("snap"),n=xa("path");return la(n,{d:"M0,0 L0,0"}),fa(n).add("djs-snap-line"),oa(e,n),{update:function(e){Qr(e)?la(n,"horizontal"===t?{d:"M-100000,"+e+" L+100000,"+e,display:""}:{d:"M "+e+",-100000 L "+e+", +100000",display:""}):la(n,{display:"none"})}}},yx.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}},yx.prototype.showSnapLine=function(t,e){var n=this.getSnapLine(t);n&&n.update(e),this._asyncHide()},yx.prototype.getSnapLine=function(t){return this._snapLines||this._createSnapLines(),this._snapLines[t]},yx.prototype.hide=function(){oo(this._snapLines,(function(t){t.update()}))};var gx={__depends__:[{__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",sx],resizeSnapping:["type",fx],snapping:["type",yx]}],__init__:["connectSnapping","createMoveSnapping"],connectSnapping:["type",tx],createMoveSnapping:["type",ux]};function bx(t,e,n,i){this._open=!1,this._results=[],this._eventMaps=[],this._canvas=t,this._eventBus=e,this._overlays=n,this._selection=i,this._container=Ko(bx.BOX_HTML),this._searchInput=ta(bx.INPUT_SELECTOR,this._container),this._resultsContainer=ta(bx.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),e.on(["canvas.destroy","diagram.destroy"],this.close,this)}function _x(t,e,n){var i=function(t){var e="";return t.forEach((function(t){t.matched?e+='<strong class="'+bx.RESULT_HIGHLIGHT_CLASS+'">'+Up(t.matched)+"</strong>":e+=Up(t.normal)})),""!==e?e:null}(e),r=Ko(n);r.innerHTML=i,t.appendChild(r)}bx.$inject=["canvas","eventBus","overlays","selection"],bx.prototype._bindEvents=function(){var t=this;function e(e,n,i,r){t._eventMaps.push({el:e,type:i,listener:qo.bind(e,n,i,r)})}e(document,"html","click",(function(e){t.close()})),e(this._container,bx.INPUT_SELECTOR,"click",(function(t){t.stopPropagation(),t.delegateTarget.focus()})),e(this._container,bx.RESULT_SELECTOR,"mouseover",(function(e){e.stopPropagation(),t._scrollToNode(e.delegateTarget),t._preselect(e.delegateTarget)})),e(this._container,bx.RESULT_SELECTOR,"click",(function(e){e.stopPropagation(),t._select(e.delegateTarget)})),e(this._container,bx.INPUT_SELECTOR,"keydown",(function(t){38===t.keyCode&&t.preventDefault(),40===t.keyCode&&t.preventDefault()})),e(this._container,bx.INPUT_SELECTOR,"keyup",(function(e){if(27===e.keyCode)return t.close();if(13===e.keyCode){var n=t._getCurrentResult();return n?t._select(n):t.close()}return 38===e.keyCode?t._scrollToDirection(!0):40===e.keyCode?t._scrollToDirection():void(37!==e.keyCode&&39!==e.keyCode&&t._search(e.delegateTarget.value))}))},bx.prototype._unbindEvents=function(){this._eventMaps.forEach((function(t){qo.unbind(t.el,t.type,t.listener)}))},bx.prototype._search=function(t){var e=this;if(this._clearResults(),t&&""!==t){var n=this._searchProvider.find(t);if(n.length){n.forEach((function(t){var n=t.element.id,i=e._createResultNode(t,n);e._results[n]={element:t.element,node:i}}));var i=ta(bx.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(i),this._preselect(i)}}},bx.prototype._scrollToDirection=function(t){var e=this._getCurrentResult();if(e){var n=t?e.previousElementSibling:e.nextElementSibling;n&&(this._scrollToNode(n),this._preselect(n))}},bx.prototype._scrollToNode=function(t){if(t&&t!==this._getCurrentResult()){var e=t.offsetTop,n=this._resultsContainer.scrollTop,i=e-this._resultsContainer.clientHeight+t.clientHeight;e<n?this._resultsContainer.scrollTop=e:n<i&&(this._resultsContainer.scrollTop=i)}},bx.prototype._clearResults=function(){Io(this._resultsContainer),this._results=[],this._resetOverlay(),this._eventBus.fire("searchPad.cleared")},bx.prototype._getCurrentResult=function(){return ta(bx.RESULT_SELECTED_SELECTOR,this._resultsContainer)},bx.prototype._createResultNode=function(t,e){var n=Ko(bx.RESULT_HTML);return t.primaryTokens.length>0&&_x(n,t.primaryTokens,bx.RESULT_PRIMARY_HTML),_x(n,t.secondaryTokens,bx.RESULT_SECONDARY_HTML),Oo(n,bx.RESULT_ID_ATTRIBUTE,e),this._resultsContainer.appendChild(n),n},bx.prototype.registerProvider=function(t){this._searchProvider=t},bx.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._bindEvents(),this._open=!0,Do(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))},bx.prototype.close=function(){this.isOpen()&&(this._unbindEvents(),this._open=!1,Do(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._resetOverlay(),this._eventBus.fire("searchPad.closed"))},bx.prototype.toggle=function(){this.isOpen()?this.close():this.open()},bx.prototype.isOpen=function(){return this._open},bx.prototype._preselect=function(t){var e=this._getCurrentResult();if(t!==e){e&&Do(e).remove(bx.RESULT_SELECTED_CLASS);var n=Oo(t,bx.RESULT_ID_ATTRIBUTE),i=this._results[n].element;Do(t).add(bx.RESULT_SELECTED_CLASS),this._resetOverlay(i),this._centerViewbox(i),this._selection.select(i),this._eventBus.fire("searchPad.preselected",i)}},bx.prototype._select=function(t){var e=Oo(t,bx.RESULT_ID_ATTRIBUTE),n=this._results[e].element;this.close(),this._resetOverlay(),this._centerViewbox(n),this._selection.select(n),this._eventBus.fire("searchPad.selected",n)},bx.prototype._centerViewbox=function(t){var e=this._canvas.viewbox(),n=os(t),i={x:n.x+n.width/2-e.outer.width/2,y:n.y+n.height/2-e.outer.height/2,width:e.outer.width,height:e.outer.height};this._canvas.viewbox(i),this._canvas.zoom(e.scale)},bx.prototype._resetOverlay=function(t){if(this._overlayId&&this._overlays.remove(this._overlayId),t){var e=function(t){var e=t.width+12,n=t.height+12,i=["width: "+e+"px","height: "+n+"px"].join("; ");return{position:{bottom:n-6,right:e-6},show:!0,html:'<div style="'+i+'" class="'+bx.OVERLAY_CLASS+'"></div>'}}(os(t));this._overlayId=this._overlays.add(t,e)}},bx.CONTAINER_SELECTOR=".djs-search-container",bx.INPUT_SELECTOR=".djs-search-input input",bx.RESULTS_CONTAINER_SELECTOR=".djs-search-results",bx.RESULT_SELECTOR=".djs-search-result",bx.RESULT_SELECTED_CLASS="djs-search-result-selected",bx.RESULT_SELECTED_SELECTOR="."+bx.RESULT_SELECTED_CLASS,bx.RESULT_ID_ATTRIBUTE="data-result-id",bx.RESULT_HIGHLIGHT_CLASS="djs-search-highlight",bx.OVERLAY_CLASS="djs-search-overlay",bx.BOX_HTML='<div class="djs-search-container djs-draggable djs-scrollable"><div class="djs-search-input"><input type="text"/></div><div class="djs-search-results"></div></div>',bx.RESULT_HTML='<div class="djs-search-result"></div>',bx.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>',bx.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';var wx={__depends__:[Zu,Uu],searchPad:["type",bx]};function xx(t,e,n){this._elementRegistry=t,this._canvas=n,e.registerProvider(this)}function Ex(t){return ro(t,(function(t){return!!t.matched})).length>0}function Sx(t,e){var n=[],i=t;if(!t)return n;t=t.toLowerCase(),e=e.toLowerCase();var r=t.indexOf(e);return r>-1?(0!==r&&n.push({normal:i.substr(0,r)}),n.push({matched:i.substr(r,e.length)}),e.length+r<t.length&&n.push({normal:i.substr(e.length+r,t.length)})):n.push({normal:i}),n}xx.$inject=["elementRegistry","searchPad","canvas"],xx.prototype.find=function(t){var e=this._canvas.getRootElement(),n=this._elementRegistry.filter((function(t){return!t.labelTarget}));return n=ro(n,(function(t){return t!==e})),n=yo(n=ro(n=uo(n,(function(e){return{primaryTokens:Sx(xl(e),t),secondaryTokens:Sx(e.id,t),element:e}})),(function(t){return Ex(t.primaryTokens)||Ex(t.secondaryTokens)})),(function(t){return xl(t.element)+t.element.id}))};var Cx={__depends__:[wx],__init__:["bpmnSearch"],bpmnSearch:["type",xx]};function kx(t){rh.call(this,t),this.on("import.parse.complete",(function(t){t.error||this._collectIds(t.definitions,t.context)}),this),this.on("diagram.destroy",(function(){this.get("moddle").ids.clear()}),this)}function Px(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Tx(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ox(){var t=this.data,e=this.verticalScrollbar,n=this.horizontalScrollbar,i=t.getSelectedRect(),r=i.l,o=i.t,a=i.left,s=i.top,c=i.width,l=i.height,u=this.getTableOffset();if(Math.abs(a)+c>u.width)n.move({left:r+c-u.width});else{var h=t.freezeTotalWidth();a<h&&n.move({left:r-1-h})}if(Math.abs(s)+l>u.height)e.move({top:o+l-u.height-1});else{var p=t.freezeTotalHeight();s<p&&e.move({top:o-1-p})}}function Ax(t,e,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==e||-1!==n){var o=this.table,a=this.selector,s=this.toolbar;t?a.setEnd(e,n,r):a.set(e,n,i),s.reset(),o.render()}}function Mx(t,e){var n=this.selector,i=this.data,r=i.rows,o=i.cols,a=Tx(n.indexes,2),s=a[0],c=a[1],l=n.range,u=l.eri,h=l.eci;if(t){var p=Tx(n.moveIndexes,2);s=p[0],c=p[1]}"left"===e?c>0&&(c-=1):"right"===e?(h!==c&&(c=h),c<o.len-1&&(c+=1)):"up"===e?s>0&&(s-=1):"down"===e?(u!==s&&(s=u),s<r.len-1&&(s+=1)):"row-first"===e?c=0:"row-last"===e?c=o.len-1:"col-first"===e?s=0:"col-last"===e&&(s=r.len-1),t&&(n.moveIndexes=[s,c]),Ax.call(this,t,s,c),Ox.call(this)}function jx(t){if(0===t.buttons&&t.target.className!=="".concat(xt,"-resizer-hover")){var e=t.offsetX,n=t.offsetY,i=this.rowResizer,r=this.colResizer,o=this.tableEl,a=this.data,s=a.rows,c=a.cols;if(e>c.indexWidth&&n>s.height)return i.hide(),void r.hide();var l=o.box(),u=a.getCellRectByXY(t.offsetX,t.offsetY);u.ri>=0&&-1===u.ci?(u.width=c.indexWidth,i.show(u,{width:l.width})):i.hide(),-1===u.ri&&u.ci>=0?(u.height=s.height,r.show(u,{height:l.height})):r.hide()}}function Rx(t){var e=this.verticalScrollbar,n=this.data,i=e.scroll().top,r=t.deltaY,o=n.rows;if(t.detail&&(r=40*t.detail),r>0){var a=n.scroll.ri+1;a<o.len&&e.move({top:i+o.getHeight(a)-1})}else{var s=n.scroll.ri-1;s>=0&&e.move({top:0===s?0:i-o.getHeight(s)})}}function Dx(t,e){var n=this.verticalScrollbar,i=this.horizontalScrollbar,r=n.scroll().top,o=i.scroll().left;"left"===t||"right"===t?i.move({left:o-e}):"up"!==t&&"down"!==t||n.move({top:r-e})}function Nx(){var t=this.data,e=this.verticalScrollbar,n=this.getTableOffset().height;e.set(n,t.rows.totalHeight())}function Ix(){var t=this.data,e=this.horizontalScrollbar,n=this.getTableOffset().width;t&&e.set(n,t.cols.totalWidth())}function Lx(){var t=this.selector,e=this.data,n=this.editor,i=Tx(e.freeze,2),r=i[0],o=i[1];if(r>0||o>0){var a=e.freezeTotalWidth(),s=e.freezeTotalHeight();n.setFreezeLengths(a,s)}t.resetAreaOffset()}function Bx(){this.table.render()}function Fx(){var t=this.tableEl,e=this.overlayerEl,n=this.overlayerCEl,i=this.table,r=this.toolbar,o=this.selector,a=this.el,s=this.getTableOffset(),c=this.getRect();t.attr(c),e.offset(c),n.offset(s),a.css("width","".concat(c.width,"px")),Nx.call(this),Ix.call(this),Lx.call(this),i.render(),r.reset(),o.reset()}function zx(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function Gx(){var t=this.data,e=this.selector;t.copy(),e.showClipboard()}function Vx(){var t=this.data,e=this.selector;t.cut(),e.showClipboard()}function Hx(t){this.data.paste(t,(function(t){return Wr("Tip",t)}))&&Fx.call(this)}function Ux(){this.data.autofilter(),Fx.call(this)}function Wx(){var t=this.toolbar;t.paintformatActive()&&(Hx.call(this,"format"),zx.call(this),t.paintformatToggle())}function $x(t){var e=this,n=this.selector,i=this.data,r=this.table,o=this.sortFilter,a=t.offsetX,s=t.offsetY,c=t.target.className==="".concat(xt,"-selector-corner"),l=i.getCellRectByXY(a,s),u=l.left,h=l.top,p=l.width,d=l.height,f=l.ri,m=l.ci,v=i.autoFilter;if(v.includes(f,m)&&u+p-20<a&&h+d-20<s){var y=v.items(m,(function(t,e){return i.rows.getCell(t,e)}));return o.set(m,y,v.getFilter(m),v.getSort(m)),void o.setOffset({left:u,top:h+d+2})}t.shiftKey||(c?n.showAutofill(f,m):Ax.call(this,!1,f,m),_t(window,(function(t){var r=i.getCellRectByXY(t.offsetX,t.offsetY);f=r.ri,m=r.ci,c?n.showAutofill(f,m):1!==t.buttons||t.shiftKey||Ax.call(e,!0,f,m,!0,!0)}),(function(){c&&i.autofill(n.arange,"all",(function(t){return Wr("Tip",t)}))&&r.render(),n.hideAutofill(),Wx.call(e)}))),c||1!==t.buttons||t.shiftKey&&Ax.call(this,!0,f,m)}function qx(){var t=this.editor,e=this.data.getSelectedRect(),n=this.getTableOffset(),i="top";e.top>n.height/2&&(i="bottom"),t.setOffset(e,i)}function Kx(){var t=this.editor,e=this.data;qx.call(this),t.setCell(e.getSelectedCell(),e.getSelectedValidator()),zx.call(this)}function Yx(t){var e=this,n=this.data,i=this.table,r=this.selector;n.scrolly(t,(function(){r.resetBRLAreaOffset(),qx.call(e),i.render()}))}function Xx(t){var e=this,n=this.data,i=this.table,r=this.selector;n.scrollx(t,(function(){r.resetBRTAreaOffset(),qx.call(e),i.render()}))}function Zx(t){var e=this,n=this.data,i=this.table,r=this.selector;n.sync_scrolly(t,(function(){r.resetBRLAreaOffset(),qx.call(e),i.render()}))}function Jx(t){var e=this,n=this.data,i=this.table,r=this.selector;n.sync_scrollx(t,(function(){r.resetBRTAreaOffset(),qx.call(e),i.render()}))}function Qx(t,e){var n=t.ri,i=this.table,r=this.selector,o=this.data;o.rows.setHeight(n,e),o.setRowHeight(n,e),i.render(),r.resetAreaOffset(),Nx.call(this),qx.call(this)}function tE(t,e){var n=t.ci,i=this.table,r=this.selector,o=this.data;o.cols.setWidth(n,e),o.setColWidth(n,e),i.render(),r.resetAreaOffset(),Ix.call(this),qx.call(this)}function eE(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",n=this.data,i=this.table;n.setSelectedCellText(t,e),"finished"===e&&i.render()}function nE(t){var e=this.data;"insert-row"===t?e.insert("row"):"delete-row"===t?e.delete("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e.delete("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t&&e.deleteCell("text"),zx.call(this),Fx.call(this)}function iE(t,e){var n=this.data;if("undo"===t)this.undo();else if("redo"===t)this.redo();else if("print"===t);else if("paintformat"===t)!0===e?Gx.call(this):zx.call(this);else if("clearformat"===t)nE.call(this,"delete-cell-format");else if("link"===t);else if("chart"===t);else if("autofilter"===t)Ux.call(this);else if("freeze"===t)if(e){var i=n.selector,r=i.ri,o=i.ci;this.freeze(r,o)}else this.freeze(0,0);else"overlayer"===t?this.enableOverlayer(e):(n.setSelectedCellAttr(t,e),"formula"===t&&Kx.call(this),Fx.call(this))}function rE(t,e,n,i){this.data.setAutoFilter(t,e,n,i),Fx.call(this)}function oE(){var t,e,n,i,r,o,a=this,s=this.overlayerEl,c=this.rowResizer,l=this.colResizer,u=this.verticalScrollbar,h=this.horizontalScrollbar,p=this.editor,d=this.contextMenu,f=this.data,m=this.toolbar,v=this.modalValidation,y=this.sortFilter;s.on("mousemove",(function(t){jx.call(a,t)})).on("mousedown",(function(t){2===t.buttons?f.xyInSelectedRect(t.offsetX,t.offsetY)?(d.setPosition(t.offsetX,t.offsetY),t.stopPropagation()):d.hide():2===t.detail?Kx.call(a):(p.clear(),$x.call(a,t))})).on("mousewheel.stop",(function(t){Rx.call(a,t)})),t=s.el,n=(e={move:function(t,e){Dx.call(a,t,e)}}).move,i=e.end,r=0,o=0,vt(t,"touchstart",(function(t){var e=t.touches[0],n=e.pageX,i=e.pageY;r=n,o=i})),vt(t,"touchmove",(function(t){if(n){var e=t.changedTouches[0],i=e.pageX,a=e.pageY,s=i-r,c=a-o;(Math.abs(s)>10||Math.abs(c)>10)&&(wt(s,c,t,n),r=i,o=a),t.preventDefault()}})),vt(t,"touchend",(function(t){if(i){var e=t.changedTouches[0],n=e.pageX,a=e.pageY;wt(n-r,a-o,t,i)}})),m.change=function(t,e){return iE.call(a,t,e)},y.ok=function(t,e,n,i){return rE.call(a,t,e,n,i)},c.finishedFn=function(t,e){Qx.call(a,t,e)},l.finishedFn=function(t,e){tE.call(a,t,e)},u.moveFn=function(t,e){Yx.call(a,t,e)},h.moveFn=function(t,e){Xx.call(a,t,e)},p.change=function(t,e){eE.call(a,e,t)},v.change=function(t){if("save"===t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];f.addValidation.apply(f,n)}else f.removeValidation()},d.itemClick=function(t){"validation"===t?v.setValue(f.getSelectedValidation()):"copy"===t?Gx.call(a):"cut"===t?Vx.call(a):"paste"===t?Hx.call(a,"all"):"paste-value"===t?Hx.call(a,"text"):"paste-format"===t?Hx.call(a,"format"):nE.call(a,t)},vt(window,"resize",(function(){a.reload()})),vt(window,"click",(function(t){a.focusing=s.contains(t.target)})),vt(window,"keydown",(function(t){if(a.focusing){var e=t.keyCode||t.which,n=t.key,i=t.ctrlKey,r=t.shiftKey,o=t.altKey,s=t.metaKey;if(i||s){var c="all";switch(r&&(c="text"),o&&(c="format"),e){case 90:a.undo(),t.preventDefault();break;case 89:a.redo(),t.preventDefault();break;case 67:Gx.call(a),t.preventDefault();break;case 88:Vx.call(a),t.preventDefault();break;case 85:m.trigger("underline"),t.preventDefault();break;case 86:Hx.call(a,c),t.preventDefault();break;case 37:Mx.call(a,r,"row-first"),t.preventDefault();break;case 38:Mx.call(a,r,"col-first"),t.preventDefault();break;case 39:Mx.call(a,r,"row-last"),t.preventDefault();break;case 40:Mx.call(a,r,"col-last"),t.preventDefault();break;case 32:Ax.call(a,!1,-1,f.selector.ci,!1),t.preventDefault();break;case 66:m.trigger("font-bold");break;case 73:m.trigger("font-italic")}}else{switch(e){case 32:r&&Ax.call(a,!1,f.selector.ri,-1,!1);break;case 27:d.hide(),zx.call(a);break;case 37:Mx.call(a,r,"left"),t.preventDefault();break;case 38:Mx.call(a,r,"up"),t.preventDefault();break;case 39:Mx.call(a,r,"right"),t.preventDefault();break;case 40:Mx.call(a,r,"down"),t.preventDefault();break;case 9:p.clear(),Mx.call(a,!1,r?"left":"right"),t.preventDefault();break;case 13:o||(p.clear(),Mx.call(a,!1,r?"up":"down"),t.preventDefault());break;case 8:nE.call(a,"delete-cell-text"),t.preventDefault()}"Delete"===n?(nE.call(a,"delete-cell-text"),t.preventDefault()):e>=65&&e<=90||e>=48&&e<=57||e>=96&&e<=105||"="===t.key?(eE.call(a,t.key,"input"),Kx.call(a)):113===e&&Kx.call(a)}}}))}function aE(t,e){new kx({container:t}).importXML(e,(function(){}))}Ka()(kx,rh),kx.Viewer=rh,kx.NavigatedViewer=jh,kx.prototype.createDiagram=function(t){return this.importXML('<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" targetNamespace="http://bpmn.io/schema/bpmn" id="Definitions_1"><bpmn:process id="Process_1" isExecutable="false"><bpmn:startEvent id="StartEvent_1"/></bpmn:process><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1"><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>',t)},kx.prototype._createModdle=function(t){var e=rh.prototype._createModdle.call(this,t);return e.ids=new Al([32,36,1]),e},kx.prototype._collectIds=function(t,e){var n,i=t.$model.ids;for(n in i.clear(),e.elementsById)i.claim(n,e.elementsById[n])},kx.prototype._interactionModules=[fh,Sh,Hh,Mh],kx.prototype._modelingModules=[Yh,up,Pp,yp,Cd,jd,Dd,dm,Pf,sf,gm,Em,Vm,Um,$m,Jm,mv,mw,Tw,Hw,$w,sv,gx,Cx],kx.prototype._modules=[].concat(kx.prototype._modules,kx.prototype._interactionModules,kx.prototype._modelingModules);var sE=function(){function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=n.settings,o=r.view,s=r.showToolbar,c=r.showContextmenu;this.el=a("div","".concat(xt,"-sheet")),this.toolbar=new vr(n,o.width,!s),e.children(this.toolbar.el,this.el),this.data=n,this.tableEl=a("div","".concat(xt,"-table")),this.svgEl=a("div","".concat(xt,"-svg")),this.svgEl.css("position","absolute"),this.svgEl.css("top","0px"),this.svgEl.css("left","0px"),this.svgEl.css("width","1000px"),this.svgEl.css("height","1000px"),fetch("pizza-collaboration.bpmn").then((function(t){if(t.ok)return t.text();throw new Error})).then((function(t){aE.call(i,i.svgEl.el,t)})).catch((function(t){return console.log("BPMN fetch: ",t)})),this.rowResizer=new St(!1,n.rows.height),this.colResizer=new St(!0,n.cols.minWidth),this.verticalScrollbar=new kt(!0),this.horizontalScrollbar=new kt(!1),this.editor=new be(Ne,(function(){return i.getTableOffset()}),n.rows.height),this.modalValidation=new Br,this.contextMenu=new Ce((function(){return i.getTableOffset()}),!c),this.selector=new Wt(n),this.overlayerCEl=a("div","".concat(xt,"-overlayer-content")).children(this.editor.el,this.selector.el),this.overlayerEl=a("div","".concat(xt,"-overlayer")).child(this.overlayerCEl),this.sortFilter=new Ur,this.el.children(this.tableEl,this.svgEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el),this.table=new zn(this.tableEl.el,n),oE.call(this),Fx.call(this),Ax.call(this,!1,0,0),this.sync_sheets=[]}var e,n,i;return e=t,(n=[{key:"exportData",value:function(){return this.data.getData()}},{key:"setLayer",value:function(){this.table.setlayer()}},{key:"loadData",value:function(t){return this.data.setData(t),this.setLayer(),Fx.call(this),console.log("loadData end"),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),Fx.call(this),this}},{key:"undo",value:function(){this.data.undo(),Fx.call(this)}},{key:"redo",value:function(){this.data.redo(),Fx.call(this)}},{key:"reload",value:function(){return Fx.call(this),this}},{key:"sync",value:function(){Bx.call(this)}},{key:"sync_movex",value:function(t){Jx.call(this,t)}},{key:"sync_movey",value:function(t){Zx.call(this,t)}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,n=t.cols,i=this.getRect(),r=i.width,o=i.height;return{width:r-n.indexWidth,height:o-e.height,left:n.indexWidth,top:e.height}}},{key:"enableOverlayer",value:function(t){t?(this.overlayerEl.show(),this.table.listening(!0)):(this.overlayerEl.hide(),this.table.listening(!1))}}])&&Px(e.prototype,n),i&&Px(e,i),t}(),cE=(n(67),n(26)),lE=n.n(cE);function uE(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}n.d(e,"spreadsheet",(function(){return pE}));var hE=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var i=e,r=e;"string"==typeof e&&(i=document.querySelector(e),r=document.querySelector(e+"2")),this.data=new mt("sheet1",n),this.data2=new mt("sheet2",n);var o=a("div","".concat(xt)).on("contextmenu",(function(t){return t.preventDefault()})),s=a("div","".concat(xt)).on("contextmenu",(function(t){return t.preventDefault()}));i.appendChild(o.el),r.appendChild(s.el),this.sheet=new sE(o,this.data),this.sheet2=new sE(s,this.data2),this.data.verticalAddSplitSheet(this.sheet2),this.data2.verticalAddSplitSheet(this.sheet)}var e,n,i;return e=t,i=[{key:"locale",value:function(t,e){U(t,e)}}],(n=[{key:"getEl",value:function(){return this.rootEl2}},{key:"loadData",value:function(t){return this.sheet.loadData(t),this.sheet2.loadData(t),this}},{key:"getData",value:function(){return this.data.getData()}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(t){return console.log("Spreadsheet change"),this.data.change=t,this}}])&&uE(e.prototype,n),i&&uE(e,i),t}(),pE=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new hE(t,e)};window&&(window.x=window.x||{},window.x.spreadsheet=pE,window.x.spreadsheet.locale=function(t,e){return U(t,e)});var dE=new lE.a,fE={b:!0,c:"#ff8800",n:50,s:"string"},mE=dE.addFolder({title:"Number"});mE.addInput(fE,"n",{label:"text"}),mE.addInput(fE,"n",{label:"slider",max:100,min:0}),mE.addInput(fE,"n",{label:"list",options:{low:0,medium:50,high:100}});var vE=dE.addFolder({title:"String"});vE.addInput(fE,"s",{label:"text"}),vE.addInput(fE,"s",{label:"list",options:{dark:"Dark",light:"Light"}}),dE.addFolder({title:"Boolean"}).addInput(fE,"b",{label:"checkbox"}),dE.addFolder({title:"Color"}).addInput(fE,"c",{label:"text"});e.default=hE}]);
//# sourceMappingURL=xspreadsheet.js.map